/*! For license information please see main.1daf90a3.js.LICENSE.txt */
!function(){var e={1694:function(e,t){var i;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var a=typeof i;if("string"===a||"number"===a)e.push(i);else if(Array.isArray(i)){if(i.length){var o=r.apply(null,i);o&&e.push(o)}}else if("object"===a)if(i.toString===Object.prototype.toString)for(var s in i)n.call(i,s)&&i[s]&&e.push(s);else e.push(i.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(i=function(){return r}.apply(t,[]))||(e.exports=i)}()},908:function(e,t,i){var n=i(8136)(i(7009),"DataView");e.exports=n},9676:function(e,t,i){var n=i(5403),r=i(2747),a=i(6037),o=i(4154),s=i(7728);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},8384:function(e,t,i){var n=i(3894),r=i(8699),a=i(4957),o=i(7184),s=i(7109);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},5797:function(e,t,i){var n=i(8136)(i(7009),"Map");e.exports=n},8059:function(e,t,i){var n=i(4086),r=i(9255),a=i(9186),o=i(3423),s=i(3739);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},8319:function(e,t,i){var n=i(8136)(i(7009),"Promise");e.exports=n},3924:function(e,t,i){var n=i(8136)(i(7009),"Set");e.exports=n},692:function(e,t,i){var n=i(8059),r=i(5774),a=i(1596);function o(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new n;++t<i;)this.add(e[t])}o.prototype.add=o.prototype.push=r,o.prototype.has=a,e.exports=o},2854:function(e,t,i){var n=i(8384),r=i(511),a=i(835),o=i(707),s=i(8832),l=i(5077);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,e.exports=u},7197:function(e,t,i){var n=i(7009).Symbol;e.exports=n},6219:function(e,t,i){var n=i(7009).Uint8Array;e.exports=n},7091:function(e,t,i){var n=i(8136)(i(7009),"WeakMap");e.exports=n},4903:function(e){e.exports=function(e,t){for(var i=-1,n=null==e?0:e.length,r=0,a=[];++i<n;){var o=e[i];t(o,i,e)&&(a[r++]=o)}return a}},7538:function(e,t,i){var n=i(6478),r=i(4963),a=i(3629),o=i(5174),s=i(6800),l=i(9102),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var i=a(e),c=!i&&r(e),h=!i&&!c&&o(e),p=!i&&!c&&!h&&l(e),d=i||c||h||p,f=d?n(e.length,String):[],m=f.length;for(var v in e)!t&&!u.call(e,v)||d&&("length"==v||h&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,m))||f.push(v);return f}},1705:function(e){e.exports=function(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}},7897:function(e){e.exports=function(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}},7112:function(e,t,i){var n=i(9231);e.exports=function(e,t){for(var i=e.length;i--;)if(n(e[i][0],t))return i;return-1}},1986:function(e,t,i){var n=i(1705),r=i(3629);e.exports=function(e,t,i){var a=t(e);return r(e)?a:n(a,i(e))}},9066:function(e,t,i){var n=i(7197),r=i(1587),a=i(3581),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?r(e):a(e)}},4906:function(e,t,i){var n=i(9066),r=i(3141);e.exports=function(e){return r(e)&&"[object Arguments]"==n(e)}},1848:function(e,t,i){var n=i(3355),r=i(3141);e.exports=function e(t,i,a,o,s){return t===i||(null==t||null==i||!r(t)&&!r(i)?t!==t&&i!==i:n(t,i,a,o,e,s))}},3355:function(e,t,i){var n=i(2854),r=i(5305),a=i(2206),o=i(8078),s=i(8383),l=i(3629),u=i(5174),c=i(9102),h="[object Arguments]",p="[object Array]",d="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,i,m,v,y){var g=l(e),_=l(t),b=g?p:s(e),x=_?p:s(t),w=(b=b==h?d:b)==d,k=(x=x==h?d:x)==d,P=b==x;if(P&&u(e)){if(!u(t))return!1;g=!0,w=!1}if(P&&!w)return y||(y=new n),g||c(e)?r(e,t,i,m,v,y):a(e,t,b,i,m,v,y);if(!(1&i)){var S=w&&f.call(e,"__wrapped__"),T=k&&f.call(t,"__wrapped__");if(S||T){var E=S?e.value():e,C=T?t.value():t;return y||(y=new n),v(E,C,i,m,y)}}return!!P&&(y||(y=new n),o(e,t,i,m,v,y))}},6703:function(e,t,i){var n=i(4786),r=i(257),a=i(8092),o=i(7907),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,p=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||r(e))&&(n(e)?p:s).test(o(e))}},8150:function(e,t,i){var n=i(9066),r=i(4635),a=i(3141),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&r(e.length)&&!!o[n(e)]}},3654:function(e,t,i){var n=i(2936),r=i(8836),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return r(e);var t=[];for(var i in Object(e))a.call(e,i)&&"constructor"!=i&&t.push(i);return t}},6478:function(e){e.exports=function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}},6194:function(e){e.exports=function(e){return function(t){return e(t)}}},75:function(e){e.exports=function(e,t){return e.has(t)}},5525:function(e,t,i){var n=i(7009)["__core-js_shared__"];e.exports=n},5305:function(e,t,i){var n=i(692),r=i(7897),a=i(75);e.exports=function(e,t,i,o,s,l){var u=1&i,c=e.length,h=t.length;if(c!=h&&!(u&&h>c))return!1;var p=l.get(e),d=l.get(t);if(p&&d)return p==t&&d==e;var f=-1,m=!0,v=2&i?new n:void 0;for(l.set(e,t),l.set(t,e);++f<c;){var y=e[f],g=t[f];if(o)var _=u?o(g,y,f,t,e,l):o(y,g,f,e,t,l);if(void 0!==_){if(_)continue;m=!1;break}if(v){if(!r(t,(function(e,t){if(!a(v,t)&&(y===e||s(y,e,i,o,l)))return v.push(t)}))){m=!1;break}}else if(y!==g&&!s(y,g,i,o,l)){m=!1;break}}return l.delete(e),l.delete(t),m}},2206:function(e,t,i){var n=i(7197),r=i(6219),a=i(9231),o=i(5305),s=i(234),l=i(2230),u=n?n.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,i,n,u,h,p){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!h(new r(e),new r(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var f=1&n;if(d||(d=l),e.size!=t.size&&!f)return!1;var m=p.get(e);if(m)return m==t;n|=2,p.set(e,t);var v=o(d(e),d(t),n,u,h,p);return p.delete(e),v;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},8078:function(e,t,i){var n=i(8248),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,i,a,o,s){var l=1&i,u=n(e),c=u.length;if(c!=n(t).length&&!l)return!1;for(var h=c;h--;){var p=u[h];if(!(l?p in t:r.call(t,p)))return!1}var d=s.get(e),f=s.get(t);if(d&&f)return d==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);for(var v=l;++h<c;){var y=e[p=u[h]],g=t[p];if(a)var _=l?a(g,y,p,t,e,s):a(y,g,p,e,t,s);if(!(void 0===_?y===g||o(y,g,i,a,s):_)){m=!1;break}v||(v="constructor"==p)}if(m&&!v){var b=e.constructor,x=t.constructor;b==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(m=!1)}return s.delete(e),s.delete(t),m}},1032:function(e,t,i){var n="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;e.exports=n},8248:function(e,t,i){var n=i(1986),r=i(5918),a=i(2742);e.exports=function(e){return n(e,a,r)}},2799:function(e,t,i){var n=i(5964);e.exports=function(e,t){var i=e.__data__;return n(t)?i["string"==typeof t?"string":"hash"]:i.map}},8136:function(e,t,i){var n=i(6703),r=i(40);e.exports=function(e,t){var i=r(e,t);return n(i)?i:void 0}},1587:function(e,t,i){var n=i(7197),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),i=e[s];try{e[s]=void 0;var n=!0}catch(l){}var r=o.call(e);return n&&(t?e[s]=i:delete e[s]),r}},5918:function(e,t,i){var n=i(4903),r=i(8174),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),n(o(e),(function(t){return a.call(e,t)})))}:r;e.exports=s},8383:function(e,t,i){var n=i(908),r=i(5797),a=i(8319),o=i(3924),s=i(7091),l=i(9066),u=i(7907),c="[object Map]",h="[object Promise]",p="[object Set]",d="[object WeakMap]",f="[object DataView]",m=u(n),v=u(r),y=u(a),g=u(o),_=u(s),b=l;(n&&b(new n(new ArrayBuffer(1)))!=f||r&&b(new r)!=c||a&&b(a.resolve())!=h||o&&b(new o)!=p||s&&b(new s)!=d)&&(b=function(e){var t=l(e),i="[object Object]"==t?e.constructor:void 0,n=i?u(i):"";if(n)switch(n){case m:return f;case v:return c;case y:return h;case g:return p;case _:return d}return t}),e.exports=b},40:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},5403:function(e,t,i){var n=i(9620);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},2747:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6037:function(e,t,i){var n=i(9620),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return r.call(t,e)?t[e]:void 0}},4154:function(e,t,i){var n=i(9620),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:r.call(t,e)}},7728:function(e,t,i){var n=i(9620);e.exports=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},6800:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,i){var n=typeof e;return!!(i=null==i?9007199254740991:i)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<i}},5964:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},257:function(e,t,i){var n=i(5525),r=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!r&&r in e}},2936:function(e){var t=Object.prototype;e.exports=function(e){var i=e&&e.constructor;return e===("function"==typeof i&&i.prototype||t)}},3894:function(e){e.exports=function(){this.__data__=[],this.size=0}},8699:function(e,t,i){var n=i(7112),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,i=n(t,e);return!(i<0)&&(i==t.length-1?t.pop():r.call(t,i,1),--this.size,!0)}},4957:function(e,t,i){var n=i(7112);e.exports=function(e){var t=this.__data__,i=n(t,e);return i<0?void 0:t[i][1]}},7184:function(e,t,i){var n=i(7112);e.exports=function(e){return n(this.__data__,e)>-1}},7109:function(e,t,i){var n=i(7112);e.exports=function(e,t){var i=this.__data__,r=n(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}},4086:function(e,t,i){var n=i(9676),r=i(8384),a=i(5797);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(a||r),string:new n}}},9255:function(e,t,i){var n=i(2799);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},9186:function(e,t,i){var n=i(2799);e.exports=function(e){return n(this,e).get(e)}},3423:function(e,t,i){var n=i(2799);e.exports=function(e){return n(this,e).has(e)}},3739:function(e,t,i){var n=i(2799);e.exports=function(e,t){var i=n(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}},234:function(e){e.exports=function(e){var t=-1,i=Array(e.size);return e.forEach((function(e,n){i[++t]=[n,e]})),i}},9620:function(e,t,i){var n=i(8136)(Object,"create");e.exports=n},8836:function(e,t,i){var n=i(2709)(Object.keys,Object);e.exports=n},9494:function(e,t,i){e=i.nmd(e);var n=i(1032),r=t&&!t.nodeType&&t,a=r&&e&&!e.nodeType&&e,o=a&&a.exports===r&&n.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=s},3581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2709:function(e){e.exports=function(e,t){return function(i){return e(t(i))}}},7009:function(e,t,i){var n=i(1032),r="object"==typeof self&&self&&self.Object===Object&&self,a=n||r||Function("return this")();e.exports=a},5774:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1596:function(e){e.exports=function(e){return this.__data__.has(e)}},2230:function(e){e.exports=function(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}},511:function(e,t,i){var n=i(8384);e.exports=function(){this.__data__=new n,this.size=0}},835:function(e){e.exports=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}},707:function(e){e.exports=function(e){return this.__data__.get(e)}},8832:function(e){e.exports=function(e){return this.__data__.has(e)}},5077:function(e,t,i){var n=i(8384),r=i(5797),a=i(8059);e.exports=function(e,t){var i=this.__data__;if(i instanceof n){var o=i.__data__;if(!r||o.length<199)return o.push([e,t]),this.size=++i.size,this;i=this.__data__=new a(o)}return i.set(e,t),this.size=i.size,this}},7907:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(i){}try{return e+""}catch(i){}}return""}},9231:function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},4963:function(e,t,i){var n=i(4906),r=i(3141),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return r(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},3629:function(e){var t=Array.isArray;e.exports=t},1473:function(e,t,i){var n=i(4786),r=i(4635);e.exports=function(e){return null!=e&&r(e.length)&&!n(e)}},5174:function(e,t,i){e=i.nmd(e);var n=i(7009),r=i(9488),a=t&&!t.nodeType&&t,o=a&&e&&!e.nodeType&&e,s=o&&o.exports===a?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;e.exports=l},8111:function(e,t,i){var n=i(1848);e.exports=function(e,t){return n(e,t)}},4786:function(e,t,i){var n=i(9066),r=i(8092);e.exports=function(e){if(!r(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},4635:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},9102:function(e,t,i){var n=i(8150),r=i(6194),a=i(9494),o=a&&a.isTypedArray,s=o?r(o):n;e.exports=s},2742:function(e,t,i){var n=i(7538),r=i(3654),a=i(1473);e.exports=function(e){return a(e)?n(e):r(e)}},8174:function(e){e.exports=function(){return[]}},9488:function(e){e.exports=function(){return!1}},5483:function(e,t,i){var n=i(8416).default,r=i(6115).default,a=i(3515).default,o=i(1588).default,s=i(3808).default,l=i(4993).default,u=i(1589).default,c=i(861).default,h=i(7424).default,p=i(4704).default,d=i(3496).default,f=i(1655).default,m=i(6389).default,v=i(6690).default,y=i(9728).default;e.exports=function(){"use strict";var e,t,i;function g(n,r){if(e)if(t){var a="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",o={};e(o),i=r(o),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}else t=r;else e=r}return g(["exports"],(function(e){var t="undefined"!=typeof self?self:{},i=n;function n(e,t,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=i,this.p2y=n}n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},n.prototype.solveCurveX=function(e,t){var i,n,r,a,o;for(void 0===t&&(t=1e-6),r=e,o=0;o<8;o++){if(a=this.sampleCurveX(r)-e,Math.abs(a)<t)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=a/s}if((r=e)<(i=0))return i;if(r>(n=1))return n;for(;i<n;){if(a=this.sampleCurveX(r),Math.abs(a-e)<t)return r;e>a?i=r:n=r,r=.5*(n-i)+i}return r},n.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var g=_;function _(e,t){this.x=e,this.y=t}_.prototype={clone:function(){return new _(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),n=Math.sin(e),r=t.y+n*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-n*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_.convert=function(e){return e instanceof _?e:Array.isArray(e)?new _(e[0],e[1]):e};var b=Math.PI/180,x=180/Math.PI;function w(e){return e*b}function k(e){return e*x}var P=[[0,0],[1,0],[1,1],[0,1]];function S(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function T(e,t,n,r){var a=new i(e,t,n,r);return function(e){return a.solve(e)}}var E=T(.25,.1,.25,1);function C(e,t,i){return Math.min(i,Math.max(t,e))}function M(e,t,i){return(i=C((i-e)/(t-e),0,1))*i*(3-2*i)}function I(e,t,i){var n=i-t,r=((e-t)%n+n)%n+t;return r===t?i:r}function O(e,t,i){if(!e.length)return i(null,[]);var n=e.length,r=new Array(e.length),a=null;e.forEach((function(e,o){t(e,(function(e,t){e&&(a=e),r[o]=t,0==--n&&i(a,r)}))}))}function D(e){var t=[];for(var i in e)t.push(e[i]);return t}function A(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,a=i;r<a.length;r++){var o=a[r];for(var s in o)e[s]=o[s]}return e}var L=1;function z(){return L++}function R(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function F(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function j(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function B(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function V(e,t){return-1!==e.indexOf(t,e.length-t.length)}function N(e,t,i){var n={};for(var r in e)n[r]=t.call(i||this,e[r],r,e);return n}function U(e,t,i){var n={};for(var r in e)t.call(i||this,e[r],r,e)&&(n[r]=e[r]);return n}function G(e){return Array.isArray(e)?e.map(G):"object"==typeof e&&e?N(e,G):e}var W={};function H(e){W[e]||("undefined"!=typeof console&&console.warn(e),W[e]=!0)}function Z(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function q(e){for(var t,i,n=0,r=0,a=e.length,o=a-1;r<a;o=r++)t=e[r],n+=((i=e[o]).x-t.x)*(t.y+i.y);return n}function X(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function K(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,i,n,r){var a=n||r;return t[i]=!a||a.toLowerCase(),""})),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var Y=null;function $(e){if(null==Y){var t=e.navigator?e.navigator.userAgent:null;Y=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Y}function J(e){try{var i=t[e];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function Q(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}var ee=t.performance;function te(e){var t=e?e.url.toString():void 0;return ee.getEntriesByName(t)}var ie,ne,re,ae,oe,se,le,ue="2.9.2",ce={now:function(){return void 0!==re?re:t.performance.now()},setNow:function(e){re=e},restoreNow:function(){re=void 0},frame:function(e){var i=t.requestAnimationFrame(e);return{cancel:function(){return t.cancelAnimationFrame(i)}}},getImageData:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.width,r=e.height;ae||(ae=t.document.createElement("canvas"));var a=ae.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return(n>ae.width||r>ae.height)&&(ae.width=n,ae.height=r),a.clearRect(-i,-i,n+2*i,r+2*i),a.drawImage(e,0,0,n,r),a.getImageData(-i,-i,n+2*i,r+2*i)},resolveURL:function(e){return ie||(ie=t.document.createElement("a")),ie.href=e,ie.href},get devicePixelRatio(){return t.devicePixelRatio},get prefersReducedMotion(){return!!t.matchMedia&&(null==ne&&(ne=t.matchMedia("(prefers-reduced-motion: reduce)")),ne.matches)}},he={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==oe){var e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{oe=null!={NODE_ENV:"production",PUBLIC_URL:"/NextPanelTest",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX?new RegExp({NODE_ENV:"production",PUBLIC_URL:"/NextPanelTest",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX):e}catch(t){oe=e}}return oe},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},pe={supported:!1,testSupport:function(e){!de&&le&&(fe?me(e):se=e)}},de=!1,fe=!1;function me(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,le),e.isContextLost())return;pe.supported=!0}catch(e){}e.deleteTexture(t),de=!0}t.document&&((le=t.document.createElement("img")).onload=function(){se&&me(se),se=null,fe=!0},le.onerror=function(){de=!0,se=null},le.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ve="01",ye="NO_ACCESS_TOKEN";function ge(e){return 0===e.indexOf("mapbox:")}function _e(e){return he.API_URL_REGEX.test(e)}var be=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(e){var t=e.match(be);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function we(e){var t=e.params.length?"?".concat(e.params.join("&")):"";return"".concat(e.protocol,"://").concat(e.authority).concat(e.path).concat(t)}function ke(e){if(!e)return null;var i=e.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(t.atob(i[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}var Pe,Se=function(){function e(t){v(this,e),this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}return y(e,[{key:"getStorageKey",value:function(e){var i=ke(he.ACCESS_TOKEN),n="";return n=i&&i.u?t.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):he.ACCESS_TOKEN||"",e?"mapbox.eventData.".concat(e,":").concat(n):"mapbox.eventData:".concat(n)}},{key:"fetchEventData",value:function(){var e=J("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{var r=t.localStorage.getItem(i);r&&(this.eventData=JSON.parse(r));var a=t.localStorage.getItem(n);a&&(this.anonId=a)}catch(e){H("Unable to read from LocalStorage")}}},{key:"saveEventData",value:function(){var e=J("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{t.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&t.localStorage.setItem(i,JSON.stringify(this.eventData))}catch(e){H("Unable to write to LocalStorage")}}},{key:"processRequests",value:function(e){}},{key:"postEvent",value:function(e,t,i,n){var r=this;if(he.EVENTS_URL){var a=xe(he.EVENTS_URL);a.params.push("access_token=".concat(n||he.ACCESS_TOKEN||""));var o={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:ue,skuId:ve,userId:this.anonId},s=t?A(o,t):o,l={url:we(a),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=Ze(l,(function(e){r.pendingRequest=null,i(e),r.saveEventData(),r.processRequests(n)}))}}},{key:"queueRequest",value:function(e,t){this.queue.push(e),this.processRequests(t)}}]),e}(),Te=new(function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,"appUserTurnstile"))._customAccessToken=e,n}return y(i,[{key:"postTurnstileEvent",value:function(e,t){he.EVENTS_URL&&he.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return ge(e)||_e(e)}))&&this.queueRequest(Date.now(),t)}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var i=ke(he.ACCESS_TOKEN),n=i?i.u:he.ACCESS_TOKEN,r=n!==this.eventData.tokenU;j(this.anonId)||(this.anonId=R(),r=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var o=new Date(this.eventData.lastSuccess),s=new Date(a),l=(a-this.eventData.lastSuccess)/864e5;r=r||l>=1||l<-1||o.getDate()!==s.getDate()}else r=!0;r?this.postEvent(a,{"enabled.telemetry":!1},(function(e){e||(t.eventData.lastSuccess=a,t.eventData.tokenU=n)}),e):this.processRequests()}}}]),i}(Se)),Ee=Te.postTurnstileEvent.bind(Te),Ce=new(function(e){f(i,e);var t=m(i);function i(){var e;return v(this,i),(e=t.call(this,"map.load")).success={},e.skuToken="",e}return y(i,[{key:"postMapLoadEvent",value:function(e,t,i,n){this.skuToken=t,this.errorCb=n,he.EVENTS_URL&&(i||he.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ye)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var i=this.queue.shift(),n=i.id,r=i.timestamp;n&&this.success[n]||(this.anonId||this.fetchEventData(),j(this.anonId)||(this.anonId=R()),this.postEvent(r,{skuToken:this.skuToken},(function(e){e?t.errorCb(e):n&&(t.success[n]=!0)}),e))}}}]),i}(Se)),Me=Ce.postMapLoadEvent.bind(Ce),Ie=new(function(e){f(i,e);var t=m(i);function i(){var e;return v(this,i),(e=t.call(this,"map.auth")).success={},e.skuToken="",e}return y(i,[{key:"getSession",value:function(e,t,i,n){var r=this;if(he.API_URL&&he.SESSION_PATH){var a=xe(he.API_URL+he.SESSION_PATH);a.params.push("sku=".concat(t||"")),a.params.push("access_token=".concat(n||he.ACCESS_TOKEN||""));var o={url:we(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=qe(o,(function(e){r.pendingRequest=null,i(e),r.saveEventData(),r.processRequests(n)}))}}},{key:"getSessionAPI",value:function(e,t,i,n){this.skuToken=t,this.errorCb=n,he.SESSION_PATH&&he.API_URL&&(i||he.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ye)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var i=this.queue.shift(),n=i.id,r=i.timestamp;n&&this.success[n]||this.getSession(r,this.skuToken,(function(e){e?t.errorCb(e):n&&(t.success[n]=!0)}),e)}}}]),i}(Se)),Oe=Ie.getSessionAPI.bind(Ie),De=new Set,Ae=500,Le=50,ze={};function Re(e){var t,i,n=je(e);n&&n.forEach((function(e){var n=e.split("=");"language"===n[0]?t=n[1]:"worldview"===n[0]&&(i=n[1])}));var r="mapbox-tiles";return t&&(r+="-".concat(t)),i&&(r+="-".concat(i)),r}function Fe(e){t.caches&&!ze[e]&&(ze[e]=t.caches.open(e))}function je(e){var t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}function Be(e){var t=e.indexOf("?");if(t<0)return e;var i=je(e).filter((function(e){var t=e.split("=");return"language"===t[0]||"worldview"===t[0]}));return i.length?"".concat(e.slice(0,t),"?").concat(i.join("&")):e.slice(0,t)}var Ve=1/0,Ne={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ne);var Ue=function(e){f(i,e);var t=m(i);function i(e,n,r){var a;return v(this,i),401===n&&_e(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),(a=t.call(this,e)).status=n,a.url=r,a}return y(i,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),i}(d(Error)),Ge=X()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===t.location.protocol?t.parent:t).location.href},We=function(e,i){if(!(/^file:/.test(n=e.url)||/^file:/.test(Ge())&&!/^\w+:/.test(n))){if(t.fetch&&t.Request&&t.AbortController&&t.Request.prototype.hasOwnProperty("signal"))return function(e,i){var n,r=new t.AbortController,a=new t.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:Ge(),signal:r.signal}),o=!1,s=!1,l=(n=a.url).indexOf("sku=")>0&&_e(n);"json"===e.type&&a.headers.set("Accept","application/json");var u=function(n,r,o){if(!s){if(n&&"SecurityError"!==n.message&&H(n),r&&o)return c(r);var u=Date.now();t.fetch(a).then((function(t){if(t.ok){var n=l?t.clone():null;return c(t,n,u)}return i(new Ue(t.statusText,t.status,e.url))})).catch((function(e){20!==e.code&&i(new Error(e.message))}))}},c=function(n,r,l){("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then((function(e){s||(r&&l&&function(e,i,n){var r=Re(e.url);if(Fe(r),ze[r]){var a={status:i.status,statusText:i.statusText,headers:new t.Headers};i.headers.forEach((function(e,t){return a.headers.set(t,e)}));var o=K(i.headers.get("Cache-Control")||"");if(!o["no-store"]){o["max-age"]&&a.headers.set("Expires",new Date(n+1e3*o["max-age"]).toUTCString());var s=a.headers.get("Expires");s&&(new Date(s).getTime()-n<42e4||function(e,t){if(void 0===Pe)try{new Response(new ReadableStream),Pe=!0}catch(e){Pe=!1}Pe?t(e.body):e.blob().then(t)}(i,(function(i){var n=new t.Response(i,a);Fe(r),ze[r]&&ze[r].then((function(t){return t.put(Be(e.url),n)})).catch((function(e){return H(e.message)}))})))}}}(a,r,l),o=!0,i(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(e){s||i(new Error(e.message))}))};return l?function(e,t){var i=Re(e.url);if(Fe(i),!ze[i])return t(null);var n=Be(e.url);ze[i].then((function(e){e.match(n).then((function(i){var r=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),i=K(e.headers.get("Cache-Control")||"");return t>Date.now()&&!i["no-cache"]}(i);e.delete(n),r&&e.put(n,i.clone()),t(null,i,r)})).catch(t)})).catch(t)}(a,u):u(null,null),{cancel:function(){s=!0,o||r.abort()}}}(e,i);if(X()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,i,void 0,!0)}var n;return function(e,i){var n=new t.XMLHttpRequest;for(var r in n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer"),e.headers)n.setRequestHeader(r,e.headers[r]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=function(){i(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var t=n.response;if("json"===e.type)try{t=JSON.parse(n.response)}catch(e){return i(e)}i(null,t,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else i(new Ue(n.statusText,n.status,e.url))},n.send(e.body),{cancel:function(){return n.abort()}}}(e,i)},He=function(e,t){return We(A(e,{type:"arrayBuffer"}),t)},Ze=function(e,t){return We(A(e,{method:"POST"}),t)},qe=function(e,t){return We(A(e,{method:"GET"}),t)};function Xe(e){var i=t.document.createElement("a");return i.href=e,i.protocol===t.document.location.protocol&&i.host===t.document.location.host}var Ke,Ye,$e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ke=[],Ye=0;var Je=function e(i,n){if(pe.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Ye>=he.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:i,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ke.push(r),r}Ye++;var a=!1,o=function(){if(!a)for(a=!0,Ye--;Ke.length&&Ye<he.MAX_PARALLEL_IMAGE_REQUESTS;){var t=Ke.shift(),i=t.requestParameters,n=t.callback;t.cancelled||(t.cancel=e(i,n).cancel)}},s=He(i,(function(e,i,r,a){o(),e?n(e):i&&(t.createImageBitmap?function(e,i){var n=new t.Blob([new Uint8Array(e)],{type:"image/png"});t.createImageBitmap(n).then((function(e){i(null,e)})).catch((function(e){i(new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(i,(function(e,t){return n(e,t,r,a)})):function(e,i){var n=new t.Image,r=t.URL;n.onload=function(){i(null,n),r.revokeObjectURL(n.src),n.onload=null,t.requestAnimationFrame((function(){n.src=$e}))},n.onerror=function(){return i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new t.Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?r.createObjectURL(a):$e}(i,(function(e,t){return n(e,t,r,a)})))}));return{cancel:function(){s.cancel(),o()}}};function Qe(e,t,i){i[e]&&-1!==i[e].indexOf(t)||(i[e]=i[e]||[],i[e].push(t))}function et(e,t,i){if(i&&i[e]){var n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}var tt=y((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,e),A(this,i),this.type=t})),it=function(e){f(i,e);var t=m(i);function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,i),t.call(this,"error",A({error:e},n))}return y(i)}(tt),nt=function(){function e(){v(this,e)}return y(e,[{key:"on",value:function(e,t){return this._listeners=this._listeners||{},Qe(e,t,this._listeners),this}},{key:"off",value:function(e,t){return et(e,t,this._listeners),et(e,t,this._oneTimeListeners),this}},{key:"once",value:function(e,t){var i=this;return t?(this._oneTimeListeners=this._oneTimeListeners||{},Qe(e,t,this._oneTimeListeners),this):new Promise((function(t){return i.once(e,t)}))}},{key:"fire",value:function(e,t){"string"==typeof e&&(e=new tt(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;var n,r=this._listeners&&this._listeners[i]?this._listeners[i].slice():[],a=p(r);try{for(a.s();!(n=a.n()).done;)n.value.call(this,e)}catch(h){a.e(h)}finally{a.f()}var o,s=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[],l=p(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;et(i,u,this._oneTimeListeners),u.call(this,e)}}catch(h){l.e(h)}finally{l.f()}var c=this._eventedParent;c&&(A(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),c.fire(e))}else e instanceof it&&console.error(e.error);return this}},{key:"listens",value:function(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}},{key:"setEventedParent",value:function(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}]),e}(),rt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function at(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,a=i;r<a.length;r++){var o=a[r];for(var s in o)e[s]=o[s]}return e}function ot(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function st(e){if(Array.isArray(e))return e.map(st);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=st(e[i]);return t}return ot(e)}var lt=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,n)).message=n,r.key=e,r}return y(i)}(d(Error)),ut=lt,ct=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];v(this,e),this.parent=t,this.bindings={};var n,r=p(i);try{for(r.s();!(n=r.n()).done;){var a=h(n.value,2),o=a[0],s=a[1];this.bindings[o]=s}}catch(l){r.e(l)}finally{r.f()}}return y(e,[{key:"concat",value:function(t){return new e(this,t)}},{key:"get",value:function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}},{key:"has",value:function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}]),e}(),ht=ct,pt={kind:"null"},dt={kind:"number"},ft={kind:"string"},mt={kind:"boolean"},vt={kind:"color"},yt={kind:"object"},gt={kind:"value"},_t={kind:"collator"},bt={kind:"formatted"},xt={kind:"resolvedImage"};function wt(e,t){return{kind:"array",itemType:e,N:t}}function kt(e){if("array"===e.kind){var t=kt(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}var Pt=[pt,dt,ft,mt,vt,bt,yt,wt(gt),xt];function St(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!St(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind){var i,n=p(Pt);try{for(n.s();!(i=n.n()).done;)if(!St(i.value,t))return null}catch(r){n.e(r)}finally{n.f()}}}return"Expected ".concat(kt(e)," but found ").concat(kt(t)," instead.")}function Tt(e,t){return t.some((function(t){return t.kind===e.kind}))}function Et(e,t){return t.some((function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e}))}function Ct(e){var t={exports:{}};return e(t,t.exports),t.exports}var Mt=Ct((function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(e){return(e=Math.round(e))<0?0:e>255?255:e}function r(e){return n("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function a(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function o(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in i)return i[s].slice();if("#"===s[0])return 4===s.length?(t=parseInt(s.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&(t=parseInt(s.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=s.indexOf("("),u=s.indexOf(")");if(-1!==l&&u+1===s.length){var c=s.substr(0,l),h=s.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=a(h[1]),m=a(h[2]),v=m<=.5?m*(f+1):m+f-m*f,y=2*m-v;return[n(255*o(y,v,d+1/3)),n(255*o(y,v,d)),n(255*o(y,v,d-1/3)),p];default:return null}}return null}}catch(e){}})),It=function(){function e(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;v(this,e),this.r=t,this.g=i,this.b=n,this.a=r}return y(e,[{key:"toString",value:function(){var e=this.toArray(),t=h(e,4),i=t[0],n=t[1],r=t[2],a=t[3];return"rgba(".concat(Math.round(i),",").concat(Math.round(n),",").concat(Math.round(r),",").concat(a,")")}},{key:"toArray",value:function(){var e=this.r,t=this.g,i=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*i/n,n]}},{key:"toArray01",value:function(){var e=this.r,t=this.g,i=this.b,n=this.a;return 0===n?[0,0,0,0]:[e/n,t/n,i/n,n]}},{key:"toArray01PremultipliedAlpha",value:function(){return[this.r,this.g,this.b,this.a]}}],[{key:"parse",value:function(t){if(t){if(t instanceof e)return t;if("string"==typeof t){var i=Mt.parseCSSColor(t);return i?new e(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}}}}]),e}();It.black=new It(0,0,0,1),It.white=new It(1,1,1,1),It.transparent=new It(0,0,0,0),It.red=new It(1,0,0,1),It.blue=new It(0,0,1,1);var Ot=It,Dt=function(){function e(t,i,n){v(this,e),this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}return y(e,[{key:"compare",value:function(e,t){return this.collator.compare(e,t)}},{key:"resolvedLocale",value:function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}]),e}(),At=y((function e(t,i,n,r,a){v(this,e),this.text=t.normalize?t.normalize():t,this.image=i,this.scale=n,this.fontStack=r,this.textColor=a})),Lt=function(){function e(t){v(this,e),this.sections=t}return y(e,[{key:"isEmpty",value:function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))}},{key:"toString",value:function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")}},{key:"serialize",value:function(){var e,t=["format"],i=p(this.sections);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.image)t.push(["image",n.image.name]);else{t.push(n.text);var r={};n.fontStack&&(r["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(r["font-scale"]=n.scale),n.textColor&&(r["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(r)}}}catch(a){i.e(a)}finally{i.f()}return t}}],[{key:"fromString",value:function(t){return new e([new At(t,null,null,null,null)])}},{key:"factory",value:function(t){return t instanceof e?t:e.fromString(t)}}]),e}(),zt=function(){function e(t){v(this,e),this.name=t.name,this.available=t.available}return y(e,[{key:"toString",value:function(){return this.name}},{key:"serialize",value:function(){return["image",this.name]}}],[{key:"fromString",value:function(t){return t?new e({name:t,available:!1}):null}}]),e}();function Rt(e,t,i,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value [".concat([e,t,i,n].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof n?[e,t,i,n]:[e,t,i]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function Ft(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Ot)return!0;if(e instanceof Dt)return!0;if(e instanceof Lt)return!0;if(e instanceof zt)return!0;if(Array.isArray(e)){var t,i=p(e);try{for(i.s();!(t=i.n()).done;)if(!Ft(t.value))return!1}catch(r){i.e(r)}finally{i.f()}return!0}if("object"==typeof e){for(var n in e)if(!Ft(e[n]))return!1;return!0}return!1}function jt(e){if(null===e)return pt;if("string"==typeof e)return ft;if("boolean"==typeof e)return mt;if("number"==typeof e)return dt;if(e instanceof Ot)return vt;if(e instanceof Dt)return _t;if(e instanceof Lt)return bt;if(e instanceof zt)return xt;if(Array.isArray(e)){var t,i,n=e.length,r=p(e);try{for(r.s();!(i=r.n()).done;){var a=jt(i.value);if(t){if(t===a)continue;t=gt;break}t=a}}catch(o){r.e(o)}finally{r.f()}return wt(t||gt,n)}return yt}function Bt(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Ot||e instanceof Lt||e instanceof zt?e.toString():JSON.stringify(e)}var Vt=function(){function e(t,i){v(this,e),this.type=t,this.value=i}return y(e,[{key:"evaluate",value:function(){return this.value}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ot?["rgba"].concat(this.value.toArray()):this.value instanceof Lt?this.value.serialize():this.value}}],[{key:"parse",value:function(t,i){if(2!==t.length)return i.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!Ft(t[1]))return i.error("invalid value");var n=t[1],r=jt(n),a=i.expectedType;return"array"!==r.kind||0!==r.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(r=a),new e(r,n)}}]),e}(),Nt=Vt,Ut=function(){function e(t){v(this,e),this.name="ExpressionEvaluationError",this.message=t}return y(e,[{key:"toJSON",value:function(){return this.message}}]),e}(),Gt={string:ft,number:dt,boolean:mt,object:yt},Wt=function(){function e(t,i){v(this,e),this.type=t,this.args=i}return y(e,[{key:"evaluate",value:function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!St(this.type,jt(i)))return i;if(t===this.args.length-1)throw new Ut("Expected value to be of type ".concat(kt(this.type),", but found ").concat(kt(jt(i))," instead."))}return null}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=this.type,t=[e.kind];if("array"===e.kind){var i=e.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){t.push(i.kind);var n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var n,r=1,a=t[0];if("array"===a){var o,s;if(t.length>2){var l=t[1];if("string"!=typeof l||!(l in Gt)||"object"===l)return i.error('The item type argument of "array" must be one of string, number, boolean',1);o=Gt[l],r++}else o=gt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);s=t[2],r++}n=wt(o,s)}else n=Gt[a];for(var u=[];r<t.length;r++){var c=i.parse(t[r],r,gt);if(!c)return null;u.push(c)}return new e(n,u)}}]),e}(),Ht=Wt,Zt=function(){function e(t){v(this,e),this.type=bt,this.sections=t}return y(e,[{key:"evaluate",value:function(e){return new Lt(this.sections.map((function(t){var i=t.content.evaluate(e);return jt(i)===xt?new At("",i,null,null,null):new At(Bt(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}},{key:"eachChild",value:function(e){var t,i=p(this.sections);try{for(i.s();!(t=i.n()).done;){var n=t.value;e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}}catch(r){i.e(r)}finally{i.f()}}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e,t=["format"],i=p(this.sections);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.push(n.content.serialize());var r={};n.scale&&(r["font-scale"]=n.scale.serialize()),n.font&&(r["text-font"]=n.font.serialize()),n.textColor&&(r["text-color"]=n.textColor.serialize()),t.push(r)}}catch(a){i.e(a)}finally{i.f()}return t}}],[{key:"parse",value:function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return i.error("First argument must be an image or text section.");for(var r=[],a=!1,o=1;o<=t.length-1;++o){var s=t[o];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;var l=null;if(s["font-scale"]&&!(l=i.parse(s["font-scale"],1,dt)))return null;var u=null;if(s["text-font"]&&!(u=i.parse(s["text-font"],1,wt(ft))))return null;var c=null;if(s["text-color"]&&!(c=i.parse(s["text-color"],1,vt)))return null;var h=r[r.length-1];h.scale=l,h.font=u,h.textColor=c}else{var p=i.parse(t[o],1,gt);if(!p)return null;var d=p.type.kind;if("string"!==d&&"value"!==d&&"null"!==d&&"resolvedImage"!==d)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,r.push({content:p,scale:null,font:null,textColor:null})}}return new e(r)}}]),e}(),qt=function(){function e(t){v(this,e),this.type=xt,this.input=t}return y(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),i=zt.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["image",this.input.serialize()]}}],[{key:"parse",value:function(t,i){if(2!==t.length)return i.error("Expected two arguments.");var n=i.parse(t[1],1,ft);return n?new e(n):i.error("No image name provided.")}}]),e}(),Xt={"to-boolean":mt,"to-color":vt,"to-number":dt,"to-string":ft},Kt=function(){function e(t,i){v(this,e),this.type=t,this.args=i}return y(e,[{key:"evaluate",value:function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){var t,i,n,r=p(this.args);try{for(r.s();!(n=r.n()).done;){if(t=n.value.evaluate(e),i=null,t instanceof Ot)return t;if("string"==typeof t){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):Rt(t[0],t[1],t[2],t[3])))return new Ot(t[0]/255,t[1]/255,t[2]/255,t[3])}}catch(c){r.e(c)}finally{r.f()}throw new Ut(i||"Could not parse color from value '".concat("string"==typeof t?t:String(JSON.stringify(t)),"'"))}if("number"===this.type.kind){var o,s=null,l=p(this.args);try{for(l.s();!(o=l.n()).done;){if(null===(s=o.value.evaluate(e)))return 0;var u=Number(s);if(!isNaN(u))return u}}catch(c){l.e(c)}finally{l.f()}throw new Ut("Could not convert ".concat(JSON.stringify(s)," to number."))}return"formatted"===this.type.kind?Lt.fromString(Bt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?zt.fromString(Bt(this.args[0].evaluate(e))):Bt(this.args[0].evaluate(e))}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){if("formatted"===this.type.kind)return new Zt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new qt(this.args[0]).serialize();var e=["to-".concat(this.type.kind)];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return i.error("Expected one argument.");for(var r=Xt[n],a=[],o=1;o<t.length;o++){var s=i.parse(t[o],o,gt);if(!s)return null;a.push(s)}return new e(r,a)}}]),e}(),Yt=Kt,$t=["Unknown","Point","LineString","Polygon"],Jt=function(){function e(){v(this,e),this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}return y(e,[{key:"id",value:function(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}},{key:"geometryType",value:function(){return this.feature?"number"==typeof this.feature.type?$t[this.feature.type]:this.feature.type:null}},{key:"geometry",value:function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}},{key:"canonicalID",value:function(){return this.canonical}},{key:"properties",value:function(){return this.feature&&this.feature.properties||{}}},{key:"distanceFromCenter",value:function(){if(this.featureTileCoord&&this.featureDistanceData){var e=this.featureDistanceData.center,t=this.featureDistanceData.scale,i=this.featureTileCoord,n=i.x,r=i.y;return this.featureDistanceData.bearing[0]*(n*t-e[0])+this.featureDistanceData.bearing[1]*(r*t-e[1])}return 0}},{key:"parseColor",value:function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ot.parse(e)),t}}]),e}(),Qt=function(){function e(t,i,n,r){v(this,e),this.name=t,this.type=i,this._evaluate=n,this.args=r}return y(e,[{key:"evaluate",value:function(e){return this._evaluate(e,this.args)}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,i){var n,r=t[0],a=e.definitions[r];if(!a)return i.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0);var o,s=Array.isArray(a)?a[0]:a.type,l=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,u=l.filter((function(e){var i=h(e,1)[0];return!Array.isArray(i)||i.length===t.length-1})),d=null,f=p(u);try{for(f.s();!(o=f.n()).done;){var m=h(o.value,2),v=m[0],y=m[1];d=new Ti(i.registry,i.path,null,i.scope);for(var g=[],_=!1,b=1;b<t.length;b++){var x=t[b],w=Array.isArray(v)?v[b-1]:v.type,k=d.parse(x,1+g.length,w);if(!k){_=!0;break}g.push(k)}if(!_)if(Array.isArray(v)&&v.length!==g.length)d.error("Expected ".concat(v.length," arguments, but found ").concat(g.length," instead."));else{for(var P=0;P<g.length;P++){var S=Array.isArray(v)?v[P]:v.type,T=g[P];d.concat(P+1).checkSubtype(S,T.type)}if(0===d.errors.length)return new e(r,s,y,g)}}}catch(O){f.e(O)}finally{f.f()}if(1===u.length)(n=i.errors).push.apply(n,c(d.errors));else{for(var E=(u.length?u:l).map((function(e){var t;return t=h(e,1)[0],Array.isArray(t)?"(".concat(t.map(kt).join(", "),")"):"(".concat(kt(t.type),"...)")})).join(" | "),C=[],M=1;M<t.length;M++){var I=i.parse(t[M],1+C.length);if(!I)return null;C.push(kt(I.type))}i.error("Expected arguments of type ".concat(E,", but found (").concat(C.join(", "),") instead."))}return null}},{key:"register",value:function(t,i){for(var n in e.definitions=i,i)t[n]=e}}]),e}(),ei=Qt,ti=function(){function e(t,i,n){v(this,e),this.type=_t,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=i}return y(e,[{key:"evaluate",value:function(e){return new Dt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}},{key:"eachChild",value:function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}],[{key:"parse",value:function(t,i){if(2!==t.length)return i.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return i.error("Collator options argument must be an object.");var r=i.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,mt);if(!r)return null;var a=i.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,mt);if(!a)return null;var o=null;return n.locale&&!(o=i.parse(n.locale,1,ft))?null:new e(r,a,o)}}]),e}(),ii=8192;function ni(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ri(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ai(e,t){var i=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(i*r*ii),Math.round(n*r*ii)]}function oi(e,t,i){var n=e[0]-t[0],r=e[1]-t[1],a=e[0]-i[0],o=e[1]-i[1];return n*o-a*r==0&&n*a<=0&&r*o<=0}function si(e,t){for(var i,n,r,a=!1,o=0,s=t.length;o<s;o++)for(var l=t[o],u=0,c=l.length;u<c-1;u++){if(oi(e,l[u],l[u+1]))return!1;(n=l[u])[1]>(i=e)[1]!=(r=l[u+1])[1]>i[1]&&i[0]<(r[0]-n[0])*(i[1]-n[1])/(r[1]-n[1])+n[0]&&(a=!a)}return a}function li(e,t){for(var i=0;i<t.length;i++)if(si(e,t[i]))return!0;return!1}function ui(e,t,i,n){var r=n[0]-i[0],a=n[1]-i[1],o=(e[0]-i[0])*a-r*(e[1]-i[1]),s=(t[0]-i[0])*a-r*(t[1]-i[1]);return o>0&&s<0||o<0&&s>0}function ci(e,t,i){var n,r,a,o,s,l,u,c=p(i);try{for(c.s();!(n=c.n()).done;)for(var h=n.value,d=0;d<h.length-1;++d)if(0!=(l=[(s=h[d+1])[0]-(o=h[d])[0],s[1]-o[1]])[0]*(u=[(a=t)[0]-(r=e)[0],a[1]-r[1]])[1]-l[1]*u[0]&&ui(r,a,o,s)&&ui(o,s,r,a))return!0}catch(f){c.e(f)}finally{c.f()}return!1}function hi(e,t){for(var i=0;i<e.length;++i)if(!si(e[i],t))return!1;for(var n=0;n<e.length-1;++n)if(ci(e[n],e[n+1],t))return!1;return!0}function pi(e,t){for(var i=0;i<t.length;i++)if(hi(e,t[i]))return!0;return!1}function di(e,t,i){for(var n=[],r=0;r<e.length;r++){for(var a=[],o=0;o<e[r].length;o++){var s=ai(e[r][o],i);ni(t,s),a.push(s)}n.push(a)}return n}function fi(e,t,i){for(var n=[],r=0;r<e.length;r++){var a=di(e[r],t,i);n.push(a)}return n}function mi(e,t,i,n){if(e[0]<i[0]||e[0]>i[2]){var r=.5*n,a=e[0]-i[0]>r?-n:i[0]-e[0]>r?n:0;0===a&&(a=e[0]-i[2]>r?-n:i[2]-e[0]>r?n:0),e[0]+=a}ni(t,e)}function vi(e,t,i,n){var r=Math.pow(2,n.z)*ii,a=[n.x*ii,n.y*ii],o=[];if(!e)return o;var s,l=p(e);try{for(l.s();!(s=l.n()).done;){var u,c=s.value,h=p(c);try{for(h.s();!(u=h.n()).done;){var d=u.value,f=[d.x+a[0],d.y+a[1]];mi(f,t,i,r),o.push(f)}}catch(m){h.e(m)}finally{h.f()}}}catch(m){l.e(m)}finally{l.f()}return o}function yi(e,t,i,n){var r=Math.pow(2,n.z)*ii,a=[n.x*ii,n.y*ii],o=[];if(!e)return o;var s,l,u=p(e);try{for(u.s();!(s=u.n()).done;){var c,h=s.value,d=[],f=p(h);try{for(f.s();!(c=f.n()).done;){var m=c.value,v=[m.x+a[0],m.y+a[1]];ni(t,v),d.push(v)}}catch(w){f.e(w)}finally{f.f()}o.push(d)}}catch(w){u.e(w)}finally{u.f()}if(t[2]-t[0]<=r/2){(l=t)[0]=l[1]=1/0,l[2]=l[3]=-1/0;var y,g=p(o);try{for(g.s();!(y=g.n()).done;){var _,b=y.value,x=p(b);try{for(x.s();!(_=x.n()).done;)mi(_.value,t,i,r)}catch(w){x.e(w)}finally{x.f()}}}catch(w){g.e(w)}finally{g.f()}}return o}var gi=function(){function e(t,i){v(this,e),this.type=mt,this.geojson=t,this.geometries=i}return y(e,[{key:"evaluate",value:function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){var a=di(t.coordinates,n,r),o=vi(e.geometry(),i,n,r);if(!ri(i,n))return!1;var s,l=p(o);try{for(l.s();!(s=l.n()).done;)if(!si(s.value,a))return!1}catch(f){l.e(f)}finally{l.f()}}if("MultiPolygon"===t.type){var u=fi(t.coordinates,n,r),c=vi(e.geometry(),i,n,r);if(!ri(i,n))return!1;var h,d=p(c);try{for(d.s();!(h=d.n()).done;)if(!li(h.value,u))return!1}catch(f){d.e(f)}finally{d.f()}}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){var a=di(t.coordinates,n,r),o=yi(e.geometry(),i,n,r);if(!ri(i,n))return!1;var s,l=p(o);try{for(l.s();!(s=l.n()).done;)if(!hi(s.value,a))return!1}catch(f){l.e(f)}finally{l.f()}}if("MultiPolygon"===t.type){var u=fi(t.coordinates,n,r),c=yi(e.geometry(),i,n,r);if(!ri(i,n))return!1;var h,d=p(c);try{for(d.s();!(h=d.n()).done;)if(!pi(h.value,u))return!1}catch(f){d.e(f)}finally{d.f()}}return!0}(e,this.geometries)}return!1}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["within",this.geojson]}}],[{key:"parse",value:function(t,i){if(2!==t.length)return i.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(Ft(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var r=0;r<n.features.length;++r){var a=n.features[r].geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new e(n,n.features[r].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new e(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new e(n,n)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}}]),e}(),_i=gi;function bi(e){if(e instanceof ei){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof _i)return!1;var t=!0;return e.eachChild((function(e){t&&!bi(e)&&(t=!1)})),t}function xi(e){if(e instanceof ei&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild((function(e){t&&!xi(e)&&(t=!1)})),t}function wi(e,t){if(e instanceof ei&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild((function(e){i&&!wi(e,t)&&(i=!1)})),i}var ki=function(){function e(t,i){v(this,e),this.type=i.type,this.name=t,this.boundExpression=i}return y(e,[{key:"evaluate",value:function(e){return this.boundExpression.evaluate(e)}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["var",this.name]}}],[{key:"parse",value:function(t,i){if(2!==t.length||"string"!=typeof t[1])return i.error("'var' expression requires exactly one string literal argument.");var n=t[1];return i.scope.has(n)?new e(n,i.scope.get(n)):i.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}}]),e}(),Pi=ki,Si=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ht,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];v(this,e),this.registry=t,this.path=i,this.key=i.map((function(e){return"[".concat(e,"]")})).join(""),this.scope=r,this.errors=a,this.expectedType=n}return y(e,[{key:"parse",value:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,i,n)._parse(e,r):this._parse(e,r)}},{key:"_parse",value:function(e,t){function i(e,t,i){return"assert"===i?new Ht(t,[e]):"coerce"===i?new Yt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found ".concat(typeof n,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;var r=this.registry[n];if(r){var a=r.parse(e,this);if(!a)return null;if(this.expectedType){var o=this.expectedType,s=a.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==s.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(o,s))return null}else a=i(a,o,t.typeAnnotation||"coerce");else a=i(a,o,t.typeAnnotation||"assert")}if(!(a instanceof Nt)&&"resolvedImage"!==a.type.kind&&Ei(a)){var l=new Jt;try{a=new Nt(a.type,a.evaluate(l))}catch(e){return this.error(e.message),null}}return a}return this.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}},{key:"concat",value:function(t,i,n){var r="number"==typeof t?this.path.concat(t):this.path,a=n?this.scope.concat(n):this.scope;return new e(this.registry,r,i||null,a,this.errors)}},{key:"error",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r="".concat(this.key).concat(i.map((function(e){return"[".concat(e,"]")})).join(""));this.errors.push(new ut(r,e))}},{key:"checkSubtype",value:function(e,t){var i=St(e,t);return i&&this.error(i),i}}]),e}(),Ti=Si;function Ei(e){if(e instanceof Pi)return Ei(e.boundExpression);if(e instanceof ei&&"error"===e.name)return!1;if(e instanceof ti)return!1;if(e instanceof _i)return!1;var t=e instanceof Yt||e instanceof Ht,i=!0;return e.eachChild((function(e){i=t?i&&Ei(e):i&&e instanceof Nt})),!!i&&bi(e)&&wi(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ci(e,t){for(var i,n,r=e.length-1,a=0,o=r,s=0;a<=o;)if(i=e[s=Math.floor((a+o)/2)],n=e[s+1],i<=t){if(s===r||t<n)return s;a=s+1}else{if(!(i>t))throw new Ut("Input is not a number.");o=s-1}return 0}var Mi=function(){function e(t,i,n){v(this,e),this.type=t,this.input=i,this.labels=[],this.outputs=[];var r,a=p(n);try{for(a.s();!(r=a.n()).done;){var o=h(r.value,2),s=o[0],l=o[1];this.labels.push(s),this.outputs.push(l)}}catch(u){a.e(u)}finally{a.f()}}return y(e,[{key:"evaluate",value:function(e){var t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);var r=t.length;return n>=t[r-1]?i[r-1].evaluate(e):i[Ci(t,n)].evaluate(e)}},{key:"eachChild",value:function(e){e(this.input);var t,i=p(this.outputs);try{for(i.s();!(t=i.n()).done;)e(t.value)}catch(n){i.e(n)}finally{i.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}],[{key:"parse",value:function(t,i){if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");var n=i.parse(t[1],1,dt);if(!n)return null;var r=[],a=null;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);for(var o=1;o<t.length;o+=2){var s=1===o?-1/0:t[o],l=t[o+1],u=o,c=o+1;if("number"!=typeof s)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=s)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=i.parse(l,c,a);if(!h)return null;a=a||h.type,r.push([s,h])}return new e(a,n,r)}}]),e}(),Ii=Mi;function Oi(e,t,i){return e*(1-i)+t*i}var Di=Object.freeze({__proto__:null,number:Oi,color:function(e,t,i){return new Ot(Oi(e.r,t.r,i),Oi(e.g,t.g,i),Oi(e.b,t.b,i),Oi(e.a,t.a,i))},array:function(e,t,i){return e.map((function(e,n){return Oi(e,t[n],i)}))}}),Ai=.95047,Li=1.08883,zi=4/29,Ri=6/29,Fi=3*Ri*Ri,ji=Math.PI/180,Bi=180/Math.PI;function Vi(e){return e>.008856451679035631?Math.pow(e,1/3):e/Fi+zi}function Ni(e){return e>Ri?e*e*e:Fi*(e-zi)}function Ui(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gi(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Wi(e){var t=Gi(e.r),i=Gi(e.g),n=Gi(e.b),r=Vi((.4124564*t+.3575761*i+.1804375*n)/Ai),a=Vi((.2126729*t+.7151522*i+.072175*n)/1);return{l:116*a-16,a:500*(r-a),b:200*(a-Vi((.0193339*t+.119192*i+.9503041*n)/Li)),alpha:e.a}}function Hi(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Ni(t),i=Ai*Ni(i),n=Li*Ni(n),new Ot(Ui(3.2404542*i-1.5371385*t-.4985314*n),Ui(-.969266*i+1.8760108*t+.041556*n),Ui(.0556434*i-.2040259*t+1.0572252*n),e.alpha)}function Zi(e,t,i){var n=t-e;return e+i*(n>180||n<-180?n-360*Math.round(n/360):n)}var qi={forward:Wi,reverse:Hi,interpolate:function(e,t,i){return{l:Oi(e.l,t.l,i),a:Oi(e.a,t.a,i),b:Oi(e.b,t.b,i),alpha:Oi(e.alpha,t.alpha,i)}}},Xi={forward:function(e){var t=Wi(e),i=t.l,n=t.a,r=t.b,a=Math.atan2(r,n)*Bi;return{h:a<0?a+360:a,c:Math.sqrt(n*n+r*r),l:i,alpha:e.a}},reverse:function(e){var t=e.h*ji,i=e.c;return Hi({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Zi(e.h,t.h,i),c:Oi(e.c,t.c,i),l:Oi(e.l,t.l,i),alpha:Oi(e.alpha,t.alpha,i)}}},Ki=Object.freeze({__proto__:null,lab:qi,hcl:Xi}),Yi=function(){function e(t,i,n,r,a){v(this,e),this.type=t,this.operator=i,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];var o,s=p(a);try{for(s.s();!(o=s.n()).done;){var l=h(o.value,2),u=l[0],c=l[1];this.labels.push(u),this.outputs.push(c)}}catch(d){s.e(d)}finally{s.f()}}return y(e,[{key:"evaluate",value:function(t){var i=this.labels,n=this.outputs;if(1===i.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=i[0])return n[0].evaluate(t);var a=i.length;if(r>=i[a-1])return n[a-1].evaluate(t);var o=Ci(i,r),s=e.interpolationFactor(this.interpolation,r,i[o],i[o+1]),l=n[o].evaluate(t),u=n[o+1].evaluate(t);return"interpolate"===this.operator?Di[this.type.kind.toLowerCase()](l,u,s):"interpolate-hcl"===this.operator?Xi.reverse(Xi.interpolate(Xi.forward(l),Xi.forward(u),s)):qi.reverse(qi.interpolate(qi.forward(l),qi.forward(u),s))}},{key:"eachChild",value:function(e){e(this.input);var t,i=p(this.outputs);try{for(i.s();!(t=i.n()).done;)e(t.value)}catch(n){i.e(n)}finally{i.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t}}],[{key:"interpolationFactor",value:function(e,t,n,r){var a=0;if("exponential"===e.name)a=$i(t,e.base,n,r);else if("linear"===e.name)a=$i(t,1,n,r);else if("cubic-bezier"===e.name){var o=e.controlPoints;a=new i(o[0],o[1],o[2],o[3]).solve($i(t,1,n,r))}return a}},{key:"parse",value:function(t,i){var n=u(t),r=n[0],a=n[1],o=n[2],s=n.slice(3);if(!Array.isArray(a)||0===a.length)return i.error("Expected an interpolation type expression.",1);if("linear"===a[0])a={name:"linear"};else if("exponential"===a[0]){var l=a[1];if("number"!=typeof l)return i.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:l}}else{if("cubic-bezier"!==a[0])return i.error("Unknown interpolation type ".concat(String(a[0])),1,0);var c=a.slice(1);if(4!==c.length||c.some((function(e){return"number"!=typeof e||e<0||e>1})))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:c}}if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(!(o=i.parse(o,2,dt)))return null;var h=[],p=null;"interpolate-hcl"===r||"interpolate-lab"===r?p=vt:i.expectedType&&"value"!==i.expectedType.kind&&(p=i.expectedType);for(var d=0;d<s.length;d+=2){var f=s[d],m=s[d+1],v=d+3,y=d+4;if("number"!=typeof f)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(h.length&&h[h.length-1][0]>=f)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',v);var g=i.parse(m,y,p);if(!g)return null;p=p||g.type,h.push([f,g])}return"number"===p.kind||"color"===p.kind||"array"===p.kind&&"number"===p.itemType.kind&&"number"==typeof p.N?new e(p,r,a,o,h):i.error("Type ".concat(kt(p)," is not interpolatable."))}}]),e}();function $i(e,t,i,n){var r=n-i,a=e-i;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}var Ji=Yi,Qi=function(){function e(t,i){v(this,e),this.type=t,this.args=i}return y(e,[{key:"evaluate",value:function(e){var t,i,n=null,r=0,a=p(this.args);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(r++,(n=o.evaluate(e))&&n instanceof zt&&!n.available&&(t||(t=n),n=null,r===this.args.length))return t;if(null!==n)break}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,i){if(t.length<2)return i.error("Expectected at least one argument.");var n=null,r=i.expectedType;r&&"value"!==r.kind&&(n=r);var a,o=[],s=p(t.slice(1));try{for(s.s();!(a=s.n()).done;){var l=a.value,u=i.parse(l,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!u)return null;n=n||u.type,o.push(u)}}catch(h){s.e(h)}finally{s.f()}var c=r&&o.some((function(e){return St(r,e.type)}));return new e(c?gt:n,o)}}]),e}(),en=Qi,tn=function(){function e(t,i){v(this,e),this.type=i.type,this.bindings=[].concat(t),this.result=i}return y(e,[{key:"evaluate",value:function(e){return this.result.evaluate(e)}},{key:"eachChild",value:function(e){var t,i=p(this.bindings);try{for(i.s();!(t=i.n()).done;)e(t.value[1])}catch(n){i.e(n)}finally{i.f()}e(this.result)}},{key:"outputDefined",value:function(){return this.result.outputDefined()}},{key:"serialize",value:function(){var e,t=["let"],i=p(this.bindings);try{for(i.s();!(e=i.n()).done;){var n=h(e.value,2),r=n[0],a=n[1];t.push(r,a.serialize())}}catch(o){i.e(o)}finally{i.f()}return t.push(this.result.serialize()),t}}],[{key:"parse",value:function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));for(var n=[],r=1;r<t.length-1;r+=2){var a=t[r];if("string"!=typeof a)return i.error("Expected string, but found ".concat(typeof a," instead."),r);if(/[^a-zA-Z0-9_]/.test(a))return i.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=i.parse(t[r+1],r+1);if(!o)return null;n.push([a,o])}var s=i.parse(t[t.length-1],t.length-1,i.expectedType,n);return s?new e(n,s):null}}]),e}(),nn=tn,rn=function(){function e(t,i,n){v(this,e),this.type=t,this.index=i,this.input=n}return y(e,[{key:"evaluate",value:function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Ut("Array index out of bounds: ".concat(t," < 0."));if(t>=i.length)throw new Ut("Array index out of bounds: ".concat(t," > ").concat(i.length-1,"."));if(t!==Math.floor(t))throw new Ut("Array index must be an integer, but found ".concat(t," instead."));return i[t]}},{key:"eachChild",value:function(e){e(this.index),e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["at",this.index.serialize(),this.input.serialize()]}}],[{key:"parse",value:function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var n=i.parse(t[1],1,dt),r=i.parse(t[2],2,wt(i.expectedType||gt));return n&&r?new e(r.type.itemType,n,r):null}}]),e}(),an=rn,on=function(){function e(t,i){v(this,e),this.type=mt,this.needle=t,this.haystack=i}return y(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(null==i)return!1;if(!Et(t,["boolean","string","number","null"]))throw new Ut("Expected first argument to be of type boolean, string, number or null, but found ".concat(kt(jt(t))," instead."));if(!Et(i,["string","array"]))throw new Ut("Expected second argument to be of type array or string, but found ".concat(kt(jt(i))," instead."));return i.indexOf(t)>=0}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["in",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var n=i.parse(t[1],1,gt),r=i.parse(t[2],2,gt);return n&&r?Tt(n.type,[mt,ft,dt,pt,gt])?new e(n,r):i.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(kt(n.type)," instead")):null}}]),e}(),sn=on,ln=function(){function e(t,i,n){v(this,e),this.type=dt,this.needle=t,this.haystack=i,this.fromIndex=n}return y(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Et(t,["boolean","string","number","null"]))throw new Ut("Expected first argument to be of type boolean, string, number or null, but found ".concat(kt(jt(t))," instead."));if(!Et(i,["string","array"]))throw new Ut("Expected second argument to be of type array or string, but found ".concat(kt(jt(i))," instead."));if(this.fromIndex){var n=this.fromIndex.evaluate(e);return i.indexOf(t,n)}return i.indexOf(t)}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var n=i.parse(t[1],1,gt),r=i.parse(t[2],2,gt);if(!n||!r)return null;if(!Tt(n.type,[mt,ft,dt,pt,gt]))return i.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(kt(n.type)," instead"));if(4===t.length){var a=i.parse(t[3],3,dt);return a?new e(n,r,a):null}return new e(n,r)}}]),e}(),un=ln,cn=function(){function e(t,i,n,r,a,o){v(this,e),this.inputType=t,this.type=i,this.input=n,this.cases=r,this.outputs=a,this.otherwise=o}return y(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);return(jt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}},{key:"eachChild",value:function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e,t=this,i=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),r=[],a={},o=p(n);try{for(o.s();!(e=o.n()).done;){var s=e.value,l=a[this.cases[s]];void 0===l?(a[this.cases[s]]=r.length,r.push([this.cases[s],[s]])):r[l][1].push(s)}}catch(y){o.e(y)}finally{o.f()}for(var u=function(e){return"number"===t.inputType.kind?Number(e):e},c=0,d=r;c<d.length;c++){var f=h(d[c],2),m=f[0],v=f[1];i.push(1===v.length?u(v[0]):v.map(u)),i.push(this.outputs[m].serialize())}return i.push(this.otherwise.serialize()),i}}],[{key:"parse",value:function(t,i){if(t.length<5)return i.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return i.error("Expected an even number of arguments.");var n,r;i.expectedType&&"value"!==i.expectedType.kind&&(r=i.expectedType);for(var a={},o=[],s=2;s<t.length-1;s+=2){var l=t[s],u=t[s+1];Array.isArray(l)||(l=[l]);var c=i.concat(s);if(0===l.length)return c.error("Expected at least one branch label.");var h,d=p(l);try{for(d.s();!(h=d.n()).done;){var f=h.value;if("number"!=typeof f&&"string"!=typeof f)return c.error("Branch labels must be numbers or strings.");if("number"==typeof f&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof f&&Math.floor(f)!==f)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,jt(f)))return null}else n=jt(f);if(void 0!==a[String(f)])return c.error("Branch labels must be unique.");a[String(f)]=o.length}}catch(g){d.e(g)}finally{d.f()}var m=i.parse(u,s,r);if(!m)return null;r=r||m.type,o.push(m)}var v=i.parse(t[1],1,gt);if(!v)return null;var y=i.parse(t[t.length-1],t.length-1,r);return y?"value"!==v.type.kind&&i.concat(1).checkSubtype(n,v.type)?null:new e(n,r,v,a,o,y):null}}]),e}(),hn=cn,pn=function(){function e(t,i,n){v(this,e),this.type=t,this.branches=i,this.otherwise=n}return y(e,[{key:"evaluate",value:function(e){var t,i=p(this.branches);try{for(i.s();!(t=i.n()).done;){var n=h(t.value,2),r=n[0],a=n[1];if(r.evaluate(e))return a.evaluate(e)}}catch(o){i.e(o)}finally{i.f()}return this.otherwise.evaluate(e)}},{key:"eachChild",value:function(e){var t,i=p(this.branches);try{for(i.s();!(t=i.n()).done;){var n=h(t.value,2),r=n[0],a=n[1];e(r),e(a)}}catch(o){i.e(o)}finally{i.f()}e(this.otherwise)}},{key:"outputDefined",value:function(){return this.branches.every((function(e){var t=h(e,2);return t[0],t[1].outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return i.error("Expected an odd number of arguments.");var n;i.expectedType&&"value"!==i.expectedType.kind&&(n=i.expectedType);for(var r=[],a=1;a<t.length-1;a+=2){var o=i.parse(t[a],a,mt);if(!o)return null;var s=i.parse(t[a+1],a+1,n);if(!s)return null;r.push([o,s]),n=n||s.type}var l=i.parse(t[t.length-1],t.length-1,n);return l?new e(n,r,l):null}}]),e}(),dn=pn,fn=function(){function e(t,i,n,r){v(this,e),this.type=t,this.input=i,this.beginIndex=n,this.endIndex=r}return y(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Et(t,["string","array"]))throw new Ut("Expected first argument to be of type array or string, but found ".concat(kt(jt(t))," instead."));if(this.endIndex){var n=this.endIndex.evaluate(e);return t.slice(i,n)}return t.slice(i)}},{key:"eachChild",value:function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}],[{key:"parse",value:function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var n=i.parse(t[1],1,gt),r=i.parse(t[2],2,dt);if(!n||!r)return null;if(!Tt(n.type,[wt(gt),ft,gt]))return i.error("Expected first argument to be of type array or string, but found ".concat(kt(n.type)," instead"));if(4===t.length){var a=i.parse(t[3],3,dt);return a?new e(n.type,n,r,a):null}return new e(n.type,n,r)}}]),e}(),mn=fn;function vn(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function yn(e,t,i,n){return 0===n.compare(t,i)}function gn(e,t,i){var n="=="!==e&&"!="!==e;return function(){function r(e,t,i){v(this,r),this.type=mt,this.lhs=e,this.rhs=t,this.collator=i,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return y(r,[{key:"evaluate",value:function(r){var a=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){var s=jt(a),l=jt(o);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new Ut('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(s.kind,", ").concat(l.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){var u=jt(a),c=jt(o);if("string"!==u.kind||"string"!==c.kind)return t(r,a,o)}return this.collator?i(r,a,o,this.collator.evaluate(r)):t(r,a,o)}},{key:"eachChild",value:function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t}}],[{key:"parse",value:function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var i=e[0],a=t.parse(e[1],1,gt);if(!a)return null;if(!vn(i,a.type))return t.concat(1).error('"'.concat(i,"\" comparisons are not supported for type '").concat(kt(a.type),"'."));var o=t.parse(e[2],2,gt);if(!o)return null;if(!vn(i,o.type))return t.concat(2).error('"'.concat(i,"\" comparisons are not supported for type '").concat(kt(o.type),"'."));if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '".concat(kt(a.type),"' and '").concat(kt(o.type),"'."));n&&("value"===a.type.kind&&"value"!==o.type.kind?a=new Ht(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new Ht(a.type,[o])));var s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,_t)))return null}return new r(a,o,s)}}]),r}()}var _n=gn("==",(function(e,t,i){return t===i}),yn),bn=gn("!=",(function(e,t,i){return t!==i}),(function(e,t,i,n){return!yn(0,t,i,n)})),xn=gn("<",(function(e,t,i){return t<i}),(function(e,t,i,n){return n.compare(t,i)<0})),wn=gn(">",(function(e,t,i){return t>i}),(function(e,t,i,n){return n.compare(t,i)>0})),kn=gn("<=",(function(e,t,i){return t<=i}),(function(e,t,i,n){return n.compare(t,i)<=0})),Pn=gn(">=",(function(e,t,i){return t>=i}),(function(e,t,i,n){return n.compare(t,i)>=0})),Sn=function(){function e(t,i,n,r,a){v(this,e),this.type=ft,this.number=t,this.locale=i,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=a}return y(e,[{key:"evaluate",value:function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}},{key:"eachChild",value:function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}],[{key:"parse",value:function(t,i){if(3!==t.length)return i.error("Expected two arguments.");var n=i.parse(t[1],1,dt);if(!n)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return i.error("NumberFormat options argument must be an object.");var a=null;if(r.locale&&!(a=i.parse(r.locale,1,ft)))return null;var o=null;if(r.currency&&!(o=i.parse(r.currency,1,ft)))return null;var s=null;if(r["min-fraction-digits"]&&!(s=i.parse(r["min-fraction-digits"],1,dt)))return null;var l=null;return r["max-fraction-digits"]&&!(l=i.parse(r["max-fraction-digits"],1,dt))?null:new e(n,a,o,s,l)}}]),e}(),Tn=function(){function e(t){v(this,e),this.type=dt,this.input=t}return y(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Ut("Expected value to be of type string or array, but found ".concat(kt(jt(t))," instead."))}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,i){if(2!==t.length)return i.error("Expected 1 argument, but found ".concat(t.length-1," instead."));var n=i.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?i.error("Expected argument of type string or array, but found ".concat(kt(n.type)," instead.")):new e(n):null}}]),e}(),En={"==":_n,"!=":bn,">":wn,"<":xn,">=":Pn,"<=":kn,array:Ht,at:an,boolean:Ht,case:dn,coalesce:en,collator:ti,format:Zt,image:qt,in:sn,"index-of":un,interpolate:Ji,"interpolate-hcl":Ji,"interpolate-lab":Ji,length:Tn,let:nn,literal:Nt,match:hn,number:Ht,"number-format":Sn,object:Ht,slice:mn,step:Ii,string:Ht,"to-boolean":Yt,"to-color":Yt,"to-number":Yt,"to-string":Yt,var:Pi,within:_i};function Cn(e,t){var i=h(t,4),n=i[0],r=i[1],a=i[2],o=i[3];n=n.evaluate(e),r=r.evaluate(e),a=a.evaluate(e);var s=o?o.evaluate(e):1,l=Rt(n,r,a,s);if(l)throw new Ut(l);return new Ot(n/255*s,r/255*s,a/255*s,s)}function Mn(e,t){return e in t}function In(e,t){var i=t[e];return void 0===i?null:i}function On(e){return{type:e}}ei.register(En,{error:[{kind:"error"},[ft],function(e,t){var i=h(t,1)[0];throw new Ut(i.evaluate(e))}],typeof:[ft,[gt],function(e,t){return kt(jt(h(t,1)[0].evaluate(e)))}],"to-rgba":[wt(dt,4),[vt],function(e,t){return h(t,1)[0].evaluate(e).toArray()}],rgb:[vt,[dt,dt,dt],Cn],rgba:[vt,[dt,dt,dt,dt],Cn],has:{type:mt,overloads:[[[ft],function(e,t){return Mn(h(t,1)[0].evaluate(e),e.properties())}],[[ft,yt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return Mn(n.evaluate(e),r.evaluate(e))}]]},get:{type:gt,overloads:[[[ft],function(e,t){return In(h(t,1)[0].evaluate(e),e.properties())}],[[ft,yt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return In(n.evaluate(e),r.evaluate(e))}]]},"feature-state":[gt,[ft],function(e,t){return In(h(t,1)[0].evaluate(e),e.featureState||{})}],properties:[yt,[],function(e){return e.properties()}],"geometry-type":[ft,[],function(e){return e.geometryType()}],id:[gt,[],function(e){return e.id()}],zoom:[dt,[],function(e){return e.globals.zoom}],pitch:[dt,[],function(e){return e.globals.pitch||0}],"distance-from-center":[dt,[],function(e){return e.distanceFromCenter()}],"heatmap-density":[dt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[dt,[],function(e){return e.globals.lineProgress||0}],"sky-radial-progress":[dt,[],function(e){return e.globals.skyRadialProgress||0}],accumulated:[gt,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[dt,On(dt),function(e,t){var i,n=0,r=p(t);try{for(r.s();!(i=r.n()).done;)n+=i.value.evaluate(e)}catch(a){r.e(a)}finally{r.f()}return n}],"*":[dt,On(dt),function(e,t){var i,n=1,r=p(t);try{for(r.s();!(i=r.n()).done;)n*=i.value.evaluate(e)}catch(a){r.e(a)}finally{r.f()}return n}],"-":{type:dt,overloads:[[[dt,dt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return n.evaluate(e)-r.evaluate(e)}],[[dt],function(e,t){return-h(t,1)[0].evaluate(e)}]]},"/":[dt,[dt,dt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return n.evaluate(e)/r.evaluate(e)}],"%":[dt,[dt,dt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return n.evaluate(e)%r.evaluate(e)}],ln2:[dt,[],function(){return Math.LN2}],pi:[dt,[],function(){return Math.PI}],e:[dt,[],function(){return Math.E}],"^":[dt,[dt,dt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return Math.pow(n.evaluate(e),r.evaluate(e))}],sqrt:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.sqrt(i.evaluate(e))}],log10:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.log(i.evaluate(e))/Math.LN10}],ln:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.log(i.evaluate(e))}],log2:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.log(i.evaluate(e))/Math.LN2}],sin:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.sin(i.evaluate(e))}],cos:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.cos(i.evaluate(e))}],tan:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.tan(i.evaluate(e))}],asin:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.asin(i.evaluate(e))}],acos:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.acos(i.evaluate(e))}],atan:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.atan(i.evaluate(e))}],min:[dt,On(dt),function(e,t){return Math.min.apply(Math,c(t.map((function(t){return t.evaluate(e)}))))}],max:[dt,On(dt),function(e,t){return Math.max.apply(Math,c(t.map((function(t){return t.evaluate(e)}))))}],abs:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.abs(i.evaluate(e))}],round:[dt,[dt],function(e,t){var i=h(t,1)[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.floor(i.evaluate(e))}],ceil:[dt,[dt],function(e,t){var i=h(t,1)[0];return Math.ceil(i.evaluate(e))}],"filter-==":[mt,[ft,gt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return e.properties()[n.value]===r.value}],"filter-id-==":[mt,[gt],function(e,t){var i=h(t,1)[0];return e.id()===i.value}],"filter-type-==":[mt,[ft],function(e,t){var i=h(t,1)[0];return e.geometryType()===i.value}],"filter-<":[mt,[ft,gt],function(e,t){var i=h(t,2),n=i[0],r=i[1],a=e.properties()[n.value],o=r.value;return typeof a==typeof o&&a<o}],"filter-id-<":[mt,[gt],function(e,t){var i=h(t,1)[0],n=e.id(),r=i.value;return typeof n==typeof r&&n<r}],"filter->":[mt,[ft,gt],function(e,t){var i=h(t,2),n=i[0],r=i[1],a=e.properties()[n.value],o=r.value;return typeof a==typeof o&&a>o}],"filter-id->":[mt,[gt],function(e,t){var i=h(t,1)[0],n=e.id(),r=i.value;return typeof n==typeof r&&n>r}],"filter-<=":[mt,[ft,gt],function(e,t){var i=h(t,2),n=i[0],r=i[1],a=e.properties()[n.value],o=r.value;return typeof a==typeof o&&a<=o}],"filter-id-<=":[mt,[gt],function(e,t){var i=h(t,1)[0],n=e.id(),r=i.value;return typeof n==typeof r&&n<=r}],"filter->=":[mt,[ft,gt],function(e,t){var i=h(t,2),n=i[0],r=i[1],a=e.properties()[n.value],o=r.value;return typeof a==typeof o&&a>=o}],"filter-id->=":[mt,[gt],function(e,t){var i=h(t,1)[0],n=e.id(),r=i.value;return typeof n==typeof r&&n>=r}],"filter-has":[mt,[gt],function(e,t){return h(t,1)[0].value in e.properties()}],"filter-has-id":[mt,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[mt,[wt(ft)],function(e,t){return h(t,1)[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[mt,[wt(gt)],function(e,t){return h(t,1)[0].value.indexOf(e.id())>=0}],"filter-in-small":[mt,[ft,wt(gt)],function(e,t){var i=h(t,2),n=i[0];return i[1].value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[mt,[ft,wt(gt)],function(e,t){var i=h(t,2),n=i[0],r=i[1];return function(e,t,i,n){for(;i<=n;){var r=i+n>>1;if(t[r]===e)return!0;t[r]>e?n=r-1:i=r+1}return!1}(e.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:mt,overloads:[[[mt,mt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return n.evaluate(e)&&r.evaluate(e)}],[On(mt),function(e,t){var i,n=p(t);try{for(n.s();!(i=n.n()).done;)if(!i.value.evaluate(e))return!1}catch(r){n.e(r)}finally{n.f()}return!0}]]},any:{type:mt,overloads:[[[mt,mt],function(e,t){var i=h(t,2),n=i[0],r=i[1];return n.evaluate(e)||r.evaluate(e)}],[On(mt),function(e,t){var i,n=p(t);try{for(n.s();!(i=n.n()).done;)if(i.value.evaluate(e))return!0}catch(r){n.e(r)}finally{n.f()}return!1}]]},"!":[mt,[mt],function(e,t){return!h(t,1)[0].evaluate(e)}],"is-supported-script":[mt,[ft],function(e,t){var i=h(t,1)[0],n=e.globals&&e.globals.isSupportedScript;return!n||n(i.evaluate(e))}],upcase:[ft,[ft],function(e,t){return h(t,1)[0].evaluate(e).toUpperCase()}],downcase:[ft,[ft],function(e,t){return h(t,1)[0].evaluate(e).toLowerCase()}],concat:[ft,On(gt),function(e,t){return t.map((function(t){return Bt(t.evaluate(e))})).join("")}],"resolved-locale":[ft,[_t],function(e,t){return h(t,1)[0].evaluate(e).resolvedLocale()}]});var Dn=En;function An(e){return{result:"success",value:e}}function Ln(e){return{result:"error",value:e}}function zn(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Rn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Fn(e){return!!e.expression&&e.expression.interpolated}function jn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Bn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Vn(e){return e}function Nn(e,t){var i,n,r,a="color"===t.type,o=e.stops&&"object"==typeof e.stops[0][0],s=o||!(o||void 0!==e.property),l=e.type||(Fn(t)?"exponential":"interval");if(a&&((e=at({},e)).stops&&(e.stops=e.stops.map((function(e){return[e[0],Ot.parse(e[1])]}))),e.default=Ot.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Ki[e.colorSpace])throw new Error("Unknown color space: ".concat(e.colorSpace));if("exponential"===l)i=Hn;else if("interval"===l)i=Wn;else if("categorical"===l){i=Gn,n=Object.create(null);var u,c=p(e.stops);try{for(c.s();!(u=c.n()).done;){var h=u.value;n[h[0]]=h[1]}}catch(P){c.e(P)}finally{c.f()}r=typeof e.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'.concat(l,'"'));i=Zn}if(o){for(var d={},f=[],m=0;m<e.stops.length;m++){var v=e.stops[m],y=v[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},f.push(y)),d[y].stops.push([v[0].value,v[1]])}for(var g=[],_=0,b=f;_<b.length;_++){var x=b[_];g.push([d[x].zoom,Nn(d[x],t)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:Ji.interpolationFactor.bind(void 0,w),zoomStops:g.map((function(e){return e[0]})),evaluate:function(i,n){var r=i.zoom;return Hn({stops:g,base:e.base},t,r).evaluate(r,n)}}}if(s){var k="exponential"===l?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Ji.interpolationFactor.bind(void 0,k),zoomStops:e.stops.map((function(e){return e[0]})),evaluate:function(a){var o=a.zoom;return i(e,t,o,n,r)}}}return{kind:"source",evaluate:function(a,o){var s=o&&o.properties?o.properties[e.property]:void 0;return void 0===s?Un(e.default,t.default):i(e,t,s,n,r)}}}function Un(e,t,i){return void 0!==e?e:void 0!==t?t:void 0!==i?i:void 0}function Gn(e,t,i,n,r){return Un(typeof i===r?n[i]:void 0,e.default,t.default)}function Wn(e,t,i){if("number"!==jn(i))return Un(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[n-1][0])return e.stops[n-1][1];var r=Ci(e.stops.map((function(e){return e[0]})),i);return e.stops[r][1]}function Hn(e,t,i){var n=void 0!==e.base?e.base:1;if("number"!==jn(i))return Un(e.default,t.default);var r=e.stops.length;if(1===r)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[r-1][0])return e.stops[r-1][1];var a=Ci(e.stops.map((function(e){return e[0]})),i),o=function(e,t,i,n){var r=n-i,a=e-i;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}(i,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],u=Di[t.type]||Vn;if(e.colorSpace&&"rgb"!==e.colorSpace){var c=Ki[e.colorSpace];u=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=s.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return u(n,r,o)}}:u(s,l,o)}function Zn(e,t,i){return"color"===t.type?i=Ot.parse(i):"formatted"===t.type?i=Lt.fromString(i.toString()):"resolvedImage"===t.type?i=zt.fromString(i.toString()):jn(i)===t.type||"enum"===t.type&&t.values[i]||(i=void 0),Un(i,e.default,t.default)}var qn=function(){function e(t,i){v(this,e),this.expression=t,this._warningHistory={},this._evaluator=new Jt,this._defaultValue=i?function(e){return"color"===e.type&&(Bn(e.default)||Array.isArray(e.default))?new Ot(0,0,0,0):"color"===e.type?Ot.parse(e.default)||null:void 0===e.default?null:e.default}(i):null,this._enumValues=i&&"enum"===i.type?i.values:null}return y(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,i,n,r,a,o,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)}},{key:"evaluate",value:function(e,t,i,n,r,a,o,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null;try{var l=this.expression.evaluate(this._evaluator);if(null==l||"number"==typeof l&&l!=l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new Ut("Expected value to be one of ".concat(Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", "),", but found ").concat(JSON.stringify(l)," instead."));return l}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}]),e}();function Xn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Dn}function Kn(e,t){var i=new Ti(Dn,[],t?function(e){var t={color:vt,string:ft,number:dt,enum:ft,boolean:mt,formatted:bt,resolvedImage:xt};return"array"===e.type?wt(t[e.value]||gt,e.length):t[e.type]}(t):void 0),n=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?An(new qn(n,t)):Ln(i.errors)}var Yn=function(){function e(t,i){v(this,e),this.kind=t,this._styleExpression=i,this.isStateDependent="constant"!==t&&!xi(i.expression)}return y(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,i,n,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,a)}},{key:"evaluate",value:function(e,t,i,n,r,a){return this._styleExpression.evaluate(e,t,i,n,r,a)}}]),e}(),$n=function(){function e(t,i,n,r){v(this,e),this.kind=t,this.zoomStops=n,this._styleExpression=i,this.isStateDependent="camera"!==t&&!xi(i.expression),this.interpolationType=r}return y(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,i,n,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,a)}},{key:"evaluate",value:function(e,t,i,n,r,a){return this._styleExpression.evaluate(e,t,i,n,r,a)}},{key:"interpolationFactor",value:function(e,t,i){return this.interpolationType?Ji.interpolationFactor(this.interpolationType,e,t,i):0}}]),e}();function Jn(e,t){if("error"===(e=Kn(e,t)).result)return e;var i=e.value.expression,n=bi(i);if(!n&&!zn(t))return Ln([new ut("","data expressions not supported")]);var r=wi(i,["zoom","pitch","distance-from-center"]);if(!r&&!Rn(t))return Ln([new ut("","zoom expressions not supported")]);var a=er(i);return a||r?a instanceof ut?Ln([a]):a instanceof Ji&&!Fn(t)?Ln([new ut("",'"interpolate" expressions cannot be used with this property')]):An(a?new $n(n?"camera":"composite",e.value,a.labels,a instanceof Ji?a.interpolation:void 0):new Yn(n?"constant":"source",e.value)):Ln([new ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}var Qn=function(){function e(t,i){v(this,e),this._parameters=t,this._specification=i,at(this,Nn(this._parameters,this._specification))}return y(e,null,[{key:"deserialize",value:function(t){return new e(t._parameters,t._specification)}},{key:"serialize",value:function(e){return{_parameters:e._parameters,_specification:e._specification}}}]),e}();function er(e){var t=null;if(e instanceof nn)t=er(e.result);else if(e instanceof en){var i,n=p(e.args);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(t=er(r))break}}catch(a){n.e(a)}finally{n.f()}}else(e instanceof Ii||e instanceof Ji)&&e.input instanceof ei&&"zoom"===e.input.name&&(t=e);return t instanceof ut||e.eachChild((function(e){var i=er(e);i instanceof ut?t=i:!t&&i?t=new ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new ut("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var tr=y((function e(t,i,n,r){v(this,e),this.message=(t?"".concat(t,": "):"")+n,r&&(this.identifier=r),null!=i&&i.__line__&&(this.line=i.__line__)}));function ir(e){var t=e.key,i=e.value,n=e.valueSpec||{},r=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=[],l=jn(i);if("object"!==l)return[new tr(t,i,"object expected, ".concat(l," found"))];for(var u in i){var c=u.split(".")[0],h=n[c]||n["*"],p=void 0;r[c]?p=r[c]:n[c]?p=zr:r["*"]?p=r["*"]:n["*"]&&(p=zr),p?s=s.concat(p({key:(t?"".concat(t,"."):t)+u,value:i[u],valueSpec:h,style:a,styleSpec:o,object:i,objectKey:u},i)):s.push(new tr(t,i[u],'unknown property "'.concat(u,'"')))}for(var d in n)r[d]||n[d].required&&void 0===n[d].default&&void 0===i[d]&&s.push(new tr(t,i,'missing required property "'.concat(d,'"')));return s}function nr(e){var t=e.value,i=e.valueSpec,n=e.style,r=e.styleSpec,a=e.key,o=e.arrayElementValidator||zr;if("array"!==jn(t))return[new tr(a,t,"array expected, ".concat(jn(t)," found"))];if(i.length&&t.length!==i.length)return[new tr(a,t,"array length ".concat(i.length," expected, length ").concat(t.length," found"))];if(i["min-length"]&&t.length<i["min-length"])return[new tr(a,t,"array length at least ".concat(i["min-length"]," expected, length ").concat(t.length," found"))];var s={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};r.$version<7&&(s.function=i.function),"object"===jn(i.value)&&(s=i.value);for(var l=[],u=0;u<t.length;u++)l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:n,styleSpec:r,key:"".concat(a,"[").concat(u,"]")}));return l}function rr(e){var t=e.key,i=e.value,n=e.valueSpec,r=jn(i);if("number"===r&&i!=i&&(r="NaN"),"number"!==r)return[new tr(t,i,"number expected, ".concat(r," found"))];if("minimum"in n){var a=n.minimum;if("array"===jn(n.minimum)&&(a=n.minimum[e.arrayIndex]),i<a)return[new tr(t,i,"".concat(i," is less than the minimum value ").concat(a))]}if("maximum"in n){var o=n.maximum;if("array"===jn(n.maximum)&&(o=n.maximum[e.arrayIndex]),i>o)return[new tr(t,i,"".concat(i," is greater than the maximum value ").concat(o))]}return[]}function ar(e){var t,i,n,r=e.valueSpec,a=ot(e.value.type),o={},s="categorical"!==a&&void 0===e.value.property,l=!s,u="array"===jn(e.value.stops)&&"array"===jn(e.value.stops[0])&&"object"===jn(e.value.stops[0][0]),c=ir({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===a)return[new tr(e.key,e.value,'identity function may not have a "stops" property')];var t=[],i=e.value;return t=t.concat(nr({key:e.key,value:i,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===jn(i)&&0===i.length&&t.push(new tr(e.key,i,"array must have at least one stop")),t},default:function(e){return zr({key:e.key,value:e.value,valueSpec:r,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===a&&s&&c.push(new tr(e.key,e.value,'missing required property "property"')),"identity"===a||e.value.stops||c.push(new tr(e.key,e.value,'missing required property "stops"')),"exponential"===a&&e.valueSpec.expression&&!Fn(e.valueSpec)&&c.push(new tr(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!zn(e.valueSpec)?c.push(new tr(e.key,e.value,"property functions not supported")):s&&!Rn(e.valueSpec)&&c.push(new tr(e.key,e.value,"zoom functions not supported"))),"categorical"!==a&&!u||void 0!==e.value.property||c.push(new tr(e.key,e.value,'"property" property is required')),c;function h(e){var t=[],a=e.value,s=e.key;if("array"!==jn(a))return[new tr(s,a,"array expected, ".concat(jn(a)," found"))];if(2!==a.length)return[new tr(s,a,"array length 2 expected, length ".concat(a.length," found"))];if(u){if("object"!==jn(a[0]))return[new tr(s,a,"object expected, ".concat(jn(a[0])," found"))];if(void 0===a[0].zoom)return[new tr(s,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new tr(s,a,"object stop key must have value")];var l=ot(a[0].zoom);if("number"!=typeof l)return[new tr(s,a[0].zoom,"stop zoom values must be numbers")];if(n&&n>l)return[new tr(s,a[0].zoom,"stop zoom values must appear in ascending order")];l!==n&&(n=l,i=void 0,o={}),t=t.concat(ir({key:"".concat(s,"[0]"),value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:rr,value:p}}))}else t=t.concat(p({key:"".concat(s,"[0]"),value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a));return Xn(st(a[1]))?t.concat([new tr("".concat(s,"[1]"),a[1],"expressions are not allowed in function stops.")]):t.concat(zr({key:"".concat(s,"[1]"),value:a[1],valueSpec:r,style:e.style,styleSpec:e.styleSpec}))}function p(e,n){var s=jn(e.value),l=ot(e.value),u=null!==e.value?e.value:n;if(t){if(s!==t)return[new tr(e.key,u,"".concat(s," stop domain type must match previous stop domain type ").concat(t))]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new tr(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==a){var c="number expected, ".concat(s," found");return zn(r)&&void 0===a&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tr(e.key,u,c)]}return"categorical"!==a||"number"!==s||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==a&&"number"===s&&"number"==typeof l&&"number"==typeof i&&void 0!==i&&l<i?[new tr(e.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===a&&l in o?[new tr(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new tr(e.key,u,"integer expected, found ".concat(String(l)))]}}function or(e){var t=("property"===e.expressionContext?Jn:Kn)(st(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new tr("".concat(e.key).concat(t.key),e.value,t.message)}));var i=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new tr(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!xi(i))return[new tr(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return sr(i,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!wi(i,["zoom","feature-state"]))return[new tr(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!bi(i))return[new tr(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function sr(e,t){var i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression){var n,r=p(t.valueSpec.expression.parameters);try{for(r.s();!(n=r.n()).done;){var a=n.value;i.delete(a)}}catch(s){r.e(s)}finally{r.f()}}if(0===i.size)return[];var o=[];return e instanceof ei&&i.has(e.name)?[new tr(t.key,t.value,'["'.concat(e.name,'"] expression is not supported in a filter for a ').concat(t.object.type," layer with id: ").concat(t.object.id))]:(e.eachChild((function(e){o.push.apply(o,c(sr(e,t)))})),o)}function lr(e){var t=e.key,i=e.value,n=e.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(ot(i))&&r.push(new tr(t,i,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(i)," found"))):-1===Object.keys(n.values).indexOf(ot(i))&&r.push(new tr(t,i,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(i)," found"))),r}function ur(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":var t,i=p(e.slice(1));try{for(i.s();!(t=i.n()).done;){var n=t.value;if(!ur(n)&&"boolean"!=typeof n)return!1}}catch(r){i.e(r)}finally{i.f()}return!0;default:return!0}}function cr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill";if(null==e)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};ur(e)||(e=yr(e));var i=e,n=!0;try{n=function(e){if(!dr(e))return e;var t=st(e);return pr(t),t=hr(t)}(i)}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(i,null,2),"\n        "))}var r=rt["filter_".concat(t)],a=Kn(n,r),o=null;if("error"===a.result)throw new Error(a.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));o=function(e,t,i){return a.value.evaluate(e,t,{},i)};var s=null,l=null;if(n!==i){var u=Kn(i,r);if("error"===u.result)throw new Error(u.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));s=function(e,t,i,n,r){return u.value.evaluate(e,t,{},i,void 0,void 0,n,r)},l=!bi(u.value.expression)}return{filter:o,dynamicFilter:s||void 0,needGeometry:vr(n),needFeature:!!l}}function hr(e){if(!Array.isArray(e))return e;var t=function(e){if(fr.has(e[0]))for(var t=1;t<e.length;t++)if(dr(e[t]))return!0;return e}(e);return!0===t?t:t.map((function(e){return hr(e)}))}function pr(e){var t=!1,i=[];if("case"===e[0]){for(var n=1;n<e.length-1;n+=2)t=t||dr(e[n]),i.push(e[n+1]);i.push(e[e.length-1])}else if("match"===e[0]){t=t||dr(e[1]);for(var r=2;r<e.length-1;r+=2)i.push(e[r+1]);i.push(e[e.length-1])}else if("step"===e[0]){t=t||dr(e[1]);for(var a=1;a<e.length-1;a+=2)i.push(e[a+1])}t&&(e.length=0,e.push.apply(e,["any"].concat(i)));for(var o=1;o<e.length;o++)pr(e[o])}function dr(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;for(var t,i=1;i<e.length;i++)if(dr(e[i]))return!0;return!1}var fr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function mr(e,t){return e<t?-1:e>t?1:0}function vr(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var t=1;t<e.length;t++)if(vr(e[t]))return!0;return!1}function yr(e){if(!e)return!0;var t,i=e[0];return e.length<=1?"any"!==i:"=="===i?gr(e[1],e[2],"=="):"!="===i?xr(gr(e[1],e[2],"==")):"<"===i||">"===i||"<="===i||">="===i?gr(e[1],e[2],i):"any"===i?(t=e.slice(1),["any"].concat(t.map(yr))):"all"===i?["all"].concat(e.slice(1).map(yr)):"none"===i?["all"].concat(e.slice(1).map(yr).map(xr)):"in"===i?_r(e[1],e.slice(2)):"!in"===i?xr(_r(e[1],e.slice(2))):"has"===i?br(e[1]):"!has"===i?xr(br(e[1])):"within"!==i||e}function gr(e,t,i){switch(e){case"$type":return["filter-type-".concat(i),t];case"$id":return["filter-id-".concat(i),t];default:return["filter-".concat(i),e,t]}}function _r(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(mr)]]:["filter-in-small",e,["literal",t]]}}function br(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function xr(e){return["!",e]}function wr(e){return ur(st(e.value))?or(at({},e,{expressionContext:"filter",valueSpec:e.styleSpec["filter_".concat(e.layerType||"fill")]})):kr(e)}function kr(e){var t=e.value,i=e.key;if("array"!==jn(t))return[new tr(i,t,"array expected, ".concat(jn(t)," found"))];var n,r=e.styleSpec,a=[];if(t.length<1)return[new tr(i,t,"filter array must have at least 1 element")];switch(a=a.concat(lr({key:"".concat(i,"[0]"),value:t[0],valueSpec:r.filter_operator,style:e.style,styleSpec:e.styleSpec})),ot(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===ot(t[1])&&a.push(new tr(i,t,'"$type" cannot be use with operator "'.concat(t[0],'"')));case"==":case"!=":3!==t.length&&a.push(new tr(i,t,'filter array for operator "'.concat(t[0],'" must have 3 elements')));case"in":case"!in":t.length>=2&&"string"!==(n=jn(t[1]))&&a.push(new tr("".concat(i,"[1]"),t[1],"string expected, ".concat(n," found")));for(var o=2;o<t.length;o++)n=jn(t[o]),"$type"===ot(t[1])?a=a.concat(lr({key:"".concat(i,"[").concat(o,"]"),value:t[o],valueSpec:r.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new tr("".concat(i,"[").concat(o,"]"),t[o],"string, number, or boolean expected, ".concat(n," found")));break;case"any":case"all":case"none":for(var s=1;s<t.length;s++)a=a.concat(kr({key:"".concat(i,"[").concat(s,"]"),value:t[s],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=jn(t[1]),2!==t.length?a.push(new tr(i,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"string"!==n&&a.push(new tr("".concat(i,"[1]"),t[1],"string expected, ".concat(n," found")));break;case"within":n=jn(t[1]),2!==t.length?a.push(new tr(i,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"object"!==n&&a.push(new tr("".concat(i,"[1]"),t[1],"object expected, ".concat(n," found")))}return a}function Pr(e,t){var i=e.key,n=e.style,r=e.styleSpec,a=e.value,o=e.objectKey,s=r["".concat(t,"_").concat(e.layerType)];if(!s)return[];var l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return zr({key:i,value:a,valueSpec:r.transition,style:n,styleSpec:r});var u,c=e.valueSpec||s[o];if(!c)return[new tr(i,a,'unknown property "'.concat(o,'"'))];if("string"===jn(a)&&zn(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(a)))return[new tr(i,a,'"'.concat(o,'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ').concat(JSON.stringify(u[1])," }`."))];var h=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&h.push(new tr(i,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Bn(st(a))&&"identity"===ot(a.type)&&h.push(new tr(i,a,'"text-font" does not support identity functions'))),h.concat(zr({key:e.key,value:a,valueSpec:c,style:n,styleSpec:r,expressionContext:"property",propertyType:t,propertyKey:o}))}function Sr(e){return Pr(e,"paint")}function Tr(e){return Pr(e,"layout")}function Er(e){var t=[],i=e.value,n=e.key,r=e.style,a=e.styleSpec;i.type||i.ref||t.push(new tr(n,i,'either "type" or "ref" is required'));var o,s=ot(i.type),l=ot(i.ref);if(i.id)for(var u=ot(i.id),c=0;c<e.arrayIndex;c++){var h=r.layers[c];ot(h.id)===u&&t.push(new tr(n,i.id,'duplicate layer id "'.concat(i.id,'", previously used at line ').concat(h.id.__line__)))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach((function(e){e in i&&t.push(new tr(n,i[e],'"'.concat(e,'" is prohibited for ref layers')))})),r.layers.forEach((function(e){ot(e.id)===l&&(o=e)})),o?o.ref?t.push(new tr(n,i.ref,"ref cannot reference another ref layer")):s=ot(o.type):"string"==typeof l&&t.push(new tr(n,i.ref,'ref layer "'.concat(l,'" not found')));else if("background"!==s&&"sky"!==s)if(i.source){var p=r.sources&&r.sources[i.source],d=p&&ot(p.type);p?"vector"===d&&"raster"===s?t.push(new tr(n,i.source,'layer "'.concat(i.id,'" requires a raster source'))):"raster"===d&&"raster"!==s?t.push(new tr(n,i.source,'layer "'.concat(i.id,'" requires a vector source'))):"vector"!==d||i["source-layer"]?"raster-dem"===d&&"hillshade"!==s?t.push(new tr(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===d&&p.lineMetrics||t.push(new tr(n,i,'layer "'.concat(i.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new tr(n,i,'layer "'.concat(i.id,'" must specify a "source-layer"'))):t.push(new tr(n,i.source,'source "'.concat(i.source,'" not found')))}else t.push(new tr(n,i,'missing required property "source"'));return t=t.concat(ir({key:n,value:i,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return zr({key:"".concat(n,".type"),value:i.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:function(e){return wr(at({layerType:s},e))},layout:function(e){return ir({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Tr(at({layerType:s},e))}}})},paint:function(e){return ir({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Sr(at({layerType:s},e))}}})}}})),t}function Cr(e){var t=e.value,i=e.key,n=jn(t);return"string"!==n?[new tr(i,t,"string expected, ".concat(n," found"))]:[]}var Mr={promoteId:function(e){var t=e.key,i=e.value;if("string"===jn(i))return Cr({key:t,value:i});var n=[];for(var r in i)n.push.apply(n,c(Cr({key:"".concat(t,".").concat(r),value:i[r]})));return n}};function Ir(e){var t=e.value,i=e.key,n=e.styleSpec,r=e.style;if(!t.type)return[new tr(i,t,'"type" is required')];var a,o=ot(t.type);switch(o){case"vector":case"raster":case"raster-dem":return a=ir({key:i,value:t,valueSpec:n["source_".concat(o.replace("-","_"))],style:e.style,styleSpec:n,objectElementValidators:Mr});case"geojson":if(a=ir({key:i,value:t,valueSpec:n.source_geojson,style:r,styleSpec:n,objectElementValidators:Mr}),t.cluster)for(var s in t.clusterProperties){var l,u,p=h(t.clusterProperties[s],2),d=p[0],f=p[1],m="string"==typeof d?[d,["accumulated"],["get",s]]:d;(l=a).push.apply(l,c(or({key:"".concat(i,".").concat(s,".map"),value:f,expressionContext:"cluster-map"}))),(u=a).push.apply(u,c(or({key:"".concat(i,".").concat(s,".reduce"),value:m,expressionContext:"cluster-reduce"})))}return a;case"video":return ir({key:i,value:t,valueSpec:n.source_video,style:r,styleSpec:n});case"image":return ir({key:i,value:t,valueSpec:n.source_image,style:r,styleSpec:n});case"canvas":return[new tr(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lr({key:"".concat(i,".type"),value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:n})}}function Or(e){var t=e.value,i=e.styleSpec,n=i.light,r=e.style,a=[],o=jn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new tr("light",t,"object expected, ".concat(o," found"))]);for(var s in t){var l=s.match(/^(.*)-transition$/);a=a.concat(l&&n[l[1]]&&n[l[1]].transition?zr({key:s,value:t[s],valueSpec:i.transition,style:r,styleSpec:i}):n[s]?zr({key:s,value:t[s],valueSpec:n[s],style:r,styleSpec:i}):[new tr(s,t[s],'unknown property "'.concat(s,'"'))])}return a}function Dr(e){var t=e.value,i=e.key,n=e.style,r=e.styleSpec,a=r.terrain,o=[],s=jn(t);if(void 0===t)return o;if("object"!==s)return o=o.concat([new tr("terrain",t,"object expected, ".concat(s," found"))]);for(var l in t){var u=l.match(/^(.*)-transition$/);o=o.concat(u&&a[u[1]]&&a[u[1]].transition?zr({key:l,value:t[l],valueSpec:r.transition,style:n,styleSpec:r}):a[l]?zr({key:l,value:t[l],valueSpec:a[l],style:n,styleSpec:r}):[new tr(l,t[l],'unknown property "'.concat(l,'"'))])}if(t.source){var c=n.sources&&n.sources[t.source],h=c&&ot(c.type);c?"raster-dem"!==h&&o.push(new tr(i,t.source,"terrain cannot be used with a source of type ".concat(String(h),', it only be used with a "raster-dem" source type'))):o.push(new tr(i,t.source,'source "'.concat(t.source,'" not found')))}else o.push(new tr(i,t,'terrain is missing required property "source"'));return o}function Ar(e){var t=e.value,i=e.style,n=e.styleSpec,r=n.fog,a=[],o=jn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new tr("fog",t,"object expected, ".concat(o," found"))]);for(var s in t){var l=s.match(/^(.*)-transition$/);a=a.concat(l&&r[l[1]]&&r[l[1]].transition?zr({key:s,value:t[s],valueSpec:n.transition,style:i,styleSpec:n}):r[s]?zr({key:s,value:t[s],valueSpec:r[s],style:i,styleSpec:n}):[new tr(s,t[s],'unknown property "'.concat(s,'"'))])}return a}var Lr={"*":function(){return[]},array:nr,boolean:function(e){var t=e.value,i=e.key,n=jn(t);return"boolean"!==n?[new tr(i,t,"boolean expected, ".concat(n," found"))]:[]},number:rr,color:function(e){var t=e.key,i=e.value,n=jn(i);return"string"!==n?[new tr(t,i,"color expected, ".concat(n," found"))]:null===Mt.parseCSSColor(i)?[new tr(t,i,'color expected, "'.concat(i,'" found'))]:[]},enum:lr,filter:wr,function:ar,layer:Er,object:ir,source:Ir,light:Or,terrain:Dr,fog:Ar,string:Cr,formatted:function(e){return 0===Cr(e).length?[]:or(e)},resolvedImage:function(e){return 0===Cr(e).length?[]:or(e)},projection:function(e){var t=e.value,i=e.styleSpec,n=i.projection,r=e.style,a=[],o=jn(t);if("object"===o)for(var s in t)a=a.concat(zr({key:s,value:t[s],valueSpec:n[s],style:r,styleSpec:i}));else"string"!==o&&(a=a.concat([new tr("projection",t,"object or string expected, ".concat(o," found"))]));return a}};function zr(e){var t=e.value,i=e.valueSpec,n=e.styleSpec;return i.expression&&Bn(ot(t))?ar(e):i.expression&&Xn(st(t))?or(e):i.type&&Lr[i.type]?Lr[i.type](e):ir(at({},e,{valueSpec:i.type?n[i.type]:i}))}function Rr(e){var t=e.value,i=e.key,n=Cr(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new tr(i,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new tr(i,t,'"glyphs" url must include a "{range}" token'))),n}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt;return Vr(zr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Rr,"*":function(){return[]}}}))}var jr=function(e){return Vr(Sr(e))},Br=function(e){return Vr(Tr(e))};function Vr(e){return e.slice().sort((function(e,t){return e.line&&t.line?e.line-t.line:0}))}function Nr(e,t){var i=!1;if(t&&t.length){var n,r=p(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.fire(new it(new Error(a.message))),i=!0}}catch(o){r.e(o)}finally{r.f()}}return i}var Ur=Gr;function Gr(e,t,i){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(i=r[2]);for(var a=0;a<this.d*this.d;a++){var o=r[3+a],s=r[3+a+1];n.push(o===s?null:r.subarray(o,s))}var l=r[3+n.length+1];this.keys=r.subarray(r[3+n.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var u=0;u<this.d*this.d;u++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var c=i/t*e;this.min=-c,this.max=e+c}Gr.prototype.insert=function(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)},Gr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Gr.prototype._insertCell=function(e,t,i,n,r,a){this.cells[r].push(a)},Gr.prototype.query=function(e,t,i,n,r){var a=this.min,o=this.max;if(e<=a&&t<=a&&o<=i&&o<=n&&!r)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,i,n,this._queryCell,s,{},r),s},Gr.prototype._queryCell=function(e,t,i,n,r,a,o,s){var l=this.cells[r];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var p=l[h];if(void 0===o[p]){var d=4*p;(s?s(c[d+0],c[d+1],c[d+2],c[d+3]):e<=c[d+2]&&t<=c[d+3]&&i>=c[d+0]&&n>=c[d+1])?(o[p]=!0,a.push(u[p])):o[p]=!1}}},Gr.prototype._forEachCell=function(e,t,i,n,r,a,o,s){for(var l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(i),h=this._convertToCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++){var f=this.d*d+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(d),this._convertFromCellCoord(p+1),this._convertFromCellCoord(d+1)))&&r.call(this,e,t,i,n,f,a,o,s))return}},Gr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Gr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Gr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var r=new Int32Array(t+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var a=t,o=0;o<e.length;o++){var s=e[o];r[3+o]=a,r.set(s,a),a+=s.length}return r[3+e.length]=a,r.set(this.keys,a),r[3+e.length+1]=a+=this.keys.length,r.set(this.bboxes,a),a+=this.bboxes.length,r.buffer};var Wr={};function Hr(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Wr[t]={klass:e,omit:i.omit||[]}}for(var Zr in Hr(Object,"Object"),Ur.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ur.deserialize=function(e){return new Ur(e.buffer)},Object.defineProperty(Ur,"name",{value:"Grid"}),Hr(Ur,"Grid"),Hr(Ot,"Color"),Hr(Error,"Error"),Hr(Ue,"AJAXError"),Hr(zt,"ResolvedImage"),Hr(Qn,"StylePropertyFunction"),Hr(qn,"StyleExpression",{omit:["_evaluator"]}),Hr($n,"ZoomDependentExpression"),Hr(Yn,"ZoomConstantExpression"),Hr(ei,"CompoundExpression",{omit:["_evaluate"]}),Dn)Wr[Dn[Zr]._classRegistryKey]||Hr(Dn[Zr],"Expression".concat(Zr));function qr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Xr(e){return t.ImageBitmap&&e instanceof t.ImageBitmap}function Kr(e,i){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(qr(e)||Xr(e))return i&&i.push(e),e;if(ArrayBuffer.isView(e)){var n=e;return i&&i.push(n.buffer),n}if(e instanceof t.ImageData)return i&&i.push(e.data.buffer),e;if(Array.isArray(e)){var r,a=[],o=p(e);try{for(o.s();!(r=o.n()).done;){var s=r.value;a.push(Kr(s,i))}}catch(d){o.e(d)}finally{o.f()}return a}if("object"==typeof e){var l=e.constructor,u=l._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class ".concat(u));var c=l.serialize?l.serialize(e,i):{};if(!l.serialize){for(var h in e)e.hasOwnProperty(h)&&(Wr[u].omit.indexOf(h)>=0||(c[h]=Kr(e[h],i)));e instanceof Error&&(c.message=e.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(c.$name=u),c}throw new Error("can't serialize object of type "+typeof e)}function Yr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||qr(e)||Xr(e)||ArrayBuffer.isView(e)||e instanceof t.ImageData)return e;if(Array.isArray(e))return e.map(Yr);if("object"==typeof e){var i=e.$name||"Object",n=Wr[i].klass;if(!n)throw new Error("can't deserialize unregistered class ".concat(i));if(n.deserialize)return n.deserialize(e);for(var r=Object.create(n.prototype),a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];"$name"!==s&&(r[s]=Yr(e[s]))}return r}throw new Error("can't deserialize object of type "+typeof e)}var $r=function(){function e(){v(this,e),this.first=!0}return y(e,[{key:"update",value:function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))}}]),e}(),Jr=function(e){return e>=1536&&e<=1791},Qr=function(e){return e>=1872&&e<=1919},ea=function(e){return e>=2208&&e<=2303},ta=function(e){return e>=11904&&e<=12031},ia=function(e){return e>=12032&&e<=12255},na=function(e){return e>=12272&&e<=12287},ra=function(e){return e>=12288&&e<=12351},aa=function(e){return e>=12352&&e<=12447},oa=function(e){return e>=12448&&e<=12543},sa=function(e){return e>=12544&&e<=12591},la=function(e){return e>=12704&&e<=12735},ua=function(e){return e>=12736&&e<=12783},ca=function(e){return e>=12784&&e<=12799},ha=function(e){return e>=12800&&e<=13055},pa=function(e){return e>=13056&&e<=13311},da=function(e){return e>=13312&&e<=19903},fa=function(e){return e>=19968&&e<=40959},ma=function(e){return e>=40960&&e<=42127},va=function(e){return e>=42128&&e<=42191},ya=function(e){return e>=44032&&e<=55215},ga=function(e){return e>=63744&&e<=64255},_a=function(e){return e>=64336&&e<=65023},ba=function(e){return e>=65040&&e<=65055},xa=function(e){return e>=65072&&e<=65103},wa=function(e){return e>=65104&&e<=65135},ka=function(e){return e>=65136&&e<=65279},Pa=function(e){return e>=65280&&e<=65519};function Sa(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;)if(Ca(t.value.charCodeAt(0)))return!0}catch(n){i.e(n)}finally{i.f()}return!1}function Ta(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;)if(!Ea(t.value.charCodeAt(0)))return!1}catch(n){i.e(n)}finally{i.f()}return!0}function Ea(e){return!(Jr(e)||Qr(e)||ea(e)||_a(e)||ka(e))}function Ca(e){return!(746!==e&&747!==e&&(e<4352||!(la(e)||sa(e)||xa(e)&&!(e>=65097&&e<=65103)||ga(e)||pa(e)||ta(e)||ua(e)||!(!ra(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||da(e)||fa(e)||ha(e)||function(e){return e>=12592&&e<=12687}(e)||function(e){return e>=43360&&e<=43391}(e)||function(e){return e>=55216&&e<=55295}(e)||function(e){return e>=4352&&e<=4607}(e)||ya(e)||aa(e)||na(e)||function(e){return e>=12688&&e<=12703}(e)||ia(e)||ca(e)||oa(e)&&12540!==e||!(!Pa(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!wa(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||function(e){return e>=5120&&e<=5759}(e)||function(e){return e>=6320&&e<=6399}(e)||ba(e)||function(e){return e>=19904&&e<=19967}(e)||ma(e)||va(e))))}function Ma(e){return!(Ca(e)||function(e){return!!(function(e){return e>=128&&e<=255}(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||function(e){return e>=8192&&e<=8303}(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||function(e){return e>=8448&&e<=8527}(e)||function(e){return e>=8528&&e<=8591}(e)||function(e){return e>=8960&&e<=9215}(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||function(e){return e>=9216&&e<=9279}(e)&&9251!==e||function(e){return e>=9280&&e<=9311}(e)||function(e){return e>=9312&&e<=9471}(e)||function(e){return e>=9632&&e<=9727}(e)||function(e){return e>=9728&&e<=9983}(e)&&!(e>=9754&&e<=9759)||function(e){return e>=11008&&e<=11263}(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ra(e)||oa(e)||function(e){return e>=57344&&e<=63743}(e)||xa(e)||wa(e)||Pa(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function Ia(e){return e>=1424&&e<=2303||_a(e)||ka(e)}function Oa(e,t){return!(!t&&Ia(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||function(e){return e>=6016&&e<=6143}(e))}function Da(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;)if(Ia(t.value.charCodeAt(0)))return!0}catch(n){i.e(n)}finally{i.f()}return!1}var Aa="deferred",La="loading",za="loaded",Ra=null,Fa="unavailable",ja=null,Ba=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Fa="error"),Ra&&Ra(e)};function Va(){Na.fire(new tt("pluginStateChange",{pluginStatus:Fa,pluginURL:ja}))}var Na=new nt,Ua=function(){return Fa},Ga=function(){if(Fa!==Aa||!ja)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Fa=La,Va(),ja&&He({url:ja},(function(e){e?Ba(e):(Fa=za,Va())}))},Wa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Fa===za||null!=Wa.applyArabicShaping},isLoading:function(){return Fa===La},setState:function(e){Fa=e.pluginStatus,ja=e.pluginURL},isParsed:function(){return null!=Wa.applyArabicShaping&&null!=Wa.processBidirectionalText&&null!=Wa.processStyledBidirectionalText},getPluginURL:function(){return ja}},Ha=function(){function e(t,i){v(this,e),this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $r,this.transition={},this.pitch=0)}return y(e,[{key:"isSupportedScript",value:function(e){return function(e,t){var i,n=p(e);try{for(n.s();!(i=n.n()).done;)if(!Oa(i.value.charCodeAt(0),t))return!1}catch(r){n.e(r)}finally{n.f()}return!0}(e,Wa.isLoaded())}},{key:"crossFadingFactor",value:function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}},{key:"getCrossfadeParameters",value:function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}}}]),e}(),Za=function(){function e(t,i){v(this,e),this.property=t,this.value=i,this.expression=function(e,t){if(Bn(e))return new Qn(e,t);if(Xn(e)){var i=Jn(e,t);if("error"===i.result)throw new Error(i.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));return i.value}var n=e;return"string"==typeof e&&"color"===t.type&&(n=Ot.parse(e)),{kind:"constant",evaluate:function(){return n}}}(void 0===i?t.specification.default:i,t.specification)}return y(e,[{key:"isDataDriven",value:function(){return"source"===this.expression.kind||"composite"===this.expression.kind}},{key:"possiblyEvaluate",value:function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)}}]),e}(),qa=function(){function e(t){v(this,e),this.property=t,this.value=new Za(t,void 0)}return y(e,[{key:"transitioned",value:function(e,t){return new Ka(this.property,this.value,t,A({},e.transition,this.transition),e.now)}},{key:"untransitioned",value:function(){return new Ka(this.property,this.value,null,{},0)}}]),e}(),Xa=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}return y(e,[{key:"getValue",value:function(e){return G(this._values[e].value.value)}},{key:"setValue",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new qa(this._values[e].property)),this._values[e].value=new Za(this._values[e].property,null===t?void 0:G(t))}},{key:"getTransition",value:function(e){return G(this._values[e].transition)}},{key:"setTransition",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new qa(this._values[e].property)),this._values[e].transition=G(t)||void 0}},{key:"serialize",value:function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t++){var n=i[t],r=this.getValue(n);void 0!==r&&(e[n]=r);var a=this.getTransition(n);void 0!==a&&(e["".concat(n,"-transition")]=a)}return e}},{key:"transitioned",value:function(e,t){for(var i=new Ya(this._properties),n=0,r=Object.keys(this._values);n<r.length;n++){var a=r[n];i._values[a]=this._values[a].transitioned(e,t._values[a])}return i}},{key:"untransitioned",value:function(){for(var e=new Ya(this._properties),t=0,i=Object.keys(this._values);t<i.length;t++){var n=i[t];e._values[n]=this._values[n].untransitioned()}return e}}]),e}(),Ka=function(){function e(t,i,n,r,a){v(this,e);var o=r.delay||0,s=r.duration||0;a=a||0,this.property=t,this.value=i,this.begin=a+o,this.end=this.begin+s,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}return y(e,[{key:"possiblyEvaluate",value:function(e,t,i){var n=e.now||0,r=this.value.possiblyEvaluate(e,t,i),a=this.prior;if(a){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return a.possiblyEvaluate(e,t,i);var o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,i),r,S(o))}return r}}]),e}(),Ya=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}return y(e,[{key:"possiblyEvaluate",value:function(e,t,i){for(var n=new Qa(this._properties),r=0,a=Object.keys(this._values);r<a.length;r++){var o=a[r];n._values[o]=this._values[o].possiblyEvaluate(e,t,i)}return n}},{key:"hasTransition",value:function(){for(var e=0,t=Object.keys(this._values);e<t.length;e++){var i=t[e];if(this._values[i].prior)return!0}return!1}}]),e}(),$a=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultPropertyValues)}return y(e,[{key:"getValue",value:function(e){return G(this._values[e].value)}},{key:"setValue",value:function(e,t){this._values[e]=new Za(this._values[e].property,null===t?void 0:G(t))}},{key:"serialize",value:function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t++){var n=i[t],r=this.getValue(n);void 0!==r&&(e[n]=r)}return e}},{key:"possiblyEvaluate",value:function(e,t,i){for(var n=new Qa(this._properties),r=0,a=Object.keys(this._values);r<a.length;r++){var o=a[r];n._values[o]=this._values[o].possiblyEvaluate(e,t,i)}return n}}]),e}(),Ja=function(){function e(t,i,n){v(this,e),this.property=t,this.value=i,this.parameters=n}return y(e,[{key:"isConstant",value:function(){return"constant"===this.value.kind}},{key:"constantOr",value:function(e){return"constant"===this.value.kind?this.value.value:e}},{key:"evaluate",value:function(e,t,i,n){return this.property.evaluate(this.value,this.parameters,e,t,i,n)}}]),e}(),Qa=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}return y(e,[{key:"get",value:function(e){return this._values[e]}}]),e}(),eo=function(){function e(t){v(this,e),this.specification=t}return y(e,[{key:"possiblyEvaluate",value:function(e,t){return e.expression.evaluate(t)}},{key:"interpolate",value:function(e,t,i){var n=Di[this.specification.type];return n?n(e,t,i):e}}]),e}(),to=function(){function e(t,i){v(this,e),this.specification=t,this.overrides=i}return y(e,[{key:"possiblyEvaluate",value:function(e,t,i,n){return new Ja(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},i,n)}:e.expression,t)}},{key:"interpolate",value:function(e,t,i){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Ja(this,{kind:"constant",value:void 0},e.parameters);var n=Di[this.specification.type];return n?new Ja(this,{kind:"constant",value:n(e.value.value,t.value.value,i)},e.parameters):e}},{key:"evaluate",value:function(e,t,i,n,r,a){return"constant"===e.kind?e.value:e.evaluate(t,i,n,r,a)}}]),e}(),io=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"possiblyEvaluate",value:function(e,t,i,n){if(void 0===e.value)return new Ja(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var r=e.expression.evaluate(t,null,{},i,n),a="resolvedImage"===e.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(a,a,a,t);return new Ja(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){var s=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Ja(this,{kind:"constant",value:s},t)}return new Ja(this,e.expression,t)}},{key:"evaluate",value:function(e,t,i,n,r,a){if("source"===e.kind){var o=e.evaluate(t,i,n,r,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},i,n),e.evaluate({zoom:Math.floor(t.zoom)},i,n),e.evaluate({zoom:Math.floor(t.zoom)+1},i,n),t):e.value}},{key:"_calculate",value:function(e,t,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t,other:i}:{from:i,to:t,other:e}}},{key:"interpolate",value:function(e){return e}}]),i}(to),no=function(){function e(t){v(this,e),this.specification=t}return y(e,[{key:"possiblyEvaluate",value:function(e,t,i,n){if(void 0!==e.value){if("constant"===e.expression.kind){var r=e.expression.evaluate(t,null,{},i,n);return this._calculate(r,r,r,t)}return this._calculate(e.expression.evaluate(new Ha(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Ha(Math.floor(t.zoom),t)),e.expression.evaluate(new Ha(Math.floor(t.zoom+1),t)),t)}}},{key:"_calculate",value:function(e,t,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}}},{key:"interpolate",value:function(e){return e}}]),e}(),ro=function(){function e(t){v(this,e),this.specification=t}return y(e,[{key:"possiblyEvaluate",value:function(e,t,i,n){return!!e.expression.evaluate(t,null,{},i,n)}},{key:"interpolate",value:function(){return!1}}]),e}(),ao=y((function e(t){v(this,e),this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];var i=new Ha(0,{});for(var n in t){var r=t[n];r.specification.overridable&&this.overridableProperties.push(n);var a=this.defaultPropertyValues[n]=new Za(r,void 0),o=this.defaultTransitionablePropertyValues[n]=new qa(r);this.defaultTransitioningPropertyValues[n]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=a.possiblyEvaluate(i)}}));function oo(e,t){return 256*(e=C(Math.floor(e),0,255))+C(Math.floor(t),0,255)}Hr(to,"DataDrivenProperty"),Hr(eo,"DataConstantProperty"),Hr(io,"CrossFadedDataDrivenProperty"),Hr(no,"CrossFadedProperty"),Hr(ro,"ColorRampProperty");var so={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},lo=y((function e(t,i){v(this,e),this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8})),uo=function(){function e(){v(this,e),this.isTransferred=!1,this.capacity=-1,this.resize(0)}return y(e,[{key:"_trim",value:function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}},{key:"clear",value:function(){this.length=0}},{key:"resize",value:function(e){this.reserve(e),this.length=e}},{key:"reserve",value:function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}},{key:"_refreshViews",value:function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}},{key:"destroy",value:function(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}],[{key:"serialize",value:function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}},{key:"deserialize",value:function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}}]),e}();function co(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,n=0;return{members:e.map((function(e){var r=so[e.type].BYTES_PER_ELEMENT,a=i=ho(i,Math.max(t,r)),o=e.components||1;return n=Math.max(n,r),i+=r*o,{name:e.name,type:e.type,components:o,offset:a}})),size:ho(i,Math.max(n,t)),alignment:t}}function ho(e,t){return Math.ceil(e/t)*t}var po=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var i=this.length;return this.resize(i+1),this.emplace(i,e,t)}},{key:"emplace",value:function(e,t,i){var n=2*e;return this.int16[n+0]=t,this.int16[n+1]=i,e}}]),i}(uo);po.prototype.bytesPerElement=4,Hr(po,"StructArrayLayout2i4");var fo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}},{key:"emplace",value:function(e,t,i,n){var r=3*e;return this.int16[r+0]=t,this.int16[r+1]=i,this.int16[r+2]=n,e}}]),i}(uo);fo.prototype.bytesPerElement=6,Hr(fo,"StructArrayLayout3i6");var mo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}},{key:"emplace",value:function(e,t,i,n,r){var a=4*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,e}}]),i}(uo);mo.prototype.bytesPerElement=8,Hr(mo,"StructArrayLayout4i8");var vo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a,o)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s){var l=6*e,u=12*e,c=3*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.uint8[u+4]=n,this.uint8[u+5]=r,this.uint8[u+6]=a,this.uint8[u+7]=o,this.float32[c+2]=s,e}}]),i}(uo);vo.prototype.bytesPerElement=12,Hr(vo,"StructArrayLayout2i4ub1f12");var yo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}},{key:"emplace",value:function(e,t,i,n,r){var a=4*e;return this.float32[a+0]=t,this.float32[a+1]=i,this.float32[a+2]=n,this.float32[a+3]=r,e}}]),i}(uo);yo.prototype.bytesPerElement=16,Hr(yo,"StructArrayLayout4f16");var go=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,i,n,r,a,o,s,l,u)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l,u,c){var h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=i,this.uint16[h+2]=n,this.uint16[h+3]=r,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,e}}]),i}(uo);go.prototype.bytesPerElement=20,Hr(go,"StructArrayLayout10ui20");var _o=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s){var l=this.length;return this.resize(l+1),this.emplace(l,e,t,i,n,r,a,o,s)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l){var u=8*e;return this.uint16[u+0]=t,this.uint16[u+1]=i,this.uint16[u+2]=n,this.uint16[u+3]=r,this.uint16[u+4]=a,this.uint16[u+5]=o,this.uint16[u+6]=s,this.uint16[u+7]=l,e}}]),i}(uo);_o.prototype.bytesPerElement=16,Hr(_o,"StructArrayLayout8ui16");var bo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,a)}},{key:"emplace",value:function(e,t,i,n,r,a,o){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=i,this.int16[s+2]=n,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,e}}]),i}(uo);bo.prototype.bytesPerElement=12,Hr(bo,"StructArrayLayout6i12");var xo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s,l,u,c,h){var p=this.length;return this.resize(p+1),this.emplace(p,e,t,i,n,r,a,o,s,l,u,c,h)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p){var d=12*e;return this.int16[d+0]=t,this.int16[d+1]=i,this.int16[d+2]=n,this.int16[d+3]=r,this.uint16[d+4]=a,this.uint16[d+5]=o,this.uint16[d+6]=s,this.uint16[d+7]=l,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=h,this.int16[d+11]=p,e}}]),i}(uo);xo.prototype.bytesPerElement=24,Hr(xo,"StructArrayLayout4i4ui4i24");var wo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,a)}},{key:"emplace",value:function(e,t,i,n,r,a,o){var s=10*e,l=5*e;return this.int16[s+0]=t,this.int16[s+1]=i,this.int16[s+2]=n,this.float32[l+2]=r,this.float32[l+3]=a,this.float32[l+4]=o,e}}]),i}(uo);wo.prototype.bytesPerElement=20,Hr(wo,"StructArrayLayout3i3f20");var ko=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint32[1*e+0]=t,e}}]),i}(uo);ko.prototype.bytesPerElement=4,Hr(ko,"StructArrayLayout1ul4");var Po=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p){var d=this.length;return this.resize(d+1),this.emplace(d,e,t,i,n,r,a,o,s,l,u,c,h,p)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d){var f=20*e,m=10*e;return this.int16[f+0]=t,this.int16[f+1]=i,this.int16[f+2]=n,this.int16[f+3]=r,this.int16[f+4]=a,this.float32[m+3]=o,this.float32[m+4]=s,this.float32[m+5]=l,this.float32[m+6]=u,this.int16[f+14]=c,this.uint32[m+8]=h,this.uint16[f+18]=p,this.uint16[f+19]=d,e}}]),i}(uo);Po.prototype.bytesPerElement=40,Hr(Po,"StructArrayLayout5i4f1i1ul2ui40");var So=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a,o)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s){var l=8*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.int16[l+2]=n,this.int16[l+4]=r,this.int16[l+5]=a,this.int16[l+6]=o,this.int16[l+7]=s,e}}]),i}(uo);So.prototype.bytesPerElement=16,Hr(So,"StructArrayLayout3i2i2i16");var To=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r)}},{key:"emplace",value:function(e,t,i,n,r,a){var o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.int16[s+6]=r,this.int16[s+7]=a,e}}]),i}(uo);To.prototype.bytesPerElement=16,Hr(To,"StructArrayLayout2f1f2i16");var Eo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}},{key:"emplace",value:function(e,t,i,n,r){var a=12*e,o=3*e;return this.uint8[a+0]=t,this.uint8[a+1]=i,this.float32[o+1]=n,this.float32[o+2]=r,e}}]),i}(uo);Eo.prototype.bytesPerElement=12,Hr(Eo,"StructArrayLayout2ub2f12");var Co=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}},{key:"emplace",value:function(e,t,i,n){var r=3*e;return this.float32[r+0]=t,this.float32[r+1]=i,this.float32[r+2]=n,e}}]),i}(uo);Co.prototype.bytesPerElement=12,Hr(Co,"StructArrayLayout3f12");var Mo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}},{key:"emplace",value:function(e,t,i,n){var r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=i,this.uint16[r+2]=n,e}}]),i}(uo);Mo.prototype.bytesPerElement=6,Hr(Mo,"StructArrayLayout3ui6");var Io=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b){var x=this.length;return this.resize(x+1),this.emplace(x,e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b,x){var w=30*e,k=15*e,P=60*e;return this.int16[w+0]=t,this.int16[w+1]=i,this.int16[w+2]=n,this.float32[k+2]=r,this.float32[k+3]=a,this.uint16[w+8]=o,this.uint16[w+9]=s,this.uint32[k+5]=l,this.uint32[k+6]=u,this.uint32[k+7]=c,this.uint16[w+16]=h,this.uint16[w+17]=p,this.uint16[w+18]=d,this.float32[k+10]=f,this.float32[k+11]=m,this.uint8[P+48]=v,this.uint8[P+49]=y,this.uint8[P+50]=g,this.uint32[k+13]=_,this.int16[w+28]=b,this.uint8[P+58]=x,e}}]),i}(uo);Io.prototype.bytesPerElement=60,Hr(Io,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");var Oo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b,x,w,k,P,S,T,E,C,M){var I=this.length;return this.resize(I+1),this.emplace(I,e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b,x,w,k,P,S,T,E,C,M)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g,_,b,x,w,k,P,S,T,E,C,M,I){var O=38*e,D=19*e;return this.int16[O+0]=t,this.int16[O+1]=i,this.int16[O+2]=n,this.float32[D+2]=r,this.float32[D+3]=a,this.int16[O+8]=o,this.int16[O+9]=s,this.int16[O+10]=l,this.int16[O+11]=u,this.int16[O+12]=c,this.int16[O+13]=h,this.uint16[O+14]=p,this.uint16[O+15]=d,this.uint16[O+16]=f,this.uint16[O+17]=m,this.uint16[O+18]=v,this.uint16[O+19]=y,this.uint16[O+20]=g,this.uint16[O+21]=_,this.uint16[O+22]=b,this.uint16[O+23]=x,this.uint16[O+24]=w,this.uint16[O+25]=k,this.uint16[O+26]=P,this.uint16[O+27]=S,this.uint16[O+28]=T,this.uint32[D+15]=E,this.float32[D+16]=C,this.float32[D+17]=M,this.float32[D+18]=I,e}}]),i}(uo);Oo.prototype.bytesPerElement=76,Hr(Oo,"StructArrayLayout3i2f6i15ui1ul3f76");var Do=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.float32[1*e+0]=t,e}}]),i}(uo);Do.prototype.bytesPerElement=4,Hr(Do,"StructArrayLayout1f4");var Ao=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a,o)}},{key:"emplace",value:function(e,t,i,n,r,a,o,s){var l=7*e;return this.float32[l+0]=t,this.float32[l+1]=i,this.float32[l+2]=n,this.float32[l+3]=r,this.float32[l+4]=a,this.float32[l+5]=o,this.float32[l+6]=s,e}}]),i}(uo);Ao.prototype.bytesPerElement=28,Hr(Ao,"StructArrayLayout7f28");var Lo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n,r){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r)}},{key:"emplace",value:function(e,t,i,n,r,a){var o=5*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=r,this.float32[o+4]=a,e}}]),i}(uo);Lo.prototype.bytesPerElement=20,Hr(Lo,"StructArrayLayout5f20");var zo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,i,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}},{key:"emplace",value:function(e,t,i,n,r){var a=6*e;return this.uint32[3*e+0]=t,this.uint16[a+2]=i,this.uint16[a+3]=n,this.uint16[a+4]=r,e}}]),i}(uo);zo.prototype.bytesPerElement=12,Hr(zo,"StructArrayLayout1ul3ui12");var Ro=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var i=this.length;return this.resize(i+1),this.emplace(i,e,t)}},{key:"emplace",value:function(e,t,i){var n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=i,e}}]),i}(uo);Ro.prototype.bytesPerElement=4,Hr(Ro,"StructArrayLayout2ui4");var Fo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint16[1*e+0]=t,e}}]),i}(uo);Fo.prototype.bytesPerElement=2,Hr(Fo,"StructArrayLayout1ui2");var jo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var i=this.length;return this.resize(i+1),this.emplace(i,e,t)}},{key:"emplace",value:function(e,t,i){var n=2*e;return this.float32[n+0]=t,this.float32[n+1]=i,e}}]),i}(uo);jo.prototype.bytesPerElement=8,Hr(jo,"StructArrayLayout2f8");var Bo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"a_pos_30",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"a_pos_31",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"a_pos_32",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"a_pos_normal_30",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"a_pos_normal_31",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"a_pos_normal_32",get:function(){return this._structArray.int16[this._pos2+5]}}]),i}(lo);Bo.prototype.size=12;var Vo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new Bo(this,e)}}]),i}(bo);Hr(Vo,"FillExtrusionExtArray");var No=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"tileAnchorY",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"x1",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"y1",get:function(){return this._structArray.float32[this._pos4+4]}},{key:"x2",get:function(){return this._structArray.float32[this._pos4+5]}},{key:"y2",get:function(){return this._structArray.float32[this._pos4+6]}},{key:"padding",get:function(){return this._structArray.int16[this._pos2+14]}},{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+8]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+19]}}]),i}(lo);No.prototype.size=40;var Uo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new No(this,e)}}]),i}(Po);Hr(Uo,"CollisionBoxArray");var Go=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.float32[this._pos4+2]}},{key:"tileAnchorY",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"glyphStartIndex",get:function(){return this._structArray.uint16[this._pos2+8]}},{key:"numGlyphs",get:function(){return this._structArray.uint16[this._pos2+9]}},{key:"vertexStartIndex",get:function(){return this._structArray.uint32[this._pos4+5]}},{key:"lineStartIndex",get:function(){return this._structArray.uint32[this._pos4+6]}},{key:"lineLength",get:function(){return this._structArray.uint32[this._pos4+7]}},{key:"segment",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"lowerSize",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"upperSize",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"lineOffsetX",get:function(){return this._structArray.float32[this._pos4+10]}},{key:"lineOffsetY",get:function(){return this._structArray.float32[this._pos4+11]}},{key:"writingMode",get:function(){return this._structArray.uint8[this._pos1+48]}},{key:"placedOrientation",get:function(){return this._structArray.uint8[this._pos1+49]},set:function(e){this._structArray.uint8[this._pos1+49]=e}},{key:"hidden",get:function(){return this._structArray.uint8[this._pos1+50]},set:function(e){this._structArray.uint8[this._pos1+50]=e}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+13]},set:function(e){this._structArray.uint32[this._pos4+13]=e}},{key:"associatedIconIndex",get:function(){return this._structArray.int16[this._pos2+28]}},{key:"flipState",get:function(){return this._structArray.uint8[this._pos1+58]},set:function(e){this._structArray.uint8[this._pos1+58]=e}}]),i}(lo);Go.prototype.size=60;var Wo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new Go(this,e)}}]),i}(Io);Hr(Wo,"PlacedSymbolArray");var Ho=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.float32[this._pos4+2]}},{key:"tileAnchorY",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"rightJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+8]}},{key:"centerJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+9]}},{key:"leftJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+10]}},{key:"verticalPlacedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+11]}},{key:"placedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+12]}},{key:"verticalPlacedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+13]}},{key:"key",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"textBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+15]}},{key:"textBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"verticalTextBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"verticalTextBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"iconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+19]}},{key:"iconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+20]}},{key:"verticalIconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+21]}},{key:"verticalIconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+22]}},{key:"featureIndex",get:function(){return this._structArray.uint16[this._pos2+23]}},{key:"numHorizontalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+24]}},{key:"numVerticalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+25]}},{key:"numIconVertices",get:function(){return this._structArray.uint16[this._pos2+26]}},{key:"numVerticalIconVertices",get:function(){return this._structArray.uint16[this._pos2+27]}},{key:"useRuntimeCollisionCircles",get:function(){return this._structArray.uint16[this._pos2+28]}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+15]},set:function(e){this._structArray.uint32[this._pos4+15]=e}},{key:"textOffset0",get:function(){return this._structArray.float32[this._pos4+16]}},{key:"textOffset1",get:function(){return this._structArray.float32[this._pos4+17]}},{key:"collisionCircleDiameter",get:function(){return this._structArray.float32[this._pos4+18]}}]),i}(lo);Ho.prototype.size=76;var Zo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new Ho(this,e)}}]),i}(Oo);Hr(Zo,"SymbolInstanceArray");var qo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getoffsetX",value:function(e){return this.float32[1*e+0]}}]),i}(Do);Hr(qo,"GlyphOffsetArray");var Xo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getx",value:function(e){return this.int16[3*e+0]}},{key:"gety",value:function(e){return this.int16[3*e+1]}},{key:"gettileUnitDistanceFromAnchor",value:function(e){return this.int16[3*e+2]}}]),i}(fo);Hr(Xo,"SymbolLineVertexArray");var Ko=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+0]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+2]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+3]}},{key:"layoutVertexArrayOffset",get:function(){return this._structArray.uint16[this._pos2+4]}}]),i}(lo);Ko.prototype.size=12;var Yo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new Ko(this,e)}}]),i}(zo);Hr(Yo,"FeatureIndexArray");var $o=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"a_centroid_pos0",get:function(){return this._structArray.uint16[this._pos2+0]}},{key:"a_centroid_pos1",get:function(){return this._structArray.uint16[this._pos2+1]}}]),i}(lo);$o.prototype.size=4;var Jo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new $o(this,e)}}]),i}(Ro);Hr(Jo,"FillExtrusionCentroidArray");var Qo=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"a_pos_30",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"a_pos_31",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"a_pos_32",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"a_pos_normal_30",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"a_pos_normal_31",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"a_pos_normal_32",get:function(){return this._structArray.int16[this._pos2+5]}}]),i}(lo);Qo.prototype.size=12;var es=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"get",value:function(e){return new Qo(this,e)}}]),i}(bo);Hr(es,"CircleGlobeExtArray");var ts=co([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),is=co([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]),ns=Ct((function(e){e.exports=function(e,t){var i,n,r,a,o,s,l,u;for(n=e.length-(i=3&e.length),r=t,o=3432918353,s=461845907,u=0;u<n;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}})),rs=Ct((function(e){e.exports=function(e,t){for(var i,n=e.length,r=t^n,a=0;n>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:r^=(255&e.charCodeAt(a+2))<<16;case 2:r^=(255&e.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}})),as=ns,os=rs;as.murmur3=ns,as.murmur2=os;var ss=function(){function e(){v(this,e),this.ids=[],this.positions=[],this.indexed=!1}return y(e,[{key:"add",value:function(e,t,i,n){this.ids.push(ls(e)),this.positions.push(t,i,n)}},{key:"getPositions",value:function(e){for(var t=ls(e),i=0,n=this.ids.length-1;i<n;){var r=i+n>>1;this.ids[r]>=t?n=r:i=r+1}for(var a=[];this.ids[i]===t;)a.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return a}}],[{key:"serialize",value:function(e,t){var i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return us(i,n,0,i.length-1),t&&t.push(i.buffer,n.buffer),{ids:i,positions:n}}},{key:"deserialize",value:function(t){var i=new e;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}]),e}();function ls(e){var t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:as(String(e))}function us(e,t,i,n){for(;i<n;){for(var r=e[i+n>>1],a=i-1,o=n+1;;){do{a++}while(e[a]<r);do{o--}while(e[o]>r);if(a>=o)break;cs(e,a,o),cs(t,3*a,3*o),cs(t,3*a+1,3*o+1),cs(t,3*a+2,3*o+2)}o-i<n-o?(us(e,t,i,o),i=o+1):(us(e,t,o+1,n),n=o)}}function cs(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}Hr(ss,"FeaturePositionMap");var hs=y((function e(t,i){v(this,e),this.gl=t.gl,this.location=i})),ps=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=0,r}return y(i,[{key:"set",value:function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}]),i}(hs),ds=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=[0,0,0,0],r}return y(i,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}]),i}(hs),fs=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=Ot.transparent,r}return y(i,[{key:"set",value:function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}]),i}(hs),ms=new Float32Array(16),vs=new Float32Array(9),ys=new Float32Array(4);function gs(e){return[oo(255*e.r,255*e.g),oo(255*e.b,255*e.a)]}var _s=function(){function e(t,i,n){v(this,e),this.value=t,this.uniformNames=i.map((function(e){return"u_".concat(e)})),this.type=n}return y(e,[{key:"setUniform",value:function(e,t,i){e.set(i.constantOr(this.value))}},{key:"getBinding",value:function(e,t,i){return"color"===this.type?new fs(e,t):new ps(e,t)}}]),e}(),bs=function(){function e(t,i){v(this,e),this.uniformNames=i.map((function(e){return"u_".concat(e)})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}return y(e,[{key:"setConstantPatternPositions",value:function(e,t){this.pixelRatioFrom=t.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=t.tl.concat(t.br),this.patternTo=e.tl.concat(e.br)}},{key:"setUniform",value:function(e,t,i,n){var r="u_pattern_to"===n||"u_dash_to"===n?this.patternTo:"u_pattern_from"===n||"u_dash_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;r&&e.set(r)}},{key:"getBinding",value:function(e,t,i){return"u_pattern_from"===i||"u_pattern_to"===i||"u_dash_from"===i||"u_dash_to"===i?new ds(e,t):new ps(e,t)}}]),e}(),xs=function(){function e(t,i,n,r){v(this,e),this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=i.map((function(e){return{name:"a_".concat(e),type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new r}return y(e,[{key:"populatePaintArray",value:function(e,t,i,n,r,a){var o=this.paintVertexArray.length,s=this.expression.evaluate(new Ha(0),t,{},r,n,a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}},{key:"updatePaintArray",value:function(e,t,i,n,r){var a=this.expression.evaluate({zoom:0},i,n,void 0,r);this._setPaintValue(e,t,a)}},{key:"_setPaintValue",value:function(e,t,i){if("color"===this.type)for(var n=gs(i),r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1]);else{for(var a=e;a<t;a++)this.paintVertexArray.emplace(a,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}]),e}(),ws=function(){function e(t,i,n,r,a,o){v(this,e),this.expression=t,this.uniformNames=i.map((function(e){return"u_".concat(e,"_t")})),this.type=n,this.useIntegerZoom=r,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=i.map((function(e){return{name:"a_".concat(e),type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o}return y(e,[{key:"populatePaintArray",value:function(e,t,i,n,r,a){var o=this.expression.evaluate(new Ha(this.zoom),t,{},r,n,a),s=this.expression.evaluate(new Ha(this.zoom+1),t,{},r,n,a),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,s)}},{key:"updatePaintArray",value:function(e,t,i,n,r){var a=this.expression.evaluate({zoom:this.zoom},i,n,void 0,r),o=this.expression.evaluate({zoom:this.zoom+1},i,n,void 0,r);this._setPaintValue(e,t,a,o)}},{key:"_setPaintValue",value:function(e,t,i,n){if("color"===this.type)for(var r=gs(i),a=gs(n),o=e;o<t;o++)this.paintVertexArray.emplace(o,r[0],r[1],a[0],a[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},{key:"setUniform",value:function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=C(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(n)}},{key:"getBinding",value:function(e,t,i){return new ps(e,t)}}]),e}(),ks=function(){function e(t,i,n,r,a,o,s){v(this,e),this.expression=t,this.type=n,this.useIntegerZoom=r,this.zoom=a,this.layerId=s,this.paintVertexAttributes=("array"===n?is:ts).members;for(var l=0;l<i.length;++l);this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}return y(e,[{key:"populatePaintArray",value:function(e,t,i){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],i)}},{key:"updatePaintArray",value:function(e,t,i,n,r,a){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],a)}},{key:"_setPaintValues",value:function(e,t,i,n){if(n&&i){var r=i.min,a=i.mid,o=i.max,s=n[r],l=n[a],u=n[o];if(s&&l&&u)for(var c=e;c<t;c++)this._setPaintValue(this.zoomInPaintVertexArray,c,l,s),this._setPaintValue(this.zoomOutPaintVertexArray,c,l,u)}}},{key:"_setPaintValue",value:function(e,t,i,n){e.emplace(t,i.tl[0],i.tl[1],i.br[0],i.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],i.pixelRatio,n.pixelRatio)}},{key:"upload",value:function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}]),e}(),Ps=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};v(this,e),this.binders={},this._buffers=[];var r=[];for(var a in t.paint._values)if(n(a)){var o=t.paint.get(a);if(o instanceof Ja&&zn(o.property.specification)){var s=Es(a,t.type),l=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,h=o.property.specification["property-type"],p="cross-faded"===h||"cross-faded-data-driven"===h,d="line-dasharray"===String(a)&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==l.kind||d)if("source"===l.kind||d||p){var f=Is(a,u,"source");this.binders[a]=p?new ks(l,s,u,c,i,f,t.id):new xs(l,s,u,f),r.push("/a_".concat(a))}else{var m=Is(a,u,"composite");this.binders[a]=new ws(l,s,u,c,i,m),r.push("/z_".concat(a))}else this.binders[a]=p?new bs(l.value,s):new _s(l.value,s,u),r.push("/u_".concat(a))}}this.cacheKey=r.sort().join("")}return y(e,[{key:"getMaxValue",value:function(e){var t=this.binders[e];return t instanceof xs||t instanceof ws?t.maxValue:0}},{key:"populatePaintArrays",value:function(e,t,i,n,r,a){for(var o in this.binders){var s=this.binders[o];(s instanceof xs||s instanceof ws||s instanceof ks)&&s.populatePaintArray(e,t,i,n,r,a)}}},{key:"setConstantPatternPositions",value:function(e,t){for(var i in this.binders){var n=this.binders[i];n instanceof bs&&n.setConstantPatternPositions(e,t)}}},{key:"updatePaintArrays",value:function(e,t,i,n,r,a){var o=!1;for(var s in e){var l,u=t.getPositions(s),c=p(u);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=i.feature(h.index);for(var f in this.binders){var m=this.binders[f];if((m instanceof xs||m instanceof ws||m instanceof ks)&&!0===m.expression.isStateDependent){var v=n.paint.get(f);m.expression=v.value,m.updatePaintArray(h.start,h.end,d,e[s],r,a),o=!0}}}}catch(y){c.e(y)}finally{c.f()}}return o}},{key:"defines",value:function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof _s||i instanceof bs)&&e.push.apply(e,c(i.uniformNames.map((function(e){return"#define HAS_UNIFORM_".concat(e)}))))}return e}},{key:"getBinderAttributes",value:function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof xs||i instanceof ws||i instanceof ks)for(var n=0;n<i.paintVertexAttributes.length;n++)e.push(i.paintVertexAttributes[n].name)}return e}},{key:"getBinderUniforms",value:function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof _s||i instanceof bs||i instanceof ws){var n,r=p(i.uniformNames);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.push(a)}}catch(o){r.e(o)}finally{r.f()}}}return e}},{key:"getPaintVertexBuffers",value:function(){return this._buffers}},{key:"getUniforms",value:function(e,t){var i=[];for(var n in this.binders){var r=this.binders[n];if(r instanceof _s||r instanceof bs||r instanceof ws){var a,o=p(r.uniformNames);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t[s]){var l=r.getBinding(e,t[s],s);i.push({name:s,property:n,binding:l})}}}catch(u){o.e(u)}finally{o.f()}}}return i}},{key:"setUniforms",value:function(e,t,i,n){var r,a=p(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.name,l=o.property,u=o.binding;this.binders[l].setUniform(u,n,i.get(l),s)}}catch(c){a.e(c)}finally{a.f()}}},{key:"updatePaintBuffers",value:function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof ks){var n=2===e.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(i instanceof xs||i instanceof ws)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}},{key:"upload",value:function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof xs||i instanceof ws||i instanceof ks)&&i.upload(e)}this.updatePaintBuffers()}},{key:"destroy",value:function(){for(var e in this.binders){var t=this.binders[e];(t instanceof xs||t instanceof ws||t instanceof ks)&&t.destroy()}}}]),e}(),Ss=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};v(this,e),this.programConfigurations={};var r,a=p(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;this.programConfigurations[o.id]=new Ps(o,i,n)}}catch(s){a.e(s)}finally{a.f()}this.needsUpload=!1,this._featureMap=new ss,this._bufferOffset=0}return y(e,[{key:"populatePaintArrays",value:function(e,t,i,n,r,a,o){for(var s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,n,r,a,o);void 0!==t.id&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}},{key:"updatePaintArrays",value:function(e,t,i,n,r){var a,o=p(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(e,this._featureMap,t,s,n,r)||this.needsUpload}}catch(l){o.e(l)}finally{o.f()}}},{key:"get",value:function(e){return this.programConfigurations[e]}},{key:"upload",value:function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}},{key:"destroy",value:function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()}}]),e}(),Ts={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Es(e,t){return Ts[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}var Cs={"line-pattern":{source:go,composite:go},"fill-pattern":{source:go,composite:go},"fill-extrusion-pattern":{source:go,composite:go},"line-dasharray":{source:_o,composite:_o}},Ms={color:{source:jo,composite:yo},number:{source:Do,composite:jo}};function Is(e,t,i){var n=Cs[e];return n&&n[i]||Ms[t][i]}Hr(_s,"ConstantBinder"),Hr(bs,"CrossFadedConstantBinder"),Hr(xs,"SourceExpressionBinder"),Hr(ks,"CrossFadedCompositeBinder"),Hr(ws,"CompositeExpressionBinder"),Hr(Ps,"ProgramConfiguration",{omit:["_buffers"]}),Hr(Ss,"ProgramConfigurationSet");var Os="-transition",Ds=function(e){f(i,e);var t=m(i);function i(e,n){var r;if(v(this,i),(r=t.call(this)).id=e.id,r.type=e.type,r._featureFilter={filter:function(){return!0},needGeometry:!1,needFeature:!1},r._filterCompiled=!1,"custom"!==e.type&&(r.metadata=e.metadata,r.minzoom=e.minzoom,r.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(r.source=e.source,r.sourceLayer=e["source-layer"],r.filter=e.filter),n.layout&&(r._unevaluatedLayout=new $a(n.layout)),n.paint)){for(var a in r._transitionablePaint=new Xa(n.paint),e.paint)r.setPaintProperty(a,e.paint[a],{validate:!1});for(var o in e.layout)r.setLayoutProperty(o,e.layout[o],{validate:!1});r._transitioningPaint=r._transitionablePaint.untransitioned(),r.paint=new Qa(n.paint)}return l(r)}return y(i,[{key:"getCrossfadeParameters",value:function(){return this._crossfadeParameters}},{key:"getLayoutProperty",value:function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}},{key:"setLayoutProperty",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(Br,"layers.".concat(this.id,".layout.").concat(e),e,t,i)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}},{key:"getPaintProperty",value:function(e){return V(e,Os)?this._transitionablePaint.getTransition(e.slice(0,-Os.length)):this._transitionablePaint.getValue(e)}},{key:"setPaintProperty",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(jr,"layers.".concat(this.id,".paint.").concat(e),e,t,i))return!1;if(V(e,Os))return this._transitionablePaint.setTransition(e.slice(0,-Os.length),t||void 0),!1;var n=this._transitionablePaint._values[e],r="cross-faded-data-driven"===n.property.specification["property-type"],a=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||a||r||this._handleOverridablePaintPropertyUpdate(e,o,s)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(e){}},{key:"getProgramIds",value:function(){return null}},{key:"getProgramConfiguration",value:function(e){return null}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,t,i){return!1}},{key:"isHidden",value:function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}},{key:"updateTransitions",value:function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}},{key:"hasTransition",value:function(){return this._transitioningPaint.hasTransition()}},{key:"recalculate",value:function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}},{key:"serialize",value:function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),U(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))}},{key:"_validate",value:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&Nr(this,e.call(Fr,{key:t,layerType:this.type,objectKey:i,value:n,styleSpec:rt,style:{glyphs:!0,sprite:!0}}))}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!1}},{key:"isTileClipped",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return!1}},{key:"resize",value:function(){}},{key:"isStateDependent",value:function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof Ja&&zn(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}},{key:"compileFilter",value:function(){this._filterCompiled||(this._featureFilter=cr(this.filter),this._filterCompiled=!0)}},{key:"invalidateCompiledFilter",value:function(){this._filterCompiled=!1}},{key:"dynamicFilter",value:function(){return this._featureFilter.dynamicFilter}},{key:"dynamicFilterNeedsFeature",value:function(){return this._featureFilter.needFeature}}]),i}(nt),As=co([{name:"a_pos",components:2,type:"Int16"}],4),Ls=co([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),zs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];v(this,e),this.segments=t}return y(e,[{key:"prepareSegment",value:function(t,i,n,r){var a=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&H("Max vertices per segment is ".concat(e.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!a||a.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==r)&&(a={vertexOffset:i.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(a.sortKey=r),this.segments.push(a)),a}},{key:"get",value:function(){return this.segments}},{key:"destroy",value:function(){var e,t=p(this.segments);try{for(t.s();!(e=t.n()).done;){var i=e.value;for(var n in i.vaos)i.vaos[n].destroy()}}catch(r){t.e(r)}finally{t.f()}}}],[{key:"simpleSegment",value:function(t,i,n,r){return new e([{vertexOffset:t,primitiveOffset:i,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}]),e}();zs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hr(zs,"SegmentVector");var Rs=8192,Fs=function(){function e(t,i){v(this,e),t&&(i?this.setSouthWest(t).setNorthEast(i):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}return y(e,[{key:"setNorthEast",value:function(e){return this._ne=e instanceof Bs?new Bs(e.lng,e.lat):Bs.convert(e),this}},{key:"setSouthWest",value:function(e){return this._sw=e instanceof Bs?new Bs(e.lng,e.lat):Bs.convert(e),this}},{key:"extend",value:function(t){var i,n,r=this._sw,a=this._ne;if(t instanceof Bs)i=t,n=t;else{if(!(t instanceof e))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(e.convert(t)):this.extend(Bs.convert(t)):this;if(i=t._sw,n=t._ne,!i||!n)return this}return r||a?(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),a.lng=Math.max(n.lng,a.lng),a.lat=Math.max(n.lat,a.lat)):(this._sw=new Bs(i.lng,i.lat),this._ne=new Bs(n.lng,n.lat)),this}},{key:"getCenter",value:function(){return new Bs((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}},{key:"getSouthWest",value:function(){return this._sw}},{key:"getNorthEast",value:function(){return this._ne}},{key:"getNorthWest",value:function(){return new Bs(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Bs(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this._sw.lng}},{key:"getSouth",value:function(){return this._sw.lat}},{key:"getEast",value:function(){return this._ne.lng}},{key:"getNorth",value:function(){return this._ne.lat}},{key:"toArray",value:function(){return[this._sw.toArray(),this._ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this._sw&&this._ne)}},{key:"contains",value:function(e){var t=Bs.convert(e),i=t.lng,n=t.lat,r=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}}],[{key:"convert",value:function(t){return!t||t instanceof e?t:new e(t)}}]),e}(),js=6371008.8,Bs=function(){function e(t,i){if(v(this,e),isNaN(t)||isNaN(i))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(i,")"));if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return y(e,[{key:"wrap",value:function(){return new e(I(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(e){var t=Math.PI/180,i=this.lat*t,n=e.lat*t,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return js*Math.acos(Math.min(r,1))}},{key:"toBounds",value:function(){var t=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Fs(new e(this.lng-i,this.lat-t),new e(this.lng+i,this.lat+t))}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),Vs=2*Math.PI*js;function Ns(e){return Vs*Math.cos(e*Math.PI/180)}function Us(e){return(180+e)/360}function Gs(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ws(e,t){return e/Ns(t)}function Hs(e){return 360*e-180}function Zs(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function qs(e,t){return e*Ns(Zs(t))}var Xs=85.051129,Ks=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;v(this,e),this.x=+t,this.y=+i,this.z=+n}return y(e,[{key:"toLngLat",value:function(){return new Bs(Hs(this.x),Zs(this.y))}},{key:"toAltitude",value:function(){return qs(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/Vs*(e=Zs(this.y),1/Math.cos(e*Math.PI/180));var e}}],[{key:"fromLngLat",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Bs.convert(t);return new e(Us(n.lng),Gs(n.lat),Ws(i,n.lat))}}]),e}();function Ys(e,t,i,n,r,a,o,s,l){var u=(t+n)/2,c=(i+r)/2,h=new g(u,c);s(h),function(e,t,i,n,r,a){var o=i-r,s=n-a;return Math.abs((n-t)*o-(i-e)*s)/Math.hypot(o,s)}(h.x,h.y,a.x,a.y,o.x,o.y)>=l?(Ys(e,t,i,u,c,a,h,s,l),Ys(e,u,c,n,r,h,o,s,l)):e.push(o)}function $s(e,t,i){var n=e[0],r=n.x,a=n.y;t(n);for(var o=[n],s=1;s<e.length;s++){var l=e[s],u=l.x,c=l.y;t(l),Ys(o,r,a,u,c,n,l,t,i),r=u,a=c,n=l}return o}function Js(e,t,i,n,r){if(r(t,i)){var a=t.add(i).mult(.5);n(a),Js(e,t,a,n,r),Js(e,a,i,n,r)}else e.push(i)}function Qs(e,t,i){var n=e[0];t(n);for(var r=[n],a=1;a<e.length;a++){var o=e[a];t(o),Js(r,n,o,t,i),n=o}return r}var el=Math.pow(2,14)-1,tl=-el-1;function il(e,t){var i=Math.round(e.x*t),n=Math.round(e.y*t);return e.x=C(i,tl,el),e.y=C(n,tl,el),(i<e.x||i>e.x+1||n<e.y||n>e.y+1)&&H("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function nl(e,t,i){var n=e.loadGeometry(),r=e.extent,a=Rs/r;if(t&&i&&i.projection.isReprojectedInTileSpace)for(var o=1<<t.z,s=i.scale,l=i.x,u=i.y,c=i.projection,h=function(e){var i=Hs((t.x+e.x/r)/o),n=Zs((t.y+e.y/r)/o),a=c.project(i,n);e.x=(a.x*s-l)*r,e.y=(a.y*s-u)*r},d=0;d<n.length;d++)if(1!==e.type)n[d]=$s(n[d],h,1);else{var f,m=[],v=p(n[d]);try{for(v.s();!(f=v.n()).done;){var y=f.value;y.x<0||y.x>=r||y.y<0||y.y>=r||(h(y),m.push(y))}}catch(k){v.e(k)}finally{v.f()}n[d]=m}var g,_=p(n);try{for(_.s();!(g=_.n()).done;){var b,x=g.value,w=p(x);try{for(w.s();!(b=w.n()).done;)il(b.value,a)}catch(k){w.e(k)}finally{w.f()}}}catch(k){_.e(k)}finally{_.f()}return n}function rl(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?nl(e):[]}}function al(e,t,i,n,r){e.emplaceBack(2*t+(n+1)/2,2*i+(r+1)/2)}function ol(e,t,i){var n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}var sl=function(){function e(t){v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new po,this.indexArray=new Mo,this.segments=new zs,this.programConfigurations=new Ss(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return y(e,[{key:"populate",value:function(e,t,i,n){var r=this.layers[0],a=[],o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));var s,l=p(e);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.feature,h=u.id,d=u.index,f=u.sourceLayerIndex,m=this.layers[0]._featureFilter.needGeometry,v=rl(c,m);if(this.layers[0]._featureFilter.filter(new Ha(this.zoom),v,i)){var y=o?o.evaluate(v,{},i):void 0,g={id:h,properties:c.properties,type:c.type,sourceLayerIndex:f,index:d,geometry:m?v.geometry:nl(c,i,n),patterns:{},sortKey:y};a.push(g)}}}catch(E){l.e(E)}finally{l.f()}o&&a.sort((function(e,t){return e.sortKey-t.sortKey}));var _=null;"globe"===n.projection.name&&(this.globeExtVertexArray=new es,_=n.projection);for(var b=0,x=a;b<x.length;b++){var w=x[b],k=w.geometry,P=w.index,S=w.sourceLayerIndex,T=e[P].feature;this.addFeature(w,k,P,t.availableImages,i,_),t.featureIndex.insert(T,k,P,S,this.index)}}},{key:"update",value:function(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,As.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Ls.members))),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}},{key:"addFeature",value:function(e,t,i,n,r,a){var o,s=p(t);try{for(s.s();!(o=s.n()).done;){var l,u=o.value,c=p(u);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=h.x,f=h.y;if(!(d<0||d>=Rs||f<0||f>=Rs)){if(a){var m=a.projectTilePoint(d,f,r),v=a.upVector(r,d,f),y=this.globeExtVertexArray;ol(y,m,v),ol(y,m,v),ol(y,m,v),ol(y,m,v)}var g=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),_=g.vertexLength;al(this.layoutVertexArray,d,f,-1,-1),al(this.layoutVertexArray,d,f,1,-1),al(this.layoutVertexArray,d,f,1,1),al(this.layoutVertexArray,d,f,-1,1),this.indexArray.emplaceBack(_,_+1,_+2),this.indexArray.emplaceBack(_,_+2,_+3),g.vertexLength+=4,g.primitiveLength+=2}}}catch(b){c.e(b)}finally{c.f()}}}catch(b){s.e(b)}finally{s.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n,r)}}]),e}();function ll(e,t){for(var i=0;i<e.length;i++)if(yl(t,e[i]))return!0;for(var n=0;n<t.length;n++)if(yl(e,t[n]))return!0;return!!pl(e,t)}function ul(e,t,i){return!!yl(e,t)||!!fl(t,e,i)}function cl(e,t){if(1===e.length)return vl(t,e[0]);for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r++)if(yl(e,n[r]))return!0;for(var a=0;a<e.length;a++)if(vl(t,e[a]))return!0;for(var o=0;o<t.length;o++)if(pl(e,t[o]))return!0;return!1}function hl(e,t,i){if(e.length>1){if(pl(e,t))return!0;for(var n=0;n<t.length;n++)if(fl(t[n],e,i))return!0}for(var r=0;r<e.length;r++)if(fl(e[r],t,i))return!0;return!1}function pl(e,t){if(0===e.length||0===t.length)return!1;for(var i=0;i<e.length-1;i++)for(var n=e[i],r=e[i+1],a=0;a<t.length-1;a++)if(dl(n,r,t[a],t[a+1]))return!0;return!1}function dl(e,t,i,n){return Z(e,i,n)!==Z(t,i,n)&&Z(e,t,i)!==Z(e,t,n)}function fl(e,t,i){var n=i*i;if(1===t.length)return e.distSqr(t[0])<n;for(var r=1;r<t.length;r++)if(ml(e,t[r-1],t[r])<n)return!0;return!1}function ml(e,t,i){var n=t.distSqr(i);if(0===n)return e.distSqr(t);var r=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/n;return e.distSqr(r<0?t:r>1?i:i.sub(t)._mult(r)._add(t))}function vl(e,t){for(var i,n,r,a=!1,o=0;o<e.length;o++)for(var s=0,l=(i=e[o]).length-1;s<i.length;l=s++)n=i[s],r=i[l],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(a=!a);return a}function yl(e,t){for(var i=!1,n=0,r=e.length-1;n<e.length;r=n++){var a=e[n],o=e[r];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(i=!i)}return i}function gl(e,t,i,n,r){var a,o=p(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t<=s.x&&i<=s.y&&n>=s.x&&r>=s.y)return!0}}catch(d){o.e(d)}finally{o.f()}var l=[new g(t,i),new g(t,r),new g(n,r),new g(n,i)];if(e.length>2){var u,c=p(l);try{for(c.s();!(u=c.n()).done;)if(yl(e,u.value))return!0}catch(d){c.e(d)}finally{c.f()}}for(var h=0;h<e.length-1;h++)if(_l(e[h],e[h+1],l))return!0;return!1}function _l(e,t,i){var n=i[0],r=i[2];if(e.x<n.x&&t.x<n.x||e.x>r.x&&t.x>r.x||e.y<n.y&&t.y<n.y||e.y>r.y&&t.y>r.y)return!1;var a=Z(e,t,i[0]);return a!==Z(e,t,i[1])||a!==Z(e,t,i[2])||a!==Z(e,t,i[3])}function bl(e,t,i){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:i.programConfigurations.get(t.id).getMaxValue(e)}function xl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function wl(e,t,i,n,r){if(!t[0]&&!t[1])return e;var a=g.convert(t)._mult(r);"viewport"===i&&a._rotate(-n);for(var o=[],s=0;s<e.length;s++)o.push(e[s].sub(a));return o}function kl(e,t,i,n){var r=g.convert(e)._mult(n);return"viewport"===t&&r._rotate(-i),r}Hr(sl,"CircleBucket",{omit:["layers"]});var Pl=new ao({"circle-sort-key":new to(rt.layout_circle["circle-sort-key"])}),Sl={paint:new ao({"circle-radius":new to(rt.paint_circle["circle-radius"]),"circle-color":new to(rt.paint_circle["circle-color"]),"circle-blur":new to(rt.paint_circle["circle-blur"]),"circle-opacity":new to(rt.paint_circle["circle-opacity"]),"circle-translate":new eo(rt.paint_circle["circle-translate"]),"circle-translate-anchor":new eo(rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new eo(rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new eo(rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new to(rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new to(rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new to(rt.paint_circle["circle-stroke-opacity"])}),layout:Pl},Tl=1e-6,El="undefined"!=typeof Float32Array?Float32Array:Array;function Cl(){var e=new El(9);return El!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ml(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Il(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],d=t[10],f=t[11],m=t[12],v=t[13],y=t[14],g=t[15],_=i[0],b=i[1],x=i[2],w=i[3];return e[0]=_*n+b*s+x*h+w*m,e[1]=_*r+b*l+x*p+w*v,e[2]=_*a+b*u+x*d+w*y,e[3]=_*o+b*c+x*f+w*g,e[4]=(_=i[4])*n+(b=i[5])*s+(x=i[6])*h+(w=i[7])*m,e[5]=_*r+b*l+x*p+w*v,e[6]=_*a+b*u+x*d+w*y,e[7]=_*o+b*c+x*f+w*g,e[8]=(_=i[8])*n+(b=i[9])*s+(x=i[10])*h+(w=i[11])*m,e[9]=_*r+b*l+x*p+w*v,e[10]=_*a+b*u+x*d+w*y,e[11]=_*o+b*c+x*f+w*g,e[12]=(_=i[12])*n+(b=i[13])*s+(x=i[14])*h+(w=i[15])*m,e[13]=_*r+b*l+x*p+w*v,e[14]=_*a+b*u+x*d+w*y,e[15]=_*o+b*c+x*f+w*g,e}function Ol(e,t,i){var n,r,a,o,s,l,u,c,h,p,d,f,m=i[0],v=i[1],y=i[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*y+t[12],e[13]=t[1]*m+t[5]*v+t[9]*y+t[13],e[14]=t[2]*m+t[6]*v+t[10]*y+t[14],e[15]=t[3]*m+t[7]*v+t[11]*y+t[15]):(r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],d=t[10],f=t[11],e[0]=n=t[0],e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=p,e[10]=d,e[11]=f,e[12]=n*m+s*v+h*y+t[12],e[13]=r*m+l*v+p*y+t[13],e[14]=a*m+u*v+d*y+t[14],e[15]=o*m+c*v+f*y+t[15]),e}function Dl(e,t,i){var n=i[0],r=i[1],a=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Al(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+u*n,e[5]=o*r+c*n,e[6]=s*r+h*n,e[7]=l*r+p*n,e[8]=u*r-a*n,e[9]=c*r-o*n,e[10]=h*r-s*n,e[11]=p*r-l*n,e}function Ll(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r-u*n,e[1]=o*r-c*n,e[2]=s*r-h*n,e[3]=l*r-p*n,e[8]=a*n+u*r,e[9]=o*n+c*r,e[10]=s*n+h*r,e[11]=l*n+p*r,e}function zl(e,t,i){var n,r,a,o=i[0],s=i[1],l=i[2],u=Math.hypot(o,s,l);return u<Tl?null:(o*=u=1/u,s*=u,l*=u,n=Math.sin(t),r=Math.cos(t),e[0]=o*o*(a=1-r)+r,e[1]=s*o*a+l*n,e[2]=l*o*a-s*n,e[3]=0,e[4]=o*s*a-l*n,e[5]=s*s*a+r,e[6]=l*s*a+o*n,e[7]=0,e[8]=o*l*a+s*n,e[9]=s*l*a-o*n,e[10]=l*l*a+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Rl=Il;function Fl(){var e=new El(3);return El!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function jl(e){var t=new El(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Bl(e){return Math.hypot(e[0],e[1],e[2])}function Vl(e,t,i){var n=new El(3);return n[0]=e,n[1]=t,n[2]=i,n}function Nl(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function Ul(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Gl(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Wl(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function Hl(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function Zl(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function ql(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e}function Xl(e,t){var i=t[0],n=t[1],r=t[2],a=i*i+n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function Kl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Yl(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[0],s=i[1],l=i[2];return e[0]=r*l-a*s,e[1]=a*o-n*l,e[2]=n*s-r*o,e}function $l(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[3]*n+i[7]*r+i[11]*a+i[15];return e[0]=(i[0]*n+i[4]*r+i[8]*a+i[12])/(o=o||1),e[1]=(i[1]*n+i[5]*r+i[9]*a+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*a+i[14])/o,e}function Jl(e,t,i){var n=i[0],r=i[1],a=i[2],o=t[0],s=t[1],l=t[2],u=r*l-a*s,c=a*o-n*l,h=n*s-r*o,p=r*h-a*c,d=a*u-n*h,f=n*c-r*u,m=2*i[3];return c*=m,h*=m,d*=2,f*=2,e[0]=o+(u*=m)+(p*=2),e[1]=s+c+d,e[2]=l+h+f,e}var Ql,eu=Ul,tu=Gl,iu=Bl;function nu(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function ru(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*a+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*a+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*a+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*a+i[15]*o,e}function au(){var e=new El(4);return El!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ou(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function su(e,t,i){i*=.5;var n=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=n*l+o*s,e[1]=r*l+a*s,e[2]=a*l-r*s,e[3]=o*l-n*s,e}function lu(e,t,i){i*=.5;var n=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=n*l-a*s,e[1]=r*l+o*s,e[2]=a*l+n*s,e[3]=o*l-r*s,e}Fl(),Ql=new El(4),El!=Float32Array&&(Ql[0]=0,Ql[1]=0,Ql[2]=0,Ql[3]=0),Fl(),Vl(1,0,0),Vl(0,1,0),au(),au(),Cl();var uu=function(){function e(t,i){v(this,e),this.pos=t,this.dir=i}return y(e,[{key:"intersectsPlane",value:function(e,t,i){var n=Kl(t,this.dir);if(Math.abs(n)<1e-6)return!1;var r=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/n;return i[0]=this.pos[0]+this.dir[0]*r,i[1]=this.pos[1]+this.dir[1]*r,i[2]=this.pos[2]+this.dir[2]*r,!0}},{key:"closestPointOnSphere",value:function(e,t,i){if(function(e,t){var i=e[0],n=e[1],r=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(i-a)<=Tl*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-o)<=Tl*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=Tl*Math.max(1,Math.abs(r),Math.abs(s))}(this.pos,e)||0===t)return i[0]=i[1]=i[2]=0,!1;var n=h(this.dir,3),r=n[0],a=n[1],o=n[2],s=this.pos[0]-e[0],l=this.pos[1]-e[1],u=this.pos[2]-e[2],c=r*r+a*a+o*o,p=2*(s*r+l*a+u*o),d=p*p-4*c*(s*s+l*l+u*u-t*t);if(d<0){var f=Math.max(-p/2,0),m=s+r*f,v=l+a*f,y=u+o*f,g=Math.hypot(m,v,y);return i[0]=m*t/g,i[1]=v*t/g,i[2]=y*t/g,!1}var _=(-p-Math.sqrt(d))/(2*c);if(_<0){var b=Math.hypot(s,l,u);return i[0]=s*t/b,i[1]=l*t/b,i[2]=u*t/b,!1}return i[0]=s+r*_,i[1]=l+a*_,i[2]=u+o*_,!0}}]),e}(),cu=function(){function e(t,i,n,r,a){v(this,e),this.TL=t,this.TR=i,this.BR=n,this.BL=r,this.horizon=a}return y(e,null,[{key:"fromInvProjectionMatrix",value:function(t,i,n){var r=[-1,1,1],a=[1,1,1],o=[1,-1,1],s=[-1,-1,1];return new e($l(r,r,t),$l(a,a,t),$l(o,o,t),$l(s,s,t),i/n)}}]),e}(),hu=function(){function e(t,i){v(this,e),this.points=t,this.planes=i}return y(e,null,[{key:"fromInvProjectionMatrix",value:function(t,i,n,r){var a=Math.pow(2,n),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(e){var n=ru([],e,t),o=1/n[3]/i*a;return function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}(n,n,[o,o,r?1/n[3]:o,o])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var t=Xl([],Yl([],eu([],o[e[0]],o[e[1]]),eu([],o[e[2]],o[e[1]]))),i=-Kl(t,o[e[1]]);return t.concat(i)}));return new e(o,s)}}]),e}(),pu=function(){function e(t,i){v(this,e),this.min=t,this.max=i,this.center=Zl([],Nl([],this.min,this.max),.5)}return y(e,[{key:"quadrant",value:function(t){for(var i=[t%2==0,t<2],n=jl(this.min),r=jl(this.max),a=0;a<i.length;a++)n[a]=i[a]?this.min[a]:this.center[a],r[a]=i[a]?this.center[a]:this.max[a];return r[2]=this.max[2],new e(n,r)}},{key:"distanceX",value:function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}},{key:"distanceY",value:function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}},{key:"distanceZ",value:function(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}},{key:"getCorners",value:function(){var e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}},{key:"intersects",value:function(e){for(var t=this.getCorners(),i=!0,n=0;n<e.planes.length;n++){for(var r=e.planes[n],a=0,o=0;o<t.length;o++)a+=Kl(r,t[o])+r[3]>=0;if(0===a)return 0;a!==t.length&&(i=!1)}if(i)return 2;for(var s=0;s<3;s++){for(var l=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=0;c<e.points.length;c++){var h=e.points[c][s]-this.min[s];l=Math.min(l,h),u=Math.max(u,h)}if(u<0||l>this.max[s]-this.min[s])return 0}return 1}}]),e}();function du(e,t,i,n,r,a,o,s,l){if(a&&e.queryGeometry.isAboveHorizon)return!1;a&&(l*=e.pixelToTileUnitsFactor);var u,c=e.tileID.canonical,h=i.projection.upVectorScale(c,i.center.lat,i.worldSize).metersToTile,d=p(t);try{for(d.s();!(u=d.n()).done;){var f,m=u.value,v=p(m);try{var y=function(){var t=f.value,u=t.add(s),p=r&&i.elevation?i.elevation.exaggeration()*r.getElevationAt(u.x,u.y,!0):0,d=i.projection.projectTilePoint(u.x,u.y,c);if(p>0){var m=i.projection.upVector(c,u.x,u.y);d.x+=m[0]*h*p,d.y+=m[1]*h*p,d.z+=m[2]*h*p}var v=a?u:fu(d.x,d.y,d.z,n),y=a?e.tilespaceRays.map((function(e){return yu(e,p)})):e.queryGeometry.screenGeometry,g=ru([],[d.x,d.y,d.z,1],n);if(!o&&a?l*=g[3]/i.cameraToCenterDistance:o&&!a&&(l*=i.cameraToCenterDistance/g[3]),a){var _=Zs((t.y/Rs+c.y)/(1<<c.z));l/=i.projection.pixelsPerMeter(_,1)/Ws(1,_)}if(ul(y,v,l))return{v:!0}};for(v.s();!(f=v.n()).done;){var g=y();if("object"===typeof g)return g.v}}catch(_){v.e(_)}finally{v.f()}}}catch(_){d.e(_)}finally{d.f()}return!1}function fu(e,t,i,n){var r=ru([],[e,t,i,1],n);return new g(r[0]/r[3],r[1]/r[3])}var mu=Vl(0,0,0),vu=Vl(0,0,1);function yu(e,t){var i=Fl();return mu[2]=t,e.intersectsPlane(mu,vu,i),new g(i[0],i[1])}var gu=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i)}(sl);function _u(e,t,i,n){var r=t.width,a=t.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==r*a*i)throw new RangeError("mismatched image size")}else n=new Uint8Array(r*a*i);return e.width=r,e.height=a,e.data=n,e}function bu(e,t,i){var n=t.width,r=t.height;n===e.width&&r===e.height||(xu(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,r)},i),e.width=n,e.height=r,e.data=t.data)}function xu(e,t,i,n,r,a){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,l=0;l<r.height;l++)for(var u=((i.y+l)*e.width+i.x)*a,c=((n.y+l)*t.width+n.x)*a,h=0;h<r.width*a;h++)s[c+h]=o[u+h];return t}Hr(gu,"HeatmapBucket",{omit:["layers"]});var wu=function(){function e(t,i){v(this,e),_u(this,t,1,i)}return y(e,[{key:"resize",value:function(t){bu(this,new e(t),1)}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,i,n,r){xu(e,t,i,n,r,1)}}]),e}(),ku=function(){function e(t,i){v(this,e),_u(this,t,4,i)}return y(e,[{key:"resize",value:function(t){bu(this,new e(t),4)}},{key:"replace",value:function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,i,n,r){xu(e,t,i,n,r,4)}}]),e}();Hr(wu,"AlphaImage"),Hr(ku,"RGBAImage");var Pu={paint:new ao({"heatmap-radius":new to(rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new to(rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new eo(rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ro(rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new eo(rt.paint_heatmap["heatmap-opacity"])})};function Su(e){var t={},i=e.resolution||256,n=e.clips?e.clips.length:1,r=e.image||new ku({width:i,height:n}),a=function(i,n,a){t[e.evaluationKey]=a;var o=e.expression.evaluate(t);r.data[i+n+0]=Math.floor(255*o.r/o.a),r.data[i+n+1]=Math.floor(255*o.g/o.a),r.data[i+n+2]=Math.floor(255*o.b/o.a),r.data[i+n+3]=Math.floor(255*o.a)};if(e.clips)for(var o=0,s=0;o<n;++o,s+=4*i)for(var l=0,u=0;l<i;l++,u+=4){var c=l/(i-1),h=e.clips[o];a(s,u,h.start*(1-c)+h.end*c)}else for(var p=0,d=0;p<i;p++,d+=4)a(0,d,p/(i-1));return r}var Tu={paint:new ao({"hillshade-illumination-direction":new eo(rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new eo(rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new eo(rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new eo(rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new eo(rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new eo(rt.paint_hillshade["hillshade-accent-color"])})},Eu=co([{name:"a_pos",components:2,type:"Int16"}],4).members,Cu=Iu,Mu=Iu;function Iu(e,t,i){i=i||2;var n,r,a,o,s,l,u,c=t&&t.length,h=c?t[0]*i:e.length,p=Ou(e,0,h,i,!0),d=[];if(!p||p.next===p.prev)return d;if(c&&(p=function(e,t,i,n){var r,a,o,s=[];for(r=0,a=t.length;r<a;r++)(o=Ou(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(Uu(o));for(s.sort(ju),r=0;r<s.length;r++)i=Du(i=Bu(s[r],i),i.next);return i}(e,t,p,i)),e.length>80*i){n=a=e[0],r=o=e[1];for(var f=i;f<h;f+=i)(s=e[f])<n&&(n=s),(l=e[f+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-n,o-r))?1/u:0}return Au(p,d,i,n,r,u),d}function Ou(e,t,i,n,r){var a,o;if(r===tc(e,t,i,n)>0)for(a=t;a<i;a+=n)o=Ju(a,e[a],e[a+1],o);else for(a=i-n;a>=t;a-=n)o=Ju(a,e[a],e[a+1],o);return o&&Zu(o,o.next)&&(Qu(o),o=o.next),o}function Du(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!Zu(n,n.next)&&0!==Hu(n.prev,n,n.next))n=n.next;else{if(Qu(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function Au(e,t,i,n,r,a,o){if(e){!o&&a&&function(e,t,i,n){var r=e;do{null===r.z&&(r.z=Nu(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,a,o,s,l,u=1;do{for(i=e,e=null,a=null,o=0;i;){for(o++,n=i,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=n}a.nextZ=null,u*=2}while(o>1)}(r)}(e,n,r,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?zu(e,n,r,a):Lu(e))t.push(s.i/i),t.push(e.i/i),t.push(l.i/i),Qu(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Au(e=Ru(Du(e),t,i),t,i,n,r,a,2):2===o&&Fu(e,t,i,n,r,a):Au(Du(e),t,i,n,r,a,1);break}}}function Lu(e){var t=e.prev,i=e,n=e.next;if(Hu(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(Gu(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Hu(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function zu(e,t,i,n){var r=e.prev,a=e,o=e.next;if(Hu(r,a,o)>=0)return!1;for(var s=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,l=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,u=Nu(r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,t,i,n),c=Nu(s,l,t,i,n),h=e.prevZ,p=e.nextZ;h&&h.z>=u&&p&&p.z<=c;){if(h!==e.prev&&h!==e.next&&Gu(r.x,r.y,a.x,a.y,o.x,o.y,h.x,h.y)&&Hu(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==e.prev&&p!==e.next&&Gu(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Hu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=u;){if(h!==e.prev&&h!==e.next&&Gu(r.x,r.y,a.x,a.y,o.x,o.y,h.x,h.y)&&Hu(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=c;){if(p!==e.prev&&p!==e.next&&Gu(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Hu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Ru(e,t,i){var n=e;do{var r=n.prev,a=n.next.next;!Zu(r,a)&&qu(r,n,n.next,a)&&Yu(r,a)&&Yu(a,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(a.i/i),Qu(n),Qu(n.next),n=e=a),n=n.next}while(n!==e);return Du(n)}function Fu(e,t,i,n,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Wu(o,s)){var l=$u(o,s);return o=Du(o,o.next),l=Du(l,l.next),Au(o,t,i,n,r,a),void Au(l,t,i,n,r,a)}s=s.next}o=o.next}while(o!==e)}function ju(e,t){return e.x-t.x}function Bu(e,t){var i=function(e,t){var i,n=t,r=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===o)return i;var l,u=i,c=i.x,h=i.y,p=1/0;n=i;do{r>=n.x&&n.x>=c&&r!==n.x&&Gu(a<h?r:o,a,c,h,a<h?o:r,a,n.x,n.y)&&(l=Math.abs(a-n.y)/(r-n.x),Yu(n,e)&&(l<p||l===p&&(n.x>i.x||n.x===i.x&&Vu(i,n)))&&(i=n,p=l)),n=n.next}while(n!==u);return i}(e,t);if(!i)return t;var n=$u(i,e),r=Du(i,i.next);return Du(n,n.next),t===i?r:t}function Vu(e,t){return Hu(e.prev,e,t.prev)<0&&Hu(t.next,e,e.next)<0}function Nu(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Uu(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function Gu(e,t,i,n,r,a,o,s){return(r-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(i-o)*(t-s)>=0&&(i-o)*(a-s)-(r-o)*(n-s)>=0}function Wu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&qu(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(Yu(e,t)&&Yu(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(Hu(e.prev,e,t.prev)||Hu(e,t.prev,t))||Zu(e,t)&&Hu(e.prev,e,e.next)>0&&Hu(t.prev,t,t.next)>0)}function Hu(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Zu(e,t){return e.x===t.x&&e.y===t.y}function qu(e,t,i,n){var r=Ku(Hu(e,t,i)),a=Ku(Hu(e,t,n)),o=Ku(Hu(i,n,e)),s=Ku(Hu(i,n,t));return r!==a&&o!==s||!(0!==r||!Xu(e,i,t))||!(0!==a||!Xu(e,n,t))||!(0!==o||!Xu(i,e,n))||!(0!==s||!Xu(i,t,n))}function Xu(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Ku(e){return e>0?1:e<0?-1:0}function Yu(e,t){return Hu(e.prev,e,e.next)<0?Hu(e,t,e.next)>=0&&Hu(e,e.prev,t)>=0:Hu(e,t,e.prev)<0||Hu(e,e.next,t)<0}function $u(e,t){var i=new ec(e.i,e.x,e.y),n=new ec(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function Ju(e,t,i,n){var r=new ec(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Qu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ec(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function tc(e,t,i,n){for(var r=0,a=t,o=i-n;a<i;a+=n)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}function ic(e,t,i,n,r){nc(e,t,i||0,n||e.length-1,r||ac)}function nc(e,t,i,n,r){for(;n>i;){if(n-i>600){var a=n-i+1,o=t-i+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);nc(e,t,Math.max(i,Math.floor(t-o*l/a+u)),Math.min(n,Math.floor(t+(a-o)*l/a+u)),r)}var c=e[t],h=i,p=n;for(rc(e,i,t),r(e[n],c)>0&&rc(e,i,n);h<p;){for(rc(e,h,p),h++,p--;r(e[h],c)<0;)h++;for(;r(e[p],c)>0;)p--}0===r(e[i],c)?rc(e,i,p):rc(e,++p,n),p<=t&&(i=p+1),t<=p&&(n=p-1)}}function rc(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function ac(e,t){return e<t?-1:e>t?1:0}function oc(e,t){var i=e.length;if(i<=1)return[e];for(var n,r,a=[],o=0;o<i;o++){var s=q(e[o]);0!==s&&(e[o].area=Math.abs(s),void 0===r&&(r=s<0),r===s<0?(n&&a.push(n),n=[e[o]]):n.push(e[o]))}if(n&&a.push(n),t>1)for(var l=0;l<a.length;l++)a[l].length<=t||(ic(a[l],t,1,a[l].length-1,sc),a[l]=a[l].slice(0,t));return a}function sc(e,t){return t.area-e.area}function lc(e,t,i){var n,r=i.patternDependencies,a=!1,o=p(t);try{for(o.s();!(n=o.n()).done;){var s=n.value.paint.get("".concat(e,"-pattern"));s.isConstant()||(a=!0);var l=s.constantOr(null);l&&(a=!0,r[l.to]=!0,r[l.from]=!0)}}catch(u){o.e(u)}finally{o.f()}return a}function uc(e,t,i,n,r){var a,o=r.patternDependencies,s=p(t);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=l.paint.get("".concat(e,"-pattern")).value;if("constant"!==u.kind){var c=u.evaluate({zoom:n-1},i,{},r.availableImages),h=u.evaluate({zoom:n},i,{},r.availableImages),d=u.evaluate({zoom:n+1},i,{},r.availableImages);c=c&&c.name?c.name:c,h=h&&h.name?h.name:h,d=d&&d.name?d.name:d,o[c]=!0,o[h]=!0,o[d]=!0,i.patterns[l.id]={min:c,mid:h,max:d}}}}catch(f){s.e(f)}finally{s.f()}return i}Iu.deviation=function(e,t,i,n){var r=t&&t.length,a=Math.abs(tc(e,0,r?t[0]*i:e.length,i));if(r)for(var o=0,s=t.length;o<s;o++)a-=Math.abs(tc(e,t[o]*i,o<s-1?t[o+1]*i:e.length,i));var l=0;for(o=0;o<n.length;o+=3){var u=n[o]*i,c=n[o+1]*i,h=n[o+2]*i;l+=Math.abs((e[u]-e[h])*(e[c+1]-e[u+1])-(e[u]-e[c])*(e[h+1]-e[u+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},Iu.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var o=0;o<t;o++)i.vertices.push(e[r][a][o]);r>0&&i.holes.push(n+=e[r-1].length)}return i},Cu.default=Mu;var cc=function(){function e(t){v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new po,this.indexArray=new Mo,this.indexArray2=new Ro,this.programConfigurations=new Ss(t.layers,t.zoom),this.segments=new zs,this.segments2=new zs,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.projection=t.projection}return y(e,[{key:"populate",value:function(e,t,i,n){this.hasPattern=lc("fill",this.layers,t);var r,a=this.layers[0].layout.get("fill-sort-key"),o=[],s=p(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,d=l.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,m=rl(u,f);if(this.layers[0]._featureFilter.filter(new Ha(this.zoom),m,i)){var v=a?a.evaluate(m,{},i,t.availableImages):void 0,y={id:c,properties:u.properties,type:u.type,sourceLayerIndex:d,index:h,geometry:f?m.geometry:nl(u,i,n),patterns:{},sortKey:v};o.push(y)}}}catch(S){s.e(S)}finally{s.f()}a&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,_=o;g<_.length;g++){var b=_[g],x=b.geometry,w=b.index,k=b.sourceLayerIndex;if(this.hasPattern){var P=uc("fill",this.layers,b,this.zoom,t);this.patternFeatures.push(P)}else this.addFeature(b,x,w,i,{},t.availableImages);t.featureIndex.insert(e[w].feature,x,w,k,this.index)}}},{key:"update",value:function(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}},{key:"addFeatures",value:function(e,t,i,n,r){var a,o=p(this.patternFeatures);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.addFeature(s,s.geometry,s.index,t,i,n)}}catch(l){o.e(l)}finally{o.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Eu),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}},{key:"addFeature",value:function(e,t,i,n,r){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=p(oc(t,500));try{for(s.s();!(a=s.n()).done;){var l,u=a.value,c=0,h=p(u);try{for(h.s();!(l=h.n()).done;)c+=l.value.length}catch(S){h.e(S)}finally{h.f()}var d,f=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray),m=f.vertexLength,v=[],y=[],g=p(u);try{for(g.s();!(d=g.n()).done;){var _=d.value;if(0!==_.length){_!==u[0]&&y.push(v.length/2);var b=this.segments2.prepareSegment(_.length,this.layoutVertexArray,this.indexArray2),x=b.vertexLength;this.layoutVertexArray.emplaceBack(_[0].x,_[0].y),this.indexArray2.emplaceBack(x+_.length-1,x),v.push(_[0].x),v.push(_[0].y);for(var w=1;w<_.length;w++)this.layoutVertexArray.emplaceBack(_[w].x,_[w].y),this.indexArray2.emplaceBack(x+w-1,x+w),v.push(_[w].x),v.push(_[w].y);b.vertexLength+=_.length,b.primitiveLength+=_.length}}}catch(S){g.e(S)}finally{g.f()}for(var k=Cu(v,y),P=0;P<k.length;P+=3)this.indexArray.emplaceBack(m+k[P],m+k[P+1],m+k[P+2]);f.vertexLength+=c,f.primitiveLength+=k.length/3}}catch(S){s.e(S)}finally{s.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,o,n)}}]),e}();Hr(cc,"FillBucket",{omit:["layers","patternFeatures"]});var hc=new ao({"fill-sort-key":new to(rt.layout_fill["fill-sort-key"])}),pc={paint:new ao({"fill-antialias":new eo(rt.paint_fill["fill-antialias"]),"fill-opacity":new to(rt.paint_fill["fill-opacity"]),"fill-color":new to(rt.paint_fill["fill-color"]),"fill-outline-color":new to(rt.paint_fill["fill-outline-color"]),"fill-translate":new eo(rt.paint_fill["fill-translate"]),"fill-translate-anchor":new eo(rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new io(rt.paint_fill["fill-pattern"])}),layout:hc},dc=co([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fc=co([{name:"a_centroid_pos",components:2,type:"Uint16"}]),mc=co([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),vc=dc.members,yc=gc;function gc(e,t,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=r,e.readFields(_c,this,t)}function _c(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var n=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[n]=r}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}function bc(e){for(var t,i,n=0,r=0,a=e.length,o=a-1;r<a;o=r++)n+=((i=e[o]).x-(t=e[r]).x)*(t.y+i.y);return n}gc.types=["Unknown","Point","LineString","Polygon"],gc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,n=1,r=0,a=0,o=0,s=[];e.pos<i;){if(r<=0){var l=e.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)a+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new g(a,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},gc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,r=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();i=7&c,n=c>>3}if(n--,1===i||2===i)(r+=e.readSVarint())<o&&(o=r),r>s&&(s=r),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==i)throw new Error("unknown command "+i)}return[o,l,s,u]},gc.prototype.toGeoJSON=function(e,t,i){var n,r,a=this.extent*Math.pow(2,i),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=gc.types[this.type];function c(e){for(var t=0;t<e.length;t++){var i=e[t];e[t]=[360*(i.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];c(l=h);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var i,n,r=[],a=0;a<t;a++){var o=bc(e[a]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(i&&r.push(i),i=[e[a]]):i.push(e[a]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)c(l[n][r])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var xc=wc;function wc(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(kc,this,t),this.length=this._features.length}function kc(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(i))}function Pc(e,t,i){if(3===e){var n=new xc(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}wc.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new yc(this._pbf,t,this.extent,this._keys,this._values)};var Sc={VectorTile:function(e,t){this.layers=e.readFields(Pc,{},t)},VectorTileFeature:yc,VectorTileLayer:xc};function Tc(e,t,i,n){var r,a=[],o=0===n?function(e,t,i,n,r,a){e.push(new g(a,i+(a-t)/(n-t)*(r-i)))}:function(e,t,i,n,r,a){e.push(new g(t+(a-i)/(r-i)*(n-t),a))},s=p(e);try{for(s.s();!(r=s.n()).done;){var l,u=r.value,c=[],h=p(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;if(!(d.length<=2)){for(var f=[],m=0;m<d.length-1;m++){var v=d[m].x,y=d[m].y,_=d[m+1].x,b=d[m+1].y,x=0===n?v:y,w=0===n?_:b;x<t?w>t&&o(f,v,y,_,b,t):x>i?w<i&&o(f,v,y,_,b,i):f.push(d[m]),w<t&&x>=t&&o(f,v,y,_,b,t),w>i&&x<=i&&o(f,v,y,_,b,i)}var k=d[d.length-1],P=0===n?k.x:k.y;P>=t&&P<=i&&f.push(k),f.length&&(k=f[f.length-1],f[0].x===k.x&&f[0].y===k.y||f.push(f[0]),c.push(f))}}}catch(S){h.e(S)}finally{h.f()}c.length&&a.push(c)}}catch(S){s.e(S)}finally{s.f()}return a}var Ec=Sc.VectorTileFeature.types,Cc=Math.pow(2,13);function Mc(e,t,i,n,r,a,o,s){e.emplaceBack((t<<1)+o,(i<<1)+a,(Math.floor(n*Cc)<<1)+r,Math.round(s))}function Ic(e,t,i){var n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}var Oc=function(){function e(){v(this,e),this.acc=new g(0,0),this.polyCount=[]}return y(e,[{key:"startRing",value:function(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new g(e.x,e.y),this.max=new g(e.x,e.y))}},{key:"append",value:function(e,t){this.currentPolyCount.edges++,this.acc._add(e);var i=this.min,n=this.max;e.x<i.x?i.x=e.x:e.x>n.x&&(n.x=e.x),e.y<i.y?i.y=e.y:e.y>n.y&&(n.y=e.y),((0===e.x||e.x===Rs)&&e.x===t.x)!=((0===e.y||e.y===Rs)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,Oi(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Rs!=e.x>Rs&&this.addBorderIntersection(1,Oi(t.y,e.y,(Rs-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,Oi(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Rs!=e.y>Rs&&this.addBorderIntersection(3,Oi(t.x,e.x,(Rs-t.y)/(e.y-t.y)))}},{key:"addBorderIntersection",value:function(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);var i=this.borders[e];t<i[0]&&(i[0]=t),t>i[1]&&(i[1]=t)}},{key:"processBorderOverlap",value:function(e,t){if(e.x===t.x){if(e.y===t.y)return;var i=0===e.x?0:1;this.addBorderIntersection(i,t.y),this.addBorderIntersection(i,e.y)}else{var n=0===e.y?2:3;this.addBorderIntersection(n,t.x),this.addBorderIntersection(n,e.x)}}},{key:"centroid",value:function(){var e=this.polyCount.reduce((function(e,t){return e+t.edges}),0);return 0!==e?this.acc.div(e)._round():new g(0,0)}},{key:"span",value:function(){return new g(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"intersectsCount",value:function(){return this.borders.reduce((function(e,t){return e+ +(t[0]!==Number.MAX_VALUE)}),0)}}]),e}(),Dc=function(){function e(t){v(this,e),this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new mo,this.centroidVertexArray=new Jo,this.indexArray=new Mo,this.programConfigurations=new Ss(t.layers,t.zoom),this.segments=new zs,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.enableTerrain=t.enableTerrain}return y(e,[{key:"populate",value:function(e,t,i,n){this.features=[],this.hasPattern=lc("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){var t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/Rs/(1<<e.z)}(i);var r,a=p(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.feature,l=o.id,u=o.index,c=o.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d=rl(s,h);if(this.layers[0]._featureFilter.filter(new Ha(this.zoom),d,i)){var f={id:l,sourceLayerIndex:c,index:u,geometry:h?d.geometry:nl(s,i,n),properties:s.properties,type:s.type,patterns:{}},m=this.layoutVertexArray.length;this.hasPattern?this.features.push(uc("fill-extrusion",this.layers,f,this.zoom,t)):this.addFeature(f,f.geometry,u,i,{},t.availableImages,n),t.featureIndex.insert(s,f.geometry,u,c,this.index,m)}}}catch(v){a.e(v)}finally{a.f()}this.sortBorders()}},{key:"addFeatures",value:function(e,t,i,n,r){var a,o=p(this.features);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.geometry;this.addFeature(s,l,s.index,t,i,n,r)}}catch(u){o.e(u)}finally{o.f()}this.sortBorders()}},{key:"update",value:function(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,mc.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"uploadCentroid",value:function(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,fc.members,!0),this.needsCentroidUpdate=!1)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"addFeature",value:function(e,t,i,n,r,a,o){var s=[new g(0,0),new g(Rs,Rs)],l=o.projection,u="globe"===l.name,c=this.enableTerrain&&!u?new Oc:null;u&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vo);for(var h,d,f=oc(t,500),m=f.length-1;m>=0;m--){var v=f[m];(0===v.length||(h=v[0]).every((function(e){return e.x<=0}))||h.every((function(e){return e.x>=Rs}))||h.every((function(e){return e.y<=0}))||h.every((function(e){return e.y>=Rs})))&&f.splice(m,1)}if(u)d=zc(f,s,n);else{d=[];var y,_=p(f);try{for(_.s();!(y=_.n()).done;){var b=y.value;d.push({polygon:b,bounds:s})}}catch(te){_.e(te)}finally{_.f()}}var x,w=p(d);try{for(w.s();!(x=w.n()).done;){for(var k=x.value,P=k.polygon,S=0,T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),E=0;E<P.length;E++){var C=P[E];if(0!==C.length){S+=C.length;var M=0;c&&c.startRing(C[0]);for(var I=0;I<C.length;I++){var O=C[I];if(I>=1){var D=C[I-1];if(!Ac(O,D,k.bounds)){c&&c.append(O,D),T.vertexLength+4>zs.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var A=O.sub(D)._perp(),L=A.x/(Math.abs(A.x)+Math.abs(A.y)),z=A.y>0?1:0,R=D.dist(O);M+R>32768&&(M=0),Mc(this.layoutVertexArray,O.x,O.y,L,z,0,0,M),Mc(this.layoutVertexArray,O.x,O.y,L,z,0,1,M),M+=R,Mc(this.layoutVertexArray,D.x,D.y,L,z,0,0,M),Mc(this.layoutVertexArray,D.x,D.y,L,z,0,1,M);var F=T.vertexLength;if(this.indexArray.emplaceBack(F,F+2,F+1),this.indexArray.emplaceBack(F+1,F+2,F+3),T.vertexLength+=4,T.primitiveLength+=2,u){var j=this.layoutVertexExtArray,B=l.projectTilePoint(O.x,O.y,n),V=l.projectTilePoint(D.x,D.y,n),N=l.upVector(n,O.x,O.y),U=l.upVector(n,D.x,D.y);Ic(j,B,N),Ic(j,B,N),Ic(j,V,U),Ic(j,V,U)}}}}}}if(T.vertexLength+S>zs.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),"Polygon"===Ec[e.type]){for(var G=[],W=[],H=T.vertexLength,Z=0;Z<P.length;Z++){var q=P[Z];if(0!==q.length){q!==P[0]&&W.push(G.length/2);for(var X=0;X<q.length;X++){var K=q[X];Mc(this.layoutVertexArray,K.x,K.y,0,0,1,1,0),G.push(K.x),G.push(K.y),c&&c.currentPolyCount.top++,u&&Ic(this.layoutVertexExtArray,l.projectTilePoint(K.x,K.y,n),l.upVector(n,K.x,K.y))}}}for(var Y=Cu(G,W),$=0;$<Y.length;$+=3)this.indexArray.emplaceBack(H+Y[$],H+Y[$+2],H+Y[$+1]);T.primitiveLength+=Y.length/3,T.vertexLength+=S}}}catch(te){w.e(te)}finally{w.f()}if(c&&c.polyCount.length>0){if(c.borders){c.vertexArrayOffset=this.centroidVertexArray.length;for(var J=c.borders,Q=this.featuresOnBorder.push(c)-1,ee=0;ee<4;ee++)J[ee][0]!==Number.MAX_VALUE&&this.borders[ee].push(Q)}this.encodeCentroid(c.borders?void 0:c.centroid(),c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,a,n)}},{key:"sortBorders",value:function(){for(var e=this,t=function(t){e.borders[t].sort((function(i,n){return e.featuresOnBorder[i].borders[t][0]-e.featuresOnBorder[n].borders[t][0]}))},i=0;i<4;i++)t(i)}},{key:"encodeCentroid",value:function(e,t){var i,n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e)if(0!==e.y){var a=t.span()._mult(this.tileToMeter);i=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(a.x/10)),n=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(a.y/10))}else i=Math.ceil(7*(e.x+450)),n=0;else i=0,n=+r;var o,s=r?this.centroidVertexArray.length:t.vertexArrayOffset,l=p(t.polyCount);try{for(l.s();!(o=l.n()).done;){var u=o.value;r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*u.edges+u.top);for(var c=0;c<2*u.edges;c++)this.centroidVertexArray.emplace(s++,0,n),this.centroidVertexArray.emplace(s++,i,n);for(var h=0;h<u.top;h++)this.centroidVertexArray.emplace(s++,i,n)}}catch(d){l.e(d)}finally{l.f()}}}]),e}();function Ac(e,t,i){return e.x===t.x&&(e.x<i[0].x||e.x>i[1].x)||e.y===t.y&&(e.y<i[0].y||e.y>i[1].y)}function Lc(){var e=Math.PI/32,t=Math.tan(e),i=js;return i*Math.sqrt(1+2*t*t)-i}function zc(e,t,i){var n=1<<i.z,r=Hs(i.x/n),a=Hs((i.x+1)/n),o=Zs(i.y/n),s=Zs((i.y+1)/n);return function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0,o=[];if(!e.length||!i||!n)return o;for(var s=function(e,t){var i,n=p(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;o.push({polygon:r,bounds:t})}}catch(a){n.e(a)}finally{n.f()}},l=Math.ceil(Math.log2(i)),u=Math.ceil(Math.log2(n)),c=l-u,h=[],d=0;d<Math.abs(c);d++)h.push(c>0?0:1);for(var f=0;f<Math.min(l,u);f++)h.push(0),h.push(1);var m=e;if(m=Tc(m,t[0].y-r,t[1].y+r,1),!(m=Tc(m,t[0].x-r,t[1].x+r,0)).length)return o;var v=[];for(h.length?v.push({polygons:m,bounds:t,depth:0}):s(m,t);v.length;){var y=v.pop(),_=y.depth,b=h[_],x=y.bounds[0],w=y.bounds[1],k=0===b?x.x:x.y,P=0===b?w.x:w.y,S=a?a(b,k,P):.5*(k+P),T=Tc(y.polygons,k-r,S+r,b),E=Tc(y.polygons,S-r,P+r,b);if(T.length){var C=[x,new g(0===b?S:w.x,1===b?S:w.y)];h.length>_+1?v.push({polygons:T,bounds:C,depth:_+1}):s(T,C)}if(E.length){var M=[new g(0===b?S:x.x,1===b?S:x.y),w];h.length>_+1?v.push({polygons:E,bounds:M,depth:_+1}):s(E,M)}}return o}(e,t,Math.ceil((a-r)/11.25),Math.ceil((o-s)/11.25),1,(function(e,t,r){if(0===e)return.5*(t+r);var a=Zs((i.y+t/Rs)/n);return(Gs(.5*(Zs((i.y+r/Rs)/n)+a))*n-i.y)*Rs}))}Hr(Dc,"FillExtrusionBucket",{omit:["layers","features"]}),Hr(Oc,"PartMetadata");var Rc={paint:new ao({"fill-extrusion-opacity":new eo(rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new to(rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new eo(rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new eo(rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new io(rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new to(rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new to(rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new eo(rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Fc(e,t,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}var jc=function(){function e(t,i,n){v(this,e),this.z=t,this.x=i,this.y=n,this.key=Nc(0,t,t,i,n)}return y(e,[{key:"equals",value:function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}},{key:"url",value:function(e,t){var i=function(e,t,i){var n=Fc(256*e,256*(t=Math.pow(2,i)-t-1),i),r=Fc(256*(e+1),256*(t+1),i);return n[0]+","+n[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),n=function(e,t,i){for(var n,r="",a=e;a>0;a--)r+=(t&(n=1<<a-1)?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",i)}},{key:"toString",value:function(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}]),e}(),Bc=y((function e(t,i){v(this,e),this.wrap=t,this.canonical=i,this.key=Nc(t,i.z,i.z,i.x,i.y)})),Vc=function(){function e(t,i,n,r,a){v(this,e),this.overscaledZ=t,this.wrap=i,this.canonical=new jc(n,+r,+a),this.key=0===i&&t===n?this.canonical.key:Nc(i,t,n,r,a)}return y(e,[{key:"equals",value:function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}},{key:"scaledTo",value:function(t){var i=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}},{key:"calculateScaledKey",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return Nc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);var i=this.canonical.z-e;return Nc(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)}},{key:"isChildOf",value:function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}},{key:"children",value:function(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var i=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new e(i,this.wrap,i,n,r),new e(i,this.wrap,i,n+1,r),new e(i,this.wrap,i,n,r+1),new e(i,this.wrap,i,n+1,r+1)]}},{key:"isLessThan",value:function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}},{key:"wrapped",value:function(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"unwrapTo",value:function(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"overscaleFactor",value:function(){return Math.pow(2,this.overscaledZ-this.canonical.z)}},{key:"toUnwrapped",value:function(){return new Bc(this.wrap,this.canonical)}},{key:"toString",value:function(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}]),e}();function Nc(e,t,i,n,r){var a=1<<Math.min(i,22),o=a*(r%a)+n%a;return e&&i<22&&(o+=a*a*((e<0?-2*e-1:2*e)%(1<<2*(22-i)))),16*(32*o+i)+(t-i)}function Uc(e,t){return e.x*t.x+e.y*t.y}function Gc(e,t){if(1===e.length){for(var i,n=0,r=t[n++];!i||r.equals(i);)if(!(i=t[n++]))return 1/0;for(;n<t.length;n++){var a=t[n],o=e[0],s=i.sub(r),l=a.sub(r),u=o.sub(r),c=Uc(s,s),h=Uc(s,l),d=Uc(l,l),f=Uc(u,s),m=Uc(u,l),v=c*d-h*h,y=(d*f-h*m)/v,g=(c*m-h*f)/v,_=r.z*(1-y-g)+i.z*y+a.z*g;if(isFinite(_))return _}return 1/0}var b,x=1/0,w=p(t);try{for(w.s();!(b=w.n()).done;){var k=b.value;x=Math.min(x,k.z)}}catch(P){w.e(P)}finally{w.f()}return x}function Wc(e){var t=new g(e[0],e[1]);return t.z=e[2],t}function Hc(e,t,i,n,r,a,o,s){var l=o*r.getElevationAt(e,t,!0,!0),u=0!==a[0],c=u?0===a[1]?o*(a[0]/7-450):o*function(e,t,i){var n=Math.floor(t[0]/8),r=Math.floor(t[1]/8),a=10*(t[0]-8*n),o=10*(t[1]-8*r),s=e.getElevationAt(n,r,!0,!0),l=e.getMeterToDEM(i),u=Math.floor(.5*(a*l-1)),c=Math.floor(.5*(o*l-1)),h=e.tileCoordToPixel(n,r),p=2*u+1,d=2*c+1,f=function(e,t,i,n,r){return[e.getElevationAtPixel(t,i,!0),e.getElevationAtPixel(t+r,i,!0),e.getElevationAtPixel(t,i+r,!0),e.getElevationAtPixel(t+n,i+r,!0)]}(e,h.x-u,h.y-c,p,d),m=Math.abs(f[0]-f[1]),v=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),g=Math.min(.25,.5*l*(m+v)/p),_=Math.min(.25,.5*l*y/d);return s+Math.max(g*a,_*o)}(r,a,s):l;return{base:l+(0===i)?-1:i,top:u?Math.max(c+n,l+i+2):l+n}}Hr(jc,"CanonicalTileID"),Hr(Vc,"OverscaledTileID",{omit:["projMatrix"]});var Zc=co([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4).members,qc=co([{name:"a_packed",components:4,type:"Float32"}]).members,Xc=Sc.VectorTileFeature.types,Kc=Math.cos(Math.PI/180*37.5),Yc=function(){function e(t){var i=this;v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(e){i.gradients[e.id]={}})),this.layoutVertexArray=new vo,this.layoutVertexArray2=new yo,this.indexArray=new Mo,this.programConfigurations=new Ss(t.layers,t.zoom),this.segments=new zs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return y(e,[{key:"populate",value:function(e,t,i,n){this.hasPattern=lc("line",this.layers,t);var r,a=this.layers[0].layout.get("line-sort-key"),o=[],s=p(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,d=l.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,m=rl(u,f);if(this.layers[0]._featureFilter.filter(new Ha(this.zoom),m,i)){var v=a?a.evaluate(m,{},i):void 0,y={id:c,properties:u.properties,type:u.type,sourceLayerIndex:d,index:h,geometry:f?m.geometry:nl(u,i,n),patterns:{},sortKey:v};o.push(y)}}}catch(C){s.e(C)}finally{s.f()}a&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=t.lineAtlas,_=t.featureIndex,b=this.addConstantDashes(g),x=0,w=o;x<w.length;x++){var k=w[x],P=k.geometry,S=k.index,T=k.sourceLayerIndex;if(b&&this.addFeatureDashes(k,g),this.hasPattern){var E=uc("line",this.layers,k,this.zoom,t);this.patternFeatures.push(E)}else this.addFeature(k,P,S,i,g.positions,t.availableImages);_.insert(e[S].feature,P,S,T,this.index)}}},{key:"addConstantDashes",value:function(e){var t,i=!1,n=p(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.paint.get("line-dasharray").value,o=r.layout.get("line-cap").value;if("constant"!==a.kind||"constant"!==o.kind)i=!0;else{var s=o.value,l=a.value;if(!l)continue;e.addDash(l.from,s),e.addDash(l.to,s),l.other&&e.addDash(l.other,s)}}}catch(u){n.e(u)}finally{n.f()}return i}},{key:"addFeatureDashes",value:function(e,t){var i,n=this.zoom,r=p(this.layers);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.paint.get("line-dasharray").value,s=a.layout.get("line-cap").value;if("constant"!==o.kind||"constant"!==s.kind){var l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0;if("constant"===o.kind){var m=o.value;if(!m)continue;l=m.other||m.to,u=m.to,c=m.from}else l=o.evaluate({zoom:n-1},e),u=o.evaluate({zoom:n},e),c=o.evaluate({zoom:n+1},e);"constant"===s.kind?h=d=f=s.value:(h=s.evaluate({zoom:n-1},e),d=s.evaluate({zoom:n},e),f=s.evaluate({zoom:n+1},e)),t.addDash(l,h),t.addDash(u,d),t.addDash(c,f);var v=t.getKey(l,h),y=t.getKey(u,d),g=t.getKey(c,f);e.patterns[a.id]={min:v,mid:y,max:g}}}}catch(_){r.e(_)}finally{r.f()}}},{key:"update",value:function(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}},{key:"addFeatures",value:function(e,t,i,n,r){var a,o=p(this.patternFeatures);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.addFeature(s,s.geometry,s.index,t,i,n)}}catch(l){o.e(l)}finally{o.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,qc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"lineFeatureClips",value:function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}},{key:"addFeature",value:function(e,t,i,n,r,a){var o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),l=o.get("line-cap").evaluate(e,{}),u=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);var h,d=p(t);try{for(d.s();!(h=d.n()).done;){var f=h.value;this.addLine(f,e,s,l,u,c)}}catch(m){d.e(m)}finally{d.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,a,n)}},{key:"addLine",value:function(e,t,i,n,r,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var o=0;o<e.length-1;o++)this.totalDistance+=e[o].dist(e[o+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===Xc[t.type],l=e.length;l>=2&&e[l-1].equals(e[l-2]);)l--;for(var u=0;u<l-1&&e[u].equals(e[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===i&&(r=1.05);var c,h,p,d,f,m=this.overscaling<=16?122880/(512*this.overscaling):0,v=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,s&&(c=e[l-2],f=e[u].sub(c)._unit()._perp());for(var y=u;y<l;y++)if(!(p=y===l-1?s?e[u+1]:void 0:e[y+1])||!e[y].equals(p)){f&&(d=f),c&&(h=c),c=e[y],f=p?p.sub(c)._unit()._perp():d;var g=(d=d||f).add(f);0===g.x&&0===g.y||g._unit();var _=d.x*f.x+d.y*f.y,b=g.x*f.x+g.y*f.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),k=b<Kc&&h&&p,P=d.x*f.y-d.y*f.x>0;if(k&&y>u){var S=c.dist(h);if(S>2*m){var T=c.sub(c.sub(h)._mult(m/S)._round());this.updateDistance(h,T),this.addCurrentVertex(T,d,0,0,v),h=T}}var E=h&&p,C=E?i:s?"butt":n;if(E&&"round"===C&&(x<a?C="miter":x<=2&&(C="fakeround")),"miter"===C&&x>r&&(C="bevel"),"bevel"===C&&(x>2&&(C="flipbevel"),x<r&&(C="miter")),h&&this.updateDistance(h,c),"miter"===C)g._mult(x),this.addCurrentVertex(c,g,0,0,v);else if("flipbevel"===C){if(x>100)g=f.mult(-1);else{var M=x*d.add(f).mag()/d.sub(f).mag();g._perp()._mult(M*(P?-1:1))}this.addCurrentVertex(c,g,0,0,v),this.addCurrentVertex(c,g.mult(-1),0,0,v)}else if("bevel"===C||"fakeround"===C){var I=-Math.sqrt(x*x-1),O=P?I:0,D=P?0:I;if(h&&this.addCurrentVertex(c,d,O,D,v),"fakeround"===C)for(var A=Math.round(180*w/Math.PI/20),L=1;L<A;L++){var z=L/A;if(.5!==z){var R=z-.5;z+=z*R*(z-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*R*R+(.848013+_*(.215638*_-1.06021)))}var F=f.sub(d)._mult(z)._add(d)._unit()._mult(P?-1:1);this.addHalfVertex(c,F.x,F.y,!1,P,0,v)}p&&this.addCurrentVertex(c,f,-O,-D,v)}else if("butt"===C)this.addCurrentVertex(c,g,0,0,v);else if("square"===C){var j=h?1:-1;h||this.addCurrentVertex(c,g,j,j,v),this.addCurrentVertex(c,g,0,0,v),h&&this.addCurrentVertex(c,g,j,j,v)}else"round"===C&&(h&&(this.addCurrentVertex(c,d,0,0,v),this.addCurrentVertex(c,d,1,1,v,!0)),p&&(this.addCurrentVertex(c,f,-1,-1,v,!0),this.addCurrentVertex(c,f,0,0,v)));if(k&&y<l-1){var B=c.dist(p);if(B>2*m){var V=c.add(p.sub(c)._mult(m/B)._round());this.updateDistance(c,V),this.addCurrentVertex(V,f,0,0,v),c=V}}}}}},{key:"addCurrentVertex",value:function(e,t,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,a,!1,i,r),this.addHalfVertex(e,o,s,a,!0,-n,r)}},{key:"addHalfVertex",value:function(e,t,i,n,r,a,o){var s=e.x,l=e.y;this.layoutVertexArray.emplaceBack((s<<1)+(n?1:0),(l<<1)+(r?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);var u=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),o.primitiveLength++),r?this.e2=u:this.e1=u}},{key:"updateScaledDistance",value:function(){if(this.lineClips){var e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}},{key:"updateDistance",value:function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}]),e}();Hr(Yc,"LineBucket",{omit:["layers","patternFeatures"]});var $c=new ao({"line-cap":new to(rt.layout_line["line-cap"]),"line-join":new to(rt.layout_line["line-join"]),"line-miter-limit":new eo(rt.layout_line["line-miter-limit"]),"line-round-limit":new eo(rt.layout_line["line-round-limit"]),"line-sort-key":new to(rt.layout_line["line-sort-key"])}),Jc={paint:new ao({"line-opacity":new to(rt.paint_line["line-opacity"]),"line-color":new to(rt.paint_line["line-color"]),"line-translate":new eo(rt.paint_line["line-translate"]),"line-translate-anchor":new eo(rt.paint_line["line-translate-anchor"]),"line-width":new to(rt.paint_line["line-width"]),"line-gap-width":new to(rt.paint_line["line-gap-width"]),"line-offset":new to(rt.paint_line["line-offset"]),"line-blur":new to(rt.paint_line["line-blur"]),"line-dasharray":new io(rt.paint_line["line-dasharray"]),"line-pattern":new io(rt.paint_line["line-pattern"]),"line-gradient":new ro(rt.paint_line["line-gradient"]),"line-trim-offset":new eo(rt.paint_line["line-trim-offset"])}),layout:$c},Qc=new(function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"possiblyEvaluate",value:function(e,t){return t=new Ha(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),o(s(i.prototype),"possiblyEvaluate",this).call(this,e,t)}},{key:"evaluate",value:function(e,t,n,r){return t=A({},t,{zoom:Math.floor(t.zoom)}),o(s(i.prototype),"evaluate",this).call(this,e,t,n,r)}}]),i}(to))(Jc.paint.properties["line-width"].specification);function eh(e,t){return t>0?t+2*e:e}Qc.useIntegerZoom=!0;var th=co([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ih=co([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),nh=co([{name:"a_projected_pos",components:4,type:"Float32"}],4);co([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var rh=co([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ah=co([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);co([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var oh=co([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sh=co([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);co([{name:"triangle",components:3,type:"Uint16"}]),co([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),co([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),co([{type:"Float32",name:"offsetX"}]),co([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var lh=24,uh=128;function ch(e,t){var i=t.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new Ha(e+1))};if("source"===i.kind)return{kind:"source"};for(var n=i.zoomStops,r=i.interpolationType,a=0;a<n.length&&n[a]<=e;)a++;for(var o=a=Math.max(0,a-1);o<n.length&&n[o]<e+1;)o++;o=Math.min(n.length-1,o);var s=n[a],l=n[o];return"composite"===i.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:l,minSize:i.evaluate(new Ha(s)),maxSize:i.evaluate(new Ha(l)),interpolationType:r}}function hh(e,t,i){var n=t.uSize,r=t.uSizeT,a=i.lowerSize,o=i.upperSize;return"source"===e.kind?a/uh:"composite"===e.kind?Oi(a/uh,o/uh,r):n}function ph(e,t){var i=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){var r=e.interpolationType,a=e.minZoom,o=e.maxZoom,s=r?C(Ji.interpolationFactor(r,t,a,o),0,1):0;"camera"===e.kind?n=Oi(e.minSize,e.maxSize,s):i=s}return{uSizeT:i,uSize:n}}var dh=Object.freeze({__proto__:null,getSizeData:ch,evaluateSizeForFeature:hh,evaluateSizeForZoom:ph,SIZE_PACK_FACTOR:uh});function fh(e,t,i){return e.sections.forEach((function(e){e.text=function(e,t,i){var n=t.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Wa.applyArabicShaping&&(e=Wa.applyArabicShaping(e)),e}(e.text,t,i)})),e}var mh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function vh(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function yh(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var gh=function(e,t,i,n,r){var a,o,s=8*r-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?r-1:0,p=i?-1:1,d=e[t+h];for(h+=p,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=p,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+h],h+=p,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),a-=u}return(d?-1:1)*o*Math.pow(2,a-n)},_h=function(e,t,i,n,r,a){var o,s,l,u=8*a-r-1,c=(1<<u)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*l-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[i+d]=255&s,d+=f,s/=256,r-=8);for(o=o<<r|s,u+=r;u>0;e[i+d]=255&o,d+=f,o/=256,u-=8);e[i+d-f]|=128*m},bh=xh;function xh(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}xh.Varint=0,xh.Fixed64=1,xh.Bytes=2,xh.Fixed32=5;var wh=4294967296,kh=1/wh,Ph="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Sh(e){return e.type===xh.Bytes?e.readVarint()+e.pos:e.pos+1}function Th(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Eh(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=e;r--)i.buf[r+n]=i.buf[r]}function Ch(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Mh(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Ih(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Oh(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Dh(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Ah(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Lh(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function zh(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Rh(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Fh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function jh(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function Bh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Vh(e,t,i){t.glyphs=[],1===e&&i.readMessage(Nh,t)}function Nh(e,t,i){if(3===e){var n=i.readMessage(Uh,{}),r=n.id,a=n.bitmap,o=n.width,s=n.height,l=n.left,u=n.top,c=n.advance;t.glyphs.push({id:r,bitmap:new wu({width:o+6,height:s+6},a),metrics:{width:o,height:s,left:l,top:u,advance:c}})}else 4===e?t.ascender=i.readSVarint():5===e&&(t.descender=i.readSVarint())}function Uh(e,t,i){1===e?t.id=i.readVarint():2===e?t.bitmap=i.readBytes():3===e?t.width=i.readVarint():4===e?t.height=i.readVarint():5===e?t.left=i.readSVarint():6===e?t.top=i.readSVarint():7===e&&(t.advance=i.readVarint())}function Gh(e){var t,i=0,n=0,r=p(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;i+=a.w*a.h,n=Math.max(n,a.w)}}catch(v){r.e(v)}finally{r.f()}e.sort((function(e,t){return t.h-e.h}));var o,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),n),h:1/0}],l=0,u=0,c=p(e);try{for(c.s();!(o=c.n()).done;)for(var h=o.value,d=s.length-1;d>=0;d--){var f=s[d];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),l=Math.max(l,h.x+h.w),h.w===f.w&&h.h===f.h){var m=s.pop();d<s.length&&(s[d]=m)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):h.w===f.w?(f.y+=h.h,f.h-=h.h):(s.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}catch(v){c.e(v)}finally{c.f()}return{w:l,h:u,fill:i/(l*u)||0}}xh.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,a=this.pos;this.type=7&n,e(r,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Fh(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Bh(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Fh(this.buf,this.pos)+Fh(this.buf,this.pos+4)*wh;return this.pos+=8,e},readSFixed64:function(){var e=Fh(this.buf,this.pos)+Bh(this.buf,this.pos+4)*wh;return this.pos+=8,e},readFloat:function(){var e=gh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=gh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,n=this.buf;return t=127&(i=n[this.pos++]),i<128?t:(t|=(127&(i=n[this.pos++]))<<7,i<128?t:(t|=(127&(i=n[this.pos++]))<<14,i<128?t:(t|=(127&(i=n[this.pos++]))<<21,i<128?t:function(e,t,i){var n,r,a=i.buf;if(n=(112&(r=a[i.pos++]))>>4,r<128)return Th(e,n,t);if(n|=(127&(r=a[i.pos++]))<<3,r<128)return Th(e,n,t);if(n|=(127&(r=a[i.pos++]))<<10,r<128)return Th(e,n,t);if(n|=(127&(r=a[i.pos++]))<<17,r<128)return Th(e,n,t);if(n|=(127&(r=a[i.pos++]))<<24,r<128)return Th(e,n,t);if(n|=(1&(r=a[i.pos++]))<<31,r<128)return Th(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Ph?function(e,t,i){return Ph.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var n="",r=t;r<i;){var a,o,s,l=e[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>i)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[r+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(o=e[r+2],128==(192&(a=e[r+1]))&&128==(192&o)&&((u=(15&l)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[r+2],s=e[r+3],128==(192&(a=e[r+1]))&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),r+=c}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==xh.Bytes)return e.push(this.readVarint(t));var i=Sh(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==xh.Bytes)return e.push(this.readSVarint());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==xh.Bytes)return e.push(this.readBoolean());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==xh.Bytes)return e.push(this.readFloat());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==xh.Bytes)return e.push(this.readDouble());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==xh.Bytes)return e.push(this.readFixed32());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==xh.Bytes)return e.push(this.readSFixed32());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==xh.Bytes)return e.push(this.readFixed64());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==xh.Bytes)return e.push(this.readSFixed64());var t=Sh(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===xh.Varint)for(;this.buf[this.pos++]>127;);else if(t===xh.Bytes)this.pos=this.readVarint()+this.pos;else if(t===xh.Fixed32)this.pos+=4;else{if(t!==xh.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),jh(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),jh(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),jh(this.buf,-1&e,this.pos),jh(this.buf,Math.floor(e*kh),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),jh(this.buf,-1&e,this.pos),jh(this.buf,Math.floor(e*kh),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,i.buf[i.pos]=127&(e>>>=7)}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var n,r,a=0;a<t.length;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!r){n>56319||a+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):r=n;continue}if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(e[i++]=239,e[i++]=191,e[i++]=189,r=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=63&n|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&Eh(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),_h(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),_h(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&Eh(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,xh.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ch,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Mh,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Dh,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Ih,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Oh,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Ah,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Lh,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,zh,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Rh,t)},writeBytesField:function(e,t){this.writeTag(e,xh.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,xh.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,xh.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,xh.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,xh.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,xh.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,xh.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,xh.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,xh.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,xh.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Wh=function(){function e(t,i){var n=i.pixelRatio,r=i.version,a=i.stretchX,o=i.stretchY,s=i.content;v(this,e),this.paddedRect=t,this.pixelRatio=n,this.stretchX=a,this.stretchY=o,this.content=s,this.version=r}return y(e,[{key:"tl",get:function(){return[this.paddedRect.x+1,this.paddedRect.y+1]}},{key:"br",get:function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}},{key:"displaySize",get:function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}]),e}(),Hh=function(){function e(t,i){v(this,e);var n={},r={};this.haveRenderCallbacks=[];var a=[];this.addImages(t,n,a),this.addImages(i,r,a);var o=Gh(a),s=o.w,l=o.h,u=new ku({width:s||1,height:l||1});for(var c in t){var h=t[c],p=n[c].paddedRect;ku.copy(h.data,u,{x:0,y:0},{x:p.x+1,y:p.y+1},h.data)}for(var d in i){var f=i[d],m=r[d].paddedRect,y=m.x+1,g=m.y+1,_=f.data.width,b=f.data.height;ku.copy(f.data,u,{x:0,y:0},{x:y,y:g},f.data),ku.copy(f.data,u,{x:0,y:b-1},{x:y,y:g-1},{width:_,height:1}),ku.copy(f.data,u,{x:0,y:0},{x:y,y:g+b},{width:_,height:1}),ku.copy(f.data,u,{x:_-1,y:0},{x:y-1,y:g},{width:1,height:b}),ku.copy(f.data,u,{x:0,y:0},{x:y+_,y:g},{width:1,height:b})}this.image=u,this.iconPositions=n,this.patternPositions=r}return y(e,[{key:"addImages",value:function(e,t,i){for(var n in e){var r=e[n],a={x:0,y:0,w:r.data.width+2,h:r.data.height+2};i.push(a),t[n]=new Wh(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}},{key:"patchUpdatedImages",value:function(e,t){for(var i in this.haveRenderCallbacks=this.haveRenderCallbacks.filter((function(t){return e.hasImage(t)})),e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)}},{key:"patchUpdatedImage",value:function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var n=h(e.tl,2),r=n[0],a=n[1];i.update(t.data,void 0,{x:r,y:a})}}}]),e}();Hr(Wh,"ImagePosition"),Hr(Hh,"ImageAtlas");var Zh={horizontal:1,vertical:2,horizontalOnly:3},qh=function(){function e(){v(this,e),this.scale=1,this.fontStack="",this.imageName=null}return y(e,null,[{key:"forText",value:function(t,i){var n=new e;return n.scale=t||1,n.fontStack=i,n}},{key:"forImage",value:function(t){var i=new e;return i.imageName=t,i}}]),e}(),Xh=function(){function e(){v(this,e),this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}return y(e,[{key:"length",value:function(){return this.text.length}},{key:"getSection",value:function(e){return this.sections[this.sectionIndex[e]]}},{key:"getSections",value:function(){return this.sections}},{key:"getSectionIndex",value:function(e){return this.sectionIndex[e]}},{key:"getCharCode",value:function(e){return this.text.charCodeAt(e)}},{key:"verticalizePunctuation",value:function(e){this.text=function(e,t){for(var i="",n=0;n<e.length;n++){var r=e.charCodeAt(n+1)||null,a=e.charCodeAt(n-1)||null;i+=!t&&(r&&Ma(r)&&!mh[e[n+1]]||a&&Ma(a)&&!mh[e[n-1]])||!mh[e[n]]?e[n]:mh[e[n]]}return i}(this.text,e)}},{key:"trim",value:function(){for(var e=0,t=0;t<this.text.length&&Yh[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,n=this.text.length-1;n>=0&&n>=e&&Yh[this.text.charCodeAt(n)];n--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}},{key:"substring",value:function(t,i){var n=new e;return n.text=this.text.substring(t,i),n.sectionIndex=this.sectionIndex.slice(t,i),n.sections=this.sections,n}},{key:"toString",value:function(){return this.text}},{key:"getMaxScale",value:function(){var e=this;return this.sectionIndex.reduce((function(t,i){return Math.max(t,e.sections[i].scale)}),0)}},{key:"addTextSection",value:function(e,t){this.text+=e.text,this.sections.push(qh.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,n=0;n<e.text.length;++n)this.sectionIndex.push(i)}},{key:"addImageSection",value:function(e){var t=e.image?e.image.name:"";if(0!==t.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(qh.forImage(t)),this.sectionIndex.push(this.sections.length-1)):H("Reached maximum number of images 6401")}else H("Can't add FormattedSection with an empty image.")}},{key:"getNextImageSectionCharCode",value:function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}],[{key:"fromFeature",value:function(t,i){for(var n=new e,r=0;r<t.sections.length;r++){var a=t.sections[r];a.image?n.addImageSection(a):n.addTextSection(a,i)}return n}}]),e}();function Kh(e,t,i,n,r,a,o,s,l,u,c,h,d,f,m,v){var y,g=Xh.fromFeature(e,r);h===Zh.vertical&&g.verticalizePunctuation(d);var _=Wa.processBidirectionalText,b=Wa.processStyledBidirectionalText;if(_&&1===g.sections.length){y=[];var x,w=_(g.toString(),np(g,u,a,t,n,f,m)),k=p(w);try{for(k.s();!(x=k.n()).done;){var P=x.value,S=new Xh;S.text=P,S.sections=g.sections;for(var T=0;T<P.length;T++)S.sectionIndex.push(0);y.push(S)}}catch(L){k.e(L)}finally{k.f()}}else if(b){y=[];var E,C=b(g.text,g.sectionIndex,np(g,u,a,t,n,f,m)),M=p(C);try{for(M.s();!(E=M.n()).done;){var I=E.value,O=new Xh;O.text=I[0],O.sectionIndex=I[1],O.sections=g.sections,y.push(O)}}catch(L){M.e(L)}finally{M.f()}}else y=function(e,t){var i,n=[],r=e.text,a=0,o=p(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;n.push(e.substring(a,s)),a=s}}catch(L){o.e(L)}finally{o.f()}return a<r.length&&n.push(e.substring(a,r.length)),n}(g,np(g,u,a,t,n,f,m));var D=[],A={positionedLines:D,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,i,n,r,a,o,s,l,u,c,h){var d,f=0,m=0,v=0,y="right"===s?1:"left"===s?0:.5,g=!1,_=p(r);try{for(_.s();!(d=_.n()).done;){var b,x=d.value.getSections(),w=p(x);try{for(w.s();!(b=w.n()).done;){var k=b.value;if(!k.imageName){var P=t[k.fontStack];if(P&&!(g=void 0!==P.ascender&&void 0!==P.descender))break}}}catch(L){w.e(L)}finally{w.f()}if(!g)break}}catch(L){_.e(L)}finally{_.f()}var S,T,E=0,C=p(r);try{for(C.s();!(S=C.n()).done;){var M=S.value;M.trim();var I=M.getMaxScale(),O=(I-1)*lh,D={positionedGlyphs:[],lineOffset:0};e.positionedLines[E]=D;var A=D.positionedGlyphs,z=0;if(M.length()){for(var R=0,F=0,j=0;j<M.length();j++){var B=M.getSection(j),V=M.getSectionIndex(j),N=M.getCharCode(j),U=B.scale,G=null,W=null,H=null,Z=lh,q=0,X=!(l===Zh.horizontal||!c&&!Ca(N)||c&&(Yh[N]||(T=N,Jr(T)||Qr(T)||ea(T)||_a(T)||ka(T))));if(B.imageName){var K=n[B.imageName];if(!K)continue;H=B.imageName,e.iconsInText=e.iconsInText||!0,W=K.paddedRect;var Y=K.displaySize;U=U*lh/h,G={width:Y[0],height:Y[1],left:1,top:-3,advance:X?Y[1]:Y[0],localGlyph:!1},q=g?-G.height*U:I*lh-17-Y[1]*U,Z=G.advance;var $=(X?Y[0]:Y[1])*U-lh*I;$>0&&$>z&&(z=$)}else{var J=i[B.fontStack];if(!J)continue;J[N]&&(W=J[N]);var Q=t[B.fontStack];if(!Q)continue;var ee=Q.glyphs[N];if(!ee)continue;if(G=ee.metrics,Z=8203!==N?lh:0,g){var te=void 0!==Q.ascender?Math.abs(Q.ascender):0,ie=void 0!==Q.descender?Math.abs(Q.descender):0,ne=(te+ie)*U;R<ne&&(R=ne,F=(te-ie)/2*U),q=-te*U}else q=(I-U)*lh-17}X?(e.verticalizable=!0,A.push({glyph:N,imageName:H,x:f,y:m+q,vertical:X,scale:U,localGlyph:G.localGlyph,fontStack:B.fontStack,sectionIndex:V,metrics:G,rect:W}),f+=Z*U+u):(A.push({glyph:N,imageName:H,x:f,y:m+q,vertical:X,scale:U,localGlyph:G.localGlyph,fontStack:B.fontStack,sectionIndex:V,metrics:G,rect:W}),f+=G.advance*U+u)}0!==A.length&&(v=Math.max(f-u,v),g?ap(A,y,z,F,a*I/2):ap(A,y,z,0,a/2)),f=0;var re=a*I+z;D.lineOffset=Math.max(z,O),m+=re,++E}else m+=a,++E}}catch(L){C.e(L)}finally{C.f()}var ae=m,oe=rp(o),se=oe.horizontalAlign,le=oe.verticalAlign;(function(e,t,i,n,r,a){var o,s=(t-i)*r,l=-a*n,u=p(e);try{for(u.s();!(o=u.n()).done;){var c,h=o.value,d=p(h.positionedGlyphs);try{for(d.s();!(c=d.n()).done;){var f=c.value;f.x+=s,f.y+=l}}catch(L){d.e(L)}finally{d.f()}}}catch(L){u.e(L)}finally{u.f()}})(e.positionedLines,y,se,le,v,ae),e.top+=-le*ae,e.bottom=e.top+ae,e.left+=-se*v,e.right=e.left+v,e.hasBaseline=g}(A,t,i,n,y,o,s,l,h,u,d,v),!function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;)if(0!==t.value.positionedGlyphs.length)return!1}catch(L){i.e(L)}finally{i.f()}return!0}(D)&&A}var Yh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},$h={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Jh(e,t,i,n,r,a){if(t.imageName){var o=n[t.imageName];return o?o.displaySize[0]*t.scale*lh/a+r:0}var s=i[t.fontStack],l=s&&s.glyphs[e];return l?l.metrics.advance*t.scale+r:0}function Qh(e,t,i,n){var r=Math.pow(e-t,2);return n?e<t?r/2:2*r:r+Math.abs(i)*i}function ep(e,t,i){var n=0;return 10===e&&(n-=1e4),i&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function tp(e,t,i,n,r,a){var o,s=null,l=Qh(t,i,r,a),u=p(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,h=Qh(t-c.x,i,r,a)+c.badness;h<=l&&(s=c,l=h)}}catch(d){u.e(d)}finally{u.f()}return{index:e,x:t,priorBreak:s,badness:l}}function ip(e){return e?ip(e.priorBreak).concat(e.index):[]}function np(e,t,i,n,r,a,o){if("point"!==a)return[];if(!e)return[];for(var s,l=[],u=function(e,t,i,n,r,a){for(var o=0,s=0;s<e.length();s++){var l=e.getSection(s);o+=Jh(e.getCharCode(s),l,n,r,t,a)}return o/Math.max(1,Math.ceil(o/i))}(e,t,i,n,r,o),c=e.text.indexOf("\u200b")>=0,h=0,p=0;p<e.length();p++){var d=e.getSection(p),f=e.getCharCode(p);if(Yh[f]||(h+=Jh(f,d,n,r,t,o)),p<e.length()-1){var m=!((s=f)<11904||!(la(s)||sa(s)||xa(s)||ga(s)||pa(s)||ta(s)||ua(s)||ra(s)||da(s)||fa(s)||ha(s)||Pa(s)||aa(s)||na(s)||ia(s)||ca(s)||oa(s)||ba(s)||va(s)||ma(s)));($h[f]||m||d.imageName)&&l.push(tp(p+1,h,u,l,ep(f,e.getCharCode(p+1),m&&c),!1))}}return ip(tp(e.length(),h,u,l,0,!0))}function rp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function ap(e,t,i,n,r){if(t||i||n||r)for(var a=e.length-1,o=e[a],s=(o.x+o.metrics.advance*o.scale)*t,l=0;l<=a;l++)e[l].x-=s,e[l].y+=i+n+r}function op(e,t,i){var n=rp(i),r=n.horizontalAlign,a=n.verticalAlign,o=t[0]-e.displaySize[0]*r,s=t[1]-e.displaySize[1]*a;return{image:e,top:s,bottom:s+e.displaySize[1],left:o,right:o+e.displaySize[0]}}function sp(e,t,i,n,r,a){var o,s=e.image;if(s.content){var l=s.content,u=s.pixelRatio||1;o=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,h,p,d,f=t.left*a,m=t.right*a;"width"===i||"both"===i?(d=r[0]+f-n[3],h=r[0]+m+n[1]):h=(d=r[0]+(f+m-s.displaySize[0])/2)+s.displaySize[0];var v=t.top*a,y=t.bottom*a;return"height"===i||"both"===i?(c=r[1]+v-n[0],p=r[1]+y+n[2]):p=(c=r[1]+(v+y-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:h,bottom:p,left:d,collisionPadding:o}}var lp=function(e){f(i,e);var t=m(i);function i(e,n,r,a,o){var s;return v(this,i),(s=t.call(this,e,n)).angle=a,s.z=r,void 0!==o&&(s.segment=o),s}return y(i,[{key:"clone",value:function(){return new i(this.x,this.y,this.z,this.angle,this.segment)}}]),i}(g);function up(e,t,i,n,r){if(void 0===t.segment)return!0;for(var a=t,o=t.segment+1,s=0;s>-i/2;){if(--o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;for(var l=[],u=0;s<i/2;){var c=e[o],h=e[o+1];if(!h)return!1;var p=e[o-1].angleTo(c)-c.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:p}),u+=p;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>r)return!1;o++,s+=c.dist(h)}return!0}function cp(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function hp(e,t,i){return e?.6*t*i:0}function pp(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function dp(e,t,i,n,r,a){for(var o=hp(i,r,a),s=pp(i,n)*a,l=0,u=cp(e)/2,c=0;c<e.length-1;c++){var h=e[c],p=e[c+1],d=h.dist(p);if(l+d>u){var f=(u-l)/d,m=Oi(h.x,p.x,f),v=Oi(h.y,p.y,f),y=new lp(m,v,0,p.angleTo(h),c);return!o||up(e,y,s,o,t)?y:void 0}l+=d}}function fp(e,t,i,n,r,a,o,s,l){var u=hp(n,a,o),c=pp(n,r),h=c*o,p=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),mp(e,p?t/2*s%t:(c/2+2*a)*o*s%t,t,u,i,h,p,!1,l)}function mp(e,t,i,n,r,a,o,s,l){for(var u=a/2,c=cp(e),h=0,p=t-i,d=[],f=0;f<e.length-1;f++){for(var m=e[f],v=e[f+1],y=m.dist(v),g=v.angleTo(m);p+i<h+y;){var _=((p+=i)-h)/y,b=Oi(m.x,v.x,_),x=Oi(m.y,v.y,_);if(b>=0&&b<l&&x>=0&&x<l&&p-u>=0&&p+u<=c){var w=new lp(b,x,0,g,f);w._round(),n&&!up(e,w,a,n,r)||d.push(w)}}h+=y}return s||d.length||o||(d=mp(e,h/2,i,n,r,a,o,!0,l)),d}function vp(e,t,i,n,r){for(var a=[],o=0;o<e.length;o++)for(var s=e[o],l=void 0,u=0;u<s.length-1;u++){var c=s[u],h=s[u+1];c.x<t&&h.x<t||(c.x<t?c=new g(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x<t&&(h=new g(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y<i&&h.y<i||(c.y<i?c=new g(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round():h.y<i&&(h=new g(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round()),c.x>=n&&h.x>=n||(c.x>=n?c=new g(n,c.y+(n-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x>=n&&(h=new g(n,c.y+(n-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y>=r&&h.y>=r||(c.y>=r?c=new g(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round():h.y>=r&&(h=new g(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round()),l&&c.equals(l[l.length-1])||(l=[c],a.push(l)),l.push(h)))))}return a}Hr(lp,"Anchor");var yp=1e20;function gp(e,t,i,n,r,a,o,s,l){for(var u=t;u<t+n;u++)_p(e,i*a+u,a,r,o,s,l);for(var c=i;c<i+r;c++)_p(e,c*a+t,1,n,o,s,l)}function _p(e,t,i,n,r,a,o){a[0]=0,o[0]=-yp,o[1]=yp,r[0]=e[t];for(var s=1,l=0,u=0;s<n;s++){r[s]=e[t+s*i];var c=s*s;do{var h=a[l];u=(r[s]-r[h]+c-h*h)/(s-h)/2}while(u<=o[l]&&--l>-1);a[++l]=s,o[l]=u,o[l+1]=yp}for(var p=0,d=0;p<n;p++){for(;o[d+1]<p;)d++;var f=a[d],m=p-f;e[t+p*i]=r[f]+m*m}}var bp={none:0,ideographs:1,all:2},xp=function(){function e(t,i,n){v(this,e),this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}return y(e,[{key:"setURL",value:function(e){this.url=e}},{key:"getGlyphs",value:function(t,i){var n=this,r=[];for(var a in t){var o,s=p(t[a]);try{for(s.s();!(o=s.n()).done;){var l=o.value;r.push({stack:a,id:l})}}catch(u){s.e(u)}finally{s.f()}}O(r,(function(t,i){var r=t.stack,a=t.id,o=n.entries[r];o||(o=n.entries[r]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});var s=o.glyphs[a];if(void 0===s){if(s=n._tinySDF(o,r,a))return o.glyphs[a]=s,void i(null,{stack:r,id:a,glyph:s});var l=Math.floor(a/256);if(256*l>65535)i(new Error("glyphs > 65535 not supported"));else if(o.ranges[l])i(null,{stack:r,id:a,glyph:s});else{var c=o.requests[l];c||(c=o.requests[l]=[],e.loadGlyphRange(r,l,n.url,n.requestManager,(function(e,t){if(t){for(var i in o.ascender=t.ascender,o.descender=t.descender,t.glyphs)n._doesCharSupportLocalGlyph(+i)||(o.glyphs[+i]=t.glyphs[+i]);o.ranges[l]=!0}var r,a=p(c);try{for(a.s();!(r=a.n()).done;)(0,r.value)(e,t)}catch(u){a.e(u)}finally{a.f()}delete o.requests[l]}))),c.push((function(e,t){e?i(e):t&&i(null,{stack:r,id:a,glyph:t.glyphs[a]||null})}))}}else i(null,{stack:r,id:a,glyph:s})}),(function(e,t){if(e)i(e);else if(t){var r,a={},o=p(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=s.stack,c=s.id,h=s.glyph;void 0===a[l]&&(a[l]={}),void 0===a[l].glyphs&&(a[l].glyphs={}),a[l].glyphs[c]=h&&{id:h.id,bitmap:h.bitmap.clone(),metrics:h.metrics},a[l].ascender=n.entries[l].ascender,a[l].descender=n.entries[l].descender}}catch(u){o.e(u)}finally{o.f()}i(null,a)}}))}},{key:"_doesCharSupportLocalGlyph",value:function(e){return this.localGlyphMode!==bp.none&&(this.localGlyphMode===bp.all?!!this.localFontFamily:!!this.localFontFamily&&(fa(e)||ya(e)||aa(e)||oa(e)||ra(e)))}},{key:"_tinySDF",value:function(t,i,n){var r=this.localFontFamily;if(r&&this._doesCharSupportLocalGlyph(n)){var a=t.tinySDF;if(!a){var o="400";/bold/i.test(i)?o="900":/medium/i.test(i)?o="500":/light/i.test(i)&&(o="200"),(a=t.tinySDF=new e.TinySDF({fontFamily:r,fontWeight:o,fontSize:48,buffer:6,radius:16})).fontWeight=o}if(this.localGlyphs[a.fontWeight][n])return this.localGlyphs[a.fontWeight][n];var s=String.fromCharCode(n),l=a.draw(s),u=l.data,c=l.width,h=l.height,p=l.glyphWidth,d=l.glyphHeight,f=l.glyphLeft,m=l.glyphTop,v=l.glyphAdvance;return this.localGlyphs[a.fontWeight][n]={id:n,bitmap:new wu({width:c,height:h},u),metrics:{width:p/2,height:d/2,left:f/2,top:m/2-27,advance:v/2,localGlyph:!0}}}}}]),e}();function wp(e,t,i,n){var r=[],a=e.image,o=a.pixelRatio,s=a.paddedRect.w-2,l=a.paddedRect.h-2,u=e.right-e.left,c=e.bottom-e.top,h=a.stretchX||[[0,s]],p=a.stretchY||[[0,l]],d=function(e,t){return e+t[1]-t[0]},f=h.reduce(d,0),m=p.reduce(d,0),v=s-f,y=l-m,_=0,b=f,x=0,w=m,k=0,P=v,S=0,T=y;if(a.content&&n){var E=a.content;_=kp(h,0,E[0]),x=kp(p,0,E[1]),b=kp(h,E[0],E[2]),w=kp(p,E[1],E[3]),k=E[0]-_,S=E[1]-x,P=E[2]-E[0]-b,T=E[3]-E[1]-w}var C=function(n,r,s,l){var h=Sp(n.stretch-_,b,u,e.left),p=Tp(n.fixed-k,P,n.stretch,f),d=Sp(r.stretch-x,w,c,e.top),v=Tp(r.fixed-S,T,r.stretch,m),y=Sp(s.stretch-_,b,u,e.left),E=Tp(s.fixed-k,P,s.stretch,f),C=Sp(l.stretch-x,w,c,e.top),M=Tp(l.fixed-S,T,l.stretch,m),I=new g(h,d),O=new g(y,d),D=new g(y,C),A=new g(h,C),L=new g(p/o,v/o),z=new g(E/o,M/o),R=t*Math.PI/180;if(R){var F=Math.sin(R),j=Math.cos(R),B=[j,-F,F,j];I._matMult(B),O._matMult(B),A._matMult(B),D._matMult(B)}var V=n.stretch+n.fixed,N=r.stretch+r.fixed;return{tl:I,tr:O,bl:A,br:D,tex:{x:a.paddedRect.x+1+V,y:a.paddedRect.y+1+N,w:s.stretch+s.fixed-V,h:l.stretch+l.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:z,minFontScaleX:P/o/u,minFontScaleY:T/o/c,isSDF:i}};if(n&&(a.stretchX||a.stretchY))for(var M=Pp(h,v,f),I=Pp(p,y,m),O=0;O<M.length-1;O++)for(var D=M[O],A=M[O+1],L=0;L<I.length-1;L++)r.push(C(D,I[L],A,I[L+1]));else r.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));return r}function kp(e,t,i){var n,r=0,a=p(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+=Math.max(t,Math.min(i,o[1]))-Math.max(t,Math.min(i,o[0]))}}catch(s){a.e(s)}finally{a.f()}return r}function Pp(e,t,i){var n,r=[{fixed:-1,stretch:0}],a=p(e);try{for(a.s();!(n=a.n()).done;){var o=h(n.value,2),s=o[0],l=o[1],u=r[r.length-1];r.push({fixed:s-u.stretch,stretch:u.stretch}),r.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}}catch(c){a.e(c)}finally{a.f()}return r.push({fixed:t+1,stretch:i}),r}function Sp(e,t,i,n){return e/t*i+n}function Tp(e,t,i,n){return e-t*i/n}function Ep(e,t,i,n){var r=t+e.positionedLines[n].lineOffset;return 0===n?i+r/2:i+(r+(t+e.positionedLines[n-1].lineOffset))/2}xp.loadGlyphRange=function(e,t,i,n,r){var a=256*t,o=a+255,s=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}","".concat(a,"-").concat(o)),Ne.Glyphs);He(s,(function(e,t){if(e)r(e);else if(t){var i,n={},a=function(e){return new bh(e).readFields(Vh,{})}(t),o=p(a.glyphs);try{for(o.s();!(i=o.n()).done;){var s=i.value;n[s.id]=s}}catch(l){o.e(l)}finally{o.f()}r(null,{glyphs:n,ascender:a.ascender,descender:a.descender})}}))},xp.TinySDF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.fontSize,n=void 0===i?24:i,r=t.buffer,a=void 0===r?3:r,o=t.radius,s=void 0===o?8:o,l=t.cutoff,u=void 0===l?.25:l,c=t.fontFamily,h=void 0===c?"sans-serif":c,p=t.fontWeight,d=void 0===p?"normal":p,f=t.fontStyle,m=void 0===f?"normal":f;v(this,e),this.buffer=a,this.cutoff=u,this.radius=s;var y=this.size=n+4*a,g=this._createCanvas(y),_=this.ctx=g.getContext("2d",{willReadFrequently:!0});_.font="".concat(m," ").concat(d," ").concat(n,"px ").concat(h),_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}return y(e,[{key:"_createCanvas",value:function(e){var t=document.createElement("canvas");return t.width=t.height=e,t}},{key:"draw",value:function(e){var t=this.ctx.measureText(e),i=t.width,n=t.actualBoundingBoxAscent,r=t.actualBoundingBoxDescent,a=t.actualBoundingBoxLeft,o=t.actualBoundingBoxRight,s=Math.ceil(n),l=Math.min(this.size-this.buffer,Math.ceil(o-a)),u=Math.min(this.size-this.buffer,s+Math.ceil(r)),c=l+2*this.buffer,h=u+2*this.buffer,p=Math.max(c*h,0),d=new Uint8ClampedArray(p),f={data:d,width:c,height:h,glyphWidth:l,glyphHeight:u,glyphTop:s,glyphLeft:0,glyphAdvance:i};if(0===l||0===u)return f;var m=this.ctx,v=this.buffer,y=this.gridInner,g=this.gridOuter;m.clearRect(v,v,l,u),m.fillText(e,v,v+s);var _=m.getImageData(v,v,l,u);g.fill(yp,0,p),y.fill(0,0,p);for(var b=0;b<u;b++)for(var x=0;x<l;x++){var w=_.data[4*(b*l+x)+3]/255;if(0!==w){var k=(b+v)*c+x+v;if(1===w)g[k]=0,y[k]=yp;else{var P=.5-w;g[k]=P>0?P*P:0,y[k]=P<0?P*P:0}}}gp(g,0,0,c,h,c,this.f,this.v,this.z),gp(y,v,v,l,u,c,this.f,this.v,this.z);for(var S=0;S<p;S++){var T=Math.sqrt(g[S])-Math.sqrt(y[S]);d[S]=Math.round(255-255*(T/this.radius+this.cutoff))}return f}}]),e}();var Cp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mp;if(v(this,e),this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}return y(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,i=this.compare,n=t[e];e>0;){var r=e-1>>1,a=t[r];if(i(n,a)>=0)break;t[e]=a,e=r}t[e]=n}},{key:"_down",value:function(e){for(var t=this.data,i=this.compare,n=this.length>>1,r=t[e];e<n;){var a=1+(e<<1),o=t[a],s=a+1;if(s<this.length&&i(t[s],o)<0&&(a=s,o=t[s]),i(o,r)>=0)break;t[e]=o,e=a}t[e]=r}}]),e}();function Mp(e,t){return e<t?-1:e>t?1:0}function Ip(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=1/0,r=1/0,a=-1/0,o=-1/0,s=e[0],l=0;l<s.length;l++){var u=s[l];(!l||u.x<n)&&(n=u.x),(!l||u.y<r)&&(r=u.y),(!l||u.x>a)&&(a=u.x),(!l||u.y>o)&&(o=u.y)}var c=Math.min(a-n,o-r),h=c/2,p=new Cp([],Op);if(0===c)return new g(n,r);for(var d=n;d<a;d+=c)for(var f=r;f<o;f+=c)p.push(new Dp(d+h,f+h,h,e));for(var m=function(e){for(var t=0,i=0,n=0,r=e[0],a=0,o=r.length,s=o-1;a<o;s=a++){var l=r[a],u=r[s],c=l.x*u.y-u.x*l.y;i+=(l.x+u.x)*c,n+=(l.y+u.y)*c,t+=3*c}return new Dp(i/t,n/t,0,e)}(e),v=p.length;p.length;){var y=p.pop();(y.d>m.d||!m.d)&&(m=y,i&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,v)),y.max-m.d<=t||(h=y.h/2,p.push(new Dp(y.p.x-h,y.p.y-h,h,e)),p.push(new Dp(y.p.x+h,y.p.y-h,h,e)),p.push(new Dp(y.p.x-h,y.p.y+h,h,e)),p.push(new Dp(y.p.x+h,y.p.y+h,h,e)),v+=4)}return i&&(console.log("num probes: ".concat(v)),console.log("best distance: ".concat(m.d))),m.p}function Op(e,t){return t.max-e.max}function Dp(e,t,i,n){this.p=new g(e,t),this.h=i,this.d=function(e,t){for(var i=!1,n=1/0,r=0;r<t.length;r++)for(var a=t[r],o=0,s=a.length,l=s-1;o<s;l=o++){var u=a[o],c=a[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(i=!i),n=Math.min(n,ml(e,u,c))}return(i?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}var Ap=Number.POSITIVE_INFINITY,Lp=Math.sqrt(2);function zp(e,t){return t[1]!==Ap?function(e,t,i){var n=0,r=0;switch(t=Math.abs(t),i=Math.abs(i),e){case"top-right":case"top-left":case"top":r=i-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-i}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,r]}(e,t[0],t[1]):function(e,t){var i=0,n=0;t<0&&(t=0);var r=t/Lp;switch(e){case"top-right":case"top-left":n=r-7;break;case"bottom-right":case"bottom-left":n=7-r;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":i=-r;break;case"top-left":case"bottom-left":i=r;break;case"left":i=t;break;case"right":i=-t}return[i,n]}(e,t[0])}function Rp(e,t,i,n,r,a,o,s,l,u){e.createArrays(),e.tilePixelRatio=Rs/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var c=e.layers[0].layout,h=e.layers[0]._unevaluatedLayout._values,d={};if("composite"===e.textSizeData.kind){var f=e.textSizeData,m=f.minZoom,v=f.maxZoom;d.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Ha(m),s),h["text-size"].possiblyEvaluate(new Ha(v),s)]}if("composite"===e.iconSizeData.kind){var y=e.iconSizeData,g=y.minZoom,_=y.maxZoom;d.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Ha(g),s),h["icon-size"].possiblyEvaluate(new Ha(_),s)]}d.layoutTextSize=h["text-size"].possiblyEvaluate(new Ha(l+1),s),d.layoutIconSize=h["icon-size"].possiblyEvaluate(new Ha(l+1),s),d.textMaxSize=h["text-size"].possiblyEvaluate(new Ha(18),s);var b,x="map"===c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),w=c.get("text-size"),k=p(e.features);try{var P=function(){var a=b.value,l=c.get("text-font").evaluate(a,{},s).join(","),h=w.evaluate(a,{},s),p=d.layoutTextSize.evaluate(a,{},s),f=(d.layoutIconSize.evaluate(a,{},s),{horizontal:{},vertical:void 0}),m=a.text,v=void 0,y=[0,0];if(m){var g=m.toString(),_=c.get("text-letter-spacing").evaluate(a,{},s)*lh,k=c.get("text-line-height").evaluate(a,{},s)*lh,P=Ta(g)?_:0,S=c.get("text-anchor").evaluate(a,{},s),T=c.get("text-variable-anchor");if(!T){var E=c.get("text-radial-offset").evaluate(a,{},s);y=E?zp(S,[E*lh,Ap]):c.get("text-offset").evaluate(a,{},s).map((function(e){return e*lh}))}var C=x?"center":c.get("text-justify").evaluate(a,{},s),M=c.get("symbol-placement"),I="point"===M,O="point"===M?c.get("text-max-width").evaluate(a,{},s)*lh:0,D=function(n){e.allowVerticalPlacement&&Sa(g)&&(f.vertical=Kh(m,t,i,r,l,O,k,S,n,P,y,Zh.vertical,!0,M,p,h))};if(!x&&T){for(var A="auto"===C?T.map((function(e){return Fp(e)})):[C],L=!1,z=0;z<A.length;z++){var R=A[z];if(!f.horizontal[R])if(L)f.horizontal[R]=f.horizontal[0];else{var F=Kh(m,t,i,r,l,O,k,"center",R,P,y,Zh.horizontal,!1,M,p,h);F&&(f.horizontal[R]=F,L=1===F.positionedLines.length)}}D("left")}else{if("auto"===C&&(C=Fp(S)),I||c.get("text-writing-mode").indexOf("horizontal")>=0||!Sa(g)){var j=Kh(m,t,i,r,l,O,k,S,C,P,y,Zh.horizontal,!1,M,p,h);j&&(f.horizontal[C]=j)}D("point"===M?"left":C)}}var B=!1;if(a.icon&&a.icon.name){var V=n[a.icon.name];V&&(v=op(r[a.icon.name],c.get("icon-offset").evaluate(a,{},s),c.get("icon-anchor").evaluate(a,{},s)),B=V.sdf,void 0===e.sdfIcons?e.sdfIcons=V.sdf:e.sdfIcons!==V.sdf&&H("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(V.pixelRatio!==e.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var N=Np(f.horizontal)||f.vertical;e.iconsInText||(e.iconsInText=!!N&&N.iconsInText),(N||v)&&jp(e,a,f,v,n,d,p,0,y,B,o,s,u)};for(k.s();!(b=k.n()).done;)P()}catch(S){k.e(S)}finally{k.f()}a&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray)}function Fp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jp(e,t,i,n,r,a,o,s,l,u,c,d,f){var m=a.textMaxSize.evaluate(t,{},d);void 0===m&&(m=o);var v,y,g=e.layers[0].layout,_=g.get("icon-offset").evaluate(t,{},d),b=Np(i.horizontal)||i.vertical,x="globe"===f.name,k=o/24,P=e.tilePixelRatio*m/24,S=(v=e.overscaling,e.zoom>18&&v>2&&(v>>=1),Math.max(Rs/(512*v),1)*g.get("symbol-spacing")),T=g.get("text-padding")*e.tilePixelRatio,E=g.get("icon-padding")*e.tilePixelRatio,C=w(g.get("text-max-angle")),M="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),I="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),O=g.get("symbol-placement"),D=S/2,A=g.get("icon-text-fit");n&&"none"!==A&&(e.allowVerticalPlacement&&i.vertical&&(y=sp(n,i.vertical,A,g.get("icon-text-fit-padding"),_,k)),b&&(n=sp(n,b,A,g.get("icon-text-fit-padding"),_,k)));var L=function(o,s,p){if(!(s.x<0||s.x>=Rs||s.y<0||s.y>=Rs)){var m=null;if(x){var v=f.projectTilePoint(s.x,s.y,p),g=v.x,b=v.y,w=v.z;m={anchor:new lp(g,b,w,0,void 0),up:f.upVector(p,s.x,s.y)}}!function(e,t,i,n,r,a,o,s,l,u,c,p,d,f,m,v,y,g,_,b,x,w,k,P,S){var T,E,C,M,I,O,D,A,L,z=e.addToLineVertexArray(t,n),R=0,F=0,j=0,B=0,V=-1,N=-1,U={},G=as(""),W=i?i.anchor:t,Z=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?(T=l.layout.get("text-offset").evaluate(x,{},S).map((function(e){return e*lh})),Z=(E=h(T,2))[0],q=E[1]):(Z=l.layout.get("text-radial-offset").evaluate(x,{},S)*lh,q=Ap),e.allowVerticalPlacement&&r.vertical){var X=r.vertical;if(m)A=Gp(X),s&&(L=Gp(s));else{var K=l.layout.get("text-rotate").evaluate(x,{},S)+90;I=Up(u,W,t,c,p,d,X,f,K,v),s&&(O=Up(u,W,t,c,p,d,s,g,K))}}if(a){var Y=l.layout.get("icon-rotate").evaluate(x,{},S),$="none"!==l.layout.get("icon-text-fit"),J=wp(a,Y,k,$),Q=s?wp(s,Y,k,$):void 0;M=Up(u,W,t,c,p,d,a,g,Y),R=4*J.length;var ee=e.iconSizeData,te=null;"source"===ee.kind?(te=[uh*l.layout.get("icon-size").evaluate(x,{},S)])[0]>Bp&&H("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')):"composite"===ee.kind&&((te=[uh*w.compositeIconSizes[0].evaluate(x,{},S),uh*w.compositeIconSizes[1].evaluate(x,{},S)])[0]>Bp||te[1]>Bp)&&H("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')),e.addSymbols(e.icon,J,te,b,_,x,!1,i,t,z.lineStartIndex,z.lineLength,-1,P,S),V=e.icon.placedSymbolArray.length-1,Q&&(F=4*Q.length,e.addSymbols(e.icon,Q,te,b,_,x,Zh.vertical,i,t,z.lineStartIndex,z.lineLength,-1,P,S),N=e.icon.placedSymbolArray.length-1)}for(var ie in r.horizontal){var ne=r.horizontal[ie];C||(G=as(ne.text),m?D=Gp(ne):C=Up(u,W,t,c,p,d,ne,f,l.layout.get("text-rotate").evaluate(x,{},S),v));var re=1===ne.positionedLines.length;if(j+=Vp(e,i,t,ne,o,l,m,x,v,z,r.vertical?Zh.horizontal:Zh.horizontalOnly,re?Object.keys(r.horizontal):[ie],U,V,w,P,S),re)break}r.vertical&&(B+=Vp(e,i,t,r.vertical,o,l,m,x,v,z,Zh.vertical,["vertical"],U,N,w,P,S));var ae=-1,oe=function(e,t){return e?Math.max(e,t):t};ae=oe(D,ae),ae=oe(A,ae);var se=(ae=oe(L,ae))>-1?1:0;e.glyphOffsetArray.length>=Kd.MAX_GLYPHS&&H("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(W.x,W.y,W.z,t.x,t.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical>=0?U.vertical:-1,V,N,G,void 0!==C?C:e.collisionBoxArray.length,void 0!==C?C+1:e.collisionBoxArray.length,void 0!==I?I:e.collisionBoxArray.length,void 0!==I?I+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,O||e.collisionBoxArray.length,O?O+1:e.collisionBoxArray.length,c,j,B,R,F,se,0,Z,q,ae)}(e,s,m,o,i,n,r,y,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,T,M,l,0,E,I,_,t,a,u,c,d)}};if("line"===O){var z,R=p(vp(t.geometry,0,0,Rs,Rs));try{for(R.s();!(z=R.n()).done;){var F,j=z.value,B=fp(j,S,C,i.vertical||b,n,24,P,e.overscaling,Rs),V=p(B);try{for(V.s();!(F=V.n()).done;){var N=F.value;b&&Wp(e,b.text,D,N)||L(j,N,d)}}catch(oe){V.e(oe)}finally{V.f()}}}catch(oe){R.e(oe)}finally{R.f()}}else if("line-center"===O){var U,G=p(t.geometry);try{for(G.s();!(U=G.n()).done;){var W=U.value;if(W.length>1){var Z=dp(W,C,i.vertical||b,n,24,P);Z&&L(W,Z,d)}}}catch(oe){G.e(oe)}finally{G.f()}}else if("Polygon"===t.type){var q,X=p(oc(t.geometry,0));try{for(X.s();!(q=X.n()).done;){var K=q.value,Y=Ip(K,16);L(K[0],new lp(Y.x,Y.y,0,0,void 0),d)}}catch(oe){X.e(oe)}finally{X.f()}}else if("LineString"===t.type){var $,J=p(t.geometry);try{for(J.s();!($=J.n()).done;){var Q=$.value;L(Q,new lp(Q[0].x,Q[0].y,0,0,void 0),d)}}catch(oe){J.e(oe)}finally{J.f()}}else if("Point"===t.type){var ee,te=p(t.geometry);try{for(te.s();!(ee=te.n()).done;){var ie,ne=ee.value,re=p(ne);try{for(re.s();!(ie=re.n()).done;){var ae=ie.value;L([ae],new lp(ae.x,ae.y,0,0,void 0),d)}}catch(oe){re.e(oe)}finally{re.f()}}}catch(oe){te.e(oe)}finally{te.f()}}}var Bp=32640;function Vp(e,t,i,n,r,o,s,l,u,h,d,f,m,v,y,_,b){var x=function(e,t,i,n,r,o,s,l){var u=[];if(0===t.positionedLines.length)return u;var h,d=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,f=function(e){var t=e[0],i=e[1],n=t*i;return n>0?[t,-i]:n<0?[-t,i]:0===t?[i,t]:[i,-t]}(i),m=Math.abs(t.top-t.bottom),v=p(t.positionedLines);try{for(v.s();!(h=v.n()).done;)m-=h.value.lineOffset}catch(oe){v.e(oe)}finally{v.f()}for(var y=t.positionedLines.length,_=m/y,b=t.top-i[1],x=0;x<y;++x){var w=t.positionedLines[x];b=Ep(t,_,b,x);var k,P=p(w.positionedGlyphs);try{for(P.s();!(k=P.n()).done;){var S=k.value;if(S.rect){var T=S.rect||{},E=4,C=!0,M=1,I=0;if(S.imageName){var O=s[S.imageName];if(!O)continue;if(O.sdf){H("SDF images are not supported in formatted text and will be ignored.");continue}C=!1,E=1/(M=O.pixelRatio)}var D=(r||l)&&S.vertical,A=S.metrics.advance*S.scale/2,L=S.metrics,z=S.rect;if(null!==z){l&&t.verticalizable&&(I=S.imageName?A-S.metrics.width*S.scale/2:0);var R=r?[S.x+A,S.y]:[0,0],F=[0,0],j=[0,0],B=!1;r||(D?(j=[S.x+A+f[0],S.y+f[1]-I],B=!0):F=[S.x+A+i[0],S.y+i[1]-I]);var V=z.w*S.scale/(M*(S.localGlyph?2:1)),N=z.h*S.scale/(M*(S.localGlyph?2:1)),U=void 0,G=void 0,W=void 0,Z=void 0;if(D){var q=S.y-b,X=new g(-A,A-q),K=-Math.PI/2,Y=a(g,c(j));(U=new g(-A+F[0],F[1]))._rotateAround(K,X)._add(Y),U.x+=-q+A,U.y-=(L.left-E)*S.scale;var $=S.imageName?L.advance*S.scale:lh*S.scale,J=String.fromCharCode(S.glyph);vh(J)?U.x+=(1-E)*S.scale:yh(J)?U.x+=$-L.height*S.scale+(-E-1)*S.scale:U.x+=S.imageName||L.width+2*E===z.w&&L.height+2*E===z.h?($-N)/2:($-(L.height+2*E)*S.scale)/2,G=new g(U.x,U.y-V),W=new g(U.x+N,U.y),Z=new g(U.x+N,U.y-V)}else{var Q=(L.left-E)*S.scale-A+F[0],ee=(-L.top-E)*S.scale+F[1],te=Q+V,ie=ee+N;U=new g(Q,ee),G=new g(te,ee),W=new g(Q,ie),Z=new g(te,ie)}if(d){var ne=void 0;ne=r?new g(0,0):B?new g(f[0],f[1]):new g(i[0],i[1]),U._rotateAround(d,ne),G._rotateAround(d,ne),W._rotateAround(d,ne),Z._rotateAround(d,ne)}var re=new g(0,0),ae=new g(0,0);u.push({tl:U,tr:G,bl:W,br:Z,tex:T,writingMode:t.writingMode,glyphOffset:R,sectionIndex:S.sectionIndex,isSDF:C,pixelOffsetTL:re,pixelOffsetBR:ae,minFontScaleX:0,minFontScaleY:0})}}}}catch(oe){P.e(oe)}finally{P.f()}}return u}(0,n,u,o,s,l,r,e.allowVerticalPlacement),w=e.textSizeData,k=null;"source"===w.kind?(k=[uh*o.layout.get("text-size").evaluate(l,{},b)])[0]>Bp&&H("".concat(e.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')):"composite"===w.kind&&((k=[uh*y.compositeTextSizes[0].evaluate(l,{},b),uh*y.compositeTextSizes[1].evaluate(l,{},b)])[0]>Bp||k[1]>Bp)&&H("".concat(e.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')),e.addSymbols(e.text,x,k,u,s,l,d,t,i,h.lineStartIndex,h.lineLength,v,_,b);var P,S=p(f);try{for(S.s();!(P=S.n()).done;)m[P.value]=e.text.placedSymbolArray.length-1}catch(T){S.e(T)}finally{S.f()}return 4*x.length}function Np(e){for(var t in e)return e[t];return null}function Up(e,t,i,n,r,a,o,s,l,u){var c=o.top,h=o.bottom,p=o.left,d=o.right,f=o.collisionPadding;if(f&&(p-=f[0],c-=f[1],d+=f[2],h+=f[3]),l){var m=new g(p,c),v=new g(d,c),y=new g(p,h),_=new g(d,h),b=w(l),x=new g(0,0);u&&(x=new g(u[0],u[1])),m._rotateAround(b,x),v._rotateAround(b,x),y._rotateAround(b,x),_._rotateAround(b,x),p=Math.min(m.x,v.x,y.x,_.x),d=Math.max(m.x,v.x,y.x,_.x),c=Math.min(m.y,v.y,y.y,_.y),h=Math.max(m.y,v.y,y.y,_.y)}return e.emplaceBack(t.x,t.y,t.z,i.x,i.y,p,c,d,h,s,n,r,a),e.length-1}function Gp(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);var t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Wp(e,t,i,n){var r=e.compareText;if(t in r){for(var a=r[t],o=a.length-1;o>=0;o--)if(n.dist(a[o])<i)return!0}else r[t]=[];return r[t].push(n),!1}var Hp=co([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]).members,Zp=co([{name:"a_pos_3",components:3,type:"Int16"}]),qp=co([{name:"a_pos",type:"Int16",components:2}]),Xp=Rs/Math.PI/2,Kp=2*Ws(1,0)*Xp*Math.PI,Yp=[64,32,16],$p=-Xp,Jp=Xp,Qp=[new pu([$p,$p,$p],[Jp,Jp,Jp]),new pu([$p,$p,$p],[0,0,Jp]),new pu([0,$p,$p],[Jp,0,Jp]),new pu([$p,0,$p],[0,Jp,Jp]),new pu([0,0,$p],[Jp,Jp,Jp])];function ed(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=Zl([],e._camera.position,e.worldSize),a=[t,i,1,1];ru(a,a,e.pixelMatrixInverse),nu(a,a,1/a[3]);var o=Xl([],eu([],a,r)),s=e.globeMatrix,l=[s[12],s[13],s[14]],u=eu([],l,r),c=Bl(u),h=Xl([],u),p=e.worldSize/(2*Math.PI),d=Kl(h,o),f=Math.asin(p/c);if(f<Math.acos(d)){if(!n)return null;var m=[],v=[];Zl(m,o,c/d),Xl(v,eu(v,m,u)),Xl(o,Nl(o,u,Zl(o,v,Math.tan(f)*c)))}var y=[];new uu(r,o).closestPointOnSphere(l,p,y);var g=Xl([],Q(s,0)),_=Xl([],Q(s,1)),b=Xl([],Q(s,2)),x=Kl(g,y),w=Kl(_,y),P=Kl(b,y),S=k(Math.asin(-w/p)),T=k(Math.atan2(x,P));T=e.center.lng+function(e,t){var i=(t-e+180)%360-180;return i<-180?i+360:i}(e.center.lng,T);var E=Us(T),M=C(Gs(S),0,1);return new Ks(E,M)}var td=y((function e(t,i,n){v(this,e),this.a=eu([],t,n),this.b=eu([],i,n),this.center=n;var r=Xl([],this.a),a=Xl([],this.b);this.angle=Math.acos(Kl(r,a))}));function id(e,t){return 0===e.angle||(i=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)))<0||i>1?null:function(e,t,i,n){var r=Math.sin(i);return e*(Math.sin((1-n)*i)/r)+t*(Math.sin(n*i)/r)}(e.a[t],e.b[t],e.angle,C(i,0,1))+e.center[t];var i}function nd(e){if(e.z<=1)return Qp[e.z+2*e.y+e.x];for(var t=ad(e),i=h(t,2),n=i[0],r=i[1],a=[sd(n[0],n[1]),sd(n[0],r[1]),sd(r[0],n[1]),sd(r[0],r[1])],o=[Jp,Jp,Jp],s=[$p,$p,$p],l=0,u=a;l<u.length;l++){var c=u[l];o[0]=Math.min(o[0],c[0]),o[1]=Math.min(o[1],c[1]),o[2]=Math.min(o[2],c[2]),s[0]=Math.max(s[0],c[0]),s[1]=Math.max(s[1],c[1]),s[2]=Math.max(s[2],c[2])}return new pu(o,s)}function rd(e,t,i){var n=t/e.worldSize,r=Number.MAX_VALUE,a=[-r,-r,-r],o=[r,r,r],s=Ml(new Float64Array(16));if(Dl(s,s,[n,n,n]),Il(s,s,e.globeMatrix),i.z<=1){for(var l=nd(i).getCorners(),u=0;u<l.length;u++)$l(l[u],l[u],s),Wl(o,o,l[u]),Hl(a,a,l[u]);return new pu(o,a)}var c=ad(i),p=h(c,2),d=p[0],f=p[1],m=new Fs;m.setSouthWest([d[1],f[0]]),m.setNorthEast([f[1],d[0]]);for(var v=[sd(m.getSouth(),m.getWest()),sd(m.getSouth(),m.getEast()),sd(m.getNorth(),m.getEast()),sd(m.getNorth(),m.getWest())],y=0;y<v.length;y++)$l(v[y],v[y],s),Wl(o,o,v[y]),Hl(a,a,v[y]);if(m.contains(e.center)){a[2]=0;var g=e.point,_=[g.x*n,g.y*n,0];return Wl(o,o,_),Hl(a,a,_),new pu(o,a)}var b=[s[12],s[13],s[14]],x=e.center.lng,k=C(e.center.lat,-85.051129,Xs),P=[Us(x),Gs(k)],S=m.getCenter().lng,T=C(m.getCenter().lat,-85.051129,Xs),E=[Us(S),Gs(T)],M=new Array(3),I=0,O=P[0]-E[0],D=P[1]-E[1];O>.5?O-=1:O<-.5&&(O+=1),Math.abs(O)>Math.abs(D)?(I=O>=0?1:3,M=b):(I=D>=0?0:2,M=ql(M,b,[s[4],s[5],s[6]],D>=0?-Math.sin(w(m.getSouth()))*Xp:-Math.sin(w(m.getNorth()))*Xp));var A=v[I],L=v[(I+1)%4],z=new td(A,L,M),R=[id(z,0)||A[0],id(z,1)||A[1],id(z,2)||A[2]];return o[2]=Math.min(A[2],L[2]),Wl(o,o,R),Hl(a,a,R),new pu(o,a)}function ad(e){var t=1<<e.z,i=e.x/t,n=(e.x+1)/t,r=(e.y+1)/t;return[[Zs(e.y/t),Hs(i)],[Zs(r),Hs(n)]]}function od(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xp;return i=w(i),[e*Math.sin(i)*n,-t*n,e*Math.cos(i)*n]}function sd(e,t,i){return od(Math.cos(w(e)),Math.sin(w(e)),t,i)}function ld(e,t,i){var n=Math.pow(2,i.z),r=(e/Rs+i.x)/n;return sd(Zs((t/Rs+i.y)/n),Hs(r))}function ud(e){return 16383/Math.max.apply(Math,c(eu([],e.max,e.min)))}function cd(e){var t,i,n=Ml(new Float64Array(16)),r=ud(e);return Dl(n,n,[r,r,r]),Ol(n,n,((t=[])[0]=-(i=e.min)[0],t[1]=-i[1],t[2]=-i[2],t)),n}function hd(e){var t=Ml(new Float64Array(16)),i=1/ud(e);return Ol(t,t,e.min),Dl(t,t,[i,i,i]),t}function pd(e,t,i,n,r){var a=function(e){var t=Rs/(2*Math.PI);return e/(2*Math.PI)/t}(i),o=[e,t,-i/(2*Math.PI)],s=Ml(new Float64Array(16));return Ol(s,s,o),Dl(s,s,[a,a,a]),Al(s,s,w(-r)),Ll(s,s,w(-n)),s}function dd(e){return M(5,6,e)}function fd(e,t){var i,n,r,a,o,s,l,u,c,h,p=sd(t.lat,t.lng);return r=(i=Ul([],function(e){var t=sd(e._center.lat,e._center.lng),i=Yl([],Vl(0,1,0),t),n=zl([],-e.angle,t);i=$l(i,i,n),zl(n,-e._pitch,i);var r=Xl([],t);return Zl(r,r,e.cameraToCenterDistance/e.pixelsPerMeter*Kp),$l(r,r,n),Nl([],t,r)}(e),p))[0],a=i[1],o=i[2],s=(n=p)[0],l=n[1],u=n[2],h=(c=Math.sqrt(r*r+a*a+o*o)*Math.sqrt(s*s+l*l+u*u))&&Kl(i,n)/c,Math.acos(Math.min(Math.max(h,-1),1))}var md=w(85),vd=Math.cos(md),yd=Math.sin(md);function gd(e,t){var i=e.fovAboveCenter,n=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,r=(e._camera.position[2]*e.worldSize-n)/Math.cos(e._pitch),a=Math.sin(i)*r/Math.sin(Math.max(Math.PI/2-e._pitch-i,.01)),o=Math.sin(e._pitch)*a+r;return Math.min(1.01*o,r*(1/e._horizonShift))}function _d(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};var i=Math.pow(2,-e.z),n=e.x*i,r=(e.x+1)*i,a=e.y*i,o=(e.y+1)*i,s=Hs(n),l=Hs(r),u=Zs(a),c=Zs(o),h=t.project(s,u),p=t.project(l,u),d=t.project(l,c),f=t.project(s,c),m=Math.min(h.x,p.x,d.x,f.x),v=Math.min(h.y,p.y,d.y,f.y),y=Math.max(h.x,p.x,d.x,f.x),g=Math.max(h.y,p.y,d.y,f.y),_=i/16;function b(e,i,n,r,a,o){var s=(n+a)/2,l=(r+o)/2,u=t.project(Hs(s),Zs(l)),c=Math.max(0,m-u.x,v-u.y,u.x-y,u.y-g);m=Math.min(m,u.x),y=Math.max(y,u.x),v=Math.min(v,u.y),g=Math.max(g,u.y),c>_&&(b(e,u,n,r,s,l),b(u,i,s,l,a,o))}b(h,p,n,a,r,a),b(p,d,r,a,r,o),b(d,f,r,o,n,o),b(f,h,n,o,n,a),m-=_,v-=_,y+=_,g+=_;var x=1/Math.max(y-m,g-v);return{scale:x,x:m*x,y:v*x,x2:y*x,y2:g*x,projection:t}}var bd=Ml(new Float32Array(16)),xd=function(){function e(t){v(this,e),this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}return y(e,[{key:"project",value:function(e,t){return{x:0,y:0,z:0}}},{key:"unproject",value:function(e,t){return new Bs(0,0)}},{key:"projectTilePoint",value:function(e,t,i){return{x:e,y:t,z:0}}},{key:"locationPoint",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._coordinatePoint(e.locationCoordinate(t),i)}},{key:"pixelsPerMeter",value:function(e,t){return Ws(1,e)*t}},{key:"pixelSpaceConversion",value:function(e,t,i){return 1}},{key:"farthestPixelDistance",value:function(e){return gd(e,e.pixelsPerMeter)}},{key:"pointCoordinate",value:function(e,t,i,n){var r=e.horizonLineFromTop(!1),a=new g(t,Math.max(r,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(a,n))}},{key:"pointCoordinate3D",value:function(e,t,i){var n=new g(t,i);if(e.elevation)return e.elevation.pointCoordinate(n);var r=this.pointCoordinate(e,n.x,n.y,0);return[r.x,r.y,r.z]}},{key:"isPointAboveHorizon",value:function(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);var i=e.horizonLineFromTop();return t.y<i}},{key:"createInversionMatrix",value:function(e,t){return bd}},{key:"createTileMatrix",value:function(e,t,i){var n,r,a,o=i.canonical,s=Ml(new Float64Array(16));if(this.isReprojectedInTileSpace){var l=_d(o,this);n=1,r=l.x+i.wrap*l.scale,a=l.y,Dl(s,s,[n/l.scale,n/l.scale,e.pixelsPerMeter/t])}else n=t/e.zoomScale(o.z),r=(o.x+Math.pow(2,o.z)*i.wrap)*n,a=o.y*n;return Ol(s,s,[r,a,0]),Dl(s,s,[n/Rs,n/Rs,1]),s}},{key:"upVector",value:function(e,t,i){return[0,0,1]}},{key:"upVectorScale",value:function(e,t,i){return{metersToTile:1}}}]),e}(),wd=function(e){f(i,e);var t=m(i);function i(e){var n;v(this,i),(n=t.call(this,e)).range=[4,7],n.center=e.center||[-96,37.5];var r=n.parallels=e.parallels||[29.5,45.5],a=h(r,2),o=a[0],s=a[1],l=Math.sin(w(o));return n.n=(l+Math.sin(w(s)))/2,n.c=1+l*(2*n.n-l),n.r0=Math.sqrt(n.c)/n.n,n}return y(i,[{key:"project",value:function(e,t){var i=this.n,n=this.c,r=this.r0,a=w(e-this.center[0]),o=w(t),s=Math.sqrt(n-2*i*Math.sin(o))/i;return{x:s*Math.sin(a*i),y:s*Math.cos(a*i)-r,z:0}}},{key:"unproject",value:function(e,t){var i=this.n,n=this.c,r=this.r0+t,a=Math.atan2(e,Math.abs(r))*Math.sign(r);r*i<0&&(a-=Math.PI*Math.sign(e)*Math.sign(r));var o=w(this.center[0])*i,s=k((a=I(a,-Math.PI-o,Math.PI-o))/i)+this.center[0],l=Math.asin(C((n-(e*e+r*r)*i*i)/(2*i),-1,1)),u=C(k(l),-85.051129,Xs);return new Bs(s,u)}}]),i}(xd),kd=1.340264,Pd=-.081106,Sd=893e-6,Td=.003796,Ed=Math.sqrt(3)/2,Cd=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"project",value:function(e,t){t=t/180*Math.PI,e=e/180*Math.PI;var i=Math.asin(Ed*Math.sin(t)),n=i*i,r=n*n*n;return{x:.5*(e*Math.cos(i)/(Ed*(kd+3*Pd*n+r*(7*Sd+9*Td*n)))/Math.PI+.5),y:1-.5*(i*(kd+Pd*n+r*(Sd+Td*n))/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI;for(var i,n=t=(2*(1-t)-1)*Math.PI,r=n*n,a=r*r*r,o=0;o<12&&(a=(r=(n=C(n-(i=(n*(kd+Pd*r+a*(Sd+Td*r))-t)/(kd+3*Pd*r+a*(7*Sd+9*Td*r))),-Math.PI/3,Math.PI/3))*n)*r*r,!(Math.abs(i)<1e-12));++o);var s=Ed*e*(kd+3*Pd*r+a*(7*Sd+9*Td*r))/Math.cos(n),l=Math.asin(Math.sin(n)/Ed),u=C(180*s/Math.PI,-180,180),c=C(180*l/Math.PI,-85.051129,Xs);return new Bs(u,c)}}]),i}(xd),Md=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e)).wrap=!0,n.supportsWorldCopies=!0,n}return y(i,[{key:"project",value:function(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}},{key:"unproject",value:function(e,t){var i=360*(e-.5),n=C(360*(.5-t),-85.051129,Xs);return new Bs(i,n)}}]),i}(xd),Id=Math.PI/2;function Od(e){return Math.tan((Id+e)/2)}var Dd=function(e){f(i,e);var t=m(i);function i(e){var n;v(this,i),(n=t.call(this,e)).center=e.center||[0,30];var r=n.parallels=e.parallels||[30,30],a=h(r,2),o=a[0],s=a[1],l=w(o),u=w(s),c=Math.cos(l);return n.n=l===u?Math.sin(l):Math.log(c/Math.cos(u))/Math.log(Od(u)/Od(l)),n.f=c*Math.pow(Od(l),n.n)/n.n,n}return y(i,[{key:"project",value:function(e,t){t=w(t),e=w(e-this.center[0]);var i=1e-6,n=this.n,r=this.f;r>0?t<-Id+i&&(t=-Id+i):t>Id-i&&(t=Id-i);var a=r/Math.pow(Od(t),n),o=a*Math.sin(n*e),s=r-a*Math.cos(n*e);return{x:.5*(o/Math.PI+.5),y:1-.5*(s/Math.PI+.5),z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI,t=(2*(1-t)-.5)*Math.PI;var i=this.n,n=this.f,r=n-t,a=Math.sign(r),o=Math.sign(i)*Math.sqrt(e*e+r*r),s=Math.atan2(e,Math.abs(r))*a;r*i<0&&(s-=Math.PI*Math.sign(e)*a);var l=C(k(s/i)+this.center[0],-180,180),u=C(k(2*Math.atan(Math.pow(n/o,1/i))-Id),-85.051129,Xs);return new Bs(l,u)}}]),i}(xd),Ad=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e)).wrap=!0,n.supportsWorldCopies=!0,n.supportsTerrain=!0,n.supportsFog=!0,n.supportsFreeCamera=!0,n.isReprojectedInTileSpace=!1,n.unsupportedLayers=[],n.range=null,n}return y(i,[{key:"project",value:function(e,t){return{x:Us(e),y:Gs(t),z:0}}},{key:"unproject",value:function(e,t){var i=Hs(e),n=Zs(t);return new Bs(i,n)}}]),i}(xd),Ld=w(Xs),zd=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"project",value:function(e,t){var i=(t=w(t))*t,n=i*i;return{x:.5*((e=w(e))*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI;var i=t=(2*(1-t)-1)*Math.PI,n=25,r=0,a=i*i;do{var o=(a=i*i)*a;i=C(i-(r=(i*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-t)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))),-Ld,Ld)}while(Math.abs(r)>1e-6&&--n>0);var s=C(k(e/(.8707+(a=i*i)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979))),-180,180),l=k(i);return new Bs(s,l)}}]),i}(xd),Rd=w(Xs),Fd=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"project",value:function(e,t){t=w(t),e=w(e);var i=Math.cos(t),n=2/Math.PI,r=Math.acos(i*Math.cos(e/2)),a=Math.sin(r)/r,o=.5*(e*n+2*i*Math.sin(e/2)/a)||0,s=.5*(t+Math.sin(t)/a)||0;return{x:.5*(o/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){var i=e=(2*e-.5)*Math.PI,n=t=(2*(1-t)-1)*Math.PI,r=25,a=1e-6,o=0,s=0;do{var l=Math.cos(n),u=Math.sin(n),c=2*u*l,h=u*u,p=l*l,d=Math.cos(i/2),f=Math.sin(i/2),m=2*d*f,v=f*f,y=1-p*d*d,g=y?1/y:0,_=y?Math.acos(l*d)*Math.sqrt(1/y):0,b=.5*(2*_*l*f+2*i/Math.PI)-e,x=.5*(_*u+n)-t,w=.5*g*(p*v+_*l*d*h)+1/Math.PI,P=g*(m*c/4-_*u*f),S=.125*g*(c*f-_*u*p*m),T=.5*g*(h*d+_*v*l)+.5,E=P*S-T*w;s=(b*S-x*w)/E,i=C(i-(o=(x*P-b*T)/E),-Math.PI,Math.PI),n=C(n-s,-Rd,Rd)}while((Math.abs(o)>a||Math.abs(s)>a)&&--r>0);return new Bs(k(i),k(n))}}]),i}(xd),jd=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e)).center=e.center||[0,0],n.parallels=e.parallels||[0,0],n.cosPhi=Math.max(.01,Math.cos(w(n.parallels[0]))),n.scale=1/(2*Math.max(Math.PI*n.cosPhi,1/n.cosPhi)),n.wrap=!0,n.supportsWorldCopies=!0,n}return y(i,[{key:"project",value:function(e,t){var i=this.scale,n=this.cosPhi;return{x:w(e)*n*i+.5,y:-Math.sin(w(t))/n*i+.5,z:0}}},{key:"unproject",value:function(e,t){var i=this.scale,n=this.cosPhi,r=-(t-.5)/i,a=C(k((e-.5)/i)/n,-180,180),o=Math.asin(C(r*n,-1,1)),s=C(k(o),-85.051129,Xs);return new Bs(a,s)}}]),i}(xd),Bd=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e)).requiresDraping=!0,n.supportsWorldCopies=!1,n.supportsFog=!0,n.zAxisUnit="pixels",n.unsupportedLayers=["debug","custom"],n.range=[3,5],n}return y(i,[{key:"projectTilePoint",value:function(e,t,i){var n=Math.pow(2,i.z),r=(e/Rs+i.x)/n,a=sd(Zs((t/Rs+i.y)/n),Hs(r));return $l(a,a,cd(nd(i))),{x:a[0],y:a[1],z:a[2]}}},{key:"locationPoint",value:function(e,t){var i=sd(t.lat,t.lng),n=Xl([],i),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;ql(i,i,n,Ws(1,0)*Rs*r);var a=Ml(new Float64Array(16));return Il(a,e.pixelMatrix,e.globeMatrix),$l(i,i,a),new g(i[0],i[1])}},{key:"pixelsPerMeter",value:function(e,t){return Ws(1,0)*t}},{key:"pixelSpaceConversion",value:function(e,t,i){var n=Oi(Ws(1,45)*t,Ws(1,e)*t,i);return this.pixelsPerMeter(e,t)/n}},{key:"createTileMatrix",value:function(e,t,i){var n=hd(nd(i.canonical));return Il(new Float64Array(16),e.globeMatrix,n)}},{key:"createInversionMatrix",value:function(e,t){var i=e.center,n=Ml(new Float64Array(16));return Il(n,n,cd(nd(t))),Ll(n,n,w(i.lng)),Al(n,n,w(i.lat)),Dl(n,n,[e._projectionScaler,e._projectionScaler,1]),Float32Array.from(n)}},{key:"pointCoordinate",value:function(e,t,i,n){return ed(e,t,i,!0)||new Ks(0,0)}},{key:"pointCoordinate3D",value:function(e,t,i){var n=this.pointCoordinate(e,t,i,0);return[n.x,n.y,n.z]}},{key:"isPointAboveHorizon",value:function(e,t){return!ed(e,t.x,t.y,!1)}},{key:"farthestPixelDistance",value:function(e){var t=function(e,t){var i,n=e.cameraToCenterDistance,r=e._centerAltitude*t,a=e._camera,o=e._camera.forward(),s=Nl([],Zl([],o,-n),[0,0,r]),l=e.worldSize/(2*Math.PI),u=[0,0,-l],c=e.width/e.height,h=Math.tan(e.fovAboveCenter),p=Zl([],a.up(),h),d=Zl([],a.right(),h*c),f=Xl([],Nl([],Nl([],o,p),d)),m=[];if(new uu(s,f).closestPointOnSphere(u,l,m)){var v=Nl([],m,u),y=eu([],v,s);i=Math.cos(e.fovAboveCenter)*Bl(y)}else{var g=eu([],s,u),_=eu([],u,s);Xl(_,_);var b=Bl(g)-l;i=Math.sqrt(b*(b+2*l));var x=Math.acos(i/(l+b))-Math.acos(Kl(o,_));i*=Math.cos(x)}return 1.01*i}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=dd(e.zoom);if(i>0){var n=gd(e,Ws(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),a=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Oi(t,n+r*(1-Math.cos(a)),Math.pow(i,10))}return t}},{key:"upVector",value:function(e,t,i){var n=1<<e.z,r=(t/Rs+e.x)/n;return sd(Zs((i/Rs+e.y)/n),Hs(r),1)}},{key:"upVectorScale",value:function(e){return{metersToTile:Kp*ud(nd(e))}}}]),i}(Ad);function Vd(e){var t=e.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new Ad(e);case"equirectangular":return new Md(e);case"naturalEarth":return new zd(e);case"equalEarth":return new Cd(e);case"winkelTripel":return new Fd(e);case"albers":return i?new jd(e):new wd(e);case"lambertConformalConic":return i?new jd(e):new Dd(e);case"globe":return new Bd(e)}throw new Error("Invalid projection name: ".concat(e.name))}var Nd=Sc.VectorTileFeature.types,Ud=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gd(e,t,i,n,r,a,o,s,l,u,c,h,p){var d=s?Math.min(Bp,Math.round(s[0])):0,f=s?Math.min(Bp,Math.round(s[1])):0;e.emplaceBack(t,i,Math.round(32*n),Math.round(32*r),a,o,(d<<1)+(l?1:0),f,16*u,16*c,256*h,256*p)}function Wd(e,t,i,n,r,a,o){e.emplaceBack(t,i,n,r,a,o)}function Hd(e,t,i,n,r){e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r)}function Zd(e){var t,i=p(e.sections);try{for(i.s();!(t=i.n()).done;)if(Da(t.value.text))return!0}catch(n){i.e(n)}finally{i.f()}return!1}var qd=function(){function e(t){v(this,e),this.layoutVertexArray=new xo,this.indexArray=new Mo,this.programConfigurations=t,this.segments=new zs,this.dynamicLayoutVertexArray=new yo,this.opacityVertexArray=new ko,this.placedSymbolArray=new Wo,this.globeExtVertexArray=new wo}return y(e,[{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}},{key:"upload",value:function(e,t,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,th.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,nh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ud,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,ih.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}]),e}();Hr(qd,"SymbolBuffers");var Xd=function(){function e(t,i,n){v(this,e),this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new n,this.segments=new zs,this.collisionVertexArray=new Eo,this.collisionVertexArrayExt=new Co}return y(e,[{key:"upload",value:function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,rh.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,ah.members,!0)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}]),e}();Hr(Xd,"CollisionBuffers");var Kd=function(){function e(t){v(this,e),this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ml([]),this.placementViewportMatrix=Ml([]);var i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ch(this.zoom,i["text-size"]),this.iconSizeData=ch(this.zoom,i["icon-size"]);var n=this.layers[0].layout,r=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((function(e){return Zh[e]})),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=t.sourceID,this.projection=t.projection}return y(e,[{key:"createArrays",value:function(){this.text=new qd(new Ss(this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new qd(new Ss(this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new qo,this.lineVertexArray=new Xo,this.symbolInstances=new Zo}},{key:"calculateGlyphDependencies",value:function(e,t,i,n,r){for(var a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,n&&r){var o=mh[e.charAt(a)];o&&(t[o.charCodeAt(0)]=!0)}}},{key:"populate",value:function(e,t,i,n){var r=this.layers[0],a=r.layout,o="globe"===this.projection.name,s=a.get("text-font"),l=a.get("text-field"),u=a.get("icon-image"),c=("constant"!==l.value.kind||l.value.value instanceof Lt&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),h="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,d=a.get("symbol-sort-key");if(this.features=[],c||h){var f,m=t.iconDependencies,v=t.glyphDependencies,y=t.availableImages,g=new Ha(this.zoom),_=p(e);try{for(_.s();!(f=_.n()).done;){var b=f.value,x=b.feature,w=b.id,k=b.index,P=b.sourceLayerIndex,S=r._featureFilter.needGeometry,T=rl(x,S);if(r._featureFilter.filter(g,T,i)){S||(T.geometry=nl(x,i,n)),o&&1!==x.type&&i.z<=5&&function(){for(var e=T.geometry,t=1<<i.z,n=i.x,r=i.y,a=.98078528056,o=0;o<e.length;o++)e[o]=Qs(e[o],(function(e){return e}),(function(e,i){return Kl(sd(Zs((e.y/Rs+r)/t),Hs((e.x/Rs+n)/t),1),sd(Zs((i.y/Rs+r)/t),Hs((i.x/Rs+n)/t),1))<a}))}();var E=void 0,C=void 0;if(c){var M=r.getValueAndResolveTokens("text-field",T,i,y),I=Lt.factory(M);Zd(I)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Ua()||this.hasRTLText&&Wa.isParsed())&&(E=fh(I,r,T))}if(h){var O=r.getValueAndResolveTokens("icon-image",T,i,y);C=O instanceof zt?O:zt.fromString(O)}if(E||C){var D=this.sortFeaturesByKey?d.evaluate(T,{},i):void 0;if(this.features.push({id:w,text:E,icon:C,index:k,sourceLayerIndex:P,geometry:T.geometry,properties:x.properties,type:Nd[x.type],sortKey:D}),C&&(m[C.name]=!0),E){var A=s.evaluate(T,{},i).join(","),L="map"===a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Zh.vertical)>=0;var z,R=p(E.sections);try{for(R.s();!(z=R.n()).done;){var F=z.value;if(F.image)m[F.image.name]=!0;else{var j=Sa(E.toString()),B=F.fontStack||A,V=v[B]=v[B]||{};this.calculateGlyphDependencies(F.text,V,L,this.allowVerticalPlacement,j)}}}catch(N){R.e(N)}finally{R.f()}}}}}}catch(N){_.e(N)}finally{_.f()}"line"===a.get("symbol-placement")&&(this.features=function(e){var t={},i={},n=[],r=0;function a(t){n.push(e[t]),r++}function o(e,t,r){var a=i[e];return delete i[e],i[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(r[0]),a}function s(e,i,r){var a=t[i];return delete t[i],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=r[0].concat(n[a].geometry[0]),a}function l(e,t,i){var n=i?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(n.x,":").concat(n.y)}for(var u=0;u<e.length;u++){var c=e[u],h=c.geometry,p=c.text?c.text.toString():null;if(p){var d=l(p,h),f=l(p,h,!0);if(d in i&&f in t&&i[d]!==t[f]){var m=s(d,f,h),v=o(d,f,n[m].geometry);delete t[d],delete i[f],i[l(p,n[v].geometry,!0)]=v,n[m].geometry=null}else d in i?o(d,f,h):f in t?s(d,f,h):(a(u),t[d]=r-1,i[f]=r-1)}else a(u)}return n.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}}},{key:"update",value:function(e,t,i,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i,n))}},{key:"isEmpty",value:function(){return 0===this.symbolInstances.length&&!this.hasRTLText}},{key:"uploadPending",value:function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}},{key:"upload",value:function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}},{key:"destroyDebugData",value:function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}},{key:"getProjection",value:function(){return this.projectionInstance||(this.projectionInstance=Vd(this.projection)),this.projectionInstance}},{key:"destroy",value:function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}},{key:"addToLineVertexArray",value:function(e,t){var i=this.lineVertexArray.length,n=e.segment;if(void 0!==n){for(var r=e.dist(t[n+1]),a=e.dist(t[n]),o={},s=n+1;s<t.length;s++)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:r},s<t.length-1&&(r+=t[s+1].dist(t[s]));for(var l=n||0;l>=0;l--)o[l]={x:t[l].x,y:t[l].y,tileUnitDistanceFromAnchor:a},l>0&&(a+=t[l-1].dist(t[l]));for(var u=0;u<t.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}},{key:"addSymbols",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d){for(var f=e.indexArray,m=e.layoutVertexArray,v=e.globeExtVertexArray,y=e.segments.prepareSegment(4*t.length,m,f,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,_=y.vertexLength,b=this.allowVerticalPlacement&&o===Zh.vertical?Math.PI/2:0,x=a.text&&a.text.sections,w=0;w<t.length;w++){var k=t[w],P=k.tl,S=k.tr,T=k.bl,E=k.br,C=k.tex,M=k.pixelOffsetTL,I=k.pixelOffsetBR,O=k.minFontScaleX,D=k.minFontScaleY,A=k.glyphOffset,L=k.isSDF,z=k.sectionIndex,R=y.vertexLength,F=A[1];if(Gd(m,l.x,l.y,P.x,F+P.y,C.x,C.y,i,L,M.x,M.y,O,D),Gd(m,l.x,l.y,S.x,F+S.y,C.x+C.w,C.y,i,L,I.x,M.y,O,D),Gd(m,l.x,l.y,T.x,F+T.y,C.x,C.y+C.h,i,L,M.x,I.y,O,D),Gd(m,l.x,l.y,E.x,F+E.y,C.x+C.w,C.y+C.h,i,L,I.x,I.y,O,D),s){var j=s.anchor,B=s.up;Wd(v,j.x,j.y,j.z,B[0],B[1],B[2]),Wd(v,j.x,j.y,j.z,B[0],B[1],B[2]),Wd(v,j.x,j.y,j.z,B[0],B[1],B[2]),Wd(v,j.x,j.y,j.z,B[0],B[1],B[2]),Hd(e.dynamicLayoutVertexArray,j.x,j.y,j.z,b)}else Hd(e.dynamicLayoutVertexArray,l.x,l.y,l.z,b);f.emplaceBack(R,R+1,R+2),f.emplaceBack(R+1,R+2,R+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),w!==t.length-1&&z===t[w+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},p,d,x&&x[z])}var V=s?s.anchor:l;e.placedSymbolArray.emplaceBack(V.x,V.y,V.z,l.x,l.y,g,this.glyphOffsetArray.length-g,_,u,c,l.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],o,0,!1,0,h,0)}},{key:"_commitLayoutVertex",value:function(e,t,i,n,r,a,o){e.emplaceBack(t,i,n,r,a,Math.round(o.x),Math.round(o.y))}},{key:"_addCollisionDebugVertices",value:function(e,t,i,n,r,a,o){for(var s=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=s.vertexLength,u=o.tileAnchorX,c=o.tileAnchorY,h=0;h<4;h++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),i.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(i.layoutVertexArray,n,r,a,u,c,new g(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,a,u,c,new g(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,a,u,c,new g(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,n,r,a,u,c,new g(e.x1,e.y2)),s.vertexLength+=4;var p=i.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),s.primitiveLength+=4}},{key:"_addTextDebugCollisionBoxes",value:function(e,t,i,n,r,a){for(var o=n;o<r;o++){var s=i.get(o),l=this.getSymbolInstanceTextSize(e,a,t,o);this._addCollisionDebugVertices(s,l,this.textCollisionBox,s.projectedAnchorX,s.projectedAnchorY,s.projectedAnchorZ,a)}}},{key:"_addIconDebugCollisionBoxes",value:function(e,t,i,n,r,a){for(var o=n;o<r;o++){var s=i.get(o),l=this.getSymbolInstanceIconSize(e,t,o);this._addCollisionDebugVertices(s,l,this.iconCollisionBox,s.projectedAnchorX,s.projectedAnchorY,s.projectedAnchorZ,a)}}},{key:"generateCollisionDebugBuffers",value:function(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xd(So,oh.members,Ro),this.iconCollisionBox=new Xd(So,oh.members,Ro);for(var i=ph(this.iconSizeData,e),n=ph(this.textSizeData,e),r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(n,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._addTextDebugCollisionBoxes(n,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._addIconDebugCollisionBoxes(i,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex,a),this._addIconDebugCollisionBoxes(i,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a)}}},{key:"getSymbolInstanceTextSize",value:function(e,t,i,n){var r=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n),a=hh(this.textSizeData,e,r)/lh;return this.tilePixelRatio*a}},{key:"getSymbolInstanceIconSize",value:function(e,t,i){var n=this.icon.placedSymbolArray.get(i),r=hh(this.iconSizeData,e,n);return this.tilePixelRatio*r}},{key:"_commitDebugCollisionVertexUpdate",value:function(e,t,i){e.emplaceBack(t,-i,-i),e.emplaceBack(t,i,-i),e.emplaceBack(t,i,i),e.emplaceBack(t,-i,i)}},{key:"_updateTextDebugCollisionBoxes",value:function(e,t,i,n,r,a){for(var o=n;o<r;o++){var s=i.get(o),l=this.getSymbolInstanceTextSize(e,a,t,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,l,s.padding)}}},{key:"_updateIconDebugCollisionBoxes",value:function(e,t,i,n,r){for(var a=n;a<r;a++){var o=i.get(a),s=this.getSymbolInstanceIconSize(e,t,a);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,s,o.padding)}}},{key:"updateCollisionDebugBuffers",value:function(e,t){if(this.hasDebugData()){this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();for(var i=ph(this.iconSizeData,e),n=ph(this.textSizeData,e),r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(n,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._updateTextDebugCollisionBoxes(n,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._updateIconDebugCollisionBoxes(i,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(i,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}}},{key:"_deserializeCollisionBoxesForSymbol",value:function(e,t,i,n,r,a,o,s,l){for(var u={},c=t;c<i;c++){var h=e.get(c);u.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,padding:h.padding,projectedAnchorX:h.projectedAnchorX,projectedAnchorY:h.projectedAnchorY,projectedAnchorZ:h.projectedAnchorZ,tileAnchorX:h.tileAnchorX,tileAnchorY:h.tileAnchorY},u.textFeatureIndex=h.featureIndex;break}for(var p=n;p<r;p++){var d=e.get(p);u.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,padding:d.padding,projectedAnchorX:d.projectedAnchorX,projectedAnchorY:d.projectedAnchorY,projectedAnchorZ:d.projectedAnchorZ,tileAnchorX:d.tileAnchorX,tileAnchorY:d.tileAnchorY},u.verticalTextFeatureIndex=d.featureIndex;break}for(var f=a;f<o;f++){var m=e.get(f);u.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,padding:m.padding,projectedAnchorX:m.projectedAnchorX,projectedAnchorY:m.projectedAnchorY,projectedAnchorZ:m.projectedAnchorZ,tileAnchorX:m.tileAnchorX,tileAnchorY:m.tileAnchorY},u.iconFeatureIndex=m.featureIndex;break}for(var v=s;v<l;v++){var y=e.get(v);u.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,padding:y.padding,projectedAnchorX:y.projectedAnchorX,projectedAnchorY:y.projectedAnchorY,projectedAnchorZ:y.projectedAnchorZ,tileAnchorX:y.tileAnchorX,tileAnchorY:y.tileAnchorY},u.verticalIconFeatureIndex=y.featureIndex;break}return u}},{key:"deserializeCollisionBoxes",value:function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}},{key:"hasTextData",value:function(){return this.text.segments.get().length>0}},{key:"hasIconData",value:function(){return this.icon.segments.get().length>0}},{key:"hasDebugData",value:function(){return this.textCollisionBox&&this.iconCollisionBox}},{key:"hasTextCollisionBoxData",value:function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}},{key:"hasIconCollisionBoxData",value:function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}},{key:"addIndicesForPlacedSymbol",value:function(e,t){for(var i=e.placedSymbolArray.get(t),n=i.vertexStartIndex+4*i.numGlyphs,r=i.vertexStartIndex;r<n;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}},{key:"getSortedSymbolIndexes",value:function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),n=[],r=[],a=[],o=0;o<this.symbolInstances.length;++o){a.push(o);var s=this.symbolInstances.get(o);n.push(0|Math.round(t*s.tileAnchorX+i*s.tileAnchorY)),r.push(s.featureIndex)}return a.sort((function(e,t){return n[e]-n[t]||r[t]-r[e]})),a}},{key:"addToSortKeyRanges",value:function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}},{key:"sortFeatures",value:function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];var i,n=p(this.symbolInstanceIndexes);try{for(n.s();!(i=n.n()).done;){var r=i.value,a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(e,i,n){e>=0&&n.indexOf(e)===i&&t.addIndicesForPlacedSymbol(t.text,e)})),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}}catch(o){n.e(o)}finally{n.f()}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}]),e}();Hr(Kd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Kd.MAX_GLYPHS=65535,Kd.addDynamicAttributes=Hd;var Yd=new ao({"symbol-placement":new eo(rt.layout_symbol["symbol-placement"]),"symbol-spacing":new eo(rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new eo(rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new to(rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new eo(rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new eo(rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new eo(rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new eo(rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new eo(rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new to(rt.layout_symbol["icon-size"]),"icon-text-fit":new eo(rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new eo(rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new to(rt.layout_symbol["icon-image"]),"icon-rotate":new to(rt.layout_symbol["icon-rotate"]),"icon-padding":new eo(rt.layout_symbol["icon-padding"]),"icon-keep-upright":new eo(rt.layout_symbol["icon-keep-upright"]),"icon-offset":new to(rt.layout_symbol["icon-offset"]),"icon-anchor":new to(rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new eo(rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new eo(rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new eo(rt.layout_symbol["text-rotation-alignment"]),"text-field":new to(rt.layout_symbol["text-field"]),"text-font":new to(rt.layout_symbol["text-font"]),"text-size":new to(rt.layout_symbol["text-size"]),"text-max-width":new to(rt.layout_symbol["text-max-width"]),"text-line-height":new to(rt.layout_symbol["text-line-height"]),"text-letter-spacing":new to(rt.layout_symbol["text-letter-spacing"]),"text-justify":new to(rt.layout_symbol["text-justify"]),"text-radial-offset":new to(rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new eo(rt.layout_symbol["text-variable-anchor"]),"text-anchor":new to(rt.layout_symbol["text-anchor"]),"text-max-angle":new eo(rt.layout_symbol["text-max-angle"]),"text-writing-mode":new eo(rt.layout_symbol["text-writing-mode"]),"text-rotate":new to(rt.layout_symbol["text-rotate"]),"text-padding":new eo(rt.layout_symbol["text-padding"]),"text-keep-upright":new eo(rt.layout_symbol["text-keep-upright"]),"text-transform":new to(rt.layout_symbol["text-transform"]),"text-offset":new to(rt.layout_symbol["text-offset"]),"text-allow-overlap":new eo(rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new eo(rt.layout_symbol["text-ignore-placement"]),"text-optional":new eo(rt.layout_symbol["text-optional"])}),$d={paint:new ao({"icon-opacity":new to(rt.paint_symbol["icon-opacity"]),"icon-color":new to(rt.paint_symbol["icon-color"]),"icon-halo-color":new to(rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new to(rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new to(rt.paint_symbol["icon-halo-blur"]),"icon-translate":new eo(rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new eo(rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new to(rt.paint_symbol["text-opacity"]),"text-color":new to(rt.paint_symbol["text-color"],{runtimeType:vt,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new to(rt.paint_symbol["text-halo-color"]),"text-halo-width":new to(rt.paint_symbol["text-halo-width"]),"text-halo-blur":new to(rt.paint_symbol["text-halo-blur"]),"text-translate":new eo(rt.paint_symbol["text-translate"]),"text-translate-anchor":new eo(rt.paint_symbol["text-translate-anchor"])}),layout:Yd},Jd=function(){function e(t){v(this,e),this.type=t.property.overrides?t.property.overrides.runtimeType:pt,this.defaultValue=t}return y(e,[{key:"evaluate",value:function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}},{key:"eachChild",value:function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return null}}]),e}();Hr(Jd,"FormatSectionOverride",{omit:["defaultValue"]});var Qd=function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,$d)}return y(i,[{key:"recalculate",value:function(e,t){o(s(i.prototype),"recalculate",this).call(this,e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));var n=this.layout.get("text-writing-mode");if(n){var r,a=[],l=p(n);try{for(l.s();!(r=l.n()).done;){var u=r.value;a.indexOf(u)<0&&a.push(u)}}catch(c){l.e(c)}finally{l.f()}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}},{key:"getValueAndResolveTokens",value:function(e,t,i,n){var r=this.layout.get(e).evaluate(t,{},i,n),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||Xn(a.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,(function(t,i){return i in e?String(e[i]):""}))}(t.properties,r)}},{key:"createBucket",value:function(e){return new Kd(e)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){return!1}},{key:"_setPaintOverrides",value:function(){var e,t=p($d.paint.overridableProperties);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(i.hasPaintOverride(this.layout,n)){var r=this.paint.get(n),a=new Jd(r),o=new qn(a,r.property.specification),s=null;s="constant"===r.value.kind||"source"===r.value.kind?new Yn("source",o):new $n("composite",o,r.value.zoomStops,r.value._interpolationType),this.paint._values[n]=new Ja(r.property,s,r.parameters)}}}catch(l){t.e(l)}finally{t.f()}}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&i.hasPaintOverride(this.layout,e)}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}}],[{key:"hasPaintOverride",value:function(e,t){var i=e.get("text-field"),n=$d.paint.properties[t],r=!1,a=function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(n.overrides&&n.overrides.hasOverride(a))return void(r=!0)}}catch(o){i.e(o)}finally{i.f()}};if("constant"===i.value.kind&&i.value.value instanceof Lt)a(i.value.value.sections);else if("source"===i.value.kind){var o=function e(t){r||(t instanceof Nt&&jt(t.value)===bt?a(t.value.sections):t instanceof Zt?a(t.sections):t.eachChild(e))},s=i.value;s._styleExpression&&o(s._styleExpression.expression)}return r}}]),i}(Ds),ef={paint:new ao({"background-color":new eo(rt.paint_background["background-color"]),"background-pattern":new no(rt.paint_background["background-pattern"]),"background-opacity":new eo(rt.paint_background["background-opacity"])})},tf={paint:new ao({"raster-opacity":new eo(rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new eo(rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new eo(rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new eo(rt.paint_raster["raster-brightness-max"]),"raster-saturation":new eo(rt.paint_raster["raster-saturation"]),"raster-contrast":new eo(rt.paint_raster["raster-contrast"]),"raster-resampling":new eo(rt.paint_raster["raster-resampling"]),"raster-fade-duration":new eo(rt.paint_raster["raster-fade-duration"])})},nf=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e,{})).implementation=e,n}return y(i,[{key:"is3D",value:function(){return"3d"===this.implementation.renderingMode}},{key:"hasOffscreenPass",value:function(){return void 0!==this.implementation.prerender}},{key:"recalculate",value:function(){}},{key:"updateTransitions",value:function(){}},{key:"hasTransition",value:function(){return!1}},{key:"serialize",value:function(){}},{key:"onAdd",value:function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}},{key:"onRemove",value:function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}]),i}(Ds),rf={paint:new ao({"sky-type":new eo(rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new eo(rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new eo(rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new eo(rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new eo(rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ro(rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new eo(rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new eo(rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new eo(rt.paint_sky["sky-opacity"])})};function af(e,t,i){var n=[0,0,1],r=ou([]);return lu(r,r,i?-w(e)+Math.PI:w(e)),su(r,r,-w(t)),Jl(n,n,r),Xl(n,n)}var of={circle:function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,Sl)}return y(i,[{key:"createBucket",value:function(e){return new sl(e)}},{key:"queryRadius",value:function(e){var t=e;return bl("circle-radius",this,t)+bl("circle-stroke-width",this,t)+xl(this.paint.get("circle-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,i,n,r,a,o,s){var l=kl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return du(e,n,a,o,s,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}},{key:"getProgramIds",value:function(){return["circle"]}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}}]),i}(Ds),heatmap:function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e,Pu))._updateColorRamp(),n}return y(i,[{key:"createBucket",value:function(e){return new gu(e)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"heatmap-color"===e&&this._updateColorRamp()}},{key:"_updateColorRamp",value:function(){this.colorRamp=Su({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}},{key:"resize",value:function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}},{key:"queryRadius",value:function(e){return bl("heatmap-radius",this,e)}},{key:"queryIntersectsFeature",value:function(e,t,i,n,r,a,o,s){var l=this.paint.get("heatmap-radius").evaluate(t,i);return du(e,n,a,o,s,!0,!0,new g(0,0),l)}},{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["heatmap","heatmapTexture"]}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}}]),i}(Ds),hillshade:function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,Tu)}return y(i,[{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["hillshade","hillshadePrepare"]}}]),i}(Ds),fill:function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,pc)}return y(i,[{key:"getProgramIds",value:function(){var e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}},{key:"recalculate",value:function(e,t){o(s(i.prototype),"recalculate",this).call(this,e,t);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}},{key:"createBucket",value:function(e){return new cc(e)}},{key:"queryRadius",value:function(){return xl(this.paint.get("fill-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,i,n,r,a){return!e.queryGeometry.isAboveHorizon&&cl(wl(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),n)}},{key:"isTileClipped",value:function(){return!0}}]),i}(Ds),"fill-extrusion":function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,Rc)}return y(i,[{key:"createBucket",value:function(e){return new Dc(e)}},{key:"queryRadius",value:function(){return xl(this.paint.get("fill-extrusion-translate"))}},{key:"is3D",value:function(){return!0}},{key:"getProgramIds",value:function(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}},{key:"queryIntersectsFeature",value:function(e,t,i,n,r,a,o,s,l){var u=kl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),c=this.paint.get("fill-extrusion-height").evaluate(t,i),h=this.paint.get("fill-extrusion-base").evaluate(t,i),d=[0,0],f=s&&a.elevation,m=a.elevation?a.elevation.exaggeration():1,v=e.tile.getBucket(this);if(f&&v instanceof Dc){var y=v.centroidVertexArray,_=l+1;if(_<y.length){var b=y.get(_);d[0]=b.a_centroid_pos0,d[1]=b.a_centroid_pos1}}if(0===d[0]&&1===d[1])return!1;"globe"===a.projection.name&&(n=zc([n],[new g(0,0),new g(Rs,Rs)],e.tileID.canonical).map((function(e){return e.polygon})).flat());var x=function(e,t,i,n,r,a,o,s,l,u,c){return"globe"===e.projection.name?function(e,t,i,n,r,a,o,s,l,u,c){var h=[],d=[],f=e.projection.upVectorScale(c,e.center.lat,e.worldSize).metersToTile,m=[0,0,0,1],v=[0,0,0,1],y=function(e,t,i,n){e[0]=t,e[1]=i,e[2]=n,e[3]=1},g=Lc();i>0&&(i+=g),n+=g;var _,b=p(t);try{for(b.s();!(_=b.n()).done;){var x,w=_.value,k=[],P=[],S=p(w);try{for(S.s();!(x=S.n()).done;){var T=x.value,E=T.x+r.x,C=T.y+r.y,M=e.projection.projectTilePoint(E,C,c),I=e.projection.upVector(c,T.x,T.y),O=i,D=n;if(o){var A=Hc(E,C,i,n,o,s,l,u);O+=A.base,D+=A.top}0!==i?y(m,M.x+I[0]*f*O,M.y+I[1]*f*O,M.z+I[2]*f*O):y(m,M.x,M.y,M.z),y(v,M.x+I[0]*f*D,M.y+I[1]*f*D,M.z+I[2]*f*D),$l(m,m,a),$l(v,v,a),k.push(Wc(m)),P.push(Wc(v))}}catch(L){S.e(L)}finally{S.f()}h.push(k),d.push(P)}}catch(L){b.e(L)}finally{b.f()}return[h,d]}(e,t,i,n,r,a,o,s,l,u,c):o?function(e,t,i,n,r,a,o,s,l){var u,c=[],h=[],d=[0,0,0,1],f=p(e);try{for(f.s();!(u=f.n()).done;){var m,v=u.value,y=[],g=[],_=p(v);try{for(_.s();!(m=_.n()).done;){var b=m.value,x=b.x+n.x,w=b.y+n.y,k=Hc(x,w,t,i,a,o,s,l);d[0]=x,d[1]=w,d[2]=k.base,d[3]=1,ru(d,d,r),d[3]=Math.max(d[3],1e-5);var P=Wc([d[0]/d[3],d[1]/d[3],d[2]/d[3]]);d[0]=x,d[1]=w,d[2]=k.top,d[3]=1,ru(d,d,r),d[3]=Math.max(d[3],1e-5);var S=Wc([d[0]/d[3],d[1]/d[3],d[2]/d[3]]);y.push(P),g.push(S)}}catch(T){_.e(T)}finally{_.f()}c.push(y),h.push(g)}}catch(T){f.e(T)}finally{f.f()}return[c,h]}(t,i,n,r,a,o,s,l,u):function(e,t,i,n,r){var a,o=[],s=[],l=r[8]*t,u=r[9]*t,c=r[10]*t,h=r[11]*t,d=r[8]*i,f=r[9]*i,m=r[10]*i,v=r[11]*i,y=p(e);try{for(y.s();!(a=y.n()).done;){var _,b=a.value,x=[],w=[],k=p(b);try{for(k.s();!(_=k.n()).done;){var P=_.value,S=P.x+n.x,T=P.y+n.y,E=r[0]*S+r[4]*T+r[12],C=r[1]*S+r[5]*T+r[13],M=r[2]*S+r[6]*T+r[14],I=r[3]*S+r[7]*T+r[15],O=E+l,D=C+u,A=M+c,L=Math.max(I+h,1e-5),z=E+d,R=C+f,F=M+m,j=Math.max(I+v,1e-5),B=new g(O/L,D/L);B.z=A/L,x.push(B);var V=new g(z/j,R/j);V.z=F/j,w.push(V)}}catch(N){k.e(N)}finally{k.f()}o.push(x),s.push(w)}}catch(N){y.e(N)}finally{y.f()}return[o,s]}(t,i,n,r,a)}(a,n,h,c,u,o,f?s:null,d,m,a.center.lat,e.tileID.canonical),w=e.queryGeometry;return function(e,t,i){var n=1/0;cl(i,t)&&(n=Gc(i,t[0]));for(var r=0;r<t.length;r++)for(var a=t[r],o=e[r],s=0;s<a.length-1;s++){var l=a[s],u=[l,a[s+1],o[s+1],o[s],l];ll(i,u)&&(n=Math.min(n,Gc(i,u)))}return n!==1/0&&n}(x[0],x[1],w.isPointQuery()?w.screenBounds:w.screenGeometry)}}]),i}(Ds),line:function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e,Jc)).gradientVersion=0,n}return y(i,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){if("line-gradient"===e){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Ii,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}},{key:"gradientExpression",value:function(){return this._transitionablePaint._values["line-gradient"].value.expression}},{key:"recalculate",value:function(e,t){o(s(i.prototype),"recalculate",this).call(this,e,t),this.paint._values["line-floorwidth"]=Qc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}},{key:"createBucket",value:function(e){return new Yc(e)}},{key:"getProgramIds",value:function(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}},{key:"getProgramConfiguration",value:function(e){return new Ps(this,e)}},{key:"queryRadius",value:function(e){var t=e,i=eh(bl("line-width",this,t),bl("line-gap-width",this,t)),n=bl("line-offset",this,t);return i/2+Math.abs(n)+xl(this.paint.get("line-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,i,n,r,a){if(e.queryGeometry.isAboveHorizon)return!1;var o=wl(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),s=e.pixelToTileUnitsFactor/2*eh(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),l=this.paint.get("line-offset").evaluate(t,i);return l&&(n=function(e,t){for(var i=[],n=new g(0,0),r=0;r<e.length;r++){for(var a=e[r],o=[],s=0;s<a.length;s++){var l=a[s-1],u=a[s],c=a[s+1],h=0===s?n:u.sub(l)._unit()._perp(),p=s===a.length-1?n:c.sub(u)._unit()._perp(),d=h._add(p)._unit();d._mult(1/(d.x*p.x+d.y*p.y)),o.push(d._mult(t)._add(u))}i.push(o)}return i}(n,l*e.pixelToTileUnitsFactor)),function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];if(e.length>=3)for(var a=0;a<r.length;a++)if(yl(e,r[a]))return!0;if(hl(e,r,i))return!0}return!1}(o,n,s)}},{key:"isTileClipped",value:function(){return!0}}]),i}(Ds),symbol:Qd,background:function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,ef)}return y(i,[{key:"getProgramIds",value:function(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}}]),i}(Ds),raster:function(e){f(i,e);var t=m(i);function i(e){return v(this,i),t.call(this,e,tf)}return y(i,[{key:"getProgramIds",value:function(){return["raster"]}}]),i}(Ds),sky:function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e,rf))._updateColorRamp(),n}return y(i,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}},{key:"_updateColorRamp",value:function(){this.colorRamp=Su({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}},{key:"needsSkyboxCapture",value:function(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){var t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}},{key:"getCenter",value:function(e,t){if("atmosphere"===this.paint.get("sky-type")){var i=this.paint.get("sky-atmosphere-sun"),n=!i,r=e.style.light,a=r.properties.get("position");return n&&"viewport"===r.properties.get("anchor")&&H("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?af(a.azimuthal,90-a.polar,t):af(i[0],90-i[1],t)}var o=this.paint.get("sky-gradient-center");return af(o[0],90-o[1],t)}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!0}},{key:"markSkyboxValid",value:function(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}},{key:"hasOffscreenPass",value:function(){return!0}},{key:"getProgramIds",value:function(){var e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}]),i}(Ds)},sf=function(){function e(t,i,n,r){v(this,e),this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(i,r)}return y(e,[{key:"update",value:function(e,i,n){var r=e.width,a=e.height,o=this.context,s=o.gl,l=t.HTMLImageElement,u=t.HTMLCanvasElement,c=t.HTMLVideoElement,h=t.ImageData,p=t.ImageBitmap;if(s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!i||!1!==i.premultiply)),n||this.size&&this.size[0]===r&&this.size[1]===a){var d=n||{x:0,y:0},f=d.x,m=d.y;e instanceof l||e instanceof u||e instanceof c||e instanceof h||p&&e instanceof p?s.texSubImage2D(s.TEXTURE_2D,0,f,m,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,f,m,r,a,s.RGBA,s.UNSIGNED_BYTE,e.data)}else this.size=[r,a],e instanceof l||e instanceof u||e instanceof c||e instanceof h||p&&e instanceof p?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,r,a,0,this.format,s.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&s.generateMipmap(s.TEXTURE_2D)}},{key:"bind",value:function(e,t){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.useMipmap?e===i.NEAREST?i.NEAREST_MIPMAP_NEAREST:i.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}},{key:"isSizePowerOfTwo",value:function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}},{key:"destroy",value:function(){this.context.gl.deleteTexture(this.texture),this.texture=null}}]),e}(),lf=function(){function e(t,i){v(this,e),this.width=t,this.height=i,this.nextRow=0,this.image=new wu({width:t,height:i}),this.positions={},this.uploaded=!1}return y(e,[{key:"getDash",value:function(e,t){var i=this.getKey(e,t);return this.positions[i]}},{key:"trim",value:function(){var e=this.width,t=this.height=F(this.nextRow);this.image.resize({width:e,height:t})}},{key:"getKey",value:function(e,t){return e.join(",")+t}},{key:"getDashRanges",value:function(e,t,i){var n=[],r=e.length%2==1?-e[e.length-1]*i:0,a=e[0]*i,o=!0;n.push({left:r,right:a,isDash:o,zeroLength:0===e[0]});for(var s=e[0],l=1;l<e.length;l++){o=!o;var u=e[l];r=s*i,a=(s+=u)*i,n.push({left:r,right:a,isDash:o,zeroLength:0===u})}return n}},{key:"addRoundDash",value:function(e,t,i){for(var n=t/2,r=-i;r<=i;r++)for(var a=this.width*(this.nextRow+i+r),o=0,s=e[o],l=0;l<this.width;l++){l/s.right>1&&(s=e[++o]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),h=Math.min(u,c),p=void 0,d=r/i*(n+1);if(s.isDash){var f=n-Math.abs(d);p=Math.sqrt(h*h+f*f)}else p=n-Math.sqrt(h*h+d*d);this.image.data[a+l]=Math.max(0,Math.min(255,p+128))}}},{key:"addRegularDash",value:function(e,t){for(var i=e.length-1;i>=0;--i){var n=e[i],r=e[i+1];n.zeroLength?e.splice(i,1):r&&r.isDash===n.isDash&&(r.left=n.left,e.splice(i,1))}var a=e[0],o=e[e.length-1];a.isDash===o.isDash&&(a.left=o.left-this.width,o.right=a.right+this.width);for(var s=this.width*this.nextRow,l=0,u=e[l],c=0;c<this.width;c++){c/u.right>1&&(u=e[++l]);var h=Math.abs(c-u.left),p=Math.abs(c-u.right),d=Math.min(h,p);this.image.data[s+c]=Math.max(0,Math.min(255,(u.isDash?d:-d)+t+128))}}},{key:"addDash",value:function(e,t){var i=this.getKey(e,t);if(this.positions[i])return this.positions[i];var n="round"===t,r=n?7:0,a=2*r+1;if(this.nextRow+a>this.height)return H("LineAtlas out of space"),null;0===e.length&&e.push(1);for(var o=0,s=0;s<e.length;s++)e[s]<0&&(H("Negative value is found in line dasharray, replacing values with 0"),e[s]=0),o+=e[s];if(0!==o){var l=this.width/o,u=this.getDashRanges(e,this.width,l);n?this.addRoundDash(u,l,r):this.addRegularDash(u,"square"===t?.5*l:0)}var c=this.nextRow+r;this.nextRow+=a;var h={tl:[c,r],br:[o,0]};return this.positions[i]=h,h}}]),e}();Hr(lf,"LineAtlas");for(var uf=function(){function e(t){var i=this;v(this,e),this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){i._triggered=!1,i._callback()})}return y(e,[{key:"trigger",value:function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))}},{key:"remove",value:function(){this._channel=void 0,this._callback=function(){}}}]),e}(),cf=function(){function e(){v(this,e),this.tasks={},this.taskQueue=[],B(["process"],this),this.invoker=new uf(this.process),this.nextId=0}return y(e,[{key:"add",value:function(e,t){var i=this,n=this.nextId++,r=function(e){var t=e.type,i=e.isSymbolTile,n=e.zoom;return n=n||0,"message"===t?0:"maybePrepare"!==t||i?"parseTile"!==t||i?"parseTile"===t&&i?300-n:"maybePrepare"===t&&i?400-n:500:200-n:100-n}(t);if(0===r){X();try{e()}finally{}return{cancel:function(){}}}return this.tasks[n]={fn:e,metadata:t,priority:r,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:function(){delete i.tasks[n]}}}},{key:"process",value:function(){var e=this;X();try{if(this.taskQueue=this.taskQueue.filter((function(t){return!!e.tasks[t]})),!this.taskQueue.length)return;var t=this.pick();if(null===t)return;var i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}},{key:"pick",value:function(){for(var e=null,t=1/0,i=0;i<this.taskQueue.length;i++){var n=this.tasks[this.taskQueue[i]];n.priority<t&&(t=n.priority,e=i)}if(null===e)return null;var r=this.taskQueue[e];return this.taskQueue.splice(e,1),r}},{key:"remove",value:function(){this.invoker.remove()}}]),e}(),hf=function(){function e(t){v(this,e),this._stringToNumber={},this._numberToString=[];for(var i=0;i<t.length;i++){var n=t[i];this._stringToNumber[n]=i,this._numberToString[i]=n}}return y(e,[{key:"encode",value:function(e){return this._stringToNumber[e]}},{key:"decode",value:function(e){return this._numberToString[e]}}]),e}(),pf=["tile","layer","source","sourceLayer","state"],df=function(){function e(t,i,n,r,a){v(this,e),this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=n,this._y=r,this.properties=t.properties,this.id=a}return y(e,[{key:"geometry",get:function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry},set:function(e){this._geometry=e}},{key:"toJSON",value:function(){var e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);var t,i=p(pf);try{for(i.s();!(t=i.n()).done;){var n=t.value;void 0!==this[n]&&(e[n]=this[n])}}catch(r){i.e(r)}finally{i.f()}return e}}]),e}(),ff=32,mf=33,vf=new Uint16Array(8184),yf=0;yf<2046;yf++){var gf=yf+2,_f=0,bf=0,xf=0,wf=0,kf=0,Pf=0;for(1&gf?xf=wf=kf=ff:_f=bf=Pf=ff;(gf>>=1)>1;){var Sf=_f+xf>>1,Tf=bf+wf>>1;1&gf?(xf=_f,wf=bf,_f=kf,bf=Pf):(_f=xf,bf=wf,xf=kf,wf=Pf),kf=Sf,Pf=Tf}var Ef=4*yf;vf[Ef+0]=_f,vf[Ef+1]=bf,vf[Ef+2]=xf,vf[Ef+3]=wf}var Cf=new Uint16Array(2178),Mf=new Uint8Array(1089),If=new Uint16Array(1089);function Of(e){return 0===e?-.03125:32===e?.03125:0}var Df=co([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Af={type:2,extent:Rs,loadGeometry:function(){return[[new g(0,0),new g(8193,0),new g(8193,8193),new g(0,8193),new g(0,0)]]}},Lf=function(){function e(t,i,n,r,a){v(this,e),this.tileID=t,this.uid=z(),this.uses=0,this.tileSize=i,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=a,this.expiredRequestCount=0,this.state="loading",r&&r.transform&&(this.projection=r.transform.projection)}return y(e,[{key:"registerFadeDuration",value:function(e){var t=e+this.timeAdded;t<ce.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}},{key:"wasRequested",value:function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}},{key:"tileTransform",get:function(){return this._tileTransform||(this._tileTransform=_d(this.tileID.canonical,this.projection)),this._tileTransform}},{key:"loadVectorData",value:function(e,t,i){if(this.unloadVectorData(),this.state="loaded",e){for(var n in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var i={};if(!t)return i;var n,r=p(e);try{var a=function(){var e=n.value,r=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==r.length){e.layers=r,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return r.filter((function(t){return t.id===e}))[0]})));var a,o=p(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;i[s.id]=e}}catch(l){o.e(l)}finally{o.f()}}};for(r.s();!(n=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}return i}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var r=this.buckets[n];if(r instanceof Kd){if(this.hasSymbolBuckets=!0,!i)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var o=this.buckets[a];if(o instanceof Kd&&o.hasRTLText){this.hasRTLText=!0,Wa.isLoading()||Wa.isLoaded()||"deferred"!==Ua()||Ga();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Uo}},{key:"unloadVectorData",value:function(){if(this.hasData()){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}},{key:"getBucket",value:function(e){return this.buckets[e.id]}},{key:"upload",value:function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sf(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sf(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new sf(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}},{key:"prepare",value:function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}},{key:"queryRenderedFeatures",value:function(e,t,i,n,r,a,o,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:o,transform:a,params:r,tileTransform:this.tileTransform},e,t,i):{}}},{key:"querySourceFeatures",value:function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var n=i.loadVTLayers(),r=t?t.sourceLayer:"",a=n._geojsonTileLayer||n[r];if(a)for(var o=cr(t&&t.filter),s=this.tileID.canonical,l=s.z,u=s.x,c=s.y,h={z:l,x:u,y:c},p=0;p<a.length;p++){var d=a.feature(p);if(o.needGeometry){var f=rl(d,!0);if(!o.filter(new Ha(this.tileID.overscaledZ),f,this.tileID.canonical))continue}else if(!o.filter(new Ha(this.tileID.overscaledZ),d))continue;var m=i.getId(d,r),v=new df(d,l,u,c,m);v.tile=h,e.push(v)}}}},{key:"hasData",value:function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}},{key:"patternsLoaded",value:function(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}},{key:"setExpiryData",value:function(e){var t=this.expirationTime;if(e.cacheControl){var i=K(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var n=Date.now(),r=!1;if(this.expirationTime>n)r=!1;else if(t)if(this.expirationTime<t)r=!0;else{var a=this.expirationTime-t;a?this.expirationTime=n+Math.max(a,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}},{key:"getExpiryTimeout",value:function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}},{key:"setFeatureState",value:function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length&&t){var i=this.latestFeatureIndex.loadVTLayers(),n=t.style.listImages();for(var r in this.buckets)if(t.style.hasLayer(r)){var a=this.buckets[r],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=i[o],l=e[o];if(s&&l&&0!==Object.keys(l).length){if(a.update(l,s,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),a instanceof Yc||a instanceof cc){var u=t.style._getSourceCache(a.layers[0].source);t._terrain&&t._terrain.enabled&&u&&a.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(u.id,this.tileID)}var c=t&&t.style&&t.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(a)))}}}}},{key:"holdingForFade",value:function(){return void 0!==this.symbolFadeHoldUntil}},{key:"symbolFadeFinished",value:function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ce.now()}},{key:"clearFadeHold",value:function(){this.symbolFadeHoldUntil=void 0}},{key:"setHoldDuration",value:function(e){this.symbolFadeHoldUntil=ce.now()+e}},{key:"setTexture",value:function(e,t){var i=t.context,n=i.gl;this.texture=t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new sf(i,e,n.RGBA,{useMipmap:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),i.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax))}},{key:"setDependencies",value:function(e,t){var i,n={},r=p(t);try{for(r.s();!(i=r.n()).done;)n[i.value]=!0}catch(a){r.e(a)}finally{r.f()}this.dependencies[e]=n}},{key:"hasDependency",value:function(e,t){var i,n=p(e);try{for(n.s();!(i=n.n()).done;){var r=i.value,a=this.dependencies[r];if(a){var o,s=p(t);try{for(s.s();!(o=s.n()).done;)if(a[o.value])return!0}catch(l){s.e(l)}finally{s.f()}}}}catch(l){n.e(l)}finally{n.f()}return!1}},{key:"clearQueryDebugViz",value:function(){}},{key:"_makeDebugTileBoundsBuffers",value:function(e,t){if(t&&"mercator"!==t.name&&!this._tileDebugBuffer){for(var i=nl(Af,this.tileID.canonical,this.tileTransform)[0],n=new po,r=new Fo,a=0;a<i.length;a++){var o=i[a],s=o.x,l=o.y;n.emplaceBack(s,l),r.emplaceBack(a)}r.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(n,qp.members),this._tileDebugSegments=zs.simpleSegment(0,0,n.length,r.length)}}},{key:"_makeTileBoundsBuffers",value:function(e,t){if(!this._tileBoundsBuffer&&t&&"mercator"!==t.name){var i,n,r=nl(Af,this.tileID.canonical,this.tileTransform)[0];if(this.isRaster){var a=function(e,t){for(var i=_d(e,t),n=Math.pow(2,e.z),r=0;r<mf;r++)for(var a=0;a<mf;a++){var o=Hs((e.x+(a+Of(a))/ff)/n),s=Zs((e.y+(r+Of(r))/ff)/n),l=t.project(o,s),u=r*mf+a;Cf[2*u+0]=Math.round((l.x*i.scale-i.x)*Rs),Cf[2*u+1]=Math.round((l.y*i.scale-i.y)*Rs)}Mf.fill(0),If.fill(0);for(var c=2045;c>=0;c--){var h=4*c,p=vf[h+0],d=vf[h+1],f=vf[h+2],m=vf[h+3],v=p+f>>1,y=d+m>>1,g=v+y-d,_=y+p-v,b=d*mf+p,x=m*mf+f,w=y*mf+v,k=Math.hypot((Cf[2*b+0]+Cf[2*x+0])/2-Cf[2*w+0],(Cf[2*b+1]+Cf[2*x+1])/2-Cf[2*w+1])>=16;if(Mf[w]=Mf[w]||(k?1:0),c<1022){var P=(d+_>>1)*mf+(p+g>>1),S=(m+_>>1)*mf+(f+g>>1);Mf[w]=Mf[w]||Mf[P]||Mf[S]}}var T=new mo,E=new Mo,C=0;function M(e,t){var i=t*mf+e;return 0===If[i]&&(T.emplaceBack(Cf[2*i+0],Cf[2*i+1],e*Rs/ff,t*Rs/ff),If[i]=++C),If[i]-1}function I(e,t,i,n,r,a){var o=e+i>>1,s=t+n>>1;if(Math.abs(e-r)+Math.abs(t-a)>1&&Mf[s*mf+o])I(r,a,e,t,o,s),I(i,n,r,a,o,s);else{var l=M(e,t),u=M(i,n),c=M(r,a);E.emplaceBack(l,u,c)}}return I(0,0,ff,ff,ff,0),I(ff,ff,0,0,0,ff),{vertices:T,indices:E}}(this.tileID.canonical,t);i=a.vertices,n=a.indices}else{i=new mo,n=new Mo;var o,s=p(r);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=l.x,c=l.y;i.emplaceBack(u,c,0,0)}}catch(f){s.e(f)}finally{s.f()}for(var h=Cu(i.int16,void 0,4),d=0;d<h.length;d+=3)n.emplaceBack(h[d],h[d+1],h[d+2])}this._tileBoundsBuffer=e.createVertexBuffer(i,Df.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(n),this._tileBoundsSegments=zs.simpleSegment(0,0,i.length,n.length)}}},{key:"_makeGlobeTileDebugBuffers",value:function(e,t){if(!this._globeTileDebugBorderBuffer&&!this._globeTileDebugTextBuffer&&t&&"globe"===t.name){var i=this.tileID.canonical,n=cd(nd(i));this._makeGlobeTileDebugBorderBuffer(e,i,n),this._makeGlobeTileDebugTextBuffer(e,i,n)}}},{key:"_makeGlobeTileDebugBorderBuffer",value:function(e,t,i){var n=new po,r=new Fo,a=new fo,o=function(e,o,s,l,u){for(var c=(s-e)/(u-1),h=(l-o)/(u-1),p=n.length,d=0;d<u;d++){var f=e+d*c,m=o+d*h;n.emplaceBack(f,m);var v=ld(f,m,t),y=$l(v,v,i);a.emplaceBack(y[0],y[1],y[2]),r.emplaceBack(p+d)}},s=Rs;o(0,0,s,0,16),o(s,0,s,s,16),o(s,s,0,s,16),o(0,s,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(n,qp.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(a,Zp.members),this._tileDebugSegments=zs.simpleSegment(0,0,n.length,r.length)}},{key:"_makeGlobeTileDebugTextBuffer",value:function(e,t,i){var n=new po,r=new Mo,a=new fo,o=25;r.reserve(32),n.reserve(o),a.reserve(o);for(var s=function(e,t){return o*e+t},l=0;l<o;l++)for(var u=2048*l,c=0;c<o;c++){var h=2048*c;n.emplaceBack(h,u);var p=ld(h,u,t),d=$l(p,p,i);a.emplaceBack(d[0],d[1],d[2])}for(var f=0;f<4;f++)for(var m=0;m<4;m++){var v=s(f,m),y=s(f,m+1),g=s(f+1,m),_=s(f+1,m+1);r.emplaceBack(v,y,g),r.emplaceBack(g,y,_)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(r),this._tileDebugTextBuffer=e.createVertexBuffer(n,qp.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(a,Zp.members),this._tileDebugTextSegments=zs.simpleSegment(0,0,o,32)}}]),e}(),zf=function(){function e(){v(this,e),this.state={},this.stateChanges={},this.deletedStates={}}return y(e,[{key:"updateState",value:function(e,t,i){var n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},A(this.stateChanges[e][n],i),null===this.deletedStates[e])for(var r in this.deletedStates[e]={},this.state[e])r!==n&&(this.deletedStates[e][r]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][n])for(var a in this.deletedStates[e][n]={},this.state[e][n])i[a]||(this.deletedStates[e][n][a]=null);else for(var o in i)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][o]&&delete this.deletedStates[e][n][o]}},{key:"removeFeatureState",value:function(e,t,i){if(null!==this.deletedStates[e]){var n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(i in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][i]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}}},{key:"getState",value:function(e,t){var i=String(t),n=A({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var r=this.deletedStates[e][t];if(null===r)return{};for(var a in r)delete n[a]}return n}},{key:"initializeTileState",value:function(e,t){e.setFeatureState(this.state,t)}},{key:"coalesceChanges",value:function(e,t){var i={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var r={};for(var a in this.stateChanges[n])this.state[n][a]||(this.state[n][a]={}),A(this.state[n][a],this.stateChanges[n][a]),r[a]=this.state[n][a];i[n]=r}for(var o in this.deletedStates){this.state[o]=this.state[o]||{};var s={};if(null===this.deletedStates[o])for(var l in this.state[o])s[l]={},this.state[o][l]={};else for(var u in this.deletedStates[o]){if(null===this.deletedStates[o][u])this.state[o][u]={};else for(var c=0,h=Object.keys(this.deletedStates[o][u]);c<h.length;c++){var p=h[c];delete this.state[o][u][p]}s[u]=this.state[o][u]}i[o]=i[o]||{},A(i[o],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var d in e)e[d].setFeatureState(i,t)}}]),e}(),Rf=function(){function e(t){v(this,e),this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}return y(e,[{key:"getElevation",value:function(e,t){var i=this.toIdx(e,t);return{min:this.minimums[i],max:this.maximums[i]}}},{key:"isLeaf",value:function(e,t){return this.leaves[this.toIdx(e,t)]}},{key:"toIdx",value:function(e,t){return t*this.size+e}}]),e}();function Ff(e,t,i,n){for(var r=0,a=Number.MAX_VALUE,o=0;o<3;o++)if(Math.abs(n[o])<1e-15){if(i[o]<e[o]||i[o]>t[o])return null}else{var s=1/n[o],l=(e[o]-i[o])*s,u=(t[o]-i[o])*s;if(l>u){var c=l;l=u,u=c}if(l>r&&(r=l),u<a&&(a=u),r>a)return null}return r}function jf(e,t,i,n,r,a,o,s,l,u,c){var h=n-e,p=r-t,d=a-i,f=o-e,m=s-t,v=l-i,y=c[1]*v-c[2]*m,g=c[2]*f-c[0]*v,_=c[0]*m-c[1]*f,b=h*y+p*g+d*_;if(Math.abs(b)<1e-15)return null;var x=1/b,w=u[0]-e,k=u[1]-t,P=u[2]-i,S=(w*y+k*g+P*_)*x;if(S<0||S>1)return null;var T=k*d-P*p,E=P*h-w*d,C=w*p-k*h,M=(c[0]*T+c[1]*E+c[2]*C)*x;return M<0||S+M>1?null:(f*T+m*E+v*C)*x}function Bf(e,t,i){return(e-t)/(i-t)}function Vf(e,t,i,n,r,a,o,s,l){var u=1<<i,c=a-n,h=o-r,p=(e+1)/u*c+n,d=(t+0)/u*h+r,f=(t+1)/u*h+r;s[0]=(e+0)/u*c+n,s[1]=d,l[0]=p,l[1]=f}var Nf=function(){function e(t){if(v(this,e),this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],this.dem){var i=function(e){for(var t=Math.ceil(Math.log2(e.dim/8)),i=[],n=Math.ceil(Math.pow(2,t)),r=1/n,a=function(e,t,i,n,r){var a=n?1:0,o=(e+1)*i-a,s=t*i,l=(t+1)*i-a;r[0]=e*i,r[1]=s,r[2]=o,r[3]=l},o=new Rf(n),s=[],l=0;l<n*n;l++){a(l%n,Math.floor(l/n),r,!1,s);var u=Gf(s[0],s[1],e),c=Gf(s[2],s[1],e),h=Gf(s[2],s[3],e),p=Gf(s[0],s[3],e);o.minimums.push(Math.min(u,c,h,p)),o.maximums.push(Math.max(u,c,h,p)),o.leaves.push(1)}for(i.push(o),n/=2;n>=1;n/=2){var d=i[i.length-1];o=new Rf(n);for(var f=0;f<n*n;f++){a(f%n,Math.floor(f/n),2,!0,s);var m=d.getElevation(s[0],s[1]),v=d.getElevation(s[2],s[1]),y=d.getElevation(s[2],s[3]),g=d.getElevation(s[0],s[3]),_=d.isLeaf(s[0],s[1]),b=d.isLeaf(s[2],s[1]),x=d.isLeaf(s[2],s[3]),w=d.isLeaf(s[0],s[3]),k=Math.min(m.min,v.min,y.min,g.min),P=Math.max(m.max,v.max,y.max,g.max),S=_&&b&&x&&w;o.maximums.push(P),o.minimums.push(k),o.leaves.push(P-k<=5&&S?1:0)}i.push(o)}return i}(this.dem),n=i.length-1,r=i[n];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(i,0,0,n,0)}}return y(e,[{key:"raycastRoot",value:function(e,t,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Ff([e,t,-100],[i,n,this.maximums[0]*o],r,a)}},{key:"raycast",value:function(e,t,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;var s=this.raycastRoot(e,t,i,n,r,a,o);if(null==s)return null;for(var l=[],u=[],c=[],h=[],p=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];p.length>0;){var d=p.pop(),f=d.idx,m=d.t,v=d.nodex,y=d.nodey,g=d.depth;if(this.leaves[f]){Vf(v,y,g,e,t,i,n,c,h);var _=1<<g,b=(v+0)/_,x=(v+1)/_,w=(y+0)/_,k=(y+1)/_,P=Gf(b,w,this.dem)*o,S=Gf(x,w,this.dem)*o,T=Gf(x,k,this.dem)*o,E=Gf(b,k,this.dem)*o,C=jf(c[0],c[1],P,h[0],c[1],S,h[0],h[1],T,r,a),M=jf(h[0],h[1],T,c[0],h[1],E,c[0],c[1],P,r,a),I=Math.min(null!==C?C:Number.MAX_VALUE,null!==M?M:Number.MAX_VALUE);if(I!==Number.MAX_VALUE)return I;var O=ql([],r,a,m);if(Uf(P,S,E,T,Bf(O[0],c[0],h[0]),Bf(O[1],c[1],h[1]))>=O[2])return m}else{for(var D=0,A=0;A<this._siblingOffset.length;A++){Vf((v<<1)+this._siblingOffset[A][0],(y<<1)+this._siblingOffset[A][1],g+1,e,t,i,n,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[f]+A]*o;var L=Ff(c,h,r,a);if(null!=L){var z=L;l[A]=z;for(var R=!1,F=0;F<D&&!R;F++)z>=l[u[F]]&&(u.splice(F,0,A),R=!0);R||(u[D]=A),D++}}for(var j=0;j<D;j++){var B=u[j];p.push({idx:this.childOffsets[f]+B,t:l[B],nodex:(v<<1)+this._siblingOffset[B][0],nodey:(y<<1)+this._siblingOffset[B][1],depth:g+1})}}}return null}},{key:"_addNode",value:function(e,t,i){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}},{key:"_construct",value:function(e,t,i,n,r){if(1!==e[n].isLeaf(t,i)){this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);for(var a=n-1,o=e[a],s=0,l=0,u=0;u<this._siblingOffset.length;u++){var c=2*t+this._siblingOffset[u][0],h=2*i+this._siblingOffset[u][1],p=o.getElevation(c,h),d=o.isLeaf(c,h),f=this._addNode(p.min,p.max,d);d&&(s|=1<<u),l||(l=f)}for(var m=0;m<this._siblingOffset.length;m++)s&1<<m||this._construct(e,2*t+this._siblingOffset[m][0],2*i+this._siblingOffset[m][1],a,l+m)}}}]),e}();function Uf(e,t,i,n,r,a){return Oi(Oi(e,i,a),Oi(t,n,a),r)}function Gf(e,t,i){var n=i.dim,r=C(e*n-.5,0,n-1),a=C(t*n-.5,0,n-1),o=Math.floor(r),s=Math.floor(a),l=Math.min(o+1,n-1),u=Math.min(s+1,n-1);return Uf(i.get(o,s),i.get(l,s),i.get(o,u),i.get(l,u),r-o,a-s)}var Wf={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]},Hf=function(){function e(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(v(this,e),this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return H('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=i.height;var o=this.dim=i.height-2,s=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=n||"mapbox",this.borderReady=r,!r){for(var l=0;l<o;l++)s[this._idx(-1,l)]=s[this._idx(0,l)],s[this._idx(o,l)]=s[this._idx(o-1,l)],s[this._idx(l,-1)]=s[this._idx(l,0)],s[this._idx(l,o)]=s[this._idx(l,o-1)];s[this._idx(-1,-1)]=s[this._idx(0,0)],s[this._idx(o,-1)]=s[this._idx(o-1,0)],s[this._idx(-1,o)]=s[this._idx(0,o-1)],s[this._idx(o,o)]=s[this._idx(o-1,o-1)],a&&this._buildQuadTree()}}return y(e,[{key:"tree",get:function(){return this._tree||this._buildQuadTree(),this._tree}},{key:"_buildQuadTree",value:function(){this._tree=new Nf(this)}},{key:"get",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(e=C(e,-1,this.dim),t=C(t,-1,this.dim));var i=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[i],this.pixels[i+1],this.pixels[i+2])}},{key:"unpackVector",get:function(){return Wf[this.encoding]}},{key:"_idx",value:function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}},{key:"_unpackMapbox",value:function(e,t,i){return(256*e*256+256*t+i)/10-1e4}},{key:"_unpackTerrarium",value:function(e,t,i){return 256*e+t+i/256-32768}},{key:"getPixels",value:function(){return new ku({width:this.stride,height:this.stride},this.pixels)}},{key:"backfillBorder",value:function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var n=t*this.dim,r=t*this.dim+this.dim,a=i*this.dim,o=i*this.dim+this.dim;switch(t){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:a=o-1;break;case 1:o=a+1}for(var s=-t*this.dim,l=-i*this.dim,u=a;u<o;u++)for(var c=n;c<r;c++){var h=4*this._idx(c,u),p=4*this._idx(c+s,u+l);this.pixels[h+0]=e.pixels[p+0],this.pixels[h+1]=e.pixels[p+1],this.pixels[h+2]=e.pixels[p+2],this.pixels[h+3]=e.pixels[p+3]}}},{key:"onDeserialize",value:function(){this._tree&&(this._tree.dem=this)}}],[{key:"getUnpackVector",value:function(e){return Wf[e]}},{key:"pack",value:function(t,i){var n=[0,0,0,0],r=e.getUnpackVector(i),a=Math.floor((t+r[3])/r[2]);return n[2]=a%256,a=Math.floor(a/256),n[1]=a%256,a=Math.floor(a/256),n[0]=a,n}}]),e}();Hr(Hf,"DEMData"),Hr(Nf,"DemMinMaxQuadTree",{omit:["dem"]});var Zf=function(){function e(t,i){v(this,e),this.max=t,this.onRemove=i,this.reset()}return y(e,[{key:"reset",value:function(){for(var e in this.data){var t,i=p(this.data[e]);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}}catch(r){i.e(r)}finally{i.f()}}return this.data={},this.order=[],this}},{key:"add",value:function(e,t,i){var n=this,r=e.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var a={value:t,timeout:void 0};if(void 0!==i&&(a.timeout=setTimeout((function(){n.remove(e,a)}),i)),this.data[r].push(a),this.order.push(r),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}},{key:"has",value:function(e){return e.wrapped().key in this.data}},{key:"getAndRemove",value:function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}},{key:"_getAndRemoveByKey",value:function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}},{key:"getByKey",value:function(e){var t=this.data[e];return t?t[0].value:null}},{key:"get",value:function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}},{key:"remove",value:function(e,t){if(!this.has(e))return this;var i=e.wrapped().key,n=void 0===t?0:this.data[i].indexOf(t),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}},{key:"setMaxSize",value:function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}},{key:"filter",value:function(e){var t=[];for(var i in this.data){var n,r=p(this.data[i]);try{for(r.s();!(n=r.n()).done;){var a=n.value;e(a.value)||t.push(a)}}catch(u){r.e(u)}finally{r.f()}}for(var o=0,s=t;o<s.length;o++){var l=s[o];this.remove(l.value.tileID,l)}}}]),e}(),qf=y((function e(t,i,n){v(this,e),this.func=t,this.mask=i,this.range=n}));qf.ReadOnly=!1,qf.ReadWrite=!0,qf.disabled=new qf(519,qf.ReadOnly,[0,1]);var Xf=7680,Kf=y((function e(t,i,n,r,a,o){v(this,e),this.test=t,this.ref=i,this.mask=n,this.fail=r,this.depthFail=a,this.pass=o}));Kf.disabled=new Kf({func:519,mask:0},0,0,Xf,Xf,Xf);var Yf=y((function e(t,i,n){v(this,e),this.blendFunction=t,this.blendColor=i,this.mask=n}));Yf.Replace=[1,0],Yf.disabled=new Yf(Yf.Replace,Ot.transparent,[!1,!1,!1,!1]),Yf.unblended=new Yf(Yf.Replace,Ot.transparent,[!0,!0,!0,!0]),Yf.alphaBlended=new Yf([1,771],Ot.transparent,[!0,!0,!0,!0]);var $f=1029,Jf=2305,Qf=y((function e(t,i,n){v(this,e),this.enable=t,this.mode=i,this.frontFace=n}));Qf.disabled=new Qf(!1,$f,Jf),Qf.backCCW=new Qf(!0,$f,Jf),Qf.backCW=new Qf(!0,$f,2304),Qf.frontCW=new Qf(!0,1028,2304),Qf.frontCCW=new Qf(!0,1028,Jf);var em=function(e){f(i,e);var t=m(i);function i(e,n,a){var o;return v(this,i),(o=t.call(this)).id=e,o._onlySymbols=a,n.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),n.on("error",(function(){o._sourceErrored=!0})),o._source=n,o._tiles={},o._cache=new Zf(0,o._unloadTile.bind(r(o))),o._timers={},o._cacheTimers={},o._minTileCacheSize=n.minTileCacheSize,o._maxTileCacheSize=n.maxTileCacheSize,o._loadedParentTiles={},o._coveredTiles={},o._state=new zf,o._isRaster="raster"===o._source.type||"raster-dem"===o._source.type||"custom"===o._source.type&&"raster"===o._source._dataType,o}return y(i,[{key:"onAdd",value:function(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}},{key:"loaded",value:function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}},{key:"getSource",value:function(){return this._source}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}}},{key:"_loadTile",value:function(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}},{key:"_unloadTile",value:function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))}},{key:"_abortTile",value:function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))}},{key:"serialize",value:function(){return this._source.serialize()}},{key:"prepare",value:function(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(var t in this._tiles){var i=this._tiles[t];this._source.prepareTile(i)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,i.tileID),i.upload(e),i.prepare(this.map.style.imageManager)}else for(var n in this._tiles){var r=this._tiles[n];r.upload(e),r.prepare(this.map.style.imageManager)}}},{key:"getIds",value:function(){return D(this._tiles).map((function(e){return e.tileID})).sort(tm).map((function(e){return e.key}))}},{key:"getRenderableIds",value:function(e){var t=this,i=[];for(var n in this._tiles)this._isIdRenderable(+n,e)&&i.push(this._tiles[n]);return e?i.sort((function(e,i){var n=e.tileID,r=i.tileID,a=new g(n.canonical.x,n.canonical.y)._rotate(t.transform.angle),o=new g(r.canonical.x,r.canonical.y)._rotate(t.transform.angle);return n.overscaledZ-r.overscaledZ||o.y-a.y||o.x-a.x})).map((function(e){return e.tileID.key})):i.map((function(e){return e.tileID})).sort(tm).map((function(e){return e.key}))}},{key:"hasRenderableParent",value:function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}},{key:"_isIdRenderable",value:function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}},{key:"reload",value:function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}},{key:"_reloadTile",value:function(e,t){var i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))}},{key:"_tileLoaded",value:function(e,t,i,n){if(n)if(e.state="errored",404!==n.status)this._source.fire(new it(n,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){var r=this.map.painter.terrain;this.update(this.transform,r.getScaledDemTileSize(),!0),r.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=ce.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new tt("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}},{key:"_backfillDEM",value:function(e){for(var t=this.getRenderableIds(),i=0;i<t.length;i++){var n=t[i];if(e.neighboringTiles&&e.neighboringTiles[n]){var r=this.getTileByID(n);a(e,r),a(r,e)}}function a(e,t){if(e.dem&&!e.dem.borderReady){e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;var i=t.tileID.canonical.x-e.tileID.canonical.x,n=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}}},{key:"getTile",value:function(e){return this.getTileByID(e.key)}},{key:"getTileByID",value:function(e){return this._tiles[e]}},{key:"_retainLoadedChildren",value:function(e,t,i,n){for(var r in this._tiles){var a=this._tiles[r];if(!(n[r]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>i)){for(var o=a.tileID;a&&a.tileID.overscaledZ>t+1;){var s=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[s.key])&&a.hasData()&&(o=s)}for(var l=o;l.overscaledZ>t;)if(e[(l=l.scaledTo(l.overscaledZ-1)).key]){n[o.key]=o;break}}}}},{key:"findLoadedParent",value:function(e,t){if(e.key in this._loadedParentTiles){var i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=t?i:null}for(var n=e.overscaledZ-1;n>=t;n--){var r=e.scaledTo(n),a=this._getLoadedTile(r);if(a)return a}}},{key:"_getLoadedTile",value:function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}},{key:"updateCacheSize",value:function(e,t){t=t||this._source.tileSize;var i=Math.ceil(e.width/t)+1,n=Math.ceil(e.height/t)+1,r=Math.floor(i*n*5),a="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,a):a;this._cache.setMaxSize(o)}},{key:"handleWrapJump",value:function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var i={};for(var n in this._tiles){var r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),i[r.tileID.key]=r}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var o in this._tiles)this._setTileReloadTimer(+o,this._tiles[o])}}},{key:"update",value:function(e,t,n){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused&&!this.transform.freezeTileCoverage&&(!this.usedForTerrain||n)){var a;this.updateCacheSize(e,t),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new Vc(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(a=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter((function(e){return r._source.hasTile(e)})))):a=[];var o=this._updateRetainedTiles(a);if(im(this._source.type)&&0!==a.length){for(var s={},l={},u=0,c=Object.keys(o);u<c.length;u++){var h=c[u],d=o[h],f=this._tiles[h];if(f&&!(f.fadeEndTime&&f.fadeEndTime<=ce.now())){var m=this.findLoadedParent(d,Math.max(d.overscaledZ-i.maxOverzooming,this._source.minzoom));m&&(this._addTile(m.tileID),s[m.tileID.key]=m.tileID),l[h]=d}}var v=a[a.length-1].overscaledZ;for(var y in this._tiles){var g=this._tiles[y];if(!o[y]&&g.hasData())for(var _=g.tileID;_.overscaledZ>v;){_=_.scaledTo(_.overscaledZ-1);var b=this._tiles[_.key];if(b&&b.hasData()&&l[_.key]){o[y]=g.tileID;break}}}for(var x in s)o[x]||(this._coveredTiles[x]=!0,o[x]=s[x])}for(var w in o)this._tiles[w].clearFadeHold();var k,P=function(e,t){var i=[];for(var n in e)n in t||i.push(n);return i}(this._tiles,o),S=p(P);try{for(S.s();!(k=S.n()).done;){var T=k.value,E=this._tiles[T];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+T)}}catch(C){S.e(C)}finally{S.f()}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}}},{key:"releaseSymbolFadeTiles",value:function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}},{key:"_updateRetainedTiles",value:function(e){var t={};if(0===e.length)return t;var n,r={},a=e.reduce((function(e,t){return Math.min(e,t.overscaledZ)}),1/0),o=e[0].overscaledZ,s=Math.max(o-i.maxOverzooming,this._source.minzoom),l=Math.max(o+i.maxUnderzooming,this._source.minzoom),u={},c=p(e);try{for(c.s();!(n=c.n()).done;){var h=n.value,d=this._addTile(h);t[h.key]=h,d.hasData()||a<this._source.maxzoom&&(u[h.key]=h)}}catch(P){c.e(P)}finally{c.f()}this._retainLoadedChildren(u,a,l,t);var f,m=p(e);try{for(m.s();!(f=m.n()).done;){var v=f.value,y=this._tiles[v.key];if(!y.hasData()){if(v.canonical.z>=this._source.maxzoom){var g=v.children(this._source.maxzoom)[0],_=this.getTile(g);if(_&&_.hasData()){t[g.key]=g;continue}}else{var b=v.children(this._source.maxzoom);if(t[b[0].key]&&t[b[1].key]&&t[b[2].key]&&t[b[3].key])continue}for(var x=y.wasRequested(),w=v.overscaledZ-1;w>=s;--w){var k=v.scaledTo(w);if(r[k.key])break;if(r[k.key]=!0,!(y=this.getTile(k))&&x&&(y=this._addTile(k)),y&&(t[k.key]=k,x=y.wasRequested(),y.hasData()))break}}}}catch(P){m.e(P)}finally{m.f()}return t}},{key:"_updateLoadedParentTileCache",value:function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],i=void 0,n=this._tiles[e].tileID;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}t.push(n.key);var r=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(r))break;n=r}for(var a=0,o=t;a<o.length;a++){var s=o[a];this._loadedParentTiles[s]=i}}}},{key:"_addTile",value:function(e){var t=this._tiles[e.key];if(t)return this._source.prepareTile&&this._source.prepareTile(t),t;(t=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));var i=Boolean(t);if(!i){var n=this.map?this.map.painter:null;t=new Lf(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,n,this._isRaster),this._source.prepareTile&&this._source.prepareTile(t)||this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,i||this._source.fire(new tt("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}},{key:"_setTileReloadTimer",value:function(e,t){var i=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((function(){i._reloadTile(e,"expired"),delete i._timers[e]}),n))}},{key:"_removeTile",value:function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}},{key:"clearTiles",value:function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}},{key:"tilesIn",value:function(e,t,i){var n=[],r=this.transform;if(!r)return n;var a="globe"===r.projection.name,o=Us(r.center.lng);for(var s in this._tiles){var l=this._tiles[s];if(i&&l.clearQueryDebugViz(),!l.holdingForFade()){var u=void 0;if(a){var h=l.tileID.canonical;if(0===h.z){var d=[Math.abs(C.apply(void 0,[o].concat(c(nm(h,-1))))-o),Math.abs(C.apply(void 0,[o].concat(c(nm(h,1))))-o)];u=[0,2*d.indexOf(Math.min.apply(Math,d))-1]}else{var f=[Math.abs(C.apply(void 0,[o].concat(c(nm(h,-1))))-o),Math.abs(C.apply(void 0,[o].concat(c(nm(h,0))))-o),Math.abs(C.apply(void 0,[o].concat(c(nm(h,1))))-o)];u=[f.indexOf(Math.min.apply(Math,f))-1]}}else u=[0];var m,v=p(u);try{for(v.s();!(m=v.n()).done;){var y=m.value,g=e.containsTile(l,r,t,y);g&&n.push(g)}}catch(_){v.e(_)}finally{v.f()}}}return n}},{key:"getVisibleCoordinates",value:function(e){var t,i=this,n=this.getRenderableIds(e).map((function(e){return i._tiles[e].tileID})),r=p(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped())}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"hasTransition",value:function(){if(this._source.hasTransition())return!0;if(im(this._source.type))for(var e in this._tiles){var t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=ce.now())return!0}return!1}},{key:"setFeatureState",value:function(e,t,i){this._state.updateState(e=e||"_geojsonTileLayer",t,i)}},{key:"removeFeatureState",value:function(e,t,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,i)}},{key:"getFeatureState",value:function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}},{key:"setDependencies",value:function(e,t,i){var n=this._tiles[e];n&&n.setDependencies(t,i)}},{key:"reloadTilesForDependencies",value:function(e,t){for(var i in this._tiles)this._tiles[i].hasDependency(e,t)&&this._reloadTile(+i,"reloading");this._cache.filter((function(i){return!i.hasDependency(e,t)}))}},{key:"_preloadTiles",value:function(e,t){var i,n=this,r=new Map,a=Array.isArray(e)?e:[e],o=this.map.painter.terrain,s=this.usedForTerrain&&o?o.getScaledDemTileSize():this._source.tileSize,l=p(a);try{for(l.s();!(i=l.n()).done;){var u,c=i.value,h=c.coveringTiles({tileSize:s,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),d=p(h);try{for(d.s();!(u=d.n()).done;){var f=u.value;r.set(f.key,f)}}catch(m){d.e(m)}finally{d.f()}this.usedForTerrain&&c.updateElevation(!1)}}catch(m){l.e(m)}finally{l.f()}O(Array.from(r.values()),(function(e,t){var i=new Lf(e,n._source.tileSize*e.overscaleFactor(),n.transform.tileZoom,n.map.painter,n._isRaster);n._loadTile(i,(function(e){"raster-dem"===n._source.type&&i.dem&&n._backfillDEM(i),t(e,i)}))}),t)}}]),i}(nt);function tm(e,t){var i=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-i||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function im(e){return"raster"===e||"image"===e||"video"===e}function nm(e,t){var i=1<<e.z;return[e.x/i+t,(e.x+1)/i+t]}em.maxOverzooming=10,em.maxUnderzooming=3;var rm=function(){function e(t,i,n){v(this,e),this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=n}return y(e,[{key:"tileCoordToPixel",value:function(e,t){var i=t*this._scale+this._offset[1],n=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(i);return new g(n,r)}},{key:"getElevationAt",value:function(e,t,i,n){var r=e*this._scale+this._offset[0],a=t*this._scale+this._offset[1],o=Math.floor(r),s=Math.floor(a),l=this._dem;return n=!!n,i?Oi(Oi(l.get(o,s,n),l.get(o,s+1,n),a-s),Oi(l.get(o+1,s,n),l.get(o+1,s+1,n),a-s),r-o):l.get(o,s,n)}},{key:"getElevationAtPixel",value:function(e,t,i){return this._dem.get(e,t,!!i)}},{key:"getMeterToDEM",value:function(e){return(1<<this._demTile.tileID.canonical.z)*Ws(1,e)*this._dem.stride}}],[{key:"create",value:function(t,i,n){var r=n||t.findDEMTileFor(i);if(r&&r.dem){var a=r.dem,o=r.tileID,s=1<<i.canonical.z-o.canonical.z;return new e(r,r.tileSize/Rs/s,[(i.canonical.x/s-o.canonical.x)*a.dim,(i.canonical.y/s-o.canonical.y)*a.dim])}}}]),e}(),am=function(){function e(t,i){v(this,e),this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ur(Rs,16,0),this.featureIndexArray=new Yo,this.promoteId=i}return y(e,[{key:"insert",value:function(e,t,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r,a);for(var s=this.grid,l=0;l<t.length;l++){for(var u=t[l],c=[1/0,1/0,-1/0,-1/0],h=0;h<u.length;h++){var p=u[h];c[0]=Math.min(c[0],p.x),c[1]=Math.min(c[1],p.y),c[2]=Math.max(c[2],p.x),c[3]=Math.max(c[3],p.y)}c[0]<Rs&&c[1]<Rs&&c[2]>=0&&c[3]>=0&&s.insert(o,c[0],c[1],c[2],c[3])}}},{key:"loadVTLayers",value:function(){if(!this.vtLayers)for(var e in this.vtLayers=new Sc.VectorTile(new bh(this.rawTileData)).layers,this.sourceLayerCoder=new hf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={},this.vtLayers)this.vtFeatures[e]=[];return this.vtLayers}},{key:"query",value:function(e,t,i,n){var r=this;this.loadVTLayers();var a=e.params||{},o=cr(a.filter),s=e.tileResult,l=e.transform,u=s.bufferedTilespaceBounds,c=this.grid.query(u.min.x,u.min.y,u.max.x,u.max.y,(function(e,t,i,n){return gl(s.bufferedTilespaceGeometry,e,t,i,n)}));c.sort(sm);var h=null;l.elevation&&c.length>0&&(h=rm.create(l.elevation,this.tileID));for(var p,d={},f=function(l){var u=c[l];if(u===p)return"continue";p=u;var f=r.featureIndexArray.get(u),m=null;r.loadMatchingFeature(d,f,o,a.layers,a.availableImages,t,i,n,(function(t,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return m||(m=nl(t,r.tileID.canonical,e.tileTransform)),i.queryIntersectsFeature(s,t,n,m,r.z,e.transform,e.pixelPosMatrix,h,a)}))},m=0;m<c.length;m++)f(m);return d}},{key:"loadMatchingFeature",value:function(e,t,i,n,r,a,o,s,l){var u=t.featureIndex,c=t.bucketIndex,h=t.sourceLayerIndex,p=t.layoutVertexArrayOffset,d=this.bucketLayerIDs[c];if(!n||function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!0;return!1}(n,d)){var f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(u);if(i.needGeometry){var v=rl(m,!0);if(!i.filter(new Ha(this.tileID.overscaledZ),v,this.tileID.canonical))return}else if(!i.filter(new Ha(this.tileID.overscaledZ),m))return;for(var y=this.getId(m,f),g=0;g<d.length;g++){var _=d[g];if(!(n&&n.indexOf(_)<0)){var b=a[_];if(b){var x={};void 0!==y&&s&&(x=s.getState(b.sourceLayer||"_geojsonTileLayer",y));var w=A({},o[_]);w.paint=om(w.paint,b.paint,m,x,r),w.layout=om(w.layout,b.layout,m,x,r);var k=!l||l(m,b,x,p);if(k){var P=new df(m,this.z,this.x,this.y,y);P.layer=w;var S=e[_];void 0===S&&(S=e[_]=[]),S.push({featureIndex:u,feature:P,intersectionZ:k})}}}}}}},{key:"lookupSymbolFeatures",value:function(e,t,i,n,r,a,o,s){var l={};this.loadVTLayers();var u,c=cr(r),h=p(e);try{for(h.s();!(u=h.n()).done;){var d=u.value;this.loadMatchingFeature(l,{bucketIndex:i,sourceLayerIndex:n,featureIndex:d,layoutVertexArrayOffset:0},c,a,o,s,t)}}catch(f){h.e(f)}finally{h.f()}return l}},{key:"loadFeature",value:function(e){var t=e.featureIndex,i=e.sourceLayerIndex;this.loadVTLayers();var n=this.sourceLayerCoder.decode(i),r=this.vtFeatures[n];if(r[t])return r[t];var a=this.vtLayers[n].feature(t);return r[t]=a,a}},{key:"hasLayer",value:function(e){var t,i=p(this.bucketLayerIDs);try{for(i.s();!(t=i.n()).done;){var n,r=t.value,a=p(r);try{for(a.s();!(n=a.n()).done;)if(e===n.value)return!0}catch(o){a.e(o)}finally{a.f()}}}catch(o){i.e(o)}finally{i.f()}return!1}},{key:"getId",value:function(e,t){var i=e.id;return this.promoteId&&"boolean"==typeof(i=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(i=Number(i)),i}}]),e}();function om(e,t,i,n,r){return N(e,(function(e,a){var o=t instanceof Qa?t.get(a):null;return o&&o.evaluate?o.evaluate(i,n,r):o}))}function sm(e,t){return t-e}Hr(am,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var lm=y((function e(t){v(this,e);var i={},n=[];for(var r in t){var a=t[r],o=i[r]={};for(var s in a.glyphs){var l=a.glyphs[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u=l.metrics.localGlyph?2:1,c={x:0,y:0,w:l.bitmap.width+2*u,h:l.bitmap.height+2*u};n.push(c),o[s]=c}}}var h=Gh(n),p=h.w,d=h.h,f=new wu({width:p||1,height:d||1});for(var m in t){var y=t[m];for(var g in y.glyphs){var _=y.glyphs[+g];if(_&&0!==_.bitmap.width&&0!==_.bitmap.height){var b=i[m][g],x=_.metrics.localGlyph?2:1;wu.copy(_.bitmap,f,{x:0,y:0},{x:b.x+x,y:b.y+x},_.bitmap)}}}this.image=f,this.positions=i}));Hr(lm,"GlyphAtlas");var um=function(){function e(t){v(this,e),this.tileID=new Vc(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=_d(t.tileID.canonical,t.projection),this.projection=t.projection}return y(e,[{key:"parse",value:function(e,t,i,n,r){var a=this;this.status="parsing",this.data=e,this.collisionBoxArray=new Uo;var o=new hf(Object.keys(e.layers).sort()),s=new am(this.tileID,this.promoteId);s.bucketLayerIDs=[];var l,u,c,h,d={},f=new lf(256,256),m={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:f,availableImages:i},v=t.familiesBySource[this.source];for(var y in v){var g=e.layers[y];if(g){var _,b=!1,x=!1,w=p(v[y]);try{for(w.s();!(_=w.n()).done;)"symbol"===_.value[0].type?b=!0:x=!0}catch(j){w.e(j)}finally{w.f()}if((!0!==this.isSymbolTile||b)&&(!1!==this.isSymbolTile||x)){1===g.version&&H('Vector tile source "'.concat(this.source,'" layer "').concat(y,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));for(var k=o.encode(y),P=[],S=0;S<g.length;S++){var T=g.feature(S),E=s.getId(T,y);P.push({feature:T,id:E,index:S,sourceLayerIndex:k})}var C,M=p(v[y]);try{for(M.s();!(C=M.n()).done;){var I=C.value,O=I[0];void 0!==this.isSymbolTile&&"symbol"===O.type!==this.isSymbolTile||O.minzoom&&this.zoom<Math.floor(O.minzoom)||O.maxzoom&&this.zoom>=O.maxzoom||"none"!==O.visibility&&(cm(I,this.zoom,i),(d[O.id]=O.createBucket({index:s.bucketLayerIDs.length,layers:I,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:k,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:i})).populate(P,m,this.tileID.canonical,this.tileTransform),s.bucketLayerIDs.push(I.map((function(e){return e.id}))))}}catch(j){M.e(j)}finally{M.f()}}}}f.trim();var A={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},L=N(m.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(L).length?n.send("getGlyphs",{uid:this.uid,stacks:L},(function(e,t){l||(l=e,u=t,F.call(a))}),void 0,!1,A):u={};var z=Object.keys(m.iconDependencies);z.length?n.send("getImages",{icons:z,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){l||(l=e,c=t,F.call(a))}),void 0,!1,A):c={};var R=Object.keys(m.patternDependencies);function F(){if(l)return r(l);if(u&&c&&h){var e=new lm(u),t=new Hh(c,h);for(var n in d){var a=d[n];a instanceof Kd?(cm(a.layers,this.zoom,i),Rp(a,u,e.positions,c,t.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection)):a.hasPattern&&(a instanceof Yc||a instanceof cc||a instanceof Dc)&&(cm(a.layers,this.zoom,i),a.addFeatures(m,this.tileID.canonical,t.patternPositions,i,this.tileTransform))}this.status="done",r(null,{buckets:D(d).filter((function(e){return!e.isEmpty()})),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:f,imageAtlas:t,glyphMap:this.returnDependencies?u:null,iconMap:this.returnDependencies?c:null,glyphPositions:this.returnDependencies?e.positions:null})}}R.length?n.send("getImages",{icons:R,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){l||(l=e,h=t,F.call(a))}),void 0,!1,A):h={},F.call(this)}}]),e}();function cm(e,t,i){var n,r=new Ha(t),a=p(e);try{for(a.s();!(n=a.n()).done;)n.value.recalculate(r,i)}catch(o){a.e(o)}finally{a.f()}}var hm=function(){function e(t){v(this,e),this.entries={},this.scheduler=t}return y(e,[{key:"request",value:function(e,t,i,n){var r=this,a=this.entries[e]=this.entries[e]||{callbacks:[]};if(a.result){var o=h(a.result,2),s=o[0],l=o[1];return this.scheduler?this.scheduler.add((function(){n(s,l)}),t):n(s,l),function(){}}return a.callbacks.push(n),a.cancel||(a.cancel=i((function(i,n){a.result=[i,n];var o,s=p(a.callbacks);try{var l=function(){var e=o.value;r.scheduler?r.scheduler.add((function(){e(i,n)}),t):e(i,n)};for(s.s();!(o=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}setTimeout((function(){return delete r.entries[e]}),3e3)}))),function(){a.result||(a.callbacks=a.callbacks.filter((function(e){return e!==n})),a.callbacks.length||(a.cancel(),delete r.entries[e]))}}}]),e}();function pm(e,t,i){var n=JSON.stringify(e.request);return e.data&&(this.deduped.entries[n]={result:[null,e.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(function(t){var n=He(e.request,(function(e,n,r,a){e?t(e):n&&t(null,{vectorTile:i?void 0:new Sc.VectorTile(new bh(n)),rawData:n,cacheControl:r,expires:a})}));return function(){n.cancel(),t()}}),t)}e.ARRAY_TYPE=El,e.AUTH_ERR_MSG=ye,e.Aabb=pu,e.Actor=function(){function e(i,n,r){v(this,e),this.target=i,this.parent=n,this.mapId=r,this.callbacks={},this.cancelCallbacks={},B(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=X()?i:t,this.scheduler=new cf}return y(e,[{key:"send",value:function(e,t,i,n){var r=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=o,this.callbacks[s]=i);var l=$(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:e,hasCallback:!!i,targetMapId:n,mustQueue:a,sourceMapId:this.mapId,data:Kr(t,l)},l),{cancel:function(){i&&delete r.callbacks[s],r.target.postMessage({id:s,type:"<cancel>",targetMapId:n,sourceMapId:r.mapId})}}}},{key:"receive",value:function(e){var t=this,i=e.data,n=i.id;if(n&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r.cancel()}else if(i.mustQueue||X()){var a=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add((function(){return t.processTask(n,i)}),a&&a.metadata||{type:"message"})}else this.processTask(n,i)}},{key:"processTask",value:function(e,t){var i=this;if("<response>"===t.type){var n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(Yr(t.error)):n(null,Yr(t.data)))}else{var r=$(this.globalScope)?void 0:[],a=t.hasCallback?function(t,n){delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:t?Kr(t):null,data:Kr(n,r)},r)}:function(e){},o=Yr(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,o,a);else if(this.parent.getWorkerSource){var s=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,s[0],o.source)[s[1]](o,a)}else a(new Error("Could not find function ".concat(t.type)))}}},{key:"remove",value:function(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}]),e}(),e.CanonicalTileID=jc,e.Color=Ot,e.ColorMode=Yf,e.CullFaceMode=Qf,e.DEMData=Hf,e.DataConstantProperty=eo,e.DedupedRequest=hm,e.DepthMode=qf,e.EXTENT=Rs,e.Elevation=function(){function e(){v(this,e)}return y(e,[{key:"isDataAvailableAtPoint",value:function(e){var t=this._source();if(!t||e.y<0||e.y>1)return!1;var i=t.getSource().maxzoom,n=1<<i,r=Math.floor(e.x),a=Math.floor((e.x-r)*n),o=Math.floor(e.y*n),s=this.findDEMTileFor(new Vc(i,r,i,a,o));return!(!s||!s.dem)}},{key:"getAtPointOrZero",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}},{key:"getAtPoint",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];null==t&&(t=null);var n=this._source();if(!n)return t;if(e.y<0||e.y>1)return t;var r=n.getSource().maxzoom,a=1<<r,o=Math.floor(e.x),s=e.x-o,l=new Vc(r,o,r,Math.floor(s*a),Math.floor(e.y*a)),u=this.findDEMTileFor(l);if(!u||!u.dem)return t;var c=u.dem,h=1<<u.tileID.canonical.z,p=(s*h-u.tileID.canonical.x)*c.dim,d=(e.y*h-u.tileID.canonical.y)*c.dim,f=Math.floor(p),m=Math.floor(d);return(i?this.exaggeration():1)*Oi(Oi(c.get(f,m),c.get(f,m+1),d-m),Oi(c.get(f+1,m),c.get(f+1,m+1),d-m),p-f)}},{key:"getAtTileOffset",value:function(e,t,i){var n=1<<e.canonical.z;return this.getAtPointOrZero(new Ks(e.wrap+(e.canonical.x+t/Rs)/n,(e.canonical.y+i/Rs)/n))}},{key:"getAtTileOffsetFunc",value:function(e,t,i,n){var r=this;return function(a){var o=r.getAtTileOffset(e,a.x,a.y),s=n.upVector(e.canonical,a.x,a.y);return Zl(s,s,o*n.upVectorScale(e.canonical,t,i).metersToTile),s}}},{key:"getForTilePoints",value:function(e,t,i,n){var r=this,a=rm.create(this,e,n);return!!a&&(t.forEach((function(e){e[2]=r.exaggeration()*a.getElevationAt(e[0],e[1],i)})),!0)}},{key:"getMinMaxForTile",value:function(e){var t=this.findDEMTileFor(e);if(!t||!t.dem)return null;for(var i=t.dem.tree,n=t.tileID,r=1<<e.canonical.z-n.canonical.z,a=e.canonical.x/r-n.canonical.x,o=e.canonical.y/r-n.canonical.y,s=0,l=0;l<e.canonical.z-n.canonical.z&&!i.leaves[s];l++){a*=2,o*=2;var u=2*Math.floor(o)+Math.floor(a);s=i.childOffsets[s]+u,a%=1,o%=1}return{min:this.exaggeration()*i.minimums[s],max:this.exaggeration()*i.maximums[s]}}},{key:"getMinElevationBelowMSL",value:function(){throw new Error("Pure virtual method called.")}},{key:"raycast",value:function(e,t,i){throw new Error("Pure virtual method called.")}},{key:"pointCoordinate",value:function(e){throw new Error("Pure virtual method called.")}},{key:"_source",value:function(){throw new Error("Pure virtual method called.")}},{key:"exaggeration",value:function(){throw new Error("Pure virtual method called.")}},{key:"findDEMTileFor",value:function(e){throw new Error("Pure virtual method called.")}},{key:"visibleDemTiles",get:function(){throw new Error("Getter must be implemented in subclass.")}}]),e}(),e.ErrorEvent=it,e.EvaluationParameters=Ha,e.Event=tt,e.Evented=nt,e.FillExtrusionBucket=Dc,e.Frustum=hu,e.FrustumCorners=cu,e.GLOBE_METERS_TO_ECEF=Kp,e.GLOBE_RADIUS=Xp,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=6,e.GLOBE_ZOOM_THRESHOLD_MIN=5,e.GlobeSharedBuffers=function(){function e(t){v(this,e),this._createGrid(t),this._createPoles(t)}return y(e,[{key:"destroy",value:function(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();var e,t=p(this._poleSegments);try{for(t.s();!(e=t.n()).done;)e.value.destroy()}catch(o){t.e(o)}finally{t.f()}var i,n=p(this._gridSegments);try{for(n.s();!(i=n.n()).done;)i.value.destroy()}catch(o){n.e(o)}finally{n.f()}if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();var r,a=p(this._wireframeSegments);try{for(a.s();!(r=a.n()).done;)r.value.destroy()}catch(o){a.e(o)}finally{a.f()}}}},{key:"_createGrid",value:function(e){for(var t=new po,i=new Mo,n=65,r=0;r<n;r++)for(var a=0;a<n;a++)t.emplaceBack(a,r);this._gridSegments=[];for(var o=0,s=0;o<Yp.length;o++){for(var l=Yp[o],u=0;u<l;u++)for(var c=0;c<64;c++){var h=u*n+c;i.emplaceBack(h+1,h,h+n),i.emplaceBack(h+n,h+n+1,h+1)}var p=64*l*2;this._gridSegments.push(zs.simpleSegment(0,s,(l+1)*n,p)),s+=p}this._gridBuffer=e.createVertexBuffer(t,qp.members),this._gridIndexBuffer=e.createIndexBuffer(i,!0)}},{key:"_createPoles",value:function(e){for(var t=new Mo,i=0;i<=64;i++)t.emplaceBack(0,i+1,i+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);var n=new Ao,r=new Ao;this._poleSegments=[];for(var a=0,o=0;a<5;a++){var s=1<<a,l=512*s/Math.PI/2,u=360/s;n.emplaceBack(0,-l,0,0,0,.5,0),r.emplaceBack(0,-l,0,0,0,.5,1);for(var c=0;c<=64;c++){var p=c/64,d=Oi(0,u,p),f=od(vd,yd,d,l),m=h(f,3),v=m[0],y=m[1],g=m[2];n.emplaceBack(v,y,g,0,0,p,0),r.emplaceBack(v,y,g,0,0,p,1)}this._poleSegments.push(zs.simpleSegment(o,0,66,64)),o+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(n,Hp,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(r,Hp,!1)}},{key:"getGridBuffers",value:function(e){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[e]]}},{key:"getPoleBuffers",value:function(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}},{key:"getWirefameBuffers",value:function(e,t){if(!this._wireframeSegments){var i=new Ro,n=64,r=n+1;this._wireframeSegments=[];for(var a=0,o=0;a<Yp.length;a++){for(var s=Yp[a],l=0;l<s;l++)for(var u=0;u<n;u++){var c=l*r+u;i.emplaceBack(c,c+1),i.emplaceBack(c,c+r),i.emplaceBack(c,c+r+1)}var h=s*n*3;this._wireframeSegments.push(zs.simpleSegment(0,o,(s+1)*r,h)),o+=h}this._wireframeIndexBuffer=e.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}}]),e}(),e.GlyphManager=xp,e.ImagePosition=Wh,e.LineAtlas=lf,e.LngLat=Bs,e.LngLatBounds=Fs,e.LocalGlyphMode=bp,e.MAX_MERCATOR_LATITUDE=Xs,e.MercatorCoordinate=Ks,e.ONE_EM=lh,e.OverscaledTileID=Vc,e.Properties=ao,e.RGBAImage=ku,e.Ray=uu,e.RequestManager=function(){function e(t,i,n){v(this,e),this._transformRequestFn=t,this._customAccessToken=i,this._silenceAuthErrors=!!n,this._createSkuToken()}return y(e,[{key:"_createSkuToken",value:function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ve,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}},{key:"_isSkuTokenExpired",value:function(){return Date.now()>this._skuTokenExpiresAt}},{key:"transformRequest",value:function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}},{key:"normalizeStyleURL",value:function(e,t){if(!ge(e))return e;var i=xe(e);return i.path="/styles/v1".concat(i.path),this._makeAPIURL(i,this._customAccessToken||t)}},{key:"normalizeGlyphsURL",value:function(e,t){if(!ge(e))return e;var i=xe(e);return i.path="/fonts/v1".concat(i.path),this._makeAPIURL(i,this._customAccessToken||t)}},{key:"normalizeSourceURL",value:function(e,t,i,n){if(!ge(e))return e;var r=xe(e);return r.path="/v4/".concat(r.authority,".json"),r.params.push("secure"),i&&r.params.push("language=".concat(i)),n&&r.params.push("worldview=".concat(n)),this._makeAPIURL(r,this._customAccessToken||t)}},{key:"normalizeSpriteURL",value:function(e,t,i,n){var r=xe(e);return ge(e)?(r.path="/styles/v1".concat(r.path,"/sprite").concat(t).concat(i),this._makeAPIURL(r,this._customAccessToken||n)):(r.path+="".concat(t).concat(i),we(r))}},{key:"normalizeTileURL",value:function(e,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!ge(e))return e;var n=xe(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(t||i&&"raster"!==n.authority&&512===i?"@2x":"").concat(pe.supported?".webp":"$1")),"raster"===n.authority?n.path="/".concat(he.RASTER_URL_PREFIX).concat(n.path):(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/".concat(he.TILE_URL_VERSION).concat(n.path));var r=this._customAccessToken||function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var n=t.value.match(/^access_token=(.*)$/);if(n)return n[1]}}catch(r){i.e(r)}finally{i.f()}return null}(n.params)||he.ACCESS_TOKEN;return he.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&n.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(n,r)}},{key:"canonicalizeTileURL",value:function(e,t){var i=xe(e);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return e;var n="mapbox://";i.path.match(/^\/raster\/v1\//)?n+="raster/".concat(i.path.replace("/".concat(he.RASTER_URL_PREFIX,"/"),"")):n+="tiles/".concat(i.path.replace("/".concat(he.TILE_URL_VERSION,"/"),""));var r=i.params;return t&&(r=r.filter((function(e){return!e.match(/^access_token=/)}))),r.length&&(n+="?".concat(r.join("&"))),n}},{key:"canonicalizeTileset",value:function(e,t){var i,n=!!t&&ge(t),r=[],a=p(e.tiles||[]);try{for(a.s();!(i=a.n()).done;){var o=i.value;_e(o)?r.push(this.canonicalizeTileURL(o,n)):r.push(o)}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"_makeAPIURL",value:function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=xe(he.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){var r=e.params.indexOf("secure");r>=0&&e.params.splice(r,1)}if("/"!==n.path&&(e.path="".concat(n.path).concat(e.path)),!he.REQUIRE_ACCESS_TOKEN)return we(e);if(t=t||he.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error("An API access token is required to use Mapbox GL. ".concat(i));if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(i))}return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token=".concat(t||"")),we(e)}}]),e}(),e.ResourceType=Ne,e.SegmentVector=zs,e.SourceCache=em,e.StencilMode=Kf,e.StructArrayLayout1ui2=Fo,e.StructArrayLayout2f1f2i16=To,e.StructArrayLayout2i4=po,e.StructArrayLayout2ui4=Ro,e.StructArrayLayout3f12=Co,e.StructArrayLayout3ui6=Mo,e.StructArrayLayout4i8=mo,e.StructArrayLayout5f20=Lo,e.Texture=sf,e.Tile=Lf,e.Transitionable=Xa,e.Uniform1f=ps,e.Uniform1i=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=0,r}return y(i,[{key:"set",value:function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}}]),i}(hs),e.Uniform2f=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=[0,0],r}return y(i,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}}]),i}(hs),e.Uniform3f=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=[0,0,0],r}return y(i,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}}]),i}(hs),e.Uniform4f=ds,e.UniformColor=fs,e.UniformMatrix2f=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=ys,r}return y(i,[{key:"set",value:function(e){for(var t=0;t<4;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix2fv(this.location,!1,e);break}}}]),i}(hs),e.UniformMatrix3f=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=vs,r}return y(i,[{key:"set",value:function(e){for(var t=0;t<9;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix3fv(this.location,!1,e);break}}}]),i}(hs),e.UniformMatrix4f=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e,n)).current=ms,r}return y(i,[{key:"set",value:function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}}]),i}(hs),e.UnwrappedTileID=Bc,e.ValidationError=tr,e.VectorTileWorkerSource=function(e){f(i,e);var t=m(i);function i(e,n,r,a,o){var s;return v(this,i),(s=t.call(this)).actor=e,s.layerIndex=n,s.availableImages=r,s.loadVectorData=o||pm,s.loading={},s.loaded={},s.deduped=new hm(e.scheduler),s.isSpriteLoaded=a,s.scheduler=e.scheduler,s}return y(i,[{key:"loadTile",value:function(e,t){var i=this,n=e.uid,r=e&&e.request,a=r&&r.collectResourceTiming,o=this.loading[n]=new um(e);o.abort=this.loadVectorData(e,(function(s,l){var u=!i.loading[n];if(delete i.loading[n],u||s||!l)return o.status="done",u||(i.loaded[n]=o),t(s);var c=l.rawData,h={};l.expires&&(h.expires=l.expires),l.cacheControl&&(h.cacheControl=l.cacheControl),o.vectorTile=l.vectorTile||new Sc.VectorTile(new bh(c));var p=function(){o.parse(o.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(e,i){if(e||!i)return t(e);var n={};if(a){var o=te(r);o.length>0&&(n.resourceTiming=JSON.parse(JSON.stringify(o)))}t(null,A({rawTileData:c.slice(0)},i,h,n))}))};i.isSpriteLoaded?p():i.once("isSpriteLoaded",(function(){i.scheduler?i.scheduler.add(p,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):p()})),i.loaded=i.loaded||{},i.loaded[n]=o}))}},{key:"reloadTile",value:function(e,t){var i=this,n=this.loaded,r=e.uid,a=this;if(n&&n[r]){var o=n[r];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain,o.projection=e.projection,o.tileTransform=_d(e.tileID.canonical,e.projection);var s=function(e,n){var r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,a.layerIndex,i.availableImages,a.actor,r)),t(e,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}},{key:"abortTile",value:function(e,t){var i=e.uid,n=this.loading[i];n&&(n.abort&&n.abort(),delete this.loading[i]),t()}},{key:"removeTile",value:function(e,t){var i=this.loaded,n=e.uid;i&&i[n]&&delete i[n],t()}}]),i}(nt),e.WritingMode=Zh,e.ZoomHistory=$r,e.add=Nl,e.addDynamicAttributes=Hd,e.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-s*u,e[1]=r*u-n*c,e[2]=n*s-r*o,e[3]=s*l-a*c,e[4]=i*c-r*l,e[5]=r*a-i*s,e[6]=a*u-o*l,e[7]=n*l-i*u,e[8]=i*o-n*a,e},e.asyncAll=O,e.bezier=T,e.bindAll=B,e.boundsAttributes=Df,e.bufferConvexPolygon=function(e,t){for(var i=[],n=0;n<e.length;n++){var r=I(n-1,-1,e.length-1),a=I(n+1,-1,e.length-1),o=e[n],s=e[a],l=e[r].sub(o).unit(),u=s.sub(o).unit(),c=u.angleWithSep(l.x,l.y),h=l.add(u).unit().mult(-1*t/Math.sin(c/2));i.push(o.add(h))}return i},e.cacheEntryPossiblyAdded=function(e){++Ve>Le&&(e.getActor().send("enforceCacheSizeLimit",Ae),Ve=0)},e.calculateGlobeLabelMatrix=function(e,t){var i=e.point,n=pd(i.x,i.y,e.worldSize/e._projectionScaler,0,0);return Il(n,n,hd(nd(t)))},e.calculateGlobeMatrix=function(e){var t=e.point,i=t.x,n=t.y,r=e._center,a=r.lng,o=r.lat;return pd(i,n,e.worldSize,a,o)},e.calculateGlobeMercatorMatrix=function(e){var t=e.worldSize,i=e.point,n=Ws(1,e.center.lat)*t,r=e.pixelsPerMeter,a=t/(n/e.pixelsPerMeter),o=Ml(new Float64Array(16));return Ol(o,o,[i.x,i.y,0]),Dl(o,o,[a,a,r]),Float32Array.from(o)},e.circumferenceAtLatitude=Ns,e.clamp=C,e.clearTileCache=function(e){var i=[];for(var n in ze)i.push(t.caches.delete(n)),delete ze[n];e&&Promise.all(i).catch(e).then((function(){return e()}))},e.clipLine=vp,e.clone=function(e){var t=new El(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=G,e.collisionCircleLayout=sh,e.config=he,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new El(16);return El!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=Cl,e.createExpression=Kn,e.createLayout=co,e.createStyleLayer=function(e){return"custom"===e.type?new nf(e):new of[e.type](e)},e.cross=Yl,e.degToRad=w,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},e.dot=Kl,e.ease=E,e.easeCubicInOut=S,e.emitValidationErrors=Nr,e.endsWith=V,e.enforceCacheSizeLimit=function(e){for(var t in ze)Fe(t),ze[t].then((function(t){t.keys().then((function(i){for(var n=0;n<i.length-e;n++)t.delete(i[n])}))}))},e.evaluateSizeForFeature=hh,e.evaluateSizeForZoom=ph,e.evaluateVariableOffset=zp,e.evented=Na,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=ce,e.exported$1=pe,e.extend=A,e.extend$1=at,e.fillExtrusionHeightLift=Lc,e.filterObject=U,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=i+i,s=n+n,l=r+r,u=i*o,c=n*o,h=n*s,p=r*o,d=r*s,f=r*l,m=a*o,v=a*s,y=a*l;return e[0]=1-h-f,e[1]=c+y,e[2]=p-v,e[3]=0,e[4]=c-y,e[5]=1-u-f,e[6]=d+m,e[7]=0,e[8]=p+v,e[9]=d-m,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.furthestTileCorner=function(e){var t=Math.round((e+45+360)%360/90)%4;return P[t]},e.getAABBPointSquareDist=function(e,t,i){for(var n=0,r=0;r<2;++r){var a=i?i[r]:0;e[r]>a&&(n+=(e[r]-a)*(e[r]-a)),t[r]<a&&(n+=(a-t[r])*(a-t[r]))}return n},e.getAnchorAlignment=rp,e.getAnchorJustification=Fp,e.getBounds=function(e){var t,i=1/0,n=1/0,r=-1/0,a=-1/0,o=p(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;i=Math.min(i,s.x),n=Math.min(n,s.y),r=Math.max(r,s.x),a=Math.max(a,s.y)}}catch(l){o.e(l)}finally{o.f()}return{min:new g(i,n),max:new g(r,a)}},e.getColumn=Q,e.getGridMatrix=function(e,t,i){var n=h(t,2),r=n[0],a=n[1],o=.015625;return[0,(a[1]-r[1])*o,1<<e.z,(a[0]-r[0])/Yp[i],0,e.y,r[0],r[1],o]},e.getImage=Je,e.getJSON=function(e,t){return We(A(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){var t=80.051129;e=C(e,-80.051129,t)/t*90;var i=Math.pow(Math.abs(Math.sin(w(e))),3);return Math.round(i*(Yp.length-1))},e.getMapSessionAPI=Oe,e.getPerformanceMeasurement=te,e.getProjection=Vd,e.getRTLTextPluginStatus=Ua,e.getReferrer=Ge,e.getTilePoint=function(e,t){var i=t.x,n=t.y;return new g(((i-(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0))*e.scale-e.x)*Rs,(n*e.scale-e.y)*Rs)},e.getTileVec3=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Vl(((t.x-i)*e.scale-e.x)*Rs,(t.y*e.scale-e.y)*Rs,qs(t.z,t.y))},e.getVideo=function(e,i){var n=t.document.createElement("video");n.muted=!0,n.onloadstart=function(){i(null,n)};for(var r=0;r<e.length;r++){var a=t.document.createElement("source");Xe(e[r])||(n.crossOrigin="Anonymous"),a.src=e[r],n.appendChild(a)}return{cancel:function(){}}},e.globeCenterToScreenPoint=function(e){var t=[0,0,0],i=Ml(new Float64Array(16));return Il(i,e.pixelMatrix,e.globeMatrix),$l(t,t,i),new g(t[0],t[1])},e.globeECEFOrigin=function(e,t){var i=[0,0,0];return $l(i,i,cd(nd(t.canonical))),$l(i,i,e),i},e.globeNormalizeECEF=cd,e.globePixelsToTileUnits=function(e,t){return Rs/(512*Math.pow(2,e))*ud(nd(t))},e.globePoleMatrixForTile=function(e,t,i){var n=Ml(new Float64Array(16)),r=1<<e,a=360*(t/r-.5),o=i.point,s=i.worldSize/(i.tileSize*r);return Ol(n,n,[o.x,o.y,-i.worldSize/Math.PI/2]),Dl(n,n,[s,s,s]),Al(n,n,w(-i._center.lat)),Ll(n,n,w(-i._center.lng+a)),Float32Array.from(n)},e.globeTileBounds=nd,e.globeTileLatLngCorners=ad,e.globeTiltAtLngLat=fd,e.globeToMercatorTransition=dd,e.globeUseCustomAntiAliasing=function(e,t,i){var n=dd(i.zoom),r=e.style.map._antialias,a=!!t.extStandardDerivatives,o=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===n&&!r&&!o&&a},e.identity=Ml,e.identity$1=ou,e.invert=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],d=t[11],f=t[12],m=t[13],v=t[14],y=t[15],g=i*s-n*o,_=i*l-r*o,b=i*u-a*o,x=n*l-r*s,w=n*u-a*s,k=r*u-a*l,P=c*m-h*f,S=c*v-p*f,T=c*y-d*f,E=h*v-p*m,C=h*y-d*m,M=p*y-d*v,I=g*M-_*C+b*E+x*T-w*S+k*P;return I?(e[0]=(s*M-l*C+u*E)*(I=1/I),e[1]=(r*C-n*M-a*E)*I,e[2]=(m*k-v*w+y*x)*I,e[3]=(p*w-h*k-d*x)*I,e[4]=(l*T-o*M-u*S)*I,e[5]=(i*M-r*T+a*S)*I,e[6]=(v*b-f*k-y*_)*I,e[7]=(c*k-p*b+d*_)*I,e[8]=(o*C-s*T+u*P)*I,e[9]=(n*T-i*C-a*P)*I,e[10]=(f*w-m*b+y*g)*I,e[11]=(h*b-c*w-d*g)*I,e[12]=(s*S-o*E-l*P)*I,e[13]=(i*E-n*S+r*P)*I,e[14]=(m*_-f*x-v*g)*I,e[15]=(c*x-h*_+p*g)*I,e):null},e.isLngLatBehindGlobe=function(e,t){return fd(e,t)>Math.PI/2*1.01},e.isMapAuthenticated=function(e){return De.has(e)},e.isMapboxURL=ge,e.isSafariWithAntialiasingBug=function(e){var t=e.navigator?e.navigator.userAgent:null;return!!$(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=Zs,e.len=iu,e.length=Bl,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.loadVectorTile=pm,e.makeRequest=We,e.mapValue=function(e,t,i,n,r){return C((e-t)/(i-t)*(r-n)+n,n,r)},e.mercatorXfromLng=Us,e.mercatorYfromLat=Gs,e.mercatorZfromAltitude=Ws,e.mul=Rl,e.mul$1=tu,e.multiply=Il,e.multiply$1=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=i[0],d=i[1],f=i[2],m=i[3],v=i[4],y=i[5],g=i[6],_=i[7],b=i[8];return e[0]=p*n+d*o+f*u,e[1]=p*r+d*s+f*c,e[2]=p*a+d*l+f*h,e[3]=m*n+v*o+y*u,e[4]=m*r+v*s+y*c,e[5]=m*a+v*l+y*h,e[6]=g*n+_*o+b*u,e[7]=g*r+_*s+b*c,e[8]=g*a+_*l+b*h,e},e.multiply$2=Gl,e.nextPowerOfTwo=F,e.normalize=Xl,e.normalize$1=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=i*i+n*n+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=i*o,e[1]=n*o,e[2]=r*o,e[3]=a*o,e},e.number=Oi,e.ortho=function(e,t,i,n,r,a,o){var s=1/(t-i),l=1/(n-r),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*s,e[13]=(r+n)*l,e[14]=(o+a)*u,e[15]=1,e},e.pbf=bh,e.perspective=function(e,t,i,n,r){var a,o=1/Math.tan(t/2);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+n)*(a=1/(n-r)),e[14]=2*r*n*a):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){for(var i={},n=0;n<t.length;n++){var r=t[n];r in e&&(i[r]=e[r])}return i},e.plugin=Wa,e.pointGeometry=g,e.polygonContainsPoint=yl,e.polygonIntersectsBox=gl,e.polygonIntersectsPolygon=ll,e.polygonizeBounds=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=new g(i,i),a=e.sub(r),o=t.add(r),s=[a,new g(o.x,a.y),o,new g(a.x,o.y)];return n&&s.push(a.clone()),s},e.posAttributes=qp,e.postMapLoadEvent=Me,e.postTurnstileEvent=Ee,e.potpack=Gh,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=k,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:Fa,pluginURL:ja}),Na.on("pluginStateChange",e),e},e.removeAuthState=function(e){De.delete(e)},e.renderColorRamp=Su,e.resample=$s,e.rotateX=Al,e.rotateX$1=su,e.rotateY=Ll,e.rotateY$1=lu,e.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+u*n,e[1]=o*r+c*n,e[2]=s*r+h*n,e[3]=l*r+p*n,e[4]=u*r-a*n,e[5]=c*r-o*n,e[6]=h*r-s*n,e[7]=p*r-l*n,e},e.rotateZ$1=function(e,t,i){i*=.5;var n=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=n*l+r*s,e[1]=r*l-n*s,e[2]=a*l+o*s,e[3]=o*l-a*s,e},e.scale=Dl,e.scale$1=nu,e.scale$2=Zl,e.scaleAndAdd=ql,e.setCacheLimits=function(e,t){Ae=e,Le=t},e.setColumn=function(e,t,i){e[4*t+0]=i[0],e[4*t+1]=i[1],e[4*t+2]=i[2],e[4*t+3]=i[3]},e.setRTLTextPlugin=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Fa===Aa||Fa===La||Fa===za)throw new Error("setRTLTextPlugin cannot be called multiple times.");ja=ce.resolveURL(e),Fa=Aa,Ra=t,Va(),i||Ga()},e.smoothstep=M,e.spec=rt,e.storeAuthState=function(e,t){t?De.add(e):De.delete(e)},e.sub=eu,e.subtract=Ul,e.symbolSize=dh,e.tileAABB=function(e,t,i,n,r,a,o,s,l){if("globe"===l.name)return rd(e,t,new jc(i,n,r));var u=_d({z:i,x:n,y:r},l);return new pu([(a+u.x/u.scale)*t,t*(u.y/u.scale),o],[(a+u.x2/u.scale)*t,t*(u.y2/u.scale),s])},e.tileTransform=_d,e.transformMat3=function(e,t,i){var n=t[0],r=t[1],a=t[2];return e[0]=n*i[0]+r*i[3]+a*i[6],e[1]=n*i[1]+r*i[4]+a*i[7],e[2]=n*i[2]+r*i[5]+a*i[8],e},e.transformMat4=$l,e.transformMat4$1=ru,e.transformQuat=Jl,e.translate=Ol,e.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=Ba,e.uniqueId=z,e.updateGlobeVertexNormal=function(e,t,i,n,r){var a=5*t+2;e.float32[a+0]=i,e.float32[a+1]=n,e.float32[a+2]=r},e.validateCustomStyleLayer=function(e){var t=[],i=e.id;return void 0===i&&t.push({message:"layers.".concat(i,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(i,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(i,': property "renderingMode" must be either "2d" or "3d"')}),t},e.validateFilter=function(e){return Vr(wr(e))},e.validateFog=function(e){return Vr(Ar(e))},e.validateLayer=function(e){return Vr(Er(e))},e.validateLight=function(e){return Vr(Or(e))},e.validateSource=function(e){return Vr(Ir(e))},e.validateStyle=Fr,e.validateTerrain=function(e){return Vr(Dr(e))},e.values=D,e.vectorTile=Sc,e.version=ue,e.warnOnce=H,e.window=t,e.wrap=I})),g(["./shared"],(function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){var i,n="[",r=p(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;n+="".concat(t(a),",")}}catch(c){r.e(c)}finally{r.f()}return"".concat(n,"]")}var o,s="{",l=p(Object.keys(e).sort());try{for(l.s();!(o=l.n()).done;){var u=o.value;s+="".concat(u,":").concat(t(e[u]),",")}}catch(c){l.e(c)}finally{l.f()}return"".concat(s,"}")}function i(i){var n,r="",a=p(e.refProperties);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+="/".concat(t(i[o]))}}catch(s){a.e(s)}finally{a.f()}return r}var n=function(){function t(e){v(this,t),this.keyCache={},e&&this.replace(e)}return y(t,[{key:"replace",value:function(e){this._layerConfigs={},this._layers={},this.update(e,[])}},{key:"update",value:function(t,n){var r,a=this,o=p(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;this._layerConfigs[s.id]=s,(this._layers[s.id]=e.createStyleLayer(s)).compileFilter(),this.keyCache[s.id]&&delete this.keyCache[s.id]}}catch(x){o.e(x)}finally{o.f()}var l,u=p(n);try{for(u.s();!(l=u.n()).done;){var c=l.value;delete this.keyCache[c],delete this._layerConfigs[c],delete this._layers[c]}}catch(x){u.e(x)}finally{u.f()}this.familiesBySource={};var h,d=function(e,t){for(var n={},r=0;r<e.length;r++){var a=t&&t[e[r].id]||i(e[r]);t&&(t[e[r].id]=a);var o=n[a];o||(o=n[a]=[]),o.push(e[r])}var s=[];for(var l in n)s.push(n[l]);return s}(e.values(this._layerConfigs),this.keyCache),f=p(d);try{for(f.s();!(h=f.n()).done;){var m=h.value.map((function(e){return a._layers[e.id]})),v=m[0];if("none"!==v.visibility){var y=v.source||"",g=this.familiesBySource[y];g||(g=this.familiesBySource[y]={});var _=v.sourceLayer||"_geojsonTileLayer",b=g[_];b||(b=g[_]=[]),b.push(m)}}}catch(x){f.e(x)}finally{f.f()}}}]),t}(),r=function(){function t(){v(this,t)}return y(t,[{key:"loadTile",value:function(t,i){var n=t.uid,r=t.encoding,a=t.rawImageData,o=t.padding,s=t.buildQuadTree,l=e.window.ImageBitmap&&a instanceof e.window.ImageBitmap?this.getImageData(a,o):a;i(null,new e.DEMData(n,l,r,o<1,s))}},{key:"getImageData",value:function(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var i=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),i}}]),t}(),a=function e(t,i){var n,r=t&&t.type;if("FeatureCollection"===r)for(n=0;n<t.features.length;n++)e(t.features[n],i);else if("GeometryCollection"===r)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],i);else if("Feature"===r)e(t.geometry,i);else if("Polygon"===r)l(t.coordinates,i);else if("MultiPolygon"===r)for(n=0;n<t.coordinates.length;n++)l(t.coordinates[n],i);return t};function l(e,t){if(0!==e.length){u(e[0],t);for(var i=1;i<e.length;i++)u(e[i],!t)}}function u(e,t){for(var i=0,n=0,r=0,a=e.length,o=a-1;r<a;o=r++){var s=(e[r][0]-e[o][0])*(e[o][1]+e[r][1]),l=i+s;n+=Math.abs(i)>=Math.abs(s)?i-l+s:s-l+i,i=l}i+n>=0!=!!t&&e.reverse()}var c=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,d=function(){function t(i){v(this,t),this._feature=i,this.extent=e.EXTENT,this.type=i.type,this.properties=i.tags,"id"in i&&!isNaN(i.id)&&(this.id=parseInt(i.id,10))}return y(t,[{key:"loadGeometry",value:function(){if(1===this._feature.type){var t,i=[],n=p(this._feature.geometry);try{for(n.s();!(t=n.n()).done;){var r=t.value;i.push([new e.pointGeometry(r[0],r[1])])}}catch(f){n.e(f)}finally{n.f()}return i}var a,o=[],s=p(this._feature.geometry);try{for(s.s();!(a=s.n()).done;){var l,u=a.value,c=[],h=p(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;c.push(new e.pointGeometry(d[0],d[1]))}}catch(f){h.e(f)}finally{h.f()}o.push(c)}}catch(f){s.e(f)}finally{s.f()}return o}},{key:"toGeoJSON",value:function(e,t,i){return c.call(this,e,t,i)}}]),t}(),g=function(){function t(i){v(this,t),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=i.length,this._features=i}return y(t,[{key:"feature",value:function(e){return new d(this._features[e])}}]),t}(),_=e.vectorTile.VectorTileFeature,b=x;function x(e,t){this.options=t||{},this.features=e,this.length=e.length}function w(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}x.prototype.feature=function(e){return new w(this.features[e],this.options.extent)},w.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var i=0;i<t.length;i++){for(var n=t[i],r=[],a=0;a<n.length;a++)r.push(new e.pointGeometry(n[a][0],n[a][1]));this.geometry.push(r)}return this.geometry},w.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,i=-1/0,n=1/0,r=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),r=Math.max(r,l.y)}return[t,n,i,r]},w.prototype.toGeoJSON=_.prototype.toGeoJSON;var k=S,P=b;function S(t){var i=new e.pbf;return function(e,t){for(var i in e.layers)t.writeMessage(3,T,e.layers[i])}(t,i),i.finish()}function T(e,t){var i;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<e.length;i++)n.feature=e.feature(i),t.writeMessage(2,E,n);var r=n.keys;for(i=0;i<r.length;i++)t.writeStringField(3,r[i]);var a=n.values;for(i=0;i<a.length;i++)t.writeMessage(4,D,a[i])}function E(e,t){var i=e.feature;void 0!==i.id&&t.writeVarintField(1,i.id),t.writeMessage(2,C,e),t.writeVarintField(3,i.type),t.writeMessage(4,O,i)}function C(e,t){var i=e.feature,n=e.keys,r=e.values,a=e.keycache,o=e.valuecache;for(var s in i.properties){var l=i.properties[s],u=a[s];if(null!==l){void 0===u&&(n.push(s),a[s]=u=n.length-1),t.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,p=o[h];void 0===p&&(r.push(l),o[h]=p=r.length-1),t.writeVarint(p)}}}function M(e,t){return(t<<3)+(7&e)}function I(e){return e<<1^e>>31}function O(e,t){for(var i=e.loadGeometry(),n=e.type,r=0,a=0,o=i.length,s=0;s<o;s++){var l=i[s],u=1;1===n&&(u=l.length),t.writeVarint(M(1,u));for(var c=3===n?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==n&&t.writeVarint(M(2,c-1));var p=l[h].x-r,d=l[h].y-a;t.writeVarint(I(p)),t.writeVarint(I(d)),r+=p,a+=d}3===n&&t.writeVarint(M(7,1))}}function D(e,t){var i=typeof e;"string"===i?t.writeStringField(1,e):"boolean"===i?t.writeBooleanField(7,e):"number"===i&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function A(e,t,i,n,r,a){if(!(r-n<=i)){var o=n+r>>1;L(e,t,o,n,r,a%2),A(e,t,i,n,o-1,a+1),A(e,t,i,o+1,r,a+1)}}function L(e,t,i,n,r,a){for(;r>n;){if(r-n>600){var o=r-n+1,s=i-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);L(e,t,i,Math.max(n,Math.floor(i-s*u/o+c)),Math.min(r,Math.floor(i+(o-s)*u/o+c)),a)}var h=t[2*i+a],p=n,d=r;for(z(e,t,n,i),t[2*r+a]>h&&z(e,t,n,r);p<d;){for(z(e,t,p,d),p++,d--;t[2*p+a]<h;)p++;for(;t[2*d+a]>h;)d--}t[2*n+a]===h?z(e,t,n,d):z(e,t,++d,r),d<=i&&(n=d+1),i<=d&&(r=d-1)}}function z(e,t,i,n){R(e,i,n),R(t,2*i,2*n),R(t,2*i+1,2*n+1)}function R(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function F(e,t,i,n){var r=e-i,a=t-n;return r*r+a*a}k.fromVectorTileJs=S,k.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var n in e)i[n]=new b(e[n].features,t),i[n].name=n,i[n].version=t.version,i[n].extent=t.extent;return S({layers:i})},k.GeoJSONWrapper=P;var j,B=function(e){return e[0]},V=function(e){return e[1]},N=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Float64Array;v(this,e),this.nodeSize=r,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new o(t.length),l=this.coords=new a(2*t.length),u=0;u<t.length;u++)s[u]=u,l[2*u]=i(t[u]),l[2*u+1]=n(t[u]);A(s,l,r,0,s.length-1,0)}return y(e,[{key:"range",value:function(e,t,i,n){return function(e,t,i,n,r,a,o){for(var s,l,u=[0,e.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),d=u.pop();if(p-d<=o)for(var f=d;f<=p;f++)s=t[2*f],l=t[2*f+1],s>=i&&s<=r&&l>=n&&l<=a&&c.push(e[f]);else{var m=Math.floor((d+p)/2);s=t[2*m],l=t[2*m+1],s>=i&&s<=r&&l>=n&&l<=a&&c.push(e[m]);var v=(h+1)%2;(0===h?i<=s:n<=l)&&(u.push(d),u.push(m-1),u.push(v)),(0===h?r>=s:a>=l)&&(u.push(m+1),u.push(p),u.push(v))}}return c}(this.ids,this.coords,e,t,i,n,this.nodeSize)}},{key:"within",value:function(e,t,i){return function(e,t,i,n,r,a){for(var o=[0,e.length-1,0],s=[],l=r*r;o.length;){var u=o.pop(),c=o.pop(),h=o.pop();if(c-h<=a)for(var p=h;p<=c;p++)F(t[2*p],t[2*p+1],i,n)<=l&&s.push(e[p]);else{var d=Math.floor((h+c)/2),f=t[2*d],m=t[2*d+1];F(f,m,i,n)<=l&&s.push(e[d]);var v=(u+1)%2;(0===u?i-r<=f:n-r<=m)&&(o.push(h),o.push(d-1),o.push(v)),(0===u?i+r>=f:n+r>=m)&&(o.push(d+1),o.push(c),o.push(v))}}return s}(this.ids,this.coords,e,t,i,this.nodeSize)}}]),e}(),U={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},G=Math.fround||(j=new Float32Array(1),function(e){return j[0]=+e,j[0]}),W=function(){function e(t){v(this,e),this.options=J(Object.create(U),t),this.trees=new Array(this.options.maxZoom+1)}return y(e,[{key:"load",value:function(e){var t=this.options,i=t.log,n=t.minZoom,r=t.maxZoom,a=t.nodeSize;i&&console.time("total time");var o="prepare ".concat(e.length," points");i&&console.time(o),this.points=e;for(var s=[],l=0;l<e.length;l++)e[l].geometry&&s.push(Z(e[l],l));this.trees[r+1]=new N(s,Q,ee,a,Float32Array),i&&console.timeEnd(o);for(var u=r;u>=n;u--){var c=+Date.now();s=this._cluster(s,u),this.trees[u]=new N(s,Q,ee,a,Float32Array),i&&console.log("z%d: %d clusters in %dms",u,s.length,+Date.now()-c)}return i&&console.timeEnd("total time"),this}},{key:"getClusters",value:function(e,t){var i=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),r=180===e[2]?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,r=180;else if(i>r){var o=this.getClusters([i,n,180,a],t),s=this.getClusters([-180,n,r,a],t);return o.concat(s)}var l,u=this.trees[this._limitZoom(t)],c=u.range(K(i),Y(a),K(r),Y(n)),h=[],d=p(c);try{for(d.s();!(l=d.n()).done;){var f=l.value,m=u.points[f];h.push(m.numPoints?q(m):this.points[m.index])}}catch(v){d.e(v)}finally{d.f()}return h}},{key:"getChildren",value:function(e){var t=this._getOriginId(e),i=this._getOriginZoom(e),n="No cluster with the specified id.",r=this.trees[i];if(!r)throw new Error(n);var a=r.points[t];if(!a)throw new Error(n);var o,s=this.options.radius/(this.options.extent*Math.pow(2,i-1)),l=r.within(a.x,a.y,s),u=[],c=p(l);try{for(c.s();!(o=c.n()).done;){var h=o.value,d=r.points[h];d.parentId===e&&u.push(d.numPoints?q(d):this.points[d.index])}}catch(f){c.e(f)}finally{c.f()}if(0===u.length)throw new Error(n);return u}},{key:"getLeaves",value:function(e,t,i){var n=[];return this._appendLeaves(n,e,t=t||10,i=i||0,0),n}},{key:"getTile",value:function(e,t,i){var n=this.trees[this._limitZoom(e)],r=Math.pow(2,e),a=this.options,o=a.extent,s=a.radius/o,l=(i-s)/r,u=(i+1+s)/r,c={features:[]};return this._addTileFeatures(n.range((t-s)/r,l,(t+1+s)/r,u),n.points,t,i,r,c),0===t&&this._addTileFeatures(n.range(1-s/r,l,1,u),n.points,r,i,r,c),t===r-1&&this._addTileFeatures(n.range(0,l,s/r,u),n.points,-1,i,r,c),c.features.length?c:null}},{key:"getClusterExpansionZoom",value:function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}},{key:"_appendLeaves",value:function(e,t,i,n,r){var a,o=this.getChildren(t),s=p(o);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=l.properties;if(u&&u.cluster?r+u.point_count<=n?r+=u.point_count:r=this._appendLeaves(e,u.cluster_id,i,n,r):r<n?r++:e.push(l),e.length===i)break}}catch(c){s.e(c)}finally{s.f()}return r}},{key:"_addTileFeatures",value:function(e,t,i,n,r,a){var o,s=p(e);try{for(s.s();!(o=s.n()).done;){var l=t[o.value],u=l.numPoints,c=void 0,h=void 0,d=void 0;if(u)c=X(l),h=l.x,d=l.y;else{var f=this.points[l.index];c=f.properties,h=K(f.geometry.coordinates[0]),d=Y(f.geometry.coordinates[1])}var m={type:1,geometry:[[Math.round(this.options.extent*(h*r-i)),Math.round(this.options.extent*(d*r-n))]],tags:c},v=void 0;u?v=l.id:this.options.generateId?v=l.index:this.points[l.index].id&&(v=this.points[l.index].id),void 0!==v&&(m.id=v),a.features.push(m)}}catch(y){s.e(y)}finally{s.f()}}},{key:"_limitZoom",value:function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))}},{key:"_cluster",value:function(e,t){for(var i=[],n=this.options,r=n.radius,a=n.extent,o=n.reduce,s=n.minPoints,l=r/(a*Math.pow(2,t)),u=0;u<e.length;u++){var c=e[u];if(!(c.zoom<=t)){c.zoom=t;var h,d=this.trees[t+1],f=d.within(c.x,c.y,l),m=c.numPoints||1,v=m,y=p(f);try{for(y.s();!(h=y.n()).done;){var g=h.value,_=d.points[g];_.zoom>t&&(v+=_.numPoints||1)}}catch(A){y.e(A)}finally{y.f()}if(v>m&&v>=s){var b,x=c.x*m,w=c.y*m,k=o&&m>1?this._map(c,!0):null,P=(u<<5)+(t+1)+this.points.length,S=p(f);try{for(S.s();!(b=S.n()).done;){var T=b.value,E=d.points[T];if(!(E.zoom<=t)){E.zoom=t;var C=E.numPoints||1;x+=E.x*C,w+=E.y*C,E.parentId=P,o&&(k||(k=this._map(c,!0)),o(k,this._map(E)))}}}catch(A){S.e(A)}finally{S.f()}c.parentId=P,i.push(H(x/v,w/v,P,v,k))}else if(i.push(c),v>1){var M,I=p(f);try{for(I.s();!(M=I.n()).done;){var O=M.value,D=d.points[O];D.zoom<=t||(D.zoom=t,i.push(D))}}catch(A){I.e(A)}finally{I.f()}}}}return i}},{key:"_getOriginId",value:function(e){return e-this.points.length>>5}},{key:"_getOriginZoom",value:function(e){return(e-this.points.length)%32}},{key:"_map",value:function(e,t){if(e.numPoints)return t?J({},e.properties):e.properties;var i=this.points[e.index].properties,n=this.options.map(i);return t&&n===i?J({},n):n}}]),e}();function H(e,t,i,n,r){return{x:G(e),y:G(t),zoom:1/0,id:i,parentId:-1,numPoints:n,properties:r}}function Z(e,t){var i=h(e.geometry.coordinates,2),n=i[0],r=i[1];return{x:G(K(n)),y:G(Y(r)),zoom:1/0,index:t,parentId:-1}}function q(e){return{type:"Feature",id:e.id,properties:X(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),$(e.y)]}};var t}function X(e){var t=e.numPoints,i=t>=1e4?"".concat(Math.round(t/1e3),"k"):t>=1e3?Math.round(t/100)/10+"k":t;return J(J({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:i})}function K(e){return e/360+.5}function Y(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function $(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function J(e,t){for(var i in t)e[i]=t[i];return e}function Q(e){return e.x}function ee(e){return e.y}function te(e,t,i,n){for(var r,a=n,o=i-t>>1,s=i-t,l=e[t],u=e[t+1],c=e[i],h=e[i+1],p=t+3;p<i;p+=3){var d=ie(e[p],e[p+1],l,u,c,h);if(d>a)r=p,a=d;else if(d===a){var f=Math.abs(p-o);f<s&&(r=p,s=f)}}a>n&&(r-t>3&&te(e,t,r,n),e[r+2]=a,i-r>3&&te(e,r,i,n))}function ie(e,t,i,n,r,a){var o=r-i,s=a-n;if(0!==o||0!==s){var l=((e-i)*o+(t-n)*s)/(o*o+s*s);l>1?(i=r,n=a):l>0&&(i+=o*l,n+=s*l)}return(o=e-i)*o+(s=t-n)*s}function ne(e,t,i,n){var r={id:void 0===e?null:e,type:t,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)re(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<t.length;n++)re(e,t[n]);else if("MultiPolygon"===i)for(n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)re(e,t[n][r])}(r),r}function re(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function ae(e,t,i,n){if(t.geometry){var r=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=n||0),"Point"===a)oe(r,s);else if("MultiPoint"===a)for(var u=0;u<r.length;u++)oe(r[u],s);else if("LineString"===a)se(r,s,o,!1);else if("MultiLineString"===a){if(i.lineMetrics){for(u=0;u<r.length;u++)se(r[u],s=[],o,!1),e.push(ne(l,"LineString",s,t.properties));return}le(r,s,o,!1)}else if("Polygon"===a)le(r,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(u=0;u<t.geometry.geometries.length;u++)ae(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<r.length;u++){var c=[];le(r[u],c,o,!0),s.push(c)}}e.push(ne(l,a,s,t.properties))}}function oe(e,t){t.push(ue(e[0])),t.push(ce(e[1])),t.push(0)}function se(e,t,i,n){for(var r,a,o=0,s=0;s<e.length;s++){var l=ue(e[s][0]),u=ce(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(o+=n?(r*u-l*a)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-a,2))),r=l,a=u}var c=t.length-3;t[2]=1,te(t,0,c,i),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function le(e,t,i,n){for(var r=0;r<e.length;r++){var a=[];se(e[r],a,i,n),t.push(a)}}function ue(e){return e/360+.5}function ce(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function he(e,t,i,n,r,a,o,s){if(n/=t,a>=(i/=t)&&o<n)return e;if(o<i||a>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],h=c.geometry,p=c.type,d=0===r?c.minX:c.minY,f=0===r?c.maxX:c.maxY;if(d>=i&&f<n)l.push(c);else if(!(f<i||d>=n)){var m=[];if("Point"===p||"MultiPoint"===p)pe(h,m,i,n,r);else if("LineString"===p)de(h,m,i,n,r,!1,s.lineMetrics);else if("MultiLineString"===p)me(h,m,i,n,r,!1);else if("Polygon"===p)me(h,m,i,n,r,!0);else if("MultiPolygon"===p)for(var v=0;v<h.length;v++){var y=[];me(h[v],y,i,n,r,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(v=0;v<m.length;v++)l.push(ne(c.id,p,m[v],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(ne(c.id,p,m,c.tags))}}}return l.length?l:null}function pe(e,t,i,n,r){for(var a=0;a<e.length;a+=3){var o=e[a+r];o>=i&&o<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function de(e,t,i,n,r,a,o){for(var s,l,u=fe(e),c=0===r?ye:ge,h=e.start,p=0;p<e.length-3;p+=3){var d=e[p],f=e[p+1],m=e[p+2],v=e[p+3],y=e[p+4],g=0===r?d:f,_=0===r?v:y,b=!1;o&&(s=Math.sqrt(Math.pow(d-v,2)+Math.pow(f-y,2))),g<i?_>i&&(l=c(u,d,f,v,y,i),o&&(u.start=h+s*l)):g>n?_<n&&(l=c(u,d,f,v,y,n),o&&(u.start=h+s*l)):ve(u,d,f,m),_<i&&g>=i&&(l=c(u,d,f,v,y,i),b=!0),_>n&&g<=n&&(l=c(u,d,f,v,y,n),b=!0),!a&&b&&(o&&(u.end=h+s*l),t.push(u),u=fe(e)),o&&(h+=s)}var x=e.length-3;d=e[x],f=e[x+1],m=e[x+2],(g=0===r?d:f)>=i&&g<=n&&ve(u,d,f,m),x=u.length-3,a&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&ve(u,u[0],u[1],u[2]),u.length&&t.push(u)}function fe(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function me(e,t,i,n,r,a){for(var o=0;o<e.length;o++)de(e[o],t,i,n,r,a,!1)}function ve(e,t,i,n){e.push(t),e.push(i),e.push(n)}function ye(e,t,i,n,r,a){var o=(a-t)/(n-t);return e.push(a),e.push(i+(r-i)*o),e.push(1),o}function ge(e,t,i,n,r,a){var o=(a-i)/(r-i);return e.push(t+(n-t)*o),e.push(a),e.push(1),o}function _e(e,t){for(var i=[],n=0;n<e.length;n++){var r,a=e[n],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=be(a.geometry,t);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var s=0;s<a.geometry.length;s++)r.push(be(a.geometry[s],t))}else if("MultiPolygon"===o)for(r=[],s=0;s<a.geometry.length;s++){for(var l=[],u=0;u<a.geometry[s].length;u++)l.push(be(a.geometry[s][u],t));r.push(l)}i.push(ne(a.id,o,r,a.tags))}return i}function be(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var n=0;n<e.length;n+=3)i.push(e[n]+t,e[n+1],e[n+2]);return i}function xe(e,t){if(e.transformed)return e;var i,n,r,a=1<<e.z,o=e.x,s=e.y;for(i=0;i<e.features.length;i++){var l=e.features[i],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(we(u[n],u[n+1],t,a,o,s));else for(n=0;n<u.length;n++){var h=[];for(r=0;r<u[n].length;r+=2)h.push(we(u[n][r],u[n][r+1],t,a,o,s));l.geometry.push(h)}}return e.transformed=!0,e}function we(e,t,i,n,r,a){return[Math.round(i*(e*n-r)),Math.round(i*(t*n-a))]}function ke(e,t,i,n,r){for(var a=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,Pe(o,e[s],a,r);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,h=e[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),h>o.maxY&&(o.maxY=h)}return o}function Pe(e,t,i,n){var r=t.geometry,a=t.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<r.length;s+=3)o.push(r[s]),o.push(r[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)Se(o,r,e,i,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<r.length;s++)Se(o,r[s],e,i,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)Se(o,u[s],e,i,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===a&&n.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var p={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==t.id&&(p.id=t.id),e.features.push(p)}}function Se(e,t,i,n,r,a){var o=n*n;if(n>0&&t.size<(r?o:n))i.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>o)&&(i.numSimplified++,s.push(t[l]),s.push(t[l+1])),i.numPoints++;r&&function(e,t){for(var i=0,n=0,r=e.length,a=r-2;n<r;a=n,n+=2)i+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(i>0===t)for(n=0,r=e.length;n<r/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[r-2-n],e[n+1]=e[r-1-n],e[r-2-n]=o,e[r-1-n]=s}}(s,a),e.push(s)}}function Te(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var i=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)ae(i,e.features[n],t,n);else ae(i,"Feature"===e.type?e:{geometry:e},t);return i}(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var i=t.buffer/t.extent,n=e,r=he(e,1,-1-i,i,0,-1,2,t),a=he(e,1,1-i,2+i,0,-1,2,t);return(r||a)&&(n=he(e,1,-i,1+i,0,-1,2,t)||[],r&&(n=_e(r,1).concat(n)),a&&(n=n.concat(_e(a,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ee(e,t,i){return 32*((1<<e)*i+t)+e}function Ce(e,t){var i=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var n=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!n)return t(null,null);var r=new g(n.features),a=k(r);0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),t(null,{vectorTile:r,rawData:a.buffer})}Te.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Te.prototype.splitTile=function(e,t,i,n,r,a,o){for(var s=[e,t,i,n],l=this.options,u=l.debug;s.length;){n=s.pop(),i=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,h=Ee(t,i,n),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=ke(e,t,i,n,l),this.tileCoords.push({z:t,x:i,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=e,r){if(t===l.maxZoom||t===r)continue;var f=1<<r-t;if(i!==Math.floor(a/f)||n!==Math.floor(o/f))continue}else if(t===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==e.length){u>1&&console.time("clipping");var m,v,y,g,_,b,x=.5*l.buffer/l.extent,w=.5-x,k=.5+x,P=1+x;m=v=y=g=null,_=he(e,c,i-x,i+k,0,p.minX,p.maxX,l),b=he(e,c,i+w,i+P,0,p.minX,p.maxX,l),e=null,_&&(m=he(_,c,n-x,n+k,1,p.minY,p.maxY,l),v=he(_,c,n+w,n+P,1,p.minY,p.maxY,l),_=null),b&&(y=he(b,c,n-x,n+k,1,p.minY,p.maxY,l),g=he(b,c,n+w,n+P,1,p.minY,p.maxY,l),b=null),u>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*i,2*n),s.push(v||[],t+1,2*i,2*n+1),s.push(y||[],t+1,2*i+1,2*n),s.push(g||[],t+1,2*i+1,2*n+1)}}},Te.prototype.getTile=function(e,t,i){var n=this.options,r=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e,s=Ee(e,t=(t%o+o)%o,i);if(this.tiles[s])return xe(this.tiles[s],r);a>1&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var l,u=e,c=t,h=i;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[Ee(u,c,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",u,c,h),a>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,i),a>1&&console.timeEnd("drilling down"),this.tiles[s]?xe(this.tiles[s],r):null):null};var Me=function(t){f(n,t);var i=m(n);function n(e,t,r,a,o){var s;return v(this,n),s=i.call(this,e,t,r,a,Ce),o&&(s.loadGeoJSON=o),s}return y(n,[{key:"loadData",value:function(t,i){var n=this,r=t&&t.request,o=r&&r.collectResourceTiming;this.loadGeoJSON(t,(function(s,l){if(s||!l)return i(s);if("object"!=typeof l)return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));a(l,!0);try{if(t.filter){var u=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===u.result)throw new Error(u.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));var c=l.features.filter((function(e){return u.value.evaluate({zoom:0},e)}));l={type:"FeatureCollection",features:c}}n._geoJSONIndex=t.cluster?new W(function(t){var i=t.superclusterOptions,n=t.clusterProperties;if(!n||!i)return i;for(var r={},a={},o={accumulated:null,zoom:0},s={properties:null},l=Object.keys(n),u=0,c=l;u<c.length;u++){var d=c[u],f=h(n[d],2),m=f[0],v=f[1],y=e.createExpression(v),g=e.createExpression("string"==typeof m?[m,["accumulated"],["get",d]]:m);r[d]=y.value,a[d]=g.value}return i.map=function(e){s.properties=e;var t,i={},n=p(l);try{for(n.s();!(t=n.n()).done;){var a=t.value;i[a]=r[a].evaluate(o,s)}}catch(u){n.e(u)}finally{n.f()}return i},i.reduce=function(e,t){s.properties=t;var i,n=p(l);try{for(n.s();!(i=n.n()).done;){var r=i.value;o.accumulated=e[r],e[r]=a[r].evaluate(o,s)}}catch(u){n.e(u)}finally{n.f()}},i}(t)).load(l.features):function(e,t){return new Te(e,t)}(l,t.geojsonVtOptions)}catch(s){return i(s)}n.loaded={};var d={};if(o){var f=e.getPerformanceMeasurement(r);f&&(d.resourceTiming={},d.resourceTiming[t.source]=JSON.parse(JSON.stringify(f)))}i(null,d)}))}},{key:"reloadTile",value:function(e,t){var i=this.loaded;return i&&i[e.uid]?o(s(n.prototype),"reloadTile",this).call(this,e,t):this.loadTile(e,t)}},{key:"loadGeoJSON",value:function(t,i){if(t.request)e.getJSON(t.request,i);else{if("string"!=typeof t.data)return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));try{return i(null,JSON.parse(t.data))}catch(e){return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")))}}}},{key:"getClusterExpansionZoom",value:function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}},{key:"getClusterChildren",value:function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}},{key:"getClusterLeaves",value:function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}]),n}(e.VectorTileWorkerSource),Ie=function(){function t(i){var n=this;v(this,t),this.self=i,this.actor=new e.Actor(i,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(n.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));n.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}return y(t,[{key:"clearCaches",value:function(e,t,i){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],i()}},{key:"checkIfReady",value:function(e,t,i){i()}},{key:"setReferrer",value:function(e,t){this.referrer=t}},{key:"spriteLoaded",value:function(t,i){for(var n in this.isSpriteLoaded[t]=i,this.workerSources[t]){var r=this.workerSources[t][n];for(var a in r)r[a]instanceof e.VectorTileWorkerSource&&(r[a].isSpriteLoaded=i,r[a].fire(new e.Event("isSpriteLoaded")))}}},{key:"setImages",value:function(e,t,i){for(var n in this.availableImages[e]=t,this.workerSources[e]){var r=this.workerSources[e][n];for(var a in r)r[a].availableImages=t}i()}},{key:"enableTerrain",value:function(e,t,i){this.terrain=t,i()}},{key:"setProjection",value:function(t,i){this.projections[t]=e.getProjection(i)}},{key:"setLayers",value:function(e,t,i){this.getLayerIndex(e).replace(t),i()}},{key:"updateLayers",value:function(e,t,i){this.getLayerIndex(e).update(t.layers,t.removedIds),i()}},{key:"loadTile",value:function(t,i,n){var r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).loadTile(r,n)}},{key:"loadDEMTile",value:function(t,i,n){var r=this.enableTerrain?e.extend({buildQuadTree:this.terrain},i):i;this.getDEMWorkerSource(t,i.source).loadTile(r,n)}},{key:"reloadTile",value:function(t,i,n){var r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).reloadTile(r,n)}},{key:"abortTile",value:function(e,t,i){this.getWorkerSource(e,t.type,t.source).abortTile(t,i)}},{key:"removeTile",value:function(e,t,i){this.getWorkerSource(e,t.type,t.source).removeTile(t,i)}},{key:"removeSource",value:function(e,t,i){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,i):i()}}},{key:"loadWorkerSource",value:function(e,t,i){try{this.self.importScripts(t.url),i()}catch(e){i(e.toString())}}},{key:"syncRTLPluginState",value:function(t,i,n){try{e.plugin.setState(i);var r=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=r){this.self.importScripts(r);var a=e.plugin.isParsed();n(a?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(r)),a)}}catch(e){n(e.toString())}}},{key:"getAvailableImages",value:function(e){var t=this.availableImages[e];return t||(t=[]),t}},{key:"getLayerIndex",value:function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}},{key:"getWorkerSource",value:function(e,t,i){var n=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][i]||(this.workerSources[e][t][i]=new this.workerSourceTypes[t]({send:function(t,i,r,a,o,s){n.actor.send(t,i,r,e,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])),this.workerSources[e][t][i]}},{key:"getDEMWorkerSource",value:function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new r),this.demWorkerSources[e][t]}},{key:"enforceCacheSizeLimit",value:function(t,i){e.enforceCacheSizeLimit(i)}},{key:"getWorkerPerformanceMetrics",value:function(e,t,i){i(void 0,void 0)}}]),t}();return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ie(self)),Ie})),g(["./shared"],(function(e){function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var n=0;n<e.length;n++)if(!t(e[n],i[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(var r in e)if(!t(e[r],i[r]))return!1;return!0}return e===i}var i=u;function u(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,i=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(i);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var i=t.getImageData(0,0,1,1);return i&&i.width===e.width}()?(void 0===d[t=e&&e.failIfMajorPerformanceCaveat]&&(d[t]=function(e){var t,i=function(e){var t=document.createElement("canvas"),i=Object.create(u.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=e,t.getContext("webgl",i)||t.getContext("experimental-webgl",i)}(e);if(!i)return!1;try{t=i.createShader(i.VERTEX_SHADER)}catch(e){return!1}return!(!t||i.isContextLost())&&(i.shaderSource(t,"void main() {}"),i.compileShader(t),!0===i.getShaderParameter(t,i.COMPILE_STATUS))}(t)),d[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var d={};function g(t,i,n){var r=e.window.document.createElement(t);return void 0!==i&&(r.className=i),n&&n.appendChild(r),r}function _(t,i,n){for(var r=e.window.document.createElementNS("http://www.w3.org/2000/svg",t),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];r.setAttributeNS(null,s,i[s])}return n&&n.appendChild(r),r}u.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var b,x=e.window.document&&e.window.document.documentElement.style,w=x&&void 0!==x.userSelect?"userSelect":"WebkitUserSelect";function k(){x&&w&&(b=x[w],x[w]="none")}function P(){x&&w&&(x[w]=b)}function S(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",S,!0)}function T(){e.window.addEventListener("click",S,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",S,!0)}),0)}function E(e,t){var i=e.getBoundingClientRect();return I(e,i,t)}function C(e,t){for(var i=e.getBoundingClientRect(),n=[],r=0;r<t.length;r++)n.push(I(e,i,t[r]));return n}function M(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function I(t,i,n){var r=t.offsetWidth===i.width?1:t.offsetWidth/i.width;return new e.pointGeometry((n.clientX-i.left)*r,(n.clientY-i.top)*r)}function O(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=i*a-r*n;return o?(e[0]=a*(o=1/o),e[1]=-n*o,e[2]=-r*o,e[3]=i*o,e):null}function D(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}var A=function(t){f(n,t);var i=m(n);function n(){var t;return v(this,n),(t=i.call(this)).images={},t.updatedImages={},t.callbackDispatchedThisFrame={},t.loaded=!1,t.requestors=[],t.patterns={},t.atlasImage=new e.RGBAImage({width:1,height:1}),t.dirty=!0,t}return y(n,[{key:"isLoaded",value:function(){return this.loaded}},{key:"setLoaded",value:function(e){if(this.loaded!==e&&(this.loaded=e,e)){var t,i=p(this.requestors);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.ids,a=n.callback;this._notify(r,a)}}catch(o){i.e(o)}finally{i.f()}this.requestors=[]}}},{key:"hasImage",value:function(e){return!!this.getImage(e)}},{key:"getImage",value:function(e){return this.images[e]}},{key:"addImage",value:function(e,t){this._validate(e,t)&&(this.images[e]=t)}},{key:"_validate",value:function(t,i){var n=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),n=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),n=!1),this._validateContent(i.content,i)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "content" value')))),n=!1),n}},{key:"_validateStretch",value:function(e,t){if(!e)return!0;var i,n=0,r=p(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a[0]<n||a[1]<a[0]||t<a[1])return!1;n=a[1]}}catch(o){r.e(o)}finally{r.f()}return!0}},{key:"_validateContent",value:function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}},{key:"updateImage",value:function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}},{key:"removeImage",value:function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}},{key:"listImages",value:function(){return Object.keys(this.images)}},{key:"getImages",value:function(e,t){var i=!0;if(!this.isLoaded()){var n,r=p(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.images[a]||(i=!1)}}catch(o){r.e(o)}finally{r.f()}}this.isLoaded()||i?this._notify(e,t):this.requestors.push({ids:e,callback:t})}},{key:"_notify",value:function(t,i){var n,r={},a=p(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;this.images[o]||this.fire(new e.Event("styleimagemissing",{id:o}));var s=this.images[o];s?r[o]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'.concat(o,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}}catch(l){a.e(l)}finally{a.f()}i(null,r)}},{key:"getPixelSize",value:function(){var e=this.atlasImage;return{width:e.width,height:e.height}}},{key:"getPattern",value:function(t){var i=this.patterns[t],n=this.getImage(t);if(!n)return null;if(i&&i.position.version===n.version)return i.position;if(i)i.position.version=n.version;else{var r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},a=new e.ImagePosition(r,n);this.patterns[t]={bin:r,position:a}}return this._updatePatternAtlas(),this.patterns[t].position}},{key:"bind",value:function(t){var i=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}},{key:"_updatePatternAtlas",value:function(){var t=[];for(var i in this.patterns)t.push(this.patterns[i].bin);var n=e.potpack(t),r=n.w,a=n.h,o=this.atlasImage;for(var s in o.resize({width:r||1,height:a||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,h=this.images[s].data,p=h.width,d=h.height;e.RGBAImage.copy(h,o,{x:0,y:0},{x:u,y:c},{width:p,height:d}),e.RGBAImage.copy(h,o,{x:0,y:d-1},{x:u,y:c-1},{width:p,height:1}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:u,y:c+d},{width:p,height:1}),e.RGBAImage.copy(h,o,{x:p-1,y:0},{x:u-1,y:c},{width:1,height:d}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:u+p,y:c},{width:1,height:d})}this.dirty=!0}},{key:"beginFrame",value:function(){this.callbackDispatchedThisFrame={}}},{key:"dispatchRenderCallbacks",value:function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(!this.callbackDispatchedThisFrame[n]){this.callbackDispatchedThisFrame[n]=!0;var r=this.images[n];D(r)&&this.updateImage(n,r)}}}catch(a){i.e(a)}finally{i.f()}}}]),n}(e.Evented),L=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new(function(){function t(){v(this,t),this.specification=e.spec.light.position}return y(t,[{key:"possiblyEvaluate",value:function(t,i){return function(t){var i=h(t,3),n=i[0],r=i[1],a=i[2],o=e.degToRad(r+90),s=e.degToRad(a);return{x:n*Math.cos(o)*Math.sin(s),y:n*Math.sin(o)*Math.sin(s),z:n*Math.cos(s),azimuthal:r,polar:a}}(t.expression.evaluate(i))}},{key:"interpolate",value:function(t,i,n){return{x:e.number(t.x,i.x,n),y:e.number(t.y,i.y,n),z:e.number(t.z,i.z,n),azimuthal:e.number(t.azimuthal,i.azimuthal,n),polar:e.number(t.polar,i.polar,n)}}}]),t}()),color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)}),z="-transition",R=function(t){f(n,t);var i=m(n);function n(t){var r;return v(this,n),(r=i.call(this))._transitionable=new e.Transitionable(L),r.setLight(t),r._transitioning=r._transitionable.untransitioned(),r}return y(n,[{key:"getLight",value:function(){return this._transitionable.serialize()}},{key:"setLight",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateLight,t,i))for(var n in t){var r=t[n];e.endsWith(n,z)?this._transitionable.setTransition(n.slice(0,-z.length),r):this._transitionable.setValue(n,r)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}]),n}(e.Evented),F=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)}),j="-transition",B=function(t){f(n,t);var i=m(n);function n(t,r){var a;return v(this,n),(a=i.call(this))._transitionable=new e.Transitionable(F),a.set(t),a._transitioning=a._transitionable.untransitioned(),a.drapeRenderMode=r,a}return y(n,[{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){for(var i in t){var n=t[i];e.endsWith(i,j)?this._transitionable.setTransition(i.slice(0,-j.length),n):this._transitionable.setValue(i,n)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}}]),n}(e.Evented);function V(t,i,n,r){var a=e.smoothstep(45,65,n),o=N(t,r),s=h(o,2),l=s[0],u=s[1],c=e.length(i),p=1-Math.min(1,Math.exp((c-l)/(u-l)*-6));return p*=p*p,(p=Math.min(1,1.00747*p))*a*t.alpha}function N(e,t){var i=.5/Math.tan(.5*t);return[e.range[0]+i,e.range[1]+i]}var U=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])}),G="-transition",W=function(t){f(n,t);var i=m(n);function n(t,r){var a;return v(this,n),(a=i.call(this))._transitionable=new e.Transitionable(U),a.set(t),a._transitioning=a._transitionable.untransitioned(),a._transform=r,a}return y(n,[{key:"state",get:function(){var t=this._transform,i="globe"===t.projection.name,n=e.globeToMercatorTransition(t.zoom),r=this.properties.get("range"),a=[.5,3];return{range:i?[e.number(a[0],r[0],n),e.number(a[1],r[1],n)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}},{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateFog,t,i)){for(var n=0,r=Object.keys(e.spec.fog);n<r.length;n++){var a=r[n];t&&void 0===t[a]&&(t[a]=e.spec.fog[a].default)}for(var o in t){var s=t[o];e.endsWith(o,G)?this._transitionable.setTransition(o.slice(0,-G.length),s):this._transitionable.setValue(o,s)}}}},{key:"getOpacity",value:function(t){if(!this._transform.projection.supportsFog)return 0;var i=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*i.a}},{key:"getOpacityAtLatLng",value:function(t,i){return this._transform.projection.supportsFog?function(t,i,n){var r=e.MercatorCoordinate.fromLngLat(i),a=n.elevation?n.elevation.getAtPointOrZero(r):0,o=[r.x,r.y,a];return e.transformMat4(o,o,n.mercatorFogMatrix),V(t,o,n.pitch,n._fov)}(this.state,t,i):0}},{key:"getFovAdjustedRange",value:function(e){return this._transform.projection.supportsFog?N(this.state,e):[0,1]}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}]),n}(e.Evented),H=function(){function t(i,n){var r=this;v(this,t),this.workerPool=i,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var a=this.workerPool.acquire(this.id),o=0;o<a.length;o++){var s=new t.Actor(a[o],n,this.id);s.name="Worker ".concat(o),this.actors.push(s)}this.ready=!1,this.broadcast("checkIfReady",null,(function(){r.ready=!0}))}return y(t,[{key:"broadcast",value:function(t,i,n){e.asyncAll(this.actors,(function(e,n){e.send(t,i,n)}),n=n||function(){})}},{key:"getActor",value:function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}},{key:"remove",value:function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)}}]),t}();function Z(t,i,n){return i*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}H.Actor=e.Actor;var q=function(){function t(e,i,n,r){v(this,t),this.screenBounds=e,this.cameraPoint=i,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,r)}return y(t,[{key:"isPointQuery",value:function(){return 1===this.screenBounds.length}},{key:"bufferedScreenGeometry",value:function(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}},{key:"bufferedCameraGeometry",value:function(t){var i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.pointGeometry(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<n.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?r[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(r[3]=this.cameraPoint)),e.bufferConvexPolygon(r,t)}},{key:"bufferedCameraGeometryGlobe",value:function(t){var i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.pointGeometry(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,t),a=this.cameraPoint.clone();switch(3*((a.y>i.y)+(a.y>n.y))+((a.x>i.x)+(a.x>n.x))){case 0:r[0]=a,r[4]=a.clone();break;case 1:r.splice(1,0,a);break;case 2:r[1]=a;break;case 3:r.splice(4,0,a);break;case 5:r.splice(2,0,a);break;case 6:r[3]=a;break;case 7:r.splice(3,0,a);break;case 8:r[2]=a}return r}},{key:"containsTile",value:function(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.queryPadding/i._projectionScaler+1,o=n?this._bufferedCameraMercator(a,i):this._bufferedScreenMercator(a,i),s=t.tileID.wrap+(o.unwrapped?r:0),l=o.polygon.map((function(i){return e.getTilePoint(t.tileTransform,i,s)}));if(e.polygonIntersectsBox(l,0,0,e.EXTENT,e.EXTENT)){s=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);var u,c=this.screenGeometryMercator.polygon.map((function(i){return e.getTileVec3(t.tileTransform,i,s)})),h=c.map((function(t){return new e.pointGeometry(t[0],t[1])})),p=i.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),d=e.getTileVec3(t.tileTransform,p,s),f=c.map((function(t){var i=e.sub(t,t,d);return e.normalize(i,i),new e.Ray(d,i)})),m=Z(t,1,i.zoom)*i._projectionScaler;return{queryGeometry:this,tilespaceGeometry:h,tilespaceRays:f,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(u=e.getBounds(l),u.min.x=e.clamp(u.min.x,0,e.EXTENT),u.min.y=e.clamp(u.min.y,0,e.EXTENT),u.max.x=e.clamp(u.max.x,0,e.EXTENT),u.max.y=e.clamp(u.max.y,0,e.EXTENT),u),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:m}}}},{key:"_bufferedScreenMercator",value:function(e,t){var i,n=Y(e);return this._screenRaycastCache[n]?this._screenRaycastCache[n]:(i="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((function(e){return t.pointCoordinate3D(e)})),unwrapped:!0},this._screenRaycastCache[n]=i,i)}},{key:"_bufferedCameraMercator",value:function(e,t){var i,n=Y(e);return this._cameraRaycastCache[n]?this._cameraRaycastCache[n]:(i="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((function(e){return t.pointCoordinate3D(e)})),unwrapped:!0},this._cameraRaycastCache[n]=i,i)}},{key:"_projectAndResample",value:function(t,i){var n=function(t,i){var n=e.multiply([],i.pixelMatrix,i.globeMatrix),r=[0,-e.GLOBE_RADIUS,0,1],a=[0,e.GLOBE_RADIUS,0,1],o=[0,0,0,1];e.transformMat4$1(r,r,n),e.transformMat4$1(a,a,n),e.transformMat4$1(o,o,n);var s=new e.pointGeometry(r[0]/r[3],r[1]/r[3]),l=new e.pointGeometry(a[0]/a[3],a[1]/a[3]),u=e.polygonContainsPoint(t,s)&&r[3]<o[3],h=e.polygonContainsPoint(t,l)&&a[3]<o[3];if(!u&&!h)return null;var p=function(e,t,i){for(var n=1;n<e.length;n++){var r=K(t.pointCoordinate3D(e[n-1]).x),a=K(t.pointCoordinate3D(e[n]).x);if(i<0){if(r<a)return{idx:n,t:-r/(a-1-r)}}else if(a<r)return{idx:n,t:(1-r)/(a+1-r)}}return null}(t,i,u?-1:1);if(!p)return null;var d=p.idx,f=p.t,m=d>1?X(t.slice(0,d),i):[],v=d<t.length?X(t.slice(d),i):[];m=m.map((function(t){return new e.pointGeometry(K(t.x),t.y)})),v=v.map((function(t){return new e.pointGeometry(K(t.x),t.y)}));var y=c(m);0===y.length&&y.push(v[v.length-1]);var g,_=e.number(y[y.length-1].y,(0===v.length?m[0]:v[0]).y,f);return g=u?[new e.pointGeometry(0,_),new e.pointGeometry(0,0),new e.pointGeometry(1,0),new e.pointGeometry(1,_)]:[new e.pointGeometry(1,_),new e.pointGeometry(1,1),new e.pointGeometry(0,1),new e.pointGeometry(0,_)],y.push.apply(y,c(g)),0===v.length?y.push(m[0]):y.push.apply(y,c(v)),{polygon:y.map((function(t){return new e.MercatorCoordinate(t.x,t.y)})),unwrapped:!1}}(t,i);if(n)return n;var r=function(t,i){for(var n=!1,r=-1/0,a=0,o=0;o<t.length-1;o++)t[o].x>r&&(r=t[o].x,a=o);for(var s=0;s<t.length-1;s++){var l=(a+s)%(t.length-1),u=t[l],c=t[l+1];Math.abs(u.x-c.x)>.5&&(u.x<c.x?(u.x+=1,0===l&&(t[t.length-1].x+=1)):(c.x+=1,l+1===t.length-1&&(t[0].x+=1)),n=!0)}var h=e.mercatorXfromLng(i.center.lng);return n&&h<Math.abs(h-1)&&t.forEach((function(e){e.x-=1})),{polygon:t,unwrapped:n}}(X(t,i).map((function(t){return new e.pointGeometry(K(t.x),t.y)})),i);return{polygon:r.polygon.map((function(t){return new e.MercatorCoordinate(t.x,t.y)})),unwrapped:r.unwrapped}}}],[{key:"createFromScreenPoints",value:function(i,n){var r,a;if(i instanceof e.pointGeometry||"number"==typeof i[0]){var o=e.pointGeometry.convert(i);r=[e.pointGeometry.convert(i)],a=n.isPointAboveHorizon(o)}else{var s=e.pointGeometry.convert(i[0]),l=e.pointGeometry.convert(i[1]);r=[s,l],a=e.polygonizeBounds(s,l).every((function(e){return n.isPointAboveHorizon(e)}))}return new t(r,n.getCameraPoint(),a,n)}}]),t}();function X(t,i){return e.resample(t,(function(e){var t=i.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function K(e){return e<0?1+e%1:e%1}function Y(e){return 100*e|0}function $(t,i,n,r,a){var o=function(n,r){if(n)return a(n);if(r){var o=e.pick(e.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(o.vectorLayers=r.vector_layers,o.vectorLayerIds=o.vectorLayers.map((function(e){return e.id}))),r.language_options&&(o.languageOptions=r.language_options),r.language&&r.language[r.id]&&(o.language=r.language[r.id]),r.worldview_options&&(o.worldviewOptions=r.worldview_options),r.worldview?o.worldview=r.worldview[r.id]:r.worldview_default&&(o.worldview=r.worldview_default),o.tiles=i.canonicalizeTileset(o,t.url),a(null,o)}};return t.url?e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url,null,n,r),e.ResourceType.Source),o):e.exported.frame((function(){return o(null,t)}))}var J,Q=function(){function t(i,n,r){v(this,t),this.bounds=e.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=n||0,this.maxzoom=r||24}return y(t,[{key:"validateBounds",value:function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}},{key:"contains",value:function(t){var i=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*i),r=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*i),a=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*i),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*i);return t.x>=n&&t.x<a&&t.y>=r&&t.y<o}}]),t}(),ee=function(){function e(t,i,n){v(this,e),this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||i.destroy()}return y(e,[{key:"bind",value:function(){this.context.bindElementBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),te={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ie=function(){function e(t,i,n,r){v(this,e),this.length=i.length,this.attributes=n,this.itemSize=i.bytesPerElement,this.dynamicDraw=r,this.context=t;var a=t.gl;this.buffer=a.createBuffer(),t.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||i.destroy()}return y(e,[{key:"bind",value:function(){this.context.bindVertexBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"enableAttributes",value:function(e,t){for(var i=0;i<this.attributes.length;i++){var n=t.attributes[this.attributes[i].name];void 0!==n&&e.enableVertexAttribArray(n)}}},{key:"setVertexAttribPointers",value:function(e,t,i){for(var n=0;n<this.attributes.length;n++){var r=this.attributes[n],a=t.attributes[r.name];void 0!==a&&e.vertexAttribPointer(a,r.components,e[te[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),ne=function(){function e(t){v(this,e),this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}return y(e,[{key:"get",value:function(){return this.current}},{key:"set",value:function(e){}},{key:"getDefault",value:function(){return this.default}},{key:"setDefault",value:function(){this.set(this.default)}}]),e}(),re=function(t){f(n,t);var i=m(n);function n(){return v(this,n),i.apply(this,arguments)}return y(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(ne),ae=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return 1}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}]),i}(ne),oe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return 0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}]),i}(ne),se=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return[!0,!0,!0,!0]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),i}(ne),le=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}]),i}(ne),ue=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return 255}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}]),i}(ne),ce=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return{func:this.gl.ALWAYS,ref:0,mask:255}}},{key:"set",value:function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}]),i}(ne),he=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}]),i}(ne),pe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}}]),i}(ne),de=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return[0,1]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}]),i}(ne),fe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}}]),i}(ne),me=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return this.gl.LESS}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}]),i}(ne),ve=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}}]),i}(ne),ye=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){var e=this.gl;return[e.ONE,e.ZERO]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}]),i}(ne),ge=function(t){f(n,t);var i=m(n);function n(){return v(this,n),i.apply(this,arguments)}return y(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(ne),_e=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return this.gl.FUNC_ADD}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}]),i}(ne),be=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}}]),i}(ne),xe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return this.gl.BACK}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}]),i}(ne),we=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return this.gl.CCW}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}]),i}(ne),ke=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}]),i}(ne),Pe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return this.gl.TEXTURE0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}]),i}(ne),Se=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),i}(ne),Te=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}}]),i}(ne),Ee=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),i}(ne),Ce=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}}]),i}(ne),Me=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}}]),i}(ne),Ie=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}]),i}(ne),Oe=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this,e)).vao=e.extVertexArrayObject,n}return y(i,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}]),i}(ne),De=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return 4}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}}]),i}(ne),Ae=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}}]),i}(ne),Le=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}}]),i}(ne),ze=function(e){f(i,e);var t=m(i);function i(e,n){var r;return v(this,i),(r=t.call(this,e)).context=e,r.parent=n,r}return y(i,[{key:"getDefault",value:function(){return null}}]),i}(ne),Re=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"setDirty",value:function(){this.dirty=!0}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}}]),i}(ze),Fe=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"attachment",value:function(){return this.gl.DEPTH_ATTACHMENT}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),i}(ze),je=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"attachment",value:function(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}]),i}(Fe),Be=function(){function e(t,i,n,r){v(this,e),this.context=t,this.width=i,this.height=n;var a=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Re(t,a),r&&(this.depthAttachment=new Fe(t,a))}return y(e,[{key:"destroy",value:function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var i=this.depthAttachment.get();i&&e.deleteRenderbuffer(i)}e.deleteFramebuffer(this.framebuffer)}}]),e}(),Ve=function(){function i(e){v(this,i),this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new re(this),this.clearDepth=new ae(this),this.clearStencil=new oe(this),this.colorMask=new se(this),this.depthMask=new le(this),this.stencilMask=new ue(this),this.stencilFunc=new ce(this),this.stencilOp=new he(this),this.stencilTest=new pe(this),this.depthRange=new de(this),this.depthTest=new fe(this),this.depthFunc=new me(this),this.blend=new ve(this),this.blendFunc=new ye(this),this.blendColor=new ge(this),this.blendEquation=new _e(this),this.cullFace=new be(this),this.cullFaceSide=new xe(this),this.frontFace=new we(this),this.program=new ke(this),this.activeTexture=new Pe(this),this.viewport=new Se(this),this.bindFramebuffer=new Te(this),this.bindRenderbuffer=new Ee(this),this.bindTexture=new Ce(this),this.bindVertexBuffer=new Me(this),this.bindElementBuffer=new Ie(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Oe(this),this.pixelStoreUnpack=new De(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Le(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}return y(i,[{key:"setDefault",value:function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}},{key:"setDirty",value:function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}},{key:"createIndexBuffer",value:function(e,t){return new ee(this,e,t)}},{key:"createVertexBuffer",value:function(e,t,i){return new ie(this,e,t,i)}},{key:"createRenderbuffer",value:function(e,t,i){var n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,e,t,i),this.bindRenderbuffer.set(null),r}},{key:"createFramebuffer",value:function(e,t,i){return new Be(this,e,t,i)}},{key:"clear",value:function(e){var t=e.color,i=e.depth,n=e.stencil,r=this.gl,a=0;t&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),void 0!==n&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),r.clear(a)}},{key:"setCullFace",value:function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}},{key:"setDepthMode",value:function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}},{key:"setStencilMode",value:function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}},{key:"setColorMode",value:function(i){t(i.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}},{key:"unbindVAO",value:function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}]),i}(),Ne=function(t){f(n,t);var i=m(n);function n(t,a,o,s){var l;return v(this,n),(l=i.call(this)).id=t,l.dispatcher=o,l.setEventedParent(s),l.type="raster",l.minzoom=0,l.maxzoom=22,l.roundZoom=!0,l.scheme="xyz",l.tileSize=512,l._loaded=!1,l._options=e.extend({type:"raster"},a),e.extend(r(l),e.pick(a,["url","scheme","tileSize"])),l}return y(n,[{key:"load",value:function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=$(this._options,this.map._requestManager,null,null,(function(i,n){t._tileJSONRequest=null,t._loaded=!0,i?t.fire(new e.ErrorEvent(i)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new Q(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"loadTile",value:function(t,i){var n=this,r=e.exported.devicePixelRatio>=2,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(a,e.ResourceType.Tile),(function(r,a,o,s){return delete t.request,t.aborted?(t.state="unloaded",i(null)):r?(t.state="errored",i(r)):a?(n.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s}),t.setTexture(a,n.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(n.dispatcher),void i(null)):i(null)}))}},{key:"abortTile",value:function(e,t){e.request&&(e.request.cancel(),delete e.request),t()}},{key:"unloadTile",value:function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}},{key:"hasTransition",value:function(){return!1}}],[{key:"loadTileData",value:function(e,t,i){e.setTexture(t,i)}},{key:"unloadTileData",value:function(e,t){e.texture&&t.saveTileTexture(e.texture)}}]),n}(e.Evented);function Ue(t,i,n,r,a,o,s,l){var u=[t,n,a,i,r,o,1,1,1],c=[s,l,1],p=e.adjoint([],u),d=e.transformMat3(c,c,e.transpose(p,p)),f=h(d,3),m=f[0],v=f[1],y=f[2];return e.multiply$1(u,[m,0,0,0,v,0,0,0,y],u)}var Ge=function(t){f(n,t);var i=m(n);function n(e,t,r,a){var o;return v(this,n),(o=i.call(this)).id=e,o.dispatcher=r,o.coordinates=t.coordinates,o.type="image",o.minzoom=0,o.maxzoom=22,o.tileSize=512,o.tiles={},o._loaded=!1,o.setEventedParent(a),o.options=t,o}return y(n,[{key:"load",value:function(t,i){var n=this;this._loaded=i||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(i,r){if(n._loaded=!0,i)n.fire(new e.ErrorEvent(i));else if(r){var a=e.window.HTMLImageElement;n.image=r instanceof a?e.exported.getImageData(r):r,n.width=n.image.width,n.height=n.image.height,t&&(n.coordinates=t),n._finishLoading()}}))}},{key:"loaded",value:function(){return this._loaded}},{key:"updateImage",value:function(e){return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}},{key:"_finishLoading",value:function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"onRemove",value:function(){this.texture&&this.texture.destroy()}},{key:"setCoordinates",value:function(t){this.coordinates=t,this._boundsArray=void 0;var i=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){var i,n=1/0,r=1/0,a=-1/0,o=-1/0,s=p(t);try{for(s.s();!(i=s.n()).done;){var l=i.value;n=Math.min(n,l.x),r=Math.min(r,l.y),a=Math.max(a,l.x),o=Math.max(o,l.y)}}catch(d){s.e(d)}finally{s.f()}var u=Math.max(a-n,o-r),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),h=Math.pow(2,c);return new e.CanonicalTileID(c,Math.floor((n+a)/2*h),Math.floor((r+o)/2*h))}(i),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}},{key:"_clear",value:function(){this._boundsArray=void 0}},{key:"_prepareData",value:function(t){for(var i in this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}if(!this._boundsArray){var r=e.tileTransform(this.tileID,this.map.transform.projection),a=this.coordinates.map((function(t){var i=r.projection.project(t[0],t[1]);return e.getTilePoint(r,i)._round()})),o=h(a,4),s=o[0],l=o[1],u=o[2],c=o[3];this.perspectiveTransform=function(t,i,n,r,a,o,s,l,u,c){var h=Ue(0,0,t,0,0,i,t,i),p=Ue(n,r,a,o,s,l,u,c);return e.multiply$1(p,e.adjoint(h,h),p),[p[6]/p[8]*t/e.EXTENT,p[7]/p[8]*i/e.EXTENT]}(this.width,this.height,s.x,s.y,l.x,l.y,c.x,c.y,u.x,u.y);var p=this._boundsArray=new e.StructArrayLayout4i8;p.emplaceBack(s.x,s.y,0,0),p.emplaceBack(l.x,l.y,e.EXTENT,0),p.emplaceBack(c.x,c.y,0,e.EXTENT),p.emplaceBack(u.x,u.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(p,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}}},{key:"prepare",value:function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,i=t.gl;this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this._prepareData(t)}}},{key:"loadTile",value:function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}},{key:"serialize",value:function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),We={vector:function(t){f(n,t);var i=m(n);function n(t,a,o,s){var u;if(v(this,n),(u=i.call(this)).id=t,u.dispatcher=o,u.type="vector",u.minzoom=0,u.maxzoom=22,u.scheme="xyz",u.tileSize=512,u.reparseOverscaled=!0,u.isTileClipped=!0,u._loaded=!1,e.extend(r(u),e.pick(a,["url","scheme","tileSize","promoteId"])),u._options=e.extend({type:"vector"},a),u._collectResourceTiming=a.collectResourceTiming,512!==u.tileSize)throw new Error("vector tile sources must have a tileSize of 512");return u.setEventedParent(s),u._tileWorkers={},u._deduped=new e.DedupedRequest,l(u)}return y(n,[{key:"load",value:function(t){var i=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));var n=this.language||this.map._language,r=this.worldview||this.map._worldview;this._tileJSONRequest=$(this._options,this.map._requestManager,n,r,(function(a,o){i._tileJSONRequest=null,i._loaded=!0,a?(n&&console.warn("Ensure that your requested language string is a valid BCP-47 code. Found: ".concat(n)),r&&2!==r.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(r)),i.fire(new e.ErrorEvent(a))):o&&(e.extend(i,o),o.bounds&&(i.tileBounds=new Q(o.bounds,i.minzoom,i.maxzoom)),e.postTurnstileEvent(o.tiles,i.map._requestManager._customAccessToken),i.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(a)}))}},{key:"loaded",value:function(){return this._loaded}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"setSourceProperty",value:function(e){var t=this;this._tileJSONRequest&&this._tileJSONRequest.cancel(),e(),this.load((function(){var e,i=t.map.style._getSourceCaches(t.id),n=p(i);try{for(n.s();!(e=n.n()).done;)e.value.clearTiles()}catch(r){n.e(r)}finally{n.f()}}))}},{key:"setTiles",value:function(e){var t=this;return this.setSourceProperty((function(){t._options.tiles=e})),this}},{key:"setUrl",value:function(e){var t=this;return this.setSourceProperty((function(){t.url=e,t._options.url=e})),this}},{key:"_setLanguage",value:function(e){var t=this;return e===this.language||this.setSourceProperty((function(){t.language=e})),this}},{key:"_setWorldview",value:function(e){var t=this;return e===this.worldview?this:this.worldviewOptions&&e&&!this.worldviewOptions[e]?(console.warn('Vector tile source "'.concat(this.id,'" does not support worldview "').concat(e,'".')),this):(this.setSourceProperty((function(){t.worldview=e})),this)}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"loadTile",value:function(t,i){var n=this,r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(r,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(a.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=i:t.request=t.actor.send("reloadTile",a,s.bind(this));else if(t.actor=this._tileWorkers[r]=this._tileWorkers[r]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",a,s.bind(this),void 0,!0);else{var o=e.loadVectorTile.call({deduped:this._deduped},a,(function(e,i){e||!i?s.call(n,e):(a.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},t.actor&&t.actor.send("loadTile",a,s.bind(n),void 0,!0))}),!0);t.request={cancel:o}}function s(n,r){return delete t.request,t.aborted?i(null):n&&404!==n.status?i(n):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"unloadTile",value:function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"hasTransition",value:function(){return!1}},{key:"afterUpdate",value:function(){this._tileWorkers={}}}]),n}(e.Evented),raster:Ne,"raster-dem":function(t){f(n,t);var i=m(n);function n(t,r,a,o){var s;return v(this,n),(s=i.call(this,t,r,a,o)).type="raster-dem",s.maxzoom=22,s._options=e.extend({type:"raster-dem"},r),s.encoding=r.encoding||"mapbox",s}return y(n,[{key:"loadTile",value:function(t,i){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(e,n){e&&(t.state="errored",i(e)),n&&(t.dem=n,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",i(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,a,o,s){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(n)t.state="errored",i(n);else if(a){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s});var l=e.window.ImageBitmap&&a instanceof e.window.ImageBitmap&&(null==J&&(J=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),J),u=1-(a.width-e.prevPowerOfTwo(a.width))/2;u<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));var c=l?a:e.exported.getImageData(a,u),h={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:c,encoding:this.encoding,padding:u};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",h,r.bind(this),void 0,!0))}}.bind(this))}},{key:"_getNeighboringTiles",value:function(t){var i=t.canonical,n=Math.pow(2,i.z),r=(i.x-1+n)%n,a=0===i.x?t.wrap-1:t.wrap,o=(i.x+1+n)%n,s=i.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,a,i.z,r,i.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y).key]={backfilled:!1},i.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,a,i.z,r,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y-1).key]={backfilled:!1}),i.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,a,i.z,r,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y+1).key]={backfilled:!1}),l}},{key:"unloadTile",value:function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}}]),n}(Ne),geojson:function(t){f(n,t);var i=m(n);function n(t,r,a,o){var s;v(this,n),(s=i.call(this)).id=t,s.type="geojson",s.minzoom=0,s.maxzoom=18,s.tileSize=512,s.isTileClipped=!0,s.reparseOverscaled=!0,s._loaded=!1,s.actor=a.getActor(),s.setEventedParent(o),s._data=r.data,s._options=e.extend({},r),s._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(s.maxzoom=r.maxzoom),r.type&&(s.type=r.type),r.attribution&&(s.attribution=r.attribution),s.promoteId=r.promoteId;var l=e.EXTENT/s.tileSize;return s.workerOptions=e.extend({source:s.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*l,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*l,extent:e.EXTENT,maxZoom:s.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:s.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==r.clusterRadius?r.clusterRadius:50)*l,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),s}return y(n,[{key:"onAdd",value:function(e){this.map=e,this.setData(this._data)}},{key:"setData",value:function(e){return this._data=e,this._updateWorkerData(),this}},{key:"getClusterExpansionZoom",value:function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}},{key:"getClusterChildren",value:function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}},{key:"getClusterLeaves",value:function(e,t,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:i},n),this}},{key:"_updateWorkerData",value:function(){var t=this;if(this._pendingLoad)this._coalesce=!0;else{this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;var i=e.extend({},this.workerOptions),n=this._data;"string"==typeof n?(i.request=this.map._requestManager.transformRequest(e.exported.resolveURL(n),e.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(n),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),i,(function(i,n){if(t._loaded=!0,t._pendingLoad=null,i)t.fire(new e.ErrorEvent(i));else{var r={dataType:"source",sourceDataType:t._metadataFired?"content":"metadata"};t._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[t.id]&&(r.resourceTiming=n.resourceTiming[t.id]),t.fire(new e.Event("data",r)),t._metadataFired=!0}t._coalesce&&(t._updateWorkerData(),t._coalesce=!1)}))}}},{key:"loaded",value:function(){return this._loaded}},{key:"loadTile",value:function(t,i){var n=this,r=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(r,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,a){return delete t.request,t.unloadVectorData(),t.aborted?i(null):e?i(e):(t.loadVectorData(a,n.map.painter,"reloadTile"===r),i(null))}),void 0,"loadTile"===r)}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}},{key:"unloadTile",value:function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"onRemove",value:function(){this._pendingLoad&&this._pendingLoad.cancel()}},{key:"serialize",value:function(){return e.extend({},this._options,{type:this.type,data:this._data})}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),video:function(t){f(n,t);var i=m(n);function n(e,t,r,a){var o;return v(this,n),(o=i.call(this,e,t,r,a)).roundZoom=!0,o.type="video",o.options=t,o}return y(n,[{key:"load",value:function(){var t=this;this._loaded=!1;var i=this.options;this.urls=[];var n,r=p(i.urls);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.urls.push(this.map._requestManager.transformRequest(a,e.ResourceType.Source).url)}}catch(o){r.e(o)}finally{r.f()}e.getVideo(this.urls,(function(i,n){t._loaded=!0,i?t.fire(new e.ErrorEvent(i)):n&&(t.video=n,t.video.loop=!0,t.video.setAttribute("playsinline",""),t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"play",value:function(){this.video&&this.video.play()}},{key:"seek",value:function(t){if(this.video){var i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(i.start(0)," and ").concat(i.end(0),"-second mark.")))):this.video.currentTime=t}}},{key:"getVideo",value:function(){return this.video}},{key:"onAdd",value:function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}},{key:"prepare",value:function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,i=t.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}}},{key:"serialize",value:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this.video&&!this.video.paused}}]),n}(Ge),image:Ge,canvas:function(t){f(n,t);var i=m(n);function n(t,r,a,o){var s;return v(this,n),s=i.call(this,t,r,a,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof e.window.HTMLCanvasElement||s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "canvas"'))),s.options=r,s.animate=void 0===r.animate||r.animate,s}return y(n,[{key:"load",value:function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}},{key:"getCanvas",value:function(){return this.canvas}},{key:"onAdd",value:function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}},{key:"onRemove",value:function(){this.pause()}},{key:"prepare",value:function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var i=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}}},{key:"serialize",value:function(){return{type:"canvas",coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this._playing}},{key:"_hasInvalidDimensions",value:function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e++){var i=t[e];if(isNaN(i)||i<=0)return!0}return!1}}]),n}(Ge),custom:function(t){f(n,t);var i=m(n);function n(t,a,o,s){var l;return v(this,n),(l=i.call(this)).id=t,l.type="custom",l._dataType="raster",l._dispatcher=o,l._implementation=a,l.setEventedParent(s),l.scheme="xyz",l.minzoom=0,l.maxzoom=22,l.tileSize=512,l._loaded=!1,l.roundZoom=!0,l._implementation||l.fire(new e.ErrorEvent(new Error("Missing implementation for ".concat(l.id," custom source")))),l._implementation.loadTile||l.fire(new e.ErrorEvent(new Error("Missing loadTile implementation for ".concat(l.id," custom source")))),l._implementation.bounds&&(l.tileBounds=new Q(l._implementation.bounds,l.minzoom,l.maxzoom)),a.update=l._update.bind(r(l)),a.coveringTiles=l._coveringTiles.bind(r(l)),e.extend(r(l),e.pick(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"])),l}return y(n,[{key:"serialize",value:function(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}},{key:"load",value:function(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}},{key:"onRemove",value:function(e){this._implementation.onRemove&&this._implementation.onRemove(e)}},{key:"hasTile",value:function(e){if(this._implementation.hasTile){var t=e.canonical,i=t.x,n=t.y,r=t.z;return this._implementation.hasTile({x:i,y:n,z:r})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"loadTile",value:function(t,i){var n=t.tileID.canonical,r=n.x,a=n.y,o=n.z,s=new e.window.AbortController,l=this._implementation.loadTile({x:r,y:a,z:o},{signal:s.signal});if(!l)return this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",i(null);l.cancel=function(){return s.abort()},t.request=l.then(function(n){return delete t.request,t.aborted?(t.state="unloaded",i(null)):n?function(t){return t instanceof e.window.ImageData||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLCanvasElement}(n)?(this.loadTileData(t,n),t.state="loaded",void i(null)):(t.state="errored",i(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment")))):(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",i(null))}.bind(this)).catch((function(e){20!==e.code&&(t.state="errored",i(e))}))}},{key:"loadTileData",value:function(e,t){Ne.loadTileData(e,t,this._map.painter)}},{key:"unloadTileData",value:function(e){Ne.unloadTileData(e,this._map.painter)}},{key:"prepareTile",value:function(e){if(!this._implementation.prepareTile)return null;var t=e.tileID.canonical,i=t.x,n=t.y,r=t.z,a=this._implementation.prepareTile({x:i,y:n,z:r});return a?(this.loadTileData(e,a),e.state="loaded",a):null}},{key:"unloadTile",value:function(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){var i=e.tileID.canonical,n=i.x,r=i.y,a=i.z;this._implementation.unloadTile({x:n,y:r,z:a})}t()}},{key:"abortTile",value:function(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}},{key:"hasTransition",value:function(){return!1}},{key:"_coveringTiles",value:function(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((function(e){return{x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}}))}},{key:"_update",value:function(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}]),n}(e.Evented)},He=function(t,i,n,r){var a=new We[i.type](t,i,n,r);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return e.bindAll(["load","abort","unload","serialize","prepare"],a),a};function Ze(t,i){var n=e.identity([]);return e.scale(n,n,[.5*t.width,.5*-t.height,1]),e.translate(n,n,[1,-1,0]),e.multiply(n,n,t.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(n)}function qe(e,t,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=e.tilesIn(n,o,s);l.sort(Ke);var u,c=[],h=p(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;c.push({wrappedTileID:d.tile.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,i,e._state,d,r,a,Ze(e.transform,d.tile.tileID),s)})}}catch(v){h.e(v)}finally{h.f()}var f=function(e){var t,i={},n={},r=p(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,o=a.queryResults,s=a.wrappedTileID,l=n[s]=n[s]||{};for(var u in o){var c,h=o[u],d=l[u]=l[u]||{},f=i[u]=i[u]||[],m=p(h);try{for(m.s();!(c=m.n()).done;){var y=c.value;d[y.featureIndex]||(d[y.featureIndex]=!0,f.push(y))}}catch(v){m.e(v)}finally{m.f()}}}}catch(v){r.e(v)}finally{r.f()}return i}(c);for(var m in f)f[m].forEach((function(t){var i=t.feature,n=i.layer;n&&"background"!==n.type&&"sky"!==n.type&&(i.source=n.source,n["source-layer"]&&(i.sourceLayer=n["source-layer"]),i.state=void 0!==i.id?e.getFeatureState(n["source-layer"],i.id):{})}));return f}function Xe(e,t){for(var i=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),n=[],r={},a=0;a<i.length;a++){var o=i[a],s=o.tileID.canonical.key;r[s]||(r[s]=!0,o.querySourceFeatures(n,t))}return n}function Ke(e,t){var i=e.tileID,n=t.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}function Ye(){return null!=ka.workerClass?new ka.workerClass:new e.window.Worker(ka.workerUrl)}var $e,Je="mapboxgl_preloaded_worker_pool",Qe=function(){function e(){v(this,e),this.active={}}return y(e,[{key:"acquire",value:function(t){if(!this.workers)for(this.workers=[];this.workers.length<e.workerCount;)this.workers.push(new Ye);return this.active[t]=!0,this.workers.slice()}},{key:"release",value:function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)}},{key:"isPreloaded",value:function(){return!!this.active[Je]}},{key:"numActive",value:function(){return Object.keys(this.active).length}}]),e}();function et(){return $e||($e=new Qe),$e}function tt(t,i){var n={};for(var r in t)"ref"!==r&&(n[r]=t[r]);return e.refProperties.forEach((function(e){e in i&&(n[e]=i[e])})),n}function it(e){e=e.slice();for(var t=Object.create(null),i=0;i<e.length;i++)t[e[i].id]=e[i];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=tt(e[n],t[e[n].ref]));return e}Qe.workerCount=2;var nt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function rt(e,t,i){i.push({command:nt.addSource,args:[e,t[e]]})}function at(e,t,i){t.push({command:nt.removeSource,args:[e]}),i[e]=!0}function ot(e,t,i,n){at(e,i,n),rt(e,t,i)}function st(e,i,n){var r;for(r in e[n])if(e[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;for(r in i[n])if(i[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;return!0}function lt(e,i,n,r,a,o){var s;for(s in i=i||{},e=e||{})e.hasOwnProperty(s)&&(t(e[s],i[s])||n.push({command:o,args:[r,s,i[s],a]}));for(s in i)i.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t(e[s],i[s])||n.push({command:o,args:[r,s,i[s],a]}))}function ut(e){return e.id}function ct(e,t){return e[t.id]=t,e}var ht=function(){function t(e,i){v(this,t),this.reset(e,i)}return y(t,[{key:"reset",value:function(e,t){this.points=e||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}},{key:"lerp",value:function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var i=1,n=this._distances[i],r=t*this.paddedLength+this.padding;n<r&&i<this._distances.length;)n=this._distances[++i];var a=i-1,o=this._distances[a],s=n-o,l=s>0?(r-o)/s:0;return this.points[a].mult(1-l).add(this.points[i].mult(l))}}]),t}(),pt=function(){function e(t,i,n){v(this,e);var r=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(i/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=i,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}return y(e,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}},{key:"insertCircle",value:function(e,t,i,n){this._forEachCell(t-n,i-n,t+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(n)}},{key:"_insertBoxCell",value:function(e,t,i,n,r,a){this.boxCells[r].push(a)}},{key:"_insertCircleCell",value:function(e,t,i,n,r,a){this.circleCells[r].push(a)}},{key:"_query",value:function(e,t,i,n,r,a){if(i<0||e>this.width||n<0||t>this.height)return!r&&[];var o=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=n){if(r)return!0;for(var s=0;s<this.boxKeys.length;s++)o.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];o.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return a?o.filter(a):o}return this._forEachCell(e,t,i,n,this._queryCell,o,{hitTest:r,seenUids:{box:{},circle:{}}},a),r?o.length>0:o}},{key:"_queryCircle",value:function(e,t,i,n,r){var a=e-i,o=e+i,s=t-i,l=t+i;if(o<0||a>this.width||l<0||s>this.height)return!n&&[];var u=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,u,{hitTest:n,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}},r),n?u.length>0:u}},{key:"query",value:function(e,t,i,n,r){return this._query(e,t,i,n,!1,r)}},{key:"hitTest",value:function(e,t,i,n,r){return this._query(e,t,i,n,!0,r)}},{key:"hitTestCircle",value:function(e,t,i,n){return this._queryCircle(e,t,i,!0,n)}},{key:"_queryCell",value:function(e,t,i,n,r,a,o,s){var l=o.seenUids,u=this.boxCells[r];if(null!==u){var c,h=this.bboxes,d=p(u);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(!l.box[f]){l.box[f]=!0;var m=4*f;if(e<=h[m+2]&&t<=h[m+3]&&i>=h[m+0]&&n>=h[m+1]&&(!s||s(this.boxKeys[f]))){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[f],x1:h[m],y1:h[m+1],x2:h[m+2],y2:h[m+3]})}}}}catch(S){d.e(S)}finally{d.f()}}var v=this.circleCells[r];if(null!==v){var y,g=this.circles,_=p(v);try{for(_.s();!(y=_.n()).done;){var b=y.value;if(!l.circle[b]){l.circle[b]=!0;var x=3*b;if(this._circleAndRectCollide(g[x],g[x+1],g[x+2],e,t,i,n)&&(!s||s(this.circleKeys[b]))){if(o.hitTest)return a.push(!0),!0;var w=g[x],k=g[x+1],P=g[x+2];a.push({key:this.circleKeys[b],x1:w-P,y1:k-P,x2:w+P,y2:k+P})}}}}catch(S){_.e(S)}finally{_.f()}}}},{key:"_queryCellCircle",value:function(e,t,i,n,r,a,o,s){var l=o.circle,u=o.seenUids,c=this.boxCells[r];if(null!==c){var h,d=this.bboxes,f=p(c);try{for(f.s();!(h=f.n()).done;){var m=h.value;if(!u.box[m]){u.box[m]=!0;var v=4*m;if(this._circleAndRectCollide(l.x,l.y,l.radius,d[v+0],d[v+1],d[v+2],d[v+3])&&(!s||s(this.boxKeys[m])))return a.push(!0),!0}}}catch(k){f.e(k)}finally{f.f()}}var y=this.circleCells[r];if(null!==y){var g,_=this.circles,b=p(y);try{for(b.s();!(g=b.n()).done;){var x=g.value;if(!u.circle[x]){u.circle[x]=!0;var w=3*x;if(this._circlesCollide(_[w],_[w+1],_[w+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return a.push(!0),!0}}}catch(k){b.e(k)}finally{b.f()}}}},{key:"_forEachCell",value:function(e,t,i,n,r,a,o,s){for(var l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(i),h=this._convertToYCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++)if(r.call(this,e,t,i,n,this.xCellCount*d+p,a,o,s))return}},{key:"_convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"_convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}},{key:"_circlesCollide",value:function(e,t,i,n,r,a){var o=n-e,s=r-t,l=i+a;return l*l>o*o+s*s}},{key:"_circleAndRectCollide",value:function(e,t,i,n,r,a,o){var s=(a-n)/2,l=Math.abs(e-(n+s));if(l>s+i)return!1;var u=(o-r)/2,c=Math.abs(t-(r+u));if(c>u+i)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=i*i}}]),e}(),dt=Math.tan(85*Math.PI/180);function ft(t,i,n,r,a,o,s){var l=e.create();if(n)if("globe"===o.name){var u=e.calculateGlobeLabelMatrix(a,i);e.multiply(l,l,u)}else{var c=O([],s);l[0]=c[0],l[1]=c[1],l[4]=c[2],l[5]=c[3],r||e.rotateZ(l,l,a.angle)}else e.multiply(l,a.labelPlaneMatrix,t);return l}function mt(e,t,i,n,r,a,o){var s=ft(e,t,i,n,r,a,o);return"globe"===a.name&&i||(s[2]=s[6]=s[10]=s[14]=0),s}function vt(t,i,n,r,a,o,s){if(n){if("globe"===o.name){var l=ft(t,i,n,r,a,o,s);return e.invert(l,l),e.multiply(l,t,l),l}var u=e.clone(t),c=e.identity([]);return c[0]=s[0],c[1]=s[1],c[4]=s[2],c[5]=s[3],e.multiply(u,u,c),r||e.rotateZ(u,u,-a.angle),u}return a.glCoordMatrix}function yt(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t.x,t.y,n,1];n?e.transformMat4$1(r,r,i):It(r,r,i);var a=r[3];return{point:[r[0]/a,r[1]/a,r[2]/a],signedDistanceFromCamera:a}}function gt(t,i){var n=[t[0],t[1],t[2],1];e.transformMat4$1(n,n,i);var r=n[3];return{point:[n[0]/r,n[1]/r,n[2]/r],signedDistanceFromCamera:r}}function _t(e,t){return Math.min(.5+e/t*.5,1.5)}function bt(e,t){var i=e[0]/e[3],n=e[1]/e[3];return i>=-t[0]&&i<=t[0]&&n>=-t[1]&&n<=t[1]}function xt(t,i,n,r,a,o,s,l,u,c){var h=n.transform,p=r?t.textSizeData:t.iconSizeData,d=e.evaluateSizeForZoom(p,n.transform.zoom),f="globe"===h.projection.name,m=[256/n.width*2+1,256/n.height*2+1],v=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;v.clear();var y=null;f&&(y=r?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);for(var g=t.lineVertexArray,_=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=n.transform.width/n.transform.height,x=!1,w=0;w<_.length;w++){var k=_.get(w);if(k.writingMode!==e.WritingMode.vertical||x||0!==w&&_.get(w-1).writingMode===e.WritingMode.horizontal||(x=!0),!k.hidden&&k.writingMode!==e.WritingMode.vertical||x){x=!1;var P=new e.pointGeometry(k.tileAnchorX,k.tileAnchorY),S=u?u(P):[0,0,0],T=h.projection.projectTilePoint(P.x,P.y,c.canonical),E=[T.x+S[0],T.y+S[1],T.z+S[2]],C=[].concat(E,[1]);if(e.transformMat4$1(C,C,i),bt(C,m)){var M=_t(n.transform.cameraToCenterDistance,C[3]),I=e.evaluateSizeForFeature(p,d,k),O=s?I/M:I*M,D=yt(new e.pointGeometry(E[0],E[1]),a,E[2]);if(D.signedDistanceFromCamera<=0)Mt(k.numGlyphs,v);else{var A={},L=s?null:u,z=Pt(k,O,!1,l,i,a,o,t.glyphOffsetArray,g,v,y,D.point,P,A,b,L,h.projection,c,s);x=z.useVertical,L&&z.needsFlipping&&(A={}),(z.notEnoughRoom||x||z.needsFlipping&&Pt(k,O,!0,l,i,a,o,t.glyphOffsetArray,g,v,y,D.point,P,A,b,L,h.projection,c,s).notEnoughRoom)&&Mt(k.numGlyphs,v)}}else Mt(k.numGlyphs,v)}else Mt(k.numGlyphs,v)}r?(t.text.dynamicLayoutVertexBuffer.updateData(v),y&&t.text.globeExtVertexBuffer.updateData(y)):(t.icon.dynamicLayoutVertexBuffer.updateData(v),y&&t.icon.globeExtVertexBuffer.updateData(y))}function wt(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m){var v=s.glyphStartIndex+s.numGlyphs,y=s.lineStartIndex,g=s.lineStartIndex+s.lineLength,_=t.getoffsetX(s.glyphStartIndex),b=t.getoffsetX(v-1),x=Et(e*_,i,n,r,a,o,s.segment,y,g,l,u,c,h,p,!0,d,f,m);if(!x)return null;var w=Et(e*b,i,n,r,a,o,s.segment,y,g,l,u,c,h,p,!0,d,f,m);return w?{first:x,last:w}:null}function kt(t,i,n,r){return t.writingMode===e.WritingMode.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*r?{useVertical:!0}:t.writingMode===e.WritingMode.vertical?i.y<n.y?{needsFlipping:!0}:null:0!==t.flipState&&function(e,t,i){var n=(t.x-e.x)*i;return 0===n||Math.abs((t.y-e.y)/n)>dt}(i,n,r)?1===t.flipState?{needsFlipping:!0}:null:i.x>n.x?{needsFlipping:!0}:null}function Pt(t,i,n,r,a,o,s,l,u,c,h,d,f,m,v,y,g,_,b){var x,w=i/24,k=t.lineOffsetX*w,P=t.lineOffsetY*w;if(t.numGlyphs>1){var S=t.glyphStartIndex+t.numGlyphs,T=t.lineStartIndex,E=t.lineStartIndex+t.lineLength,C=wt(w,l,k,P,n,d,f,t,u,o,m,y,!1,g,_,b);if(!C)return{notEnoughRoom:!0};var M=gt(C.first.point,s).point,I=gt(C.last.point,s).point,O=new e.pointGeometry(M[0],M[1]),D=new e.pointGeometry(I[0],I[1]);if(r&&!n){var A=kt(t,O,D,v);if(t.flipState=A&&A.needsFlipping?1:2,A)return A}x=[C.first];for(var L=t.glyphStartIndex+1;L<S-1;L++)x.push(Et(w*l.getoffsetX(L),k,P,n,d,f,t.segment,T,E,u,o,m,y,!1,!1,g,_,b));x.push(C.last)}else{if(r&&!n){var z=yt(f,a).point,R=t.lineStartIndex+t.segment+1,F=new e.pointGeometry(u.getx(R),u.gety(R)),j=yt(F,a),B=j.signedDistanceFromCamera>0?j.point:Tt(f,F,z,1,a,void 0,g,_.canonical),V=kt(t,new e.pointGeometry(z[0],z[1]),new e.pointGeometry(B[0],B[1]),v);if(t.flipState=V&&V.needsFlipping?1:2,V)return V}var N=Et(w*l.getoffsetX(t.glyphStartIndex),k,P,n,d,f,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,m,y,!1,!1,g,_,b);if(!N)return{notEnoughRoom:!0};x=[N]}if(h){var U,G=p(x);try{for(G.s();!(U=G.n()).done;){var W=U.value;e.updateGlobeVertexNormal(h,c.length+0,W.up[0],W.up[1],W.up[2]),e.updateGlobeVertexNormal(h,c.length+1,W.up[0],W.up[1],W.up[2]),e.updateGlobeVertexNormal(h,c.length+2,W.up[0],W.up[1],W.up[2]),e.updateGlobeVertexNormal(h,c.length+3,W.up[0],W.up[1],W.up[2]),e.addDynamicAttributes(c,W.point[0],W.point[1],W.point[2],W.angle)}}catch(X){G.e(X)}finally{G.f()}}else{var H,Z=p(x);try{for(Z.s();!(H=Z.n()).done;){var q=H.value;e.addDynamicAttributes(c,q.point[0],q.point[1],q.point[2],q.angle)}}catch(X){Z.e(X)}finally{Z.f()}}return{}}function St(t,i,n,r,a){var o=r.projectTilePoint(t.x,t.y,i);if(!a)return yt(o,n,o.z);var s=a(t);return yt(new e.pointGeometry(o.x+s[0],o.y+s[1]),n,o.z+s[2])}function Tt(t,i,n,r,a,o,s,l){var u=St(t.add(t.sub(i)._unit()),l,a,s,o).point,c=e.sub([],n,u);return e.scaleAndAdd([],n,c,r/e.length(c))}function Et(t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y,g){var _=r?t-i:t+i,b=_>0?1:-1,x=0;r&&(b*=-1,x=Math.PI),b<0&&(x+=Math.PI);for(var w=b>0?l+s:l+s+1,k=a,P=a,S=0,T=0,E=Math.abs(_),C=[],M=[],I=o,O=function(){var t=w-b;return 0===S?o:new e.pointGeometry(c.getx(t),c.gety(t))},D=function(){return Tt(O(),I,P,E-S+1,h,d,v,y.canonical)};S+T<=E;){if((w+=b)<l||w>=u)return null;if(P=k,C.push(k),f&&M.push(I||O()),void 0===(k=p[w])){var A=St(I=new e.pointGeometry(c.getx(w),c.gety(w)),y.canonical,h,v,d);k=A.signedDistanceFromCamera>0?p[w]=A.point:D()}else I=null;S+=T,T=e.distance(P,k)}I=I||new e.pointGeometry(c.getx(w),c.gety(w));var L=O();m&&d&&(p[w]=k=void 0===p[w]?k:D(),T=e.distance(P,k));var z=(E-S)/T,R=I.sub(L).mult(z)._add(L),F=e.sub([],k,P),j=e.scaleAndAdd([],P,F,z),B=[0,0,1],V=F[0],N=F[1];if(g&&(0!==(B=v.upVector(y.canonical,R.x,R.y))[0]||0!==B[1]||1!==B[2])){var U=[1,0,0],G=[0,1,0];U[0]=B[2],U[1]=0,U[2]=-B[0],e.cross(G,B,U),e.normalize(U,U),e.normalize(G,G),V=e.dot(F,U),N=e.dot(F,G)}if(n){var W=e.cross([],B,F);e.normalize(W,W),e.scaleAndAdd(j,j,W,n*b)}var H=x+Math.atan2(N,V);return C.push(j),f&&M.push(R),{point:j,angle:H,path:C,tilePath:M,up:B}}var Ct=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Mt(e,t){for(var i=0;i<e;i++){var n=t.length;t.resize(n+4),t.float32.set(Ct,4*n)}}function It(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e[3]=i[3]*n+i[7]*r+i[15],e}var Ot=100,Dt=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new pt(e.width+200,e.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new pt(e.width+200,e.height+200,25);v(this,t),this.transform=e,this.grid=n,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Ot,this.screenBottomBoundary=e.height+Ot,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=i}return y(t,[{key:"placeCollisionBox",value:function(e,t,i,n,r,a,o,s){var l=i.projectedAnchorX,u=i.projectedAnchorY,c=i.projectedAnchorZ,h=i.elevation,p=i.tileID;if(h&&p){var d=e.getProjection().upVector(p.canonical,i.tileAnchorX,i.tileAnchorY),f=e.getProjection().upVectorScale(p.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=d[0]*h*f,u+=d[1]*h*f,c+=d[2]*h*f}var m=this.projectAndGetPerspectiveRatio(o,[l,u,c],i.tileID,"globe"===e.projection.name||!!h||this.transform.pitch>0,e.getProjection()),v=a*m.perspectiveRatio,y=(i.x1*t+n.x-i.padding)*v+m.point.x,g=(i.y1*t+n.y-i.padding)*v+m.point.y,_=(i.x2*t+n.x+i.padding)*v+m.point.x,b=(i.y2*t+n.y+i.padding)*v+m.point.y,x=m.perspectiveRatio<=.55||m.occluded;return!this.isInsideGrid(y,g,_,b)||!r&&this.grid.hitTest(y,g,_,b,s)||x?{box:[],offscreen:!1,occluded:m.occluded}:{box:[y,g,_,b],offscreen:this.isOffscreen(y,g,_,b),occluded:!1}}},{key:"placeCollisionCircles",value:function(t,i,n,r,a,o,s,l,u,c,h,d,f,m,v){var y=[],g=this.transform.elevation,_=g?g.getAtTileOffsetFunc(v,this.transform.center.lat,this.transform.worldSize,t.getProjection()):function(e){return[0,0,0]},b=new e.pointGeometry(n.tileAnchorX,n.tileAnchorY),x=t.getProjection().projectTilePoint(n.tileAnchorX,n.tileAnchorY,v.canonical),w=_(b),k=[x.x+w[0],x.y+w[1],x.z+w[2]],P="globe"===t.projection.name,S=this.projectAndGetPerspectiveRatio(s,[k[0],k[1],k[2]],v,P||!!g||this.transform.pitch>0,t.getProjection()),T=S.perspectiveRatio,E=(h?o/T:o*T)/e.ONE_EM,C=yt(new e.pointGeometry(k[0],k[1]),l,k[2]).point,M=S.signedDistanceFromCamera>0?wt(E,a,n.lineOffsetX*E,n.lineOffsetY*E,!1,C,b,n,r,l,{},g&&!h?_:null,h&&!!g,t.getProjection(),v,h):null,I=!1,O=!1,D=!0;if(M&&!S.occluded){for(var A=.5*f*T+m,L=new e.pointGeometry(-100,-100),z=new e.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),R=new ht,F=M.first,j=M.last,B=[],V=F.path.length-1;V>=1;V--)B.push(F.path[V]);for(var N=1;N<j.path.length;N++)B.push(j.path[N]);var U=2.5*A;if(u){var G=B.map(g&&!P?function(e,t){var i=_(t<F.path.length-1?F.tilePath[F.path.length-1-t]:j.tilePath[t-F.path.length+2]);return e[2]=i[2],gt(e,u)}:function(e){return gt(e,u)});B=G.some((function(e){return e.signedDistanceFromCamera<=0}))?[]:G.map((function(e){return e.point}))}var W=[];if(B.length>0){for(var H=B.map((function(t){return new e.pointGeometry(t[0],t[1])})),Z=1/0,q=-1/0,X=1/0,K=-1/0,Y=0;Y<H.length;Y++)Z=Math.min(Z,H[Y].x),X=Math.min(X,H[Y].y),q=Math.max(q,H[Y].x),K=Math.max(K,H[Y].y);W=Z>=L.x&&q<=z.x&&X>=L.y&&K<=z.y?[H]:q<L.x||Z>z.x||K<L.y||X>z.y?[]:e.clipLine([H],L.x,L.y,z.x,z.y)}var $,J=p(W);try{for(J.s();!($=J.n()).done;){var Q=$.value;R.reset(Q,.25*A);var ee=0;ee=R.length<=.5*A?1:Math.ceil(R.paddedLength/U)+1;for(var te=0;te<ee;te++){var ie=te/Math.max(ee-1,1),ne=R.lerp(ie),re=ne.x+Ot,ae=ne.y+Ot;y.push(re,ae,A,0);var oe=re-A,se=ae-A,le=re+A,ue=ae+A;if(D=D&&this.isOffscreen(oe,se,le,ue),O=O||this.isInsideGrid(oe,se,le,ue),!i&&this.grid.hitTestCircle(re,ae,A,d)&&(I=!0,!c))return{circles:[],offscreen:!1,collisionDetected:I,occluded:!1}}}}catch(ce){J.e(ce)}finally{J.f()}}return{circles:!c&&I||!O?[]:y,offscreen:D,collisionDetected:I,occluded:S.occluded}}},{key:"queryRenderedSymbols",value:function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var i,n=[],r=1/0,a=1/0,o=-1/0,s=-1/0,l=p(t);try{for(l.s();!(i=l.n()).done;){var u=i.value,c=new e.pointGeometry(u.x+Ot,u.y+Ot);r=Math.min(r,c.x),a=Math.min(a,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y),n.push(c)}}catch(b){l.e(b)}finally{l.f()}var h,d=this.grid.query(r,a,o,s).concat(this.ignoredGrid.query(r,a,o,s)),f={},m={},v=p(d);try{for(v.s();!(h=v.n()).done;){var y=h.value,g=y.key;if(void 0===f[g.bucketInstanceId]&&(f[g.bucketInstanceId]={}),!f[g.bucketInstanceId][g.featureIndex]){var _=[new e.pointGeometry(y.x1,y.y1),new e.pointGeometry(y.x2,y.y1),new e.pointGeometry(y.x2,y.y2),new e.pointGeometry(y.x1,y.y2)];e.polygonIntersectsPolygon(n,_)&&(f[g.bucketInstanceId][g.featureIndex]=!0,void 0===m[g.bucketInstanceId]&&(m[g.bucketInstanceId]=[]),m[g.bucketInstanceId].push(g.featureIndex))}}}catch(b){v.e(b)}finally{v.f()}return m}},{key:"insertCollisionBox",value:function(e,t,i,n,r){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:n,collisionGroupID:r},e[0],e[1],e[2],e[3])}},{key:"insertCollisionCircles",value:function(e,t,i,n,r){for(var a=t?this.ignoredGrid:this.grid,o={bucketInstanceId:i,featureIndex:n,collisionGroupID:r},s=0;s<e.length;s+=4)a.insertCircle(o,e[s],e[s+1],e[s+2])}},{key:"projectAndGetPerspectiveRatio",value:function(t,i,n,r,a){var o=[i[0],i[1],i[2],1],s=!1;if(i[2]||this.transform.pitch>0){e.transformMat4$1(o,o,t);var l="globe"===a.name;this.fogState&&n&&!l&&(s=function(t,i,n,r,a,o){var s=o.calculateFogTileMatrix(a),l=[i,n,r];return e.transformMat4(l,l,s),V(t,l,o.pitch,o._fov)}(this.fogState,i[0],i[1],i[2],n.toUnwrapped(),this.transform)>.9)}else It(o,o,t);return{point:new e.pointGeometry((o[0]/o[3]+1)/2*this.transform.width+Ot,(-o[1]/o[3]+1)/2*this.transform.height+Ot),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/o[3]*.5,1.5),signedDistanceFromCamera:o[3],occluded:r&&o[2]>o[3]||s}}},{key:"isOffscreen",value:function(e,t,i,n){return i<Ot||e>=this.screenRightBoundary||n<Ot||t>this.screenBottomBoundary}},{key:"isInsideGrid",value:function(e,t,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}},{key:"getViewportMatrix",value:function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}]),t}();function At(t,i,n){var r=i.createTileMatrix(t,t.worldSize,n.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,r)}function Lt(e,t,i){if(t.projection.name===i.projection.name)return e.projMatrix;var n=i.clone();return n.setProjection(t.projection),At(n,t.getProjection(),e)}function zt(e,t,i){return t.name===i.projection.name?e.projMatrix:At(i,t,e)}var Rt=function(){function e(t,i,n,r){v(this,e),this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?i:-i))):r&&n?1:0,this.placed=n}return y(e,[{key:"isHidden",value:function(){return 0===this.opacity&&!this.placed}}]),e}(),Ft=function(){function e(t,i,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];v(this,e),this.text=new Rt(t?t.text:null,i,n,a),this.icon=new Rt(t?t.icon:null,i,r,a),this.clipped=o}return y(e,[{key:"isHidden",value:function(){return this.text.isHidden()&&this.icon.isHidden()}}]),e}(),jt=y((function e(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];v(this,e),this.text=t,this.icon=i,this.skipFade=n,this.clipped=r})),Bt=y((function t(){v(this,t),this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]})),Vt=y((function e(t,i,n,r,a){v(this,e),this.bucketInstanceId=t,this.featureIndex=i,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=a})),Nt=function(){function e(t){v(this,e),this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}return y(e,[{key:"get",value:function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]}}]),e}();function Ut(t,i,n,r,a){var o=e.getAnchorAlignment(t),s=-(o.horizontalAlign-.5)*i,l=-(o.verticalAlign-.5)*n,u=e.evaluateVariableOffset(t,r);return new e.pointGeometry(s+u[0]*a,l+u[1]*a)}function Gt(t,i,n,r,a){var o=new e.pointGeometry(t,i);return n&&o._rotate(r?a:-a),o}var Wt=function(){function t(e,i,n,r,a){v(this,t),this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new Dt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Nt(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}return y(t,[{key:"getBucketParts",value:function(t,i,n,r){var a=n.getBucket(i),o=n.latestFeatureIndex;if(a&&o&&i.id===a.layerIds[0]){var s=a.layers[0].layout,l=n.collisionBoxArray,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/e.EXTENT,h=n.tileID.toUnwrapped();this.transform.setProjection(a.projection);var d,f,m,v=(d=n.tileID,f=a.getProjection(),m=this.transform,f.name===this.projection?m.calculateProjMatrix(d.toUnwrapped()):At(m,f,d)),y="map"===s.get("text-pitch-alignment"),g="map"===s.get("text-rotation-alignment");i.compileFilter();var _=i.dynamicFilter(),b=i.dynamicFilterNeedsFeature(),x=this.transform.calculatePixelsToTileUnitsMatrix(n),w=mt(v,n.tileID.canonical,y,g,this.transform,a.getProjection(),x),k=null;if(y){var P=vt(v,n.tileID.canonical,y,g,this.transform,a.getProjection(),x);k=e.multiply([],this.transform.labelPlaneMatrix,P)}var S=null;_&&n.latestFeatureIndex&&(S={unwrappedTileID:h,dynamicFilter:_,dynamicFilterNeedsFeature:b,featureIndex:n.latestFeatureIndex}),this.retainedQueryData[a.bucketInstanceId]=new Vt(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);var T={bucket:a,layout:s,posMatrix:v,textLabelPlaneMatrix:w,labelToScreenMatrix:k,clippingData:S,scale:u,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(a.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(a.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r){var E,C=p(a.sortKeyRanges);try{for(C.s();!(E=C.n()).done;){var M=E.value,I=M.sortKey,O=M.symbolInstanceStart,D=M.symbolInstanceEnd;t.push({sortKey:I,symbolInstanceStart:O,symbolInstanceEnd:D,parameters:T})}}catch(A){C.e(A)}finally{C.f()}}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:T})}}},{key:"attemptAnchorPlacement",value:function(e,t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y){var g,_=[h.textOffset0,h.textOffset1],b=Ut(e,i,n,_,r),x=this.collisionIndex.placeCollisionBox(d,r,t,Gt(b.x,b.y,a,o,this.transform.angle),c,s,l,u.predicate);if((!m||0!==this.collisionIndex.placeCollisionBox(d,d.getSymbolInstanceIconSize(y,this.transform.zoom,p),m,Gt(b.x,b.y,a,o,this.transform.angle),c,s,l,u.predicate).box.length)&&x.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(g=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:_,width:i,height:n,anchor:e,textScale:r,prevAnchor:g},this.markUsedJustification(d,e,h,f),d.allowVerticalPlacement&&(this.markUsedOrientation(d,f,h),this.placedOrientations[h.crossTileID]=f),{shift:b,placedGlyphBoxes:x}}},{key:"placeLayerBucketPart",value:function(t,i,n,r){var a=this,o=t.parameters,s=o.bucket,l=o.layout,u=o.posMatrix,c=o.textLabelPlaneMatrix,h=o.labelToScreenMatrix,d=o.clippingData,f=o.textPixelRatio,m=o.holdingForFade,v=o.collisionBoxArray,y=o.partiallyEvaluatedTextSize,g=o.partiallyEvaluatedIconSize,_=o.collisionGroup,b=l.get("text-optional"),x=l.get("icon-optional"),w=l.get("text-allow-overlap"),k=l.get("icon-allow-overlap"),P="map"===l.get("text-rotation-alignment"),S="map"===l.get("text-pitch-alignment"),T="none"!==l.get("icon-text-fit"),E="viewport-y"===l.get("symbol-z-order");this.transform.setProjection(s.projection);var C=w&&(k||!s.hasIconData()||x),M=k&&(w||!s.hasTextData()||b);!s.collisionArrays&&v&&s.deserializeCollisionBoxes(v),n&&r&&s.updateCollisionDebugBuffers(this.transform.zoom,v);var I=function(t,r,o){if(d){var v={zoom:a.transform.zoom,pitch:a.transform.pitch},E=null;if(d.dynamicFilterNeedsFeature){var I=a.retainedQueryData[s.bucketInstanceId];E=d.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:I.bucketIndex,sourceLayerIndex:I.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,d.dynamicFilter)(v,E,a.retainedQueryData[s.bucketInstanceId].tileID.canonical,new e.pointGeometry(t.tileAnchorX,t.tileAnchorY),a.transform.calculateDistanceTileData(d.unwrappedTileID)))return a.placements[t.crossTileID]=new jt(!1,!1,!1,!0),void(i[t.crossTileID]=!0)}if(!i[t.crossTileID])if(m)a.placements[t.crossTileID]=new jt(!1,!1,!1);else{var O=!1,D=!1,A=!0,L=!1,z=!1,R=null,F={box:null,offscreen:null,occluded:null},j={box:null,offscreen:null,occluded:null},B=null,V=null,N=null,U=0,G=0,W=0;o.textFeatureIndex?U=o.textFeatureIndex:t.useRuntimeCollisionCircles&&(U=t.featureIndex),o.verticalTextFeatureIndex&&(G=o.verticalTextFeatureIndex);var H=function(e){e.tileID=a.retainedQueryData[s.bucketInstanceId].tileID,(a.transform.elevation||e.elevation)&&(e.elevation=a.transform.elevation?a.transform.elevation.getAtTileOffset(a.retainedQueryData[s.bucketInstanceId].tileID,e.tileAnchorX,e.tileAnchorY):0)},Z=o.textBox;if(Z){H(Z);var q=function(i){var n=e.WritingMode.horizontal;if(s.allowVerticalPlacement&&!i&&a.prevPlacement){var r=a.prevPlacement.placedOrientations[t.crossTileID];r&&(a.placedOrientations[t.crossTileID]=r,n=r,a.markUsedOrientation(s,n,t))}return n},X=function(i,n){if(s.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&o.verticalTextBox){var r,a=p(s.writingModes);try{for(a.s();!(r=a.n()).done&&(r.value===e.WritingMode.vertical?(F=n(),j=F):F=i(),!(F&&F.box&&F.box.length)););}catch(l){a.e(l)}finally{a.f()}}else F=i()};if(l.get("text-variable-anchor")){var K=l.get("text-variable-anchor");if(a.prevPlacement&&a.prevPlacement.variableOffsets[t.crossTileID]){var Y=a.prevPlacement.variableOffsets[t.crossTileID];K.indexOf(Y.anchor)>0&&(K=K.filter((function(e){return e!==Y.anchor})),K.unshift(Y.anchor))}var $=function(e,i,n){var o=s.getSymbolInstanceTextSize(y,t,a.transform.zoom,r),l=(e.x2-e.x1)*o+2*e.padding,c=(e.y2-e.y1)*o+2*e.padding,h=T&&!k?i:null;h&&H(h);for(var p={box:[],offscreen:!1,occluded:!1},d=w?2*K.length:K.length,m=0;m<d;++m){var v=a.attemptAnchorPlacement(K[m%K.length],e,l,c,o,P,S,f,u,_,m>=K.length,t,r,s,n,h,y,g);if(v&&(p=v.placedGlyphBoxes)&&p.box&&p.box.length){O=!0,R=v.shift;break}}return p};X((function(){return $(Z,o.iconBox,e.WritingMode.horizontal)}),(function(){var i=o.verticalTextBox;return i&&H(i),s.allowVerticalPlacement&&!(F&&F.box&&F.box.length)&&t.numVerticalGlyphVertices>0&&i?$(i,o.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),F&&(O=F.box,A=F.offscreen,L=F.occluded);var J=q(F&&F.box);if(!O&&a.prevPlacement){var Q=a.prevPlacement.variableOffsets[t.crossTileID];Q&&(a.variableOffsets[t.crossTileID]=Q,a.markUsedJustification(s,Q.anchor,t,J))}}else{var ee=function(i,n){var o=s.getSymbolInstanceTextSize(y,t,a.transform.zoom,r),l=a.collisionIndex.placeCollisionBox(s,o,i,new e.pointGeometry(0,0),w,f,u,_.predicate);return l&&l.box&&l.box.length&&(a.markUsedOrientation(s,n,t),a.placedOrientations[t.crossTileID]=n),l};X((function(){return ee(Z,e.WritingMode.horizontal)}),(function(){var i=o.verticalTextBox;return s.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&i?(H(i),ee(i,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),q(F&&F.box&&F.box.length)}}if(O=(B=F)&&B.box&&B.box.length>0,A=B&&B.offscreen,L=B&&B.occluded,t.useRuntimeCollisionCircles){var te=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),ie=e.evaluateSizeForFeature(s.textSizeData,y,te),ne=l.get("text-padding");V=a.collisionIndex.placeCollisionCircles(s,w,te,s.lineVertexArray,s.glyphOffsetArray,ie,u,c,h,n,S,_.predicate,t.collisionCircleDiameter*ie/e.ONE_EM,ne,a.retainedQueryData[s.bucketInstanceId].tileID),O=w||V.circles.length>0&&!V.collisionDetected,A=A&&V.offscreen,L=V.occluded}if(o.iconFeatureIndex&&(W=o.iconFeatureIndex),o.iconBox){var re=function(t){H(t);var i=T&&R?Gt(R.x,R.y,P,S,a.transform.angle):new e.pointGeometry(0,0),n=s.getSymbolInstanceIconSize(g,a.transform.zoom,r);return a.collisionIndex.placeCollisionBox(s,n,t,i,k,f,u,_.predicate)};D=j&&j.box&&j.box.length&&o.verticalIconBox?(N=re(o.verticalIconBox)).box.length>0:(N=re(o.iconBox)).box.length>0,A=A&&N.offscreen,z=N.occluded}var ae=b||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,oe=x||0===t.numIconVertices;if(ae||oe?oe?ae||(D=D&&O):O=D&&O:D=O=D&&O,O&&B&&B.box&&a.collisionIndex.insertCollisionBox(B.box,l.get("text-ignore-placement"),s.bucketInstanceId,j&&j.box&&G?G:U,_.ID),D&&N&&a.collisionIndex.insertCollisionBox(N.box,l.get("icon-ignore-placement"),s.bucketInstanceId,W,_.ID),V&&(O&&a.collisionIndex.insertCollisionCircles(V.circles,l.get("text-ignore-placement"),s.bucketInstanceId,U,_.ID),n)){var se=s.bucketInstanceId,le=a.collisionCircleArrays[se];void 0===le&&(le=a.collisionCircleArrays[se]=new Bt);for(var ue=0;ue<V.circles.length;ue+=4)le.circles.push(V.circles[ue+0]),le.circles.push(V.circles[ue+1]),le.circles.push(V.circles[ue+2]),le.circles.push(V.collisionDetected?1:0)}var ce="globe"!==s.projection.name;C=C&&(ce||!L),M=M&&(ce||!z),a.placements[t.crossTileID]=new jt(O||C,D||M,A||s.justReloaded),i[t.crossTileID]=!0}};if(E)for(var O=s.getSortedSymbolIndexes(this.transform.angle),D=O.length-1;D>=0;--D){var A=O[D];I(s.symbolInstances.get(A),A,s.collisionArrays[A])}else for(var L=t.symbolInstanceStart;L<t.symbolInstanceEnd;L++)I(s.symbolInstances.get(L),L,s.collisionArrays[L]);if(n&&s.bucketInstanceId in this.collisionCircleArrays){var z=this.collisionCircleArrays[s.bucketInstanceId];e.invert(z.invProjMatrix,u),z.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}},{key:"markUsedJustification",value:function(t,i,n,r){var a;a=r===e.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(i)];for(var o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];o<s.length;o++){var l=s[o];l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=a>=0&&l!==a?0:n.crossTileID)}}},{key:"markUsedOrientation",value:function(t,i,n){for(var r=i===e.WritingMode.horizontal||i===e.WritingMode.horizontalOnly?i:0,a=i===e.WritingMode.vertical?i:0,o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];o<s.length;o++){var l=s[o];t.text.placedSymbolArray.get(l).placedOrientation=r}n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}},{key:"commit",value:function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,i=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var n=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=r[s];u?(this.opacities[s]=new Ft(u,n,l.text,l.icon,null,l.clipped),i=i||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new Ft(null,n,l.text,l.icon,l.skipFade,l.clipped),i=i||l.text||l.icon)}for(var c in r){var h=r[c];if(!this.opacities[c]){var p=new Ft(h,n,!1,!1);p.isHidden()||(this.opacities[c]=p,i=i||h.text.placed||h.icon.placed)}}for(var d in a)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=a[d]);for(var f in o)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=o[f]);i?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}},{key:"updateLayerOpacities",value:function(e,t){var i,n={},r=p(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.getBucket(e);o&&a.latestFeatureIndex&&e.id===o.layerIds[0]&&this.updateBucketOpacities(o,n,a.collisionBoxArray)}}catch(s){r.e(s)}finally{r.f()}}},{key:"updateBucketOpacities",value:function(t,i,n){var r=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var a=t.layers[0].layout,o=!!t.layers[0].dynamicFilter(),s=new Ft(null,0,!1,!1,!0),l=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),c=a.get("text-variable-anchor"),h="map"===a.get("text-rotation-alignment"),p="map"===a.get("text-pitch-alignment"),d="none"!==a.get("icon-text-fit"),f=new Ft(null,0,l&&(u||!t.hasIconData()||a.get("icon-optional")),u&&(l||!t.hasTextData()||a.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);for(var m=function(e,t,i){for(var n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(i)},v=0,y=function(n){var a=t.symbolInstances.get(n),l=a.numHorizontalGlyphVertices,u=a.numVerticalGlyphVertices,y=a.crossTileID,g=r.opacities[y];i[y]?g=s:g||(g=f,r.opacities[y]=g),i[y]=!0;var _=l>0||u>0,b=a.numIconVertices>0,x=r.placedOrientations[a.crossTileID],w=x===e.WritingMode.vertical,k=x===e.WritingMode.horizontal||x===e.WritingMode.horizontalOnly;if(!_&&!b||g.isHidden()||v++,_){var P=Qt(g.text);m(t.text,l,w?ei:P),m(t.text,u,k?ei:P);var S=g.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(e){e>=0&&(t.text.placedSymbolArray.get(e).hidden=S||w?1:0)})),a.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=S||k?1:0);var T=r.variableOffsets[a.crossTileID];T&&r.markUsedJustification(t,T.anchor,a,x);var E=r.placedOrientations[a.crossTileID];E&&(r.markUsedJustification(t,"left",a,E),r.markUsedOrientation(t,E,a))}if(b){var C=Qt(g.icon);a.placedIconSymbolIndex>=0&&(m(t.icon,a.numIconVertices,w?ei:C),t.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=g.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(m(t.icon,a.numVerticalIconVertices,k?ei:C),t.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var M=t.collisionArrays[n];if(M){var I=new e.pointGeometry(0,0),O=!0;if(M.textBox||M.verticalTextBox){if(c){var D=r.variableOffsets[y];D?(I=Ut(D.anchor,D.width,D.height,D.textOffset,D.textScale),h&&I._rotate(p?r.transform.angle:-r.transform.angle)):O=!1}o&&(O=!g.clipped),M.textBox&&Ht(t.textCollisionBox.collisionVertexArray,g.text.placed,!O||w,I.x,I.y),M.verticalTextBox&&Ht(t.textCollisionBox.collisionVertexArray,g.text.placed,!O||k,I.x,I.y)}var A=O&&Boolean(!k&&M.verticalIconBox);M.iconBox&&Ht(t.iconCollisionBox.collisionVertexArray,g.icon.placed,A,d?I.x:0,d?I.y:0),M.verticalIconBox&&Ht(t.iconCollisionBox.collisionVertexArray,g.icon.placed,!A,d?I.x:0,d?I.y:0)}}},g=0;g<t.symbolInstances.length;g++)y(g);if(t.fullyClipped=0===v,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var _=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=_.invProjMatrix,t.placementViewportMatrix=_.viewportMatrix,t.collisionCircleArray=_.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}},{key:"symbolFadeChange",value:function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}},{key:"zoomAdjustment",value:function(e){return Math.max(0,(this.transform.zoom-e)/1.5)}},{key:"hasTransitions",value:function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}},{key:"stillRecent",value:function(e,t){var i=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*i>e}},{key:"setStale",value:function(){this.stale=!0}}]),t}();function Ht(e,t,i,n,r){e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0)}var Zt=Math.pow(2,25),qt=Math.pow(2,24),Xt=Math.pow(2,17),Kt=Math.pow(2,16),Yt=Math.pow(2,9),$t=Math.pow(2,8),Jt=Math.pow(2,1);function Qt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*Zt+t*qt+i*Xt+t*Kt+i*Yt+t*$t+i*Jt+t}var ei=0,ti=function(){function e(t){v(this,e),this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}return y(e,[{key:"continuePlacement",value:function(e,t,i,n,r){for(var a=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(a,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<a.length;){var o=a[this._currentPartIndex];if(t.placeLayerBucketPart(o,this._seenCrossTileIDs,i,0===o.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}]),e}(),ii=function(){function t(e,i,n,r,a,o,s,l){v(this,t),this.placement=new Wt(e,a,o,s,l),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}return y(t,[{key:"isDone",value:function(){return this._done}},{key:"continuePlacement",value:function(t,i,n){for(var r=this,a=e.exported.now(),o=function(){var t=e.exported.now()-a;return!r._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=i[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new ti(s)),this._inProgressLayer.continuePlacement(n[s.source],this.placement,this._showCollisionBoxes,s,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}},{key:"commit",value:function(e){return this.placement.commit(e),this.placement}}]),t}(),ni=512/e.EXTENT/2,ri=function(){function t(e,i,n){v(this,t),this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<i.length;r++){var a=i.get(r),o=a.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:a.crossTileID,coord:this.getScaledCoordinates(a,e)})}}return y(t,[{key:"getScaledCoordinates",value:function(t,i){var n=ni/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*e.EXTENT+t.tileAnchorX)*n),y:Math.floor((i.canonical.y*e.EXTENT+t.tileAnchorY)*n)}}},{key:"findMatches",value:function(e,t,i){for(var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),r=0;r<e.length;r++){var a=e.get(r);if(!a.crossTileID){var o=this.indexedSymbolInstances[a.key];if(o){var s,l=this.getScaledCoordinates(a,t),u=p(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(Math.abs(c.coord.x-l.x)<=n&&Math.abs(c.coord.y-l.y)<=n&&!i[c.crossTileID]){i[c.crossTileID]=!0,a.crossTileID=c.crossTileID;break}}}catch(h){u.e(h)}finally{u.f()}}}}}}]),t}(),ai=function(){function e(){v(this,e),this.maxCrossTileID=0}return y(e,[{key:"generate",value:function(){return++this.maxCrossTileID}}]),e}(),oi=function(){function e(){v(this,e),this.indexes={},this.usedCrossTileIDs={},this.lng=0}return y(e,[{key:"handleWrapJump",value:function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var i in this.indexes){var n=this.indexes[i],r={};for(var a in n){var o=n[a];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),r[o.tileID.key]=o}this.indexes[i]=r}this.lng=e}},{key:"addBucket",value:function(e,t,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var n=0;n<t.symbolInstances.length;n++)t.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var r=this.usedCrossTileIDs[e.overscaledZ];for(var a in this.indexes){var o=this.indexes[a];if(Number(a)>e.overscaledZ)for(var s in o){var l=o[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,r)}else{var u=o[e.scaledTo(Number(a)).key];u&&u.findMatches(t.symbolInstances,e,r)}}for(var c=0;c<t.symbolInstances.length;c++){var h=t.symbolInstances.get(c);h.crossTileID||(h.crossTileID=i.generate(),r[h.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ri(e,t.symbolInstances,t.bucketInstanceId),!0}},{key:"removeBucketCrossTileIDs",value:function(e,t){for(var i in t.indexedSymbolInstances){var n,r=p(t.indexedSymbolInstances[i]);try{for(r.s();!(n=r.n()).done;){var a=n.value;delete this.usedCrossTileIDs[e][a.crossTileID]}}catch(o){r.e(o)}finally{r.f()}}}},{key:"removeStaleBuckets",value:function(e){var t=!1;for(var i in this.indexes){var n=this.indexes[i];for(var r in n)e[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],t=!0)}return t}}]),e}(),si=function(){function e(){v(this,e),this.layerIndexes={},this.crossTileIDs=new ai,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}return y(e,[{key:"addLayer",value:function(e,t,i,n){var r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new oi);var a=!1,o={};"globe"!==n.name&&r.handleWrapJump(i);var s,l=p(t);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.getBucket(e);c&&e.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(a=!0),o[c.bucketInstanceId]=!0)}}catch(h){l.e(h)}finally{l.f()}return r.removeStaleBuckets(o)&&(a=!0),a}},{key:"pruneUnusedLayers",value:function(e){var t={};for(var i in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[i]||delete this.layerIndexes[i]}}]),e}(),li=function(t,i){return e.emitValidationErrors(t,i&&i.filter((function(e){return"source.canvas"!==e.identifier})))},ui=e.pick(nt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ci=e.pick(nt,["setCenter","setZoom","setBearing","setPitch"]),hi={version:8,layers:[],sources:{}},pi={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0},di=function(i){f(a,i);var n=m(a);function a(t){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,a),(i=n.call(this)).map=t,i.dispatcher=new H(et(),r(i)),i.imageManager=new A,i.imageManager.setEventedParent(r(i)),i.glyphManager=new e.GlyphManager(t._requestManager,o.localFontFamily?e.LocalGlyphMode.all:o.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,o.localFontFamily||o.localIdeographFontFamily),i.lineAtlas=new e.LineAtlas(256,512),i.crossTileSymbolIndex=new si,i._layers={},i._num3DLayers=0,i._numSymbolLayers=0,i._numCircleLayers=0,i._serializedLayers={},i._sourceCaches={},i._otherSourceCaches={},i._symbolSourceCaches={},i.zoomHistory=new e.ZoomHistory,i._loaded=!1,i._availableImages=[],i._order=[],i._drapedFirstOrder=[],i._markersNeedUpdate=!1,i._resetUpdates(),i.dispatcher.broadcast("setReferrer",e.getReferrer());var s=r(i);return i._rtlTextPluginCallback=a.registerForPluginStateChange((function(t){s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,i){if(e.triggerPluginCompletionEvent(t),i&&i.every((function(e){return e})))for(var n in s._sourceCaches){var r=s._sourceCaches[n],a=r.getSource().type;"vector"!==a&&"geojson"!==a||r.reload()}}))})),i.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=i.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(var n in i._layers){var r=i._layers[n];r.source===t.id&&i._validateLayer(r)}}})),i}return y(a,[{key:"loadURL",value:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof n.validate?n.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);var a=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(a,(function(t,n){i._request=null,t?i.fire(new e.ErrorEvent(t)):n&&i._load(n,r)}))}},{key:"loadJSON",value:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((function(){i._request=null,i._load(t,!1!==n.validate)}))}},{key:"loadEmpty",value:function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(hi,!1)}},{key:"_updateLayerCount",value:function(e,t){var i=t?1:-1;e.is3D()&&(this._num3DLayers+=i),"circle"===e.type&&(this._numCircleLayers+=i),"symbol"===e.type&&(this._numSymbolLayers+=i)}},{key:"_load",value:function(t,i){if(!i||!li(this,e.validateStyle(t))){for(var n in this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection(),t.sources)this.addSource(n,t.sources[n],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);var r=it(this.stylesheet.layers);this._order=r.map((function(e){return e.id})),this._layers={},this._serializedLayers={};var a,o=p(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}}catch(l){o.e(l)}finally{o.f()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new R(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}}},{key:"terrainSetForDrapingOnly",value:function(){return!!this.terrain&&0===this.terrain.drapeRenderMode}},{key:"setProjection",value:function(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}},{key:"_updateMapProjection",value:function(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}},{key:"applyProjectionUpdate",value:function(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}},{key:"_loadSprite",value:function(t){var i=this;this._spriteRequest=function(t,i,n){var r,a,o,s=e.exported.devicePixelRatio>1?"@2x":"",l=e.getJSON(i.transformRequest(i.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){l=null,o||(o=e,r=t,c())})),u=e.getImage(i.transformRequest(i.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){u=null,o||(o=e,a=t,c())}));function c(){if(o)n(o);else if(r&&a){var t=e.exported.getImageData(a),i={};for(var s in r){var l=r[s],u=l.width,c=l.height,h=l.x,p=l.y,d=l.sdf,f=l.pixelRatio,m=l.stretchX,v=l.stretchY,y=l.content,g=new e.RGBAImage({width:u,height:c});e.RGBAImage.copy(t,g,{x:h,y:p},{x:0,y:0},{width:u,height:c}),i[s]={data:g,pixelRatio:f,sdf:d,stretchX:m,stretchY:v,content:y}}n(null,i)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(t,this.map._requestManager,(function(t,n){if(i._spriteRequest=null,t)i.fire(new e.ErrorEvent(t));else if(n)for(var r in n)i.imageManager.addImage(r,n[r]);i.imageManager.setLoaded(!0),i._availableImages=i.imageManager.listImages(),i.dispatcher.broadcast("setImages",i._availableImages),i.dispatcher.broadcast("spriteLoaded",!0),i.fire(new e.Event("data",{dataType:"style"}))}))}},{key:"_validateLayer",value:function(t){var i=this.getSource(t.source);if(i){var n=t.sourceLayer;n&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'.concat(n,'" does not exist on source "').concat(i.id,'" as specified by style layer "').concat(t.id,'"'))))}}},{key:"loaded",value:function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}},{key:"_serializeLayers",value:function(e){var t,i=[],n=p(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=this._layers[r];"custom"!==a.type&&i.push(a.serialize())}}catch(o){n.e(o)}finally{n.f()}return i}},{key:"hasTransitions",value:function(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(var e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}},{key:"order",get:function(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}},{key:"isLayerDraped",value:function(e){return!!this.terrain&&pi[e.type]}},{key:"_checkLoaded",value:function(){if(!this._loaded)throw new Error("Style is not done loading")}},{key:"update",value:function(t){if(this._loaded){var i=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var a in(n.length||r.length)&&this._updateWorkerLayers(n,r),this._updatedSources){var o=this._updatedSources[a];"reload"===o?this._reloadSource(a):"clear"===o&&this._clearSource(a)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}var l={};for(var u in this._sourceCaches){var c=this._sourceCaches[u];l[u]=c.used,c.used=!1}var h,d=p(this._order);try{for(d.s();!(h=d.n()).done;){var f=h.value,m=this._layers[f];if(m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)){var v=this._getLayerSourceCache(m);v&&(v.used=!0)}var y=this.map.painter;if(y){var g=m.getProgramIds();if(!g)continue;var _,b=m.getProgramConfiguration(t.zoom),x=p(g);try{for(x.s();!(_=x.n()).done;){var w=_.value;y.useProgram(w,b)}}catch(S){x.e(S)}finally{x.f()}}}}catch(S){d.e(S)}finally{d.f()}for(var k in l){var P=this._sourceCaches[k];l[k]!==P.used&&P.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new e.Event("data",{dataType:"style"}))}}},{key:"_updateTilesForChangedImages",value:function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}},{key:"_updateWorkerLayers",value:function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}},{key:"_resetUpdates",value:function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}},{key:"setState",value:function(i){var n=this;if(this._checkLoaded(),li(this,e.validateStyle(i)))return!1;(i=e.clone$1(i)).layers=it(i.layers);var r=function(e,i){if(!e)return[{command:nt.setStyle,args:[i]}];var n=[];try{if(!t(e.version,i.version))return[{command:nt.setStyle,args:[i]}];t(e.center,i.center)||n.push({command:nt.setCenter,args:[i.center]}),t(e.zoom,i.zoom)||n.push({command:nt.setZoom,args:[i.zoom]}),t(e.bearing,i.bearing)||n.push({command:nt.setBearing,args:[i.bearing]}),t(e.pitch,i.pitch)||n.push({command:nt.setPitch,args:[i.pitch]}),t(e.sprite,i.sprite)||n.push({command:nt.setSprite,args:[i.sprite]}),t(e.glyphs,i.glyphs)||n.push({command:nt.setGlyphs,args:[i.glyphs]}),t(e.transition,i.transition)||n.push({command:nt.setTransition,args:[i.transition]}),t(e.light,i.light)||n.push({command:nt.setLight,args:[i.light]}),t(e.fog,i.fog)||n.push({command:nt.setFog,args:[i.fog]}),t(e.projection,i.projection)||n.push({command:nt.setProjection,args:[i.projection]});var r={},a=[];!function(e,i,n,r){var a;for(a in i=i||{},e=e||{})e.hasOwnProperty(a)&&(i.hasOwnProperty(a)||at(a,n,r));for(a in i)i.hasOwnProperty(a)&&(e.hasOwnProperty(a)?t(e[a],i[a])||("geojson"===e[a].type&&"geojson"===i[a].type&&st(e,i,a)?n.push({command:nt.setGeoJSONSourceData,args:[a,i[a].data]}):ot(a,i,n,r)):rt(a,i,n))}(e.sources,i.sources,a,r);var o=[];e.layers&&e.layers.forEach((function(e){e.source&&r[e.source]?n.push({command:nt.removeLayer,args:[e.id]}):o.push(e)}));var s=e.terrain;s&&r[s.source]&&(n.push({command:nt.setTerrain,args:[void 0]}),s=void 0),n=n.concat(a),t(s,i.terrain)||n.push({command:nt.setTerrain,args:[i.terrain]}),function(e,i,n){i=i||[];var r,a,o,s,l,u,c,h=(e=e||[]).map(ut),p=i.map(ut),d=e.reduce(ct,{}),f=i.reduce(ct,{}),m=h.slice(),v=Object.create(null);for(r=0,a=0;r<h.length;r++)o=h[r],f.hasOwnProperty(o)?a++:(n.push({command:nt.removeLayer,args:[o]}),m.splice(m.indexOf(o,a),1));for(r=0,a=0;r<p.length;r++)o=p[p.length-1-r],m[m.length-1-r]!==o&&(d.hasOwnProperty(o)?(n.push({command:nt.removeLayer,args:[o]}),m.splice(m.lastIndexOf(o,m.length-a),1)):a++,u=m[m.length-r],n.push({command:nt.addLayer,args:[f[o],u]}),m.splice(m.length-r,0,o),v[o]=!0);for(r=0;r<p.length;r++)if(s=d[o=p[r]],l=f[o],!v[o]&&!t(s,l))if(t(s.source,l.source)&&t(s["source-layer"],l["source-layer"])&&t(s.type,l.type)){for(c in lt(s.layout,l.layout,n,o,null,nt.setLayoutProperty),lt(s.paint,l.paint,n,o,null,nt.setPaintProperty),t(s.filter,l.filter)||n.push({command:nt.setFilter,args:[o,l.filter]}),t(s.minzoom,l.minzoom)&&t(s.maxzoom,l.maxzoom)||n.push({command:nt.setLayerZoomRange,args:[o,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?lt(s[c],l[c],n,o,c.slice(6),nt.setPaintProperty):t(s[c],l[c])||n.push({command:nt.setLayerProperty,args:[o,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?lt(s[c],l[c],n,o,c.slice(6),nt.setPaintProperty):t(s[c],l[c])||n.push({command:nt.setLayerProperty,args:[o,c,l[c]]}))}else n.push({command:nt.removeLayer,args:[o]}),u=m[m.lastIndexOf(o)+1],n.push({command:nt.addLayer,args:[l,u]})}(o,i.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:nt.setStyle,args:[i]}]}return n}(this.serialize(),i).filter((function(e){return!(e.command in ci)}));if(0===r.length)return!1;var a=r.filter((function(e){return!(e.command in ui)}));if(a.length>0)throw new Error("Unimplemented: ".concat(a.map((function(e){return e.command})).join(", "),"."));return r.forEach((function(e){"setTransition"!==e.command&&n[e.command].apply(n,e.args)})),this.stylesheet=i,this._updateMapProjection(),!0}},{key:"addImage",value:function(t,i){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,i),this._afterImageUpdated(t),this)}},{key:"updateImage",value:function(e,t){this.imageManager.updateImage(e,t)}},{key:"getImage",value:function(e){return this.imageManager.getImage(e)}},{key:"removeImage",value:function(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}},{key:"_afterImageUpdated",value:function(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}},{key:"listImages",value:function(){return this._checkLoaded(),this._availableImages.slice()}},{key:"addSource",value:function(t,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!i.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(i).join(", "),"."));if(!(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(e.validateSource,"sources.".concat(t),i,null,r))){this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);var a=He(t,i,this.dispatcher,this);a.setEventedParent(this,(function(){return{isSourceLoaded:n._isSourceCacheLoaded(t),source:a.serialize(),sourceId:t}}));var o=function(i){var r=(i?"symbol:":"other:")+t,o=n._sourceCaches[r]=new e.SourceCache(r,a,i);(i?n._symbolSourceCaches:n._otherSourceCaches)[t]=o,o.style=n,o.onAdd(n.map)};o(!1),"vector"!==i.type&&"geojson"!==i.type||o(!0),a.onAdd&&a.onAdd(this.map),this._changed=!0}}},{key:"removeSource",value:function(t){this._checkLoaded();var i=this.getSource(t);if(!i)throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(n,'" is using it.'))));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while terrain is using it.'))));var r,a=this._getSourceCaches(t),o=p(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;delete this._sourceCaches[s.id],delete this._updatedSources[s.id],s.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:s.getSource().id})),s.setEventedParent(null),s.clearTiles()}}catch(l){o.e(l)}finally{o.f()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changed=!0,this}},{key:"setGeoJSONSourceData",value:function(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}},{key:"getSource",value:function(e){var t=this._getSourceCache(e);return t&&t.getSource()}},{key:"addLayer",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var r=t.id;if(this.getLayer(r))this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(r,'" already exists on this map'))));else{var a;if("custom"===t.type){if(li(this,e.validateCustomStyleLayer(t)))return;a=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=e.clone$1(t),t=e.extend(t,{source:r})),this._validate(e.validateLayer,"layers.".concat(r),t,{arrayIndex:-1},n))return;a=e.createStyleLayer(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[a.id]=a.serialize(),this._updateLayerCount(a,!0)}var o=i?this._order.indexOf(i):this._order.length;if(i&&-1===o)this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(i,'" does not exist on this map.'))));else{this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=a;var s=this._getLayerSourceCache(a);if(this._removedLayers[r]&&a.source&&s&&"custom"!==a.type){var l=this._removedLayers[r];delete this._removedLayers[r],l.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",s.pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map),this._updateDrapeFirstLayers()}}}},{key:"moveLayer",value:function(t,i){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==i){var n=this._order.indexOf(t);this._order.splice(n,1);var r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(i,'" does not exist on this map.')))):(this._order.splice(r,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be moved."))))}},{key:"removeLayer",value:function(t){this._checkLoaded();var i=this._layers[t];if(i){i.setEventedParent(null),this._updateLayerCount(i,!1);var n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=i,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],i.onRemove&&i.onRemove(this.map),this._updateDrapeFirstLayers()}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be removed."))))}},{key:"getLayer",value:function(e){return this._layers[e]}},{key:"hasLayer",value:function(e){return e in this._layers}},{key:"hasLayerType",value:function(e){for(var t in this._layers)if(this._layers[t].type===e)return!0;return!1}},{key:"setLayerZoomRange",value:function(t,i,n){this._checkLoaded();var r=this.getLayer(t);r?r.minzoom===i&&r.maxzoom===n||(null!=i&&(r.minzoom=i),null!=n&&(r.maxzoom=n),this._updateLayer(r)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot have zoom extent."))))}},{key:"setFilter",value:function(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var a=this.getLayer(i);if(a){if(!t(a.filter,n))return null==n?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(e.validateFilter,"layers.".concat(a.id,".filter"),n,{layerType:a.type},r)||(a.filter=e.clone$1(n),this._updateLayer(a)))}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be filtered."))))}},{key:"getFilter",value:function(t){var i=this.getLayer(t);return i&&e.clone$1(i.filter)}},{key:"setLayoutProperty",value:function(i,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(i);o?t(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,a),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be styled."))))}},{key:"getLayoutProperty",value:function(t,i){var n=this.getLayer(t);if(n)return n.getLayoutProperty(i);this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style."))))}},{key:"setPaintProperty",value:function(i,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(i);o?t(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,a)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be styled."))))}},{key:"getPaintProperty",value:function(e,t){var i=this.getLayer(e);return i&&i.getPaintProperty(t)}},{key:"setFeatureState",value:function(t,i){this._checkLoaded();var n=t.source,r=t.sourceLayer,a=this.getSource(n);if(a){var o=a.type;if("geojson"===o&&r)this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));else if("vector"!==o||r){void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));var s,l=this._getSourceCaches(n),u=p(l);try{for(u.s();!(s=u.n()).done;)s.value.setFeatureState(r,t.id,i)}catch(c){u.e(c)}finally{u.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"removeFeatureState",value:function(t,i){this._checkLoaded();var n=t.source,r=this.getSource(n);if(r){var a=r.type,o="vector"===a?t.sourceLayer:void 0;if("vector"!==a||o)if(i&&"string"!=typeof t.id&&"number"!=typeof t.id)this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));else{var s,l=this._getSourceCaches(n),u=p(l);try{for(u.s();!(s=u.n()).done;)s.value.removeFeatureState(o,t.id,i)}catch(c){u.e(c)}finally{u.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"getFeatureState",value:function(t){this._checkLoaded();var i=t.source,n=t.sourceLayer,r=this.getSource(i);if(r){if("vector"!==r.type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(i)[0].getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(i,"' does not exist in the map's style."))))}},{key:"getTransition",value:function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}},{key:"serialize",value:function(){var t={};for(var i in this._sourceCaches){var n=this._sourceCaches[i].getSource();t[n.id]||(t[n.id]=n.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))}},{key:"_updateLayer",value:function(e){this._updatedLayers[e.id]=!0;var t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}},{key:"_flattenAndSortRenderedFeatures",value:function(e){for(var t=this,i=function(e){return"fill-extrusion"===t._layers[e].type},n={},r=[],a=this._order.length-1;a>=0;a--){var o=this._order[a];if(i(o)){n[o]=a;var s,l=p(e);try{for(l.s();!(s=l.n()).done;){var u=s.value[o];if(u){var c,h=p(u);try{for(h.s();!(c=h.n()).done;){var d=c.value;r.push(d)}}catch(S){h.e(S)}finally{h.f()}}}}catch(S){l.e(S)}finally{l.f()}}}r.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var f=[],m=this._order.length-1;m>=0;m--){var v=this._order[m];if(i(v))for(var y=r.length-1;y>=0;y--){var g=r[y].feature;if(n[g.layer.id]<m)break;f.push(g),r.pop()}else{var _,b=p(e);try{for(b.s();!(_=b.n()).done;){var x=_.value[v];if(x){var w,k=p(x);try{for(k.s();!(w=k.n()).done;){var P=w.value;f.push(P.feature)}}catch(S){k.e(S)}finally{k.f()}}}}catch(S){b.e(S)}finally{b.f()}}}return f}},{key:"queryRenderedFeatures",value:function(t,i,n){var r=this;i&&i.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",i.filter,null,i);var a={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];var o,s=p(i.layers);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=this._layers[l];if(!u)return this.fire(new e.ErrorEvent(new Error("The layer '".concat(l,"' does not exist in the map's style and cannot be queried for features.")))),[];a[u.source]=!0}}catch(v){s.e(v)}finally{s.f()}}var c=[];i.availableImages=this._availableImages;var h=i&&i.layers?i.layers.some((function(e){var t=r.getLayer(e);return t&&t.is3D()})):this.has3DLayers(),d=q.createFromScreenPoints(t,n);for(var f in this._sourceCaches){var m=this._sourceCaches[f].getSource().id;i.layers&&!a[m]||c.push(qe(this._sourceCaches[f],this._layers,this._serializedLayers,d,i,n,h,!!this.map._showQueryGeometry))}return this.placement&&c.push(function(e,t,i,n,r,a,o){var s,l={},u=a.queryRenderedSymbols(n),c=[],h=p(Object.keys(u).map(Number));try{for(h.s();!(s=h.n()).done;){var d=s.value;c.push(o[d])}}catch(v){h.e(v)}finally{h.f()}c.sort(Ke);for(var f=function(){var i=y[m],n=i.featureIndex.lookupSymbolFeatures(u[i.bucketInstanceId],t,i.bucketIndex,i.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(var a in n){var o=l[a]=l[a]||[],s=n[a];s.sort((function(e,t){var n=i.featureSortOrder;if(n){var r=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}));var c,h=p(s);try{for(h.s();!(c=h.n()).done;){var d=c.value;o.push(d)}}catch(v){h.e(v)}finally{h.f()}}},m=0,y=c;m<y.length;m++)f();var g=function(t){l[t].forEach((function(n){var r=n.feature,a=i(e[t]).getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=a}))};for(var _ in l)g(_);return l}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),d.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)}},{key:"querySourceFeatures",value:function(t,i){i&&i.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",i.filter,null,i);var n,r=this._getSourceCaches(t),a=[],o=p(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;a=a.concat(Xe(s,i))}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"addSourceType",value:function(e,t,i){return a.getSourceType(e)?i(new Error('A source type called "'.concat(e,'" already exists.'))):(a.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},i):i(null,null))}},{key:"getLight",value:function(){return this.light.getLight()}},{key:"setLight",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();var n=this.light.getLight(),r=!1;for(var a in e)if(!t(e[a],n[a])){r=!0;break}if(r){var o=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,i),this.light.updateTransitions(o)}}},{key:"getTerrain",value:function(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}},{key:"setTerrainForDraping",value:function(){this.setTerrain({source:"",exaggeration:0},0)}},{key:"setTerrain",value:function(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===n){if("object"==typeof i.source){var r="terrain-dem-src";this.addSource(r,i.source),i=e.clone$1(i),i=e.extend(i,{source:r})}if(this._validate(e.validateTerrain,"terrain",i))return}if(!this.terrain||this.terrain&&n!==this.terrain.drapeRenderMode)this._createTerrain(i,n);else{for(var a=this.terrain,o=a.get(),s=0,l=Object.keys(e.spec.terrain);s<l.length;s++){var u=l[s];!i.hasOwnProperty(u)&&e.spec.terrain[u].default&&(i[u]=e.spec.terrain[u].default)}for(var c in i)if(!t(i[c],o[c])){a.set(i),this.stylesheet.terrain=i;var h=this._setTransitionParameters({duration:0});a.updateTransitions(h);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}},{key:"_createFog",value:function(e){var t=this.fog=new W(e,this.map.transform);this.stylesheet.fog=e;var i=this._setTransitionParameters({duration:0});t.updateTransitions(i)}},{key:"_updateMarkersOpacity",value:function(){var e=this;0!==this.map._markers.length&&this.map._requestDomTask((function(){var t,i=p(e.map._markers);try{for(i.s();!(t=i.n()).done;)t.value._evaluateOpacity()}catch(n){i.e(n)}finally{i.f()}}))}},{key:"getFog",value:function(){return this.fog?this.fog.get():null}},{key:"setFog",value:function(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){var i=this.fog,n=i.get();for(var r in 0===Object.keys(e).length&&i.set(e),e)if(!t(e[r],n[r])){i.set(e),this.stylesheet.fog=e;var a=this._setTransitionParameters({duration:0});i.updateTransitions(a);break}}else this._createFog(e);this._markersNeedUpdate=!0}},{key:"_setTransitionParameters",value:function(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}},{key:"_updateDrapeFirstLayers",value:function(){var e,t,i=this;if(this.map._optimizeForTerrain&&this.terrain){var n=this._order.filter((function(e){return i.isLayerDraped(i._layers[e])})),r=this._order.filter((function(e){return!i.isLayerDraped(i._layers[e])}));this._drapedFirstOrder=[],(e=this._drapedFirstOrder).push.apply(e,c(n)),(t=this._drapedFirstOrder).push.apply(t,c(r))}}},{key:"_createTerrain",value:function(e,t){var i=this.terrain=new B(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();var n=this._setTransitionParameters({duration:0});i.updateTransitions(n)}},{key:"_force3DLayerUpdate",value:function(){for(var e in this._layers){var t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}},{key:"_forceSymbolLayerUpdate",value:function(){for(var e in this._layers){var t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}},{key:"_validate",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&li(this,t.call(e.validateStyle,e.extend({key:i,style:this.serialize(),value:n,styleSpec:e.spec},r)))}},{key:"_remove",value:function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}},{key:"_clearSource",value:function(e){var t,i=this._getSourceCaches(e),n=p(i);try{for(n.s();!(t=n.n()).done;)t.value.clearTiles()}catch(r){n.e(r)}finally{n.f()}}},{key:"_reloadSource",value:function(e){var t,i=this._getSourceCaches(e),n=p(i);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.resume(),r.reload()}}catch(a){n.e(a)}finally{n.f()}}},{key:"_updateSources",value:function(e){for(var t in this._sourceCaches)this._sourceCaches[t].update(e)}},{key:"_generateCollisionBoxes",value:function(){for(var e in this._sourceCaches){var t=this._sourceCaches[e];t.resume(),t.reload()}}},{key:"_updatePlacement",value:function(t,i,n,r){var a,o=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=!1,u=!1,c={},h=p(this._order);try{for(h.s();!(a=h.n()).done;){var d=a.value,f=this._layers[d];if("symbol"===f.type){if(!c[f.source]){var m=function(){var e=o._getLayerSourceCache(f);if(!e)return"continue";c[f.source]=e.getRenderableIds(!0).map((function(t){return e.getTileByID(t)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}();if("continue"===m)continue}var v=this.crossTileSymbolIndex.addLayer(f,c[f.source],t.center.lng,t.projection);l=l||v}}}catch(x){h.e(x)}finally{h.f()}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new ii(t,this._order,s,i,n,r,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,c),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),u=!0),l&&this.pauseablePlacement.placement.setStale()),u||l){var y,g=p(this._order);try{for(g.s();!(y=g.n()).done;){var _=y.value,b=this._layers[_];"symbol"===b.type&&this.placement.updateLayerOpacities(b,c[b.source])}}catch(x){g.e(x)}finally{g.f()}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}},{key:"_releaseSymbolFadeTiles",value:function(){for(var e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}},{key:"getImages",value:function(e,t,i){this.imageManager.getImages(t.icons,i),this._updateTilesForChangedImages();var n=function(e){e&&e.setDependencies(t.tileID.key,t.type,t.icons)};n(this._otherSourceCaches[t.source]),n(this._symbolSourceCaches[t.source])}},{key:"getGlyphs",value:function(e,t,i){this.glyphManager.getGlyphs(t.stacks,i)}},{key:"getResource",value:function(t,i,n){return e.makeRequest(i,n)}},{key:"_getSourceCache",value:function(e){return this._otherSourceCaches[e]}},{key:"_getLayerSourceCache",value:function(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}},{key:"_getSourceCaches",value:function(e){var t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}},{key:"_isSourceCacheLoaded",value:function(t){var i=this._getSourceCaches(t);return 0===i.length?(this.fire(new e.ErrorEvent(new Error("There is no source with ID '".concat(t,"'")))),!1):i.every((function(e){return e.loaded()}))}},{key:"has3DLayers",value:function(){return this._num3DLayers>0}},{key:"hasSymbolLayers",value:function(){return this._numSymbolLayers>0}},{key:"hasCircleLayers",value:function(){return this._numCircleLayers>0}},{key:"_clearWorkerCaches",value:function(){this.dispatcher.broadcast("clearCaches")}},{key:"destroy",value:function(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}]),a}(e.Evented);di.getSourceType=function(e){return We[e]},di.setSourceType=function(e,t){We[e]=t},di.registerForPluginStateChange=e.registerForPluginStateChange;var fi="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",mi="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",vi={},yi={};vi=wi("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),yi=wi("#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);var gi=wi("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),_i=fi,bi="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",xi={background:wi("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:wi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:wi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);\n#else \nmat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:wi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:wi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:wi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:wi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:wi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:wi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:wi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:wi("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:wi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:wi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:wi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:wi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nhighp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nvec4 out_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:wi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:wi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:wi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:wi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:wi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:wi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:wi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",mi),skyboxGradient:wi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",mi),skyboxCapture:wi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\nvec4 color=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector.xyz*height;vec4 globe=u_globe_matrix*vec4(globe_pos,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:wi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);\n#ifdef PROJECTION_GLOBE_VIEW\nfloat globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nfloat horizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function wi(e,t,i){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,a=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),o=e.match(r),s=t.match(r),l=fi.match(r),u=s?s.concat(o):o;i||(vi.staticUniforms&&(u=vi.staticUniforms.concat(u)),yi.staticUniforms&&(u=yi.staticUniforms.concat(u))),u&&(u=u.concat(l));var c={};return{fragmentSource:e=e.replace(n,(function(e,t,i,n,r){return c[r]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nvarying ").concat(i," ").concat(n," ").concat(r,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(r,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(r,"\n    ").concat(i," ").concat(n," ").concat(r," = u_").concat(r,";\n#endif\n")})),vertexSource:t=t.replace(n,(function(e,t,i,n,r){var a="float"===n?"vec2":"vec4",o=r.match(/color/)?"color":a;return c[r]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nuniform lowp float u_").concat(r,"_t;\nattribute ").concat(i," ").concat(a," a_").concat(r,";\nvarying ").concat(i," ").concat(n," ").concat(r,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(r,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(r," = a_").concat(r,";\n#else\n    ").concat(i," ").concat(n," ").concat(r," = u_").concat(r,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(r," = unpack_mix_").concat(o,"(a_").concat(r,", u_").concat(r,"_t);\n#else\n    ").concat(i," ").concat(n," ").concat(r," = u_").concat(r,";\n#endif\n"):"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nuniform lowp float u_").concat(r,"_t;\nattribute ").concat(i," ").concat(a," a_").concat(r,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(r,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(i," ").concat(n," ").concat(r," = a_").concat(r,";\n#else\n    ").concat(i," ").concat(n," ").concat(r," = u_").concat(r,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(i," ").concat(n," ").concat(r," = unpack_mix_").concat(o,"(a_").concat(r,", u_").concat(r,"_t);\n#else\n    ").concat(i," ").concat(n," ").concat(r," = u_").concat(r,";\n#endif\n")})),staticAttributes:a,staticUniforms:u}}var ki=function(){function e(){v(this,e),this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}return y(e,[{key:"bind",value:function(e,t,i,n,r,a,o,s,l){this.context=e;for(var u=this.boundPaintVertexBuffers.length!==n.length,c=0;!u&&c<n.length;c++)this.boundPaintVertexBuffers[c]!==n[c]&&(u=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===i&&!u&&this.boundIndexBuffer===r&&this.boundVertexOffset===a&&this.boundDynamicVertexBuffer===o&&this.boundDynamicVertexBuffer2===s&&this.boundDynamicVertexBuffer3===l?(e.bindVertexArrayOES.set(this.vao),o&&o.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind(),l&&l.bind()):this.freshBind(t,i,n,r,a,o,s,l)}},{key:"freshBind",value:function(e,t,i,n,r,a,o,s){var l,u=e.numAttributes,c=this.context,h=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),l=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s;else{l=c.currentNumAttributes||0;for(var d=u;d<l;d++)h.disableVertexAttribArray(d)}t.enableAttributes(h,e);var f,m=p(i);try{for(m.s();!(f=m.n()).done;)f.value.enableAttributes(h,e)}catch(_){m.e(_)}finally{m.f()}a&&a.enableAttributes(h,e),o&&o.enableAttributes(h,e),s&&s.enableAttributes(h,e),t.bind(),t.setVertexAttribPointers(h,e,r);var v,y=p(i);try{for(y.s();!(v=y.n()).done;){var g=v.value;g.bind(),g.setVertexAttribPointers(h,e,r)}}catch(_){y.e(_)}finally{y.f()}a&&(a.bind(),a.setVertexAttribPointers(h,e,r)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(h,e,r)),s&&(s.bind(),s.setVertexAttribPointers(h,e,r)),c.currentNumAttributes=u}},{key:"destroy",value:function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}]),e}();function Pi(t,i){var n=Math.pow(2,i.canonical.z),r=i.canonical.y;return[new e.MercatorCoordinate(0,r/n).toLngLat().lat,new e.MercatorCoordinate(0,(r+1)/n).toLngLat().lat]}function Si(t,i,n,r,a,o,s){var l=t.context,u=l.gl,c=n.fbo;if(c){t.prepareDrawTile();var h=t.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());var p=function(e,t,i,n){var r=i.paint.get("hillshade-shadow-color"),a=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color"),s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var l=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:Pi(0,t.tileID),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:a,u_accent:o}}(t,n,r,t.terrain?i.projMatrix:null);t.prepareDrawProgram(l,h,i.toUnwrapped());var d=t.getTileBoundsBuffers(n),f=d.tileBoundsBuffer,m=d.tileBoundsIndexBuffer,v=d.tileBoundsSegments;h.draw(l,u.TRIANGLES,a,o,s,e.CullFaceMode.disabled,p,r.id,f,m,v)}}function Ti(t,i,n){if(i.needsDEMTextureUpload){var r=t.context,a=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(n.stride);var o=n.getPixels();i.demTexture?i.demTexture.update(o,{premultiply:!1}):i.demTexture=new e.Texture(r,o,a.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}}function Ei(t,i,n,r,a,o){var s=t.context,l=s.gl;if(i.dem){var u=i.dem;if(s.activeTexture.set(l.TEXTURE1),Ti(t,i,u),i.demTexture){i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);var c=u.dim;s.activeTexture.set(l.TEXTURE0);var h=i.fbo;if(!h){var p=new e.Texture(s,{width:c,height:c,data:null},l.RGBA);p.bind(l.LINEAR,l.CLAMP_TO_EDGE),(h=i.fbo=s.createFramebuffer(c,c,!0)).colorAttachment.set(p.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,c,c]);var d=t.getMercatorTileBoundsBuffers(),f=d.tileBoundsBuffer,m=d.tileBoundsIndexBuffer,v=d.tileBoundsSegments;t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,o,e.CullFaceMode.disabled,function(t,i){var n=i.stride,r=e.create();return e.ortho(r,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(r,r,[0,-e.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:i.unpackVector}}(i.tileID,u),n.id,f,m,v),i.needsHillshadePrepare=!1}}}var Ci=function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_image0:new e.Uniform1i(t,i.u_image0),u_skirt_height:new e.Uniform1f(t,i.u_skirt_height)}},Mi=function(e,t){return{u_matrix:e,u_image0:0,u_skirt_height:t}},Ii=function(e,t,i,n,r,a,o,s,l,u,c,h,p,d){return{u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(n),u_merc_matrix:i,u_zoom_transition:r,u_merc_center:a,u_image0:0,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:c,u_globe_radius:h,u_viewport:p,u_grid_matrix:d?Float32Array.from(d):new Float32Array(9)}};function Oi(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}var Di=new(function(){function e(){v(this,e),this.operations={}}return y(e,[{key:"newMorphing",value:function(e,t,i,n,r){if(e in this.operations){var a=this.operations[e];a.to.tileID.key!==i.tileID.key&&(a.queued=i)}else this.operations[e]={startTime:n,phase:0,duration:r,from:t,to:i,queued:null}}},{key:"getMorphValuesForProxy",value:function(e){if(!(e in this.operations))return null;var t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}},{key:"update",value:function(e){for(var t in this.operations){var i=this.operations[t];for(i.phase=(e-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,e)){delete this.operations[t];break}}}},{key:"_nextOp",value:function(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}},{key:"_validOp",value:function(e){return e.from.hasData()&&e.to.hasData()}}]),e}()),Ai={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Li(e,t){var i=1<<e.z;return!t&&(0===e.x||e.x===i-1)||0===e.y||e.y===i-1}var zi=function(e){return{u_matrix:e}};function Ri(t,i,n,r,a){if(a>0){var o=e.exported.now(),s=(o-t.timeAdded)/a,l=i?(o-i.timeAdded)/a:-1,u=n.getSource(),c=r.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!i||Math.abs(i.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),p=h&&t.refreshedUponExpiration?1:e.clamp(h?s:1-l,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var Fi=function(e){f(i,e);var t=m(i);function i(e){var n;v(this,i);var a={type:"raster-dem",maxzoom:e.transform.maxZoom},o=new H(et(),null),s=He("mock-dem",a,o,e.style);return n=t.call(this,"mock-dem",s,!1),s.setEventedParent(r(n)),n._sourceLoaded=!0,n}return y(i,[{key:"_loadTile",value:function(e,t){e.state="loaded",t(null)}}]),i}(e.SourceCache),ji=function(t){f(n,t);var i=m(n);function n(e){var t;v(this,n);var a=He("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new H(et(),null),e.style);return t=i.call(this,"proxy",a,!1),a.setEventedParent(r(t)),t.map=t.getSource().map=e,t.used=t._sourceLoaded=!0,t.renderCache=[],t.renderCachePool=[],t.proxyCachedFBO={},t}return y(n,[{key:"update",value:function(t,i,n){var r=this;if(!t.freezeTileCoverage){this.transform=t;var a=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((function(i,n){if(i[n.key]="",!r._tiles[n.key]){var a=new e.Tile(n,r._source.tileSize*n.overscaleFactor(),t.tileZoom);a.state="loaded",r._tiles[n.key]=a}return i}),{});for(var o in this._tiles)o in a||(this.freeFBO(o),this._tiles[o].unloadVectorData(),delete this._tiles[o])}}},{key:"freeFBO",value:function(e){var t=this.proxyCachedFBO[e];if(void 0!==t){var i,n=Object.values(t);(i=this.renderCachePool).push.apply(i,n),delete this.proxyCachedFBO[e]}}},{key:"deallocRenderCache",value:function(){this.renderCache.forEach((function(e){return e.fb.destroy()})),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}]),n}(e.SourceCache),Bi=function(e){f(i,e);var t=m(i);function i(e,n,r){var a;return v(this,i),(a=t.call(this,e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)).proxyTileKey=n,a.projMatrix=r,a}return y(i)}(e.OverscaledTileID),Vi=function(t){f(n,t);var i=m(n);function n(t,r){var a;v(this,n),(a=i.call(this)).painter=t,a.terrainTileForTile={},a.prevTerrainTileForTile={};var o=function(t){var i=new e.StructArrayLayout4i8,n=new e.StructArrayLayout3ui6,r=131;i.reserve(17161),n.reserve(33800);for(var a=e.EXTENT/128,o=e.EXTENT+a/2,s=o+a,l=-a;l<s;l+=a)for(var u=-a;u<s;u+=a){var c=u<0||u>o||l<0||l>o?24575:0,h=e.clamp(Math.round(u),0,e.EXTENT),p=e.clamp(Math.round(l),0,e.EXTENT);i.emplaceBack(h+c,p,h,p)}for(var d=function(e,t){var i=t*r+e;n.emplaceBack(i+1,i,i+r),n.emplaceBack(i+r,i+r+1,i+1)},f=1;f<129;f++)for(var m=1;m<129;m++)d(m,f);return[0,129].forEach((function(e){for(var t=0;t<130;t++)d(t,e),d(e,t)})),[i,n,32768]}(),s=h(o,3),l=s[0],u=s[1],c=s[2],p=t.context;a.gridBuffer=p.createVertexBuffer(l,e.boundsAttributes.members),a.gridIndexBuffer=p.createIndexBuffer(u),a.gridSegments=e.SegmentVector.simpleSegment(0,0,l.length,u.length),a.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,l.length,c),a.proxyCoords=[],a.proxiedCoords={},a._visibleDemTiles=[],a._drapedRenderBatches=[],a._sourceTilesOverlap={},a.proxySourceCache=new ji(r.map),a.orthoMatrix=e.create(),e.ortho(a.orthoMatrix,0,e.EXTENT,0,e.EXTENT,0,1);var d=p.gl;return a._overlapStencilMode=new e.StencilMode({func:d.GEQUAL,mask:255},0,255,d.KEEP,d.KEEP,d.REPLACE),a._previousZoom=t.transform.zoom,a.pool=[],a._findCoveringTileCache={},a._tilesDirty={},a.style=r,a._useVertexMorphing=!0,a._exaggeration=1,a._mockSourceCache=new Fi(r.map),a}return y(n,[{key:"style",set:function(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency()}},{key:"update",value:function(t,i,n){var r=this;if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;var a=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(a.get("source")),this._exaggeration=a.get("exaggeration");var o=function(){r.sourceCache.used&&e.warnOnce("Raster DEM source '".concat(r.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));var t=r.getScaledDemTileSize();r.sourceCache.update(i,t,!0),r.resetTileLookupCache(r.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),i.updateElevation(!n),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0}else this._disable()}},{key:"resetTileLookupCache",value:function(e){this._findCoveringTileCache[e]={}}},{key:"getScaledDemTileSize",value:function(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}},{key:"_checkRenderCacheEfficiency",value:function(){var t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce("Terrain render cache efficiency is not optimal (".concat(t.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(t.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}},{key:"_onStyleDataEvent",value:function(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}},{key:"_disable",value:function(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(var e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}},{key:"destroy",value:function(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((function(e){return e.fb.destroy()})),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}},{key:"_source",value:function(){return this.enabled?this.sourceCache:null}},{key:"exaggeration",value:function(){return this._exaggeration}},{key:"visibleDemTiles",get:function(){return this._visibleDemTiles}},{key:"drapeBufferSize",get:function(){var e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}},{key:"useVertexMorphing",set:function(e){this._useVertexMorphing=e}},{key:"updateTileBinding",value:function(t){var i=this;if(this.enabled){this.prevTerrainTileForTile=this.terrainTileForTile;var n=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);var a=this.proxyCoords=n.getIds().map((function(e){var t=n.getTileByID(e).tileID;return t.projMatrix=r.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,i){var n=i.transform.pointCoordinate(i.transform.getCameraPoint()),r=new e.pointGeometry(n.x,n.y);t.sort((function(t,i){if(i.overscaledZ-t.overscaledZ)return i.overscaledZ-t.overscaledZ;var n=new e.pointGeometry(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),a=new e.pointGeometry(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),o=r.mult(1<<t.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(n)-o.distSqr(a)}))}(a,this.painter),this._previousZoom=r.zoom;var o=this.proxyToSource||{};this.proxyToSource={},a.forEach((function(e){i.proxyToSource[e.key]={}})),this.terrainTileForTile={};var s=this._style._sourceCaches;for(var l in s){var u=s[l];if(u.used&&(u!==this.sourceCache&&this.resetTileLookupCache(u.id),this._setupProxiedCoordsForOrtho(u,t[l],o),!u.usedForTerrain)){var c=t[l];u.getSource().reparseOverscaled&&this._assignTerrainTiles(c)}}this.proxiedCoords[n.id]=a.map((function(e){return new Bi(e,e.key,i.orthoMatrix)})),this._assignTerrainTiles(a),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();var h={};this._visibleDemTiles=[];var d,f=p(this.proxyCoords);try{for(f.s();!(d=f.n()).done;){var m=d.value,v=this.terrainTileForTile[m.key];if(v){var y=v.tileID.key;y in h||(this._visibleDemTiles.push(v),h[y]=y)}}}catch(g){f.e(g)}finally{f.f()}}}},{key:"_assignTerrainTiles",value:function(e){var t=this;this._initializing||e.forEach((function(e){if(!t.terrainTileForTile[e.key]){var i=t._findTileCoveringTileID(e,t.sourceCache);i&&(t.terrainTileForTile[e.key]=i)}}))}},{key:"_prepareDEMTextures",value:function(){var e=this.painter.context,t=e.gl;for(var i in this.terrainTileForTile){var n=this.terrainTileForTile[i],r=n.dem;!r||n.demTexture&&!n.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),Ti(this.painter,n,r))}}},{key:"_prepareDemTileUniforms",value:function(e,t,i,n){if(!t||null==t.demTexture)return!1;var r=e.tileID.canonical,a=Math.pow(2,t.tileID.canonical.z-r.z),o=n||"";return i["u_dem_tl".concat(o)]=[r.x*a%1,r.y*a%1],i["u_dem_scale".concat(o)]=a,!0}},{key:"emptyDEMTexture",get:function(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}},{key:"emptyDepthBufferTexture",get:function(){var t=this.painter.context,i=t.gl;if(!this._emptyDepthBufferTexture){var n=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,n,i.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}},{key:"_getLoadedAreaMinimum",value:function(){var e=0,t=this._visibleDemTiles.reduce((function(t,i){if(!i.dem)return t;var n=i.dem.tree.minimums[0];return n>0&&e++,t+n}),0);return e?t/e:0}},{key:"_updateEmptyDEMTexture",value:function(){var t=this.painter.context,i=t.gl;t.activeTexture.set(i.TEXTURE2);var n=this._getLoadedAreaMinimum(),r=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(n,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;var a=this._emptyDEMTexture;return a?a.update(r,{premultiply:!1}):a=this._emptyDEMTexture=new e.Texture(t,r,i.RGBA,{premultiply:!1}),a}},{key:"setupElevationDraw",value:function(t,i,n){var r,a=this.painter.context,o=a.gl,s=(r=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(r),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();var l=this.painter.transform,u=l.projection,c=t.tileID.canonical;s.u_tile_tl_up=u.upVector(c,0,0),s.u_tile_tr_up=u.upVector(c,e.EXTENT,0),s.u_tile_br_up=u.upVector(c,e.EXTENT,e.EXTENT),s.u_tile_bl_up=u.upVector(c,0,e.EXTENT),s.u_tile_up_scale=n&&n.useDenormalizedUpVectorScale?e.GLOBE_METERS_TO_ECEF:u.upVectorScale(c,l.center.lat,l.worldSize).metersToTile;var h=null,p=null,d=1;if(n&&n.morphing&&this._useVertexMorphing){var f=n.morphing.srcDemTile,m=n.morphing.dstDemTile;d=n.morphing.phase,f&&m&&(this._prepareDemTileUniforms(t,f,s,"_prev")&&(p=f),this._prepareDemTileUniforms(t,m,s)&&(h=m))}if(p&&h?(a.activeTexture.set(o.TEXTURE2),h.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.activeTexture.set(o.TEXTURE4),p.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=d):(h=this.terrainTileForTile[t.tileID.key],a.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(t,h,s)?h.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE)),a.activeTexture.set(o.TEXTURE3),n&&n.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),this._depthFBO&&(s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.u_depth_size_inv=[1,1]),n&&n.useMeterToDem&&h){var v=(1<<h.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=v}n&&n.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),i.setTerrainUniformValues(a,s)}},{key:"renderToBackBuffer",value:function(t){var i=this.painter,n=this.painter.context;0!==t.length&&(n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,i,n,r,a){if("globe"===t.transform.projection.name)!function(t,i,n,r,a){var o,s,l=t.context,u=l.gl,c=t.options.showTerrainWireframe?2:0,d=t.transform,f=e.globeUseCustomAntiAliasing(t,l,d),m=function(e,i){if(s!==e){var n=[Ai[e],"PROJECTION_GLOBE_VIEW"];f&&n.push("CUSTOM_ANTIALIASING"),i&&n.push(Ai[c]),o=t.useProgram("globeRaster",null,n),s=e}},v=t.colorModeForRenderPass(),y=new e.DepthMode(u.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);Di.update(a);var g=e.calculateGlobeMercatorMatrix(d),_=[e.mercatorXfromLng(d.center.lng),e.mercatorYfromLat(d.center.lat)],b=t.globeSharedBuffers,x=[d.width*e.exported.devicePixelRatio,d.height*e.exported.devicePixelRatio];if((c?[!1,!0]:[!1]).forEach((function(c){s=-1;var f,w=c?u.LINES:u.TRIANGLES,k=p(r);try{for(k.s();!(f=k.n()).done;){var P=f.value,S=n.getTile(P),T=e.StencilMode.disabled,E=i.prevTerrainTileForTile[P.key],C=i.terrainTileForTile[P.key];Oi(E,C)&&Di.newMorphing(P.key,E,C,a,250),l.activeTexture.set(u.TEXTURE0),S.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE);var M=Di.getMorphValuesForProxy(P.key),I=M?1:0,O={useDenormalizedUpVectorScale:!0};M&&e.extend$1(O,{morphing:{srcDemTile:M.from,dstDemTile:M.to,phase:e.easeCubicInOut(M.phase)}});var D=Float32Array.from(d.globeMatrix),A=e.globeTileLatLngCorners(P.canonical),L=e.getLatitudinalLod((A[0][0]+A[1][0])/2),z=e.getGridMatrix(P.canonical,A,L),R=e.globeNormalizeECEF(e.globeTileBounds(P.canonical)),F=Ii(d.projMatrix,D,g,R,e.globeToMercatorTransition(d.zoom),_,d.frustumCorners.TL,d.frustumCorners.TR,d.frustumCorners.BR,d.frustumCorners.BL,d.globeCenterInViewSpace,d.globeRadius,x,z);if(m(I,c),i.setupElevationDraw(S,o,O),t.prepareDrawProgram(l,o,P.toUnwrapped()),b){var j=c?b.getWirefameBuffers(t.context,L):b.getGridBuffers(L),B=h(j,3),V=B[0],N=B[1],U=B[2];o.draw(l,w,y,T,v,e.CullFaceMode.backCCW,F,"globe_raster",V,N,U)}}}catch(G){k.e(G)}finally{k.f()}})),b){var w=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];f&&w.push("CUSTOM_ANTIALIASING"),o=t.useProgram("globeRaster",null,w);var k,P=p(r);try{var S=function(){var r=k.value,a=r.canonical,s=a.x,c=a.y,p=a.z,f=0===c,m=c===(1<<p)-1,g=b.getPoleBuffers(p),w=h(g,4),P=w[0],S=w[1],T=w[2],E=w[3];if(E&&(f||m)){var C=n.getTile(r);l.activeTexture.set(u.TEXTURE0),C.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE);var M=e.globePoleMatrixForTile(p,s,d),I=e.globeNormalizeECEF(e.globeTileBounds(r.canonical)),O=function(t,i){return t.draw(l,u.TRIANGLES,y,e.StencilMode.disabled,v,e.CullFaceMode.disabled,Ii(d.projMatrix,M,M,I,0,_,d.frustumCorners.TL,d.frustumCorners.TR,d.frustumCorners.BR,d.frustumCorners.BL,d.globeCenterInViewSpace,d.globeRadius,x),"globe_pole_raster",i,T,E)};i.setupElevationDraw(C,o,{}),t.prepareDrawProgram(l,o,r.toUnwrapped()),f&&O(o,P),m&&(M=e.scale(e.create(),M,[1,-1,1]),O(o,S))}};for(P.s();!(k=P.n()).done;)S()}catch(T){P.e(T)}finally{P.f()}}}(t,i,n,r,a);else{var o,s,l=t.context,u=l.gl,c=t.options.showTerrainWireframe?2:0,d=function(e,i){if(s!==e){var n=[Ai[e]];i&&n.push(Ai[c]),o=t.useProgram("terrainRaster",null,n),s=e}},f=t.colorModeForRenderPass(),m=new e.DepthMode(u.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);Di.update(a);var v=t.transform,y=6*Math.pow(1.5,22-v.zoom)*i.exaggeration();(c?[!1,!0]:[!1]).forEach((function(c){s=-1;var g,_=c?u.LINES:u.TRIANGLES,b=c?i.getWirefameBuffer():[i.gridIndexBuffer,i.gridSegments],x=h(b,2),w=x[0],k=x[1],P=p(r);try{for(P.s();!(g=P.n()).done;){var S=g.value,T=n.getTile(S),E=e.StencilMode.disabled,C=i.prevTerrainTileForTile[S.key],M=i.terrainTileForTile[S.key];Oi(C,M)&&Di.newMorphing(S.key,C,M,a,250),l.activeTexture.set(u.TEXTURE0),T.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE,u.LINEAR_MIPMAP_NEAREST);var I=Di.getMorphValuesForProxy(S.key),O=I?1:0,D=void 0;I&&(D={morphing:{srcDemTile:I.from,dstDemTile:I.to,phase:e.easeCubicInOut(I.phase)}});var A=Mi(S.projMatrix,Li(S.canonical,v.renderWorldCopies)?y/10:y);d(O,c),i.setupElevationDraw(T,o,D),t.prepareDrawProgram(l,o,S.toUnwrapped()),o.draw(l,_,m,E,f,e.CullFaceMode.backCCW,A,"terrain_raster",i.gridBuffer,w,k)}}catch(L){P.e(L)}finally{P.f()}}))}}(i,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}},{key:"renderBatch",value:function(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;var i,n=this.painter,r=this.painter.context,a=this.proxySourceCache,o=this.proxiedCoords[a.id],s=this._drapedRenderBatches.shift(),l=[],u=n.style.order,c=0,h=p(o);try{for(h.s();!(i=h.n()).done;){var d=i.value,f=a.getTileByID(d.proxyTileKey),m=a.proxyCachedFBO[d.key]?a.proxyCachedFBO[d.key][t]:void 0,v=void 0!==m?a.renderCache[m]:this.pool[c++],y=void 0!==m;if(f.texture=v.tex,!y||v.dirty){var g=void 0;r.bindFramebuffer.set(v.fb.framebuffer),this.renderedToTile=!1,v.dirty&&(r.clear({color:e.Color.transparent,stencil:0}),v.dirty=!1);for(var _=s.start;_<=s.end;++_){var b=n.style._layers[u[_]];if(!b.isHidden(n.transform.zoom)){var x=n.style._getLayerSourceCache(b),w=x?this.proxyToSource[d.key][x.id]:[d];if(w){var k=w;r.viewport.set([0,0,v.fb.width,v.fb.height]),g!==(x?x.id:null)&&(this._setupStencil(v,w,b,x),g=x?x.id:null),n.renderLayer(n,x,b,k)}}}this.renderedToTile?(v.dirty=!0,l.push(f.tileID)):y||--c,5===c&&(c=0,this.renderToBackBuffer(l))}else l.push(f.tileID)}}catch(P){h.e(P)}finally{h.f()}return this.renderToBackBuffer(l),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),s.end+1}},{key:"postRender",value:function(){}},{key:"renderCacheEfficiency",value:function(e){var t=e.order.length;if(0===t)return{efficiency:100};for(var i,n=0,r=0,a=!1,o=0;o<t;++o){var s=e._layers[e.order[o]];this._style.isLayerDraped(s)?(a&&++n,++r):a||(a=!0,i=s.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-n/r),firstUndrapedLayer:i}}},{key:"getMinElevationBelowMSL",value:function(){var e=0;return this._visibleDemTiles.filter((function(e){return e.dem})).forEach((function(t){e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}},{key:"raycast",value:function(e,t,i){if(!this._visibleDemTiles)return null;var n=this._visibleDemTiles.filter((function(e){return e.dem})).map((function(n){var r=n.tileID,a=Math.pow(2,r.overscaledZ),o=r.canonical,s=o.x,l=o.y,u=s/a,c=(s+1)/a,h=l/a,p=(l+1)/a;return{minx:u,miny:h,maxx:c,maxy:p,t:n.dem.tree.raycastRoot(u,h,c,p,e,t,i),tile:n}}));n.sort((function(e,t){return(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)}));var r,a=p(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(null==o.t)return null;var s=o.tile.dem.tree.raycast(o.minx,o.miny,o.maxx,o.maxy,e,t,i);if(null!=s)return s}}catch(l){a.e(l)}finally{a.f()}return null}},{key:"_createFBO",value:function(){var t=this.painter.context,i=t.gl,n=this.drapeBufferSize;t.activeTexture.set(i.TEXTURE0);var r=new e.Texture(t,{width:n[0],height:n[1],data:null},i.RGBA);r.bind(i.LINEAR,i.CLAMP_TO_EDGE);var a=t.createFramebuffer(n[0],n[1],!1);return a.colorAttachment.set(r.texture),a.depthAttachment=new je(t,a.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,a.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):a.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:a,tex:r,dirty:!1}}},{key:"_initFBOPool",value:function(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}},{key:"_shouldDisableRenderCache",value:function(){var e=this;if(this._style.light&&this._style.light.hasTransition())return!0;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some((function(t){var i=e._style._layers[t],n=i.isHidden(e.painter.transform.zoom),r=i.getCrossfadeParameters(),a=!!r&&1!==r.t,o=i.hasTransition();return"custom"!==i.type&&!n&&(a||o)}))}},{key:"_clearRasterFadeFromRenderCache",value:function(){var e=!1;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t]._source instanceof Ne){e=!0;break}if(e)for(var i=0;i<this._style.order.length;++i){var n=this._style._layers[this._style.order[i]],r=n.isHidden(this.painter.transform.zoom),a=this._style._getLayerSourceCache(n);if("raster"===n.type&&!r&&a){var o,s=n.paint.get("raster-fade-duration"),l=p(this.proxyCoords);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=this.proxyToSource[u.key][a.id];if(c){var h,d=p(c);try{for(d.s();!(h=d.n()).done;){var f=h.value,m=Ri(a.getTile(f),a.findLoadedParent(f,0),a,this.painter.transform,s);(1!==m.opacity||0!==m.mix)&&this._clearRenderCacheForTile(a.id,f)}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){l.e(v)}finally{l.f()}}}}},{key:"_setupDrapedRenderBatches",value:function(){var e=this._style.order,t=e.length;if(0!==t){for(var i,n=[],r=0,a=this._style._layers[e[r]];!this._style.isLayerDraped(a)&&a.isHidden(this.painter.transform.zoom)&&++r<t;)a=this._style._layers[e[r]];for(;r<t;++r){var o=this._style._layers[e[r]];o.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(o)?void 0===i&&(i=r):void 0!==i&&(n.push({start:i,end:r-1}),i=void 0))}void 0!==i&&n.push({start:i,end:r-1}),this._drapedRenderBatches=n}}},{key:"_setupRenderCache",value:function(e){var t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){var i=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(var n=0;n<i.length;++n){var r,a=Object.values(i[n]);(r=t.renderCachePool).push.apply(r,a)}}}else{this._clearRasterFadeFromRenderCache();for(var o=this.proxyCoords,s=this._tilesDirty,l=o.length-1;l>=0;l--){var u=o[l];if(t.getTileByID(u.key),void 0!==t.proxyCachedFBO[u.key]){var h=e[u.key],d=this.proxyToSource[u.key],f=0,m=function(e){var t=d[e],i=h[e];if(!i||i.length!==t.length||t.some((function(t,n){return t!==i[n]||s[e]&&s[e].hasOwnProperty(t.key)})))return f=-1,"break";++f};for(var v in d)if("break"===m(v))break;for(var y in t.proxyCachedFBO[u.key])t.renderCache[t.proxyCachedFBO[u.key][y]].dirty=f<0||f!==Object.values(h).length}}var g=c(this._drapedRenderBatches);g.sort((function(e,t){return t.end-t.start-(e.end-e.start)}));var _,b=p(g);try{for(b.s();!(_=b.n()).done;){var x,w=_.value,k=p(o);try{for(k.s();!(x=k.n()).done;){var P=x.value;if(!t.proxyCachedFBO[P.key]){var S=t.renderCachePool.pop();void 0===S&&t.renderCache.length<50&&(S=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==S&&(t.proxyCachedFBO[P.key]={},t.proxyCachedFBO[P.key][w.start]=S,t.renderCache[S].dirty=!0)}}}catch(T){k.e(T)}finally{k.f()}}}catch(T){b.e(T)}finally{b.f()}this._tilesDirty={}}}},{key:"_setupStencil",value:function(e,t,i,n){if(n&&this._sourceTilesOverlap[n.id]){var r=this.painter.context,a=r.gl;if(t.length<=1)this._overlapStencilType=!1;else{var o;if(i.isTileClipped())o=t.length,this._overlapStencilMode.test={func:a.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:a.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}}else this._overlapStencilType&&(this._overlapStencilType=!1)}},{key:"clipOrMaskOverlapStencilType",value:function(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}},{key:"stencilModeForRTTOverlap",value:function(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}},{key:"_renderTileClippingMasks",value:function(t,i){var n=this.painter,r=this.painter.context,a=r.gl;n._tileClippingMaskIDs={},r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);var o,s=n.useProgram("clippingMask"),l=p(t);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=n._tileClippingMaskIDs[u.key]=--i;s.draw(r,a.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:a.ALWAYS,mask:0},c,255,a.KEEP,a.KEEP,a.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,zi(u.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}catch(h){l.e(h)}finally{l.f()}}},{key:"pointCoordinate",value:function(t){var i=this.painter.transform;if(t.x<0||t.x>i.width||t.y<0||t.y>i.height)return null;var n=[t.x,t.y,1,1];e.transformMat4$1(n,n,i.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),n[0]/=i.worldSize,n[1]/=i.worldSize;var r=i._camera.position,a=e.mercatorZfromAltitude(1,i.center.lat),o=[r[0],r[1],r[2]/a,0],s=e.subtract([],n.slice(0,3),o);e.normalize(s,s);var l=this.raycast(o,s,this._exaggeration);return null!==l&&l?(e.scaleAndAdd(o,o,s,l),o[3]=o[2],o[2]*=a,o):null}},{key:"drawDepth",value:function(){var t=this.painter,i=t.context,n=this.proxySourceCache,r=Math.ceil(t.width),a=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===a||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){var o=i.gl,s=i.createFramebuffer(r,a,!0);i.activeTexture.set(o.TEXTURE0);var l=new e.Texture(i,{width:r,height:a,data:null},o.RGBA);l.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.colorAttachment.set(l.texture);var u=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,r,a);s.depthAttachment.set(u),this._depthFBO=s,this._depthTexture=l}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,r,a]),function(t,i,n,r){if("globe"!==t.transform.projection.name){var a=t.context,o=a.gl;a.clear({depth:1});var s,l=t.useProgram("terrainDepth"),u=new e.DepthMode(o.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D),c=p(r);try{for(c.s();!(s=c.n()).done;){var h=s.value,d=n.getTile(h),f=Mi(h.projMatrix,0);i.setupElevationDraw(d,l),l.draw(a,o.TRIANGLES,u,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,f,"terrain_depth",i.gridBuffer,i.gridIndexBuffer,i.gridNoSkirtSegments)}}catch(m){c.e(m)}finally{c.f()}}}(t,this,n,this.proxyCoords)}},{key:"_setupProxiedCoordsForOrtho",value:function(e,t,i){if(e.getSource()instanceof Ge)return this._setupProxiedCoordsForImageSource(e,t,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};for(var n=this.proxiedCoords[e.id]=[],r=this.proxyCoords,a=0;a<r.length;a++){var o=r[a],s=this._findTileCoveringTileID(o,e);if(s){var l=this._createProxiedId(o,s,i[o.key]&&i[o.key][e.id]);n.push(l),this.proxyToSource[o.key][e.id]=[l]}}for(var u=!1,c=0;c<t.length;c++){var h=e.getTile(t[c]);if(h&&h.hasData()){var p=this._findTileCoveringTileID(h.tileID,this.proxySourceCache);if(p&&p.tileID.canonical.z!==h.tileID.canonical.z){var d=this.proxyToSource[p.tileID.key][e.id],f=this._createProxiedId(p.tileID,h,i[p.tileID.key]&&i[p.tileID.key][e.id]);d?d.splice(d.length-1,0,f):this.proxyToSource[p.tileID.key][e.id]=[f],n.push(f),u=!0}}}this._sourceTilesOverlap[e.id]=u}},{key:"_setupProxiedCoordsForImageSource",value:function(t,i,n){if(t.getSource().loaded())for(var r=this.proxiedCoords[t.id]=[],a=this.proxyCoords,o=t.getSource(),s=new e.pointGeometry(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),l=o.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce((function(e,t){return e.min.x=Math.min(e.min.x,t.x-s.x),e.min.y=Math.min(e.min.y,t.y-s.y),e.max.x=Math.max(e.max.x,t.x-s.x),e.max.y=Math.max(e.max.y,t.y-s.y),e}),{min:new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=function(t,i){var n=t.wrap+t.canonical.x/(1<<t.canonical.z),r=t.canonical.y/(1<<t.canonical.z),a=e.EXTENT/(1<<t.canonical.z),o=i.wrap+i.canonical.x/(1<<i.canonical.z),s=i.canonical.y/(1<<i.canonical.z);return n+a<o+l.min.x||n>o+l.max.x||r+a<s+l.min.y||r>s+l.max.y},c=0;c<a.length;c++)for(var h=a[c],p=0;p<i.length;p++){var d=t.getTile(i[p]);if(d&&d.hasData()&&!u(h,d.tileID)){var f=this._createProxiedId(h,d,n[h.key]&&n[h.key][t.id]),m=this.proxyToSource[h.key][t.id];m?m.push(f):this.proxyToSource[h.key][t.id]=[f],r.push(f)}}}},{key:"_createProxiedId",value:function(t,i,n){var r=this.orthoMatrix;if(n){var a=n.find((function(e){return e.key===i.tileID.key}));if(a)return a}if(i.tileID.key!==t.key){var o,s,l,u=t.canonical.z-i.tileID.canonical.z;r=e.create();var c=i.tileID.wrap-t.wrap<<t.overscaledZ;u>0?(s=(o=e.EXTENT>>u)*((i.tileID.canonical.x<<u)-t.canonical.x+c),l=o*((i.tileID.canonical.y<<u)-t.canonical.y)):(o=e.EXTENT<<-u,s=e.EXTENT*(i.tileID.canonical.x-(t.canonical.x+c<<-u)),l=e.EXTENT*(i.tileID.canonical.y-(t.canonical.y<<-u))),e.ortho(r,0,o,0,o,0,1),e.translate(r,r,[s,l,0])}return new Bi(i.tileID,t.key,r)}},{key:"_findTileCoveringTileID",value:function(t,i){var n=i.getTile(t);if(n&&n.hasData())return n;var r=this._findCoveringTileCache[i.id],a=r[t.key];if((n=a?i.getTileByID(a):null)&&n.hasData()||null===a)return n;var o=n?n.tileID:t,s=o.overscaledZ,l=i.getSource().minzoom,u=[];if(!a){var c=i.getSource().maxzoom;if(t.canonical.z>=c){var h=t.canonical.z-c;i.getSource().reparseOverscaled?(s=Math.max(t.canonical.z+2,i.transform.tileZoom),o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h)):0!==h&&(s=c,o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h))}o.key!==t.key&&(u.push(o.key),n=i.getTile(o))}var p=function(e){u.forEach((function(t){r[t]=e})),u.length=0};for(s-=1;s>=l&&(!n||!n.hasData());s--){n&&p(n.tileID.key);var d=o.calculateScaledKey(s);if((n=i.getTileByID(d))&&n.hasData())break;var f=r[d];if(null===f)break;void 0===f?u.push(d):n=i.getTileByID(f)}return p(n?n.tileID.key:null),n&&n.hasData()?n:null}},{key:"findDEMTileFor",value:function(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}},{key:"prepareDrawTile",value:function(){this.renderedToTile=!0}},{key:"_clearRenderCacheForTile",value:function(e,t){var i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[t.key]=!0}},{key:"getWirefameBuffer",value:function(){if(!this.wireframeSegments){var t=function(t){for(var i=0,n=new e.StructArrayLayout2ui4,r=131,a=1;a<129;a++){for(var o=1;o<129;o++)i=a*r+o,n.emplaceBack(i,i+1),n.emplaceBack(i,i+r),n.emplaceBack(i+1,i+r),128===a&&n.emplaceBack(i+r,i+r+1);n.emplaceBack(i+1,i+1+r)}return n}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}]),n}(e.Elevation);function Ni(e){for(var t=[],i=0;i<e.length;i++)if(null!==e[i]){var n=e[i].split(" ");t.push(n.pop())}return t}var Ui=function(){function t(i,n,r,a,o,s){v(this,t);var l=i.gl;this.program=l.createProgram();var u,c=Ni(r.staticAttributes),h=a?a.getBinderAttributes():[],d=c.concat(h),f=r.staticUniforms?Ni(r.staticUniforms):[],m=a?a.getBinderUniforms():[],y=f.concat(m),g=[],_=p(y);try{for(_.s();!(u=_.n()).done;){var b=u.value;g.indexOf(b)<0&&g.push(b)}}catch(O){_.e(O)}finally{_.f()}var x=a?a.defines():[];x=x.concat(s.map((function(e){return"#define ".concat(e)})));var w=x.concat(i.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(bi):bi,bi,_i,gi.fragmentSource,yi.fragmentSource,r.fragmentSource).join("\n"),k=x.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",_i,gi.vertexSource,yi.vertexSource,vi.vertexSource,r.vertexSource).join("\n"),P=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost())this.failedToCreate=!0;else{l.shaderSource(P,w),l.compileShader(P),l.attachShader(this.program,P);var S=l.createShader(l.VERTEX_SHADER);if(l.isContextLost())this.failedToCreate=!0;else{l.shaderSource(S,k),l.compileShader(S),l.attachShader(this.program,S),this.attributes={};var T={};this.numAttributes=d.length;for(var E=0;E<this.numAttributes;E++)d[E]&&(l.bindAttribLocation(this.program,E,d[E]),this.attributes[d[E]]=E);l.linkProgram(this.program),l.deleteShader(S),l.deleteShader(P);for(var C=0;C<g.length;C++){var M=g[C];if(M&&!T[M]){var I=l.getUniformLocation(this.program,M);I&&(T[M]=I)}}this.fixedUniforms=o(i,T),this.binderUniforms=a?a.getUniforms(i,T):[],-1!==s.indexOf("TERRAIN")&&(this.terrainUniforms=function(t,i){return{u_dem:new e.Uniform1i(t,i.u_dem),u_dem_prev:new e.Uniform1i(t,i.u_dem_prev),u_dem_unpack:new e.Uniform4f(t,i.u_dem_unpack),u_dem_tl:new e.Uniform2f(t,i.u_dem_tl),u_dem_scale:new e.Uniform1f(t,i.u_dem_scale),u_dem_tl_prev:new e.Uniform2f(t,i.u_dem_tl_prev),u_dem_scale_prev:new e.Uniform1f(t,i.u_dem_scale_prev),u_dem_size:new e.Uniform1f(t,i.u_dem_size),u_dem_lerp:new e.Uniform1f(t,i.u_dem_lerp),u_exaggeration:new e.Uniform1f(t,i.u_exaggeration),u_depth:new e.Uniform1i(t,i.u_depth),u_depth_size_inv:new e.Uniform2f(t,i.u_depth_size_inv),u_meter_to_dem:new e.Uniform1f(t,i.u_meter_to_dem),u_label_plane_matrix_inv:new e.UniformMatrix4f(t,i.u_label_plane_matrix_inv),u_tile_tl_up:new e.Uniform3f(t,i.u_tile_tl_up),u_tile_tr_up:new e.Uniform3f(t,i.u_tile_tr_up),u_tile_br_up:new e.Uniform3f(t,i.u_tile_br_up),u_tile_bl_up:new e.Uniform3f(t,i.u_tile_bl_up),u_tile_up_scale:new e.Uniform1f(t,i.u_tile_up_scale)}}(i,T)),-1!==s.indexOf("FOG")&&(this.fogUniforms=function(t,i){return{u_fog_matrix:new e.UniformMatrix4f(t,i.u_fog_matrix),u_fog_range:new e.Uniform2f(t,i.u_fog_range),u_fog_color:new e.Uniform4f(t,i.u_fog_color),u_fog_horizon_blend:new e.Uniform1f(t,i.u_fog_horizon_blend),u_fog_temporal_offset:new e.Uniform1f(t,i.u_fog_temporal_offset),u_frustum_tl:new e.Uniform3f(t,i.u_frustum_tl),u_frustum_tr:new e.Uniform3f(t,i.u_frustum_tr),u_frustum_br:new e.Uniform3f(t,i.u_frustum_br),u_frustum_bl:new e.Uniform3f(t,i.u_frustum_bl),u_globe_pos:new e.Uniform3f(t,i.u_globe_pos),u_globe_radius:new e.Uniform1f(t,i.u_globe_radius),u_globe_transition:new e.Uniform1f(t,i.u_globe_transition),u_is_globe:new e.Uniform1i(t,i.u_is_globe),u_viewport:new e.Uniform2f(t,i.u_viewport)}}(i,T))}}}return y(t,[{key:"setTerrainUniformValues",value:function(e,t){if(this.terrainUniforms){var i=this.terrainUniforms;if(!this.failedToCreate)for(var n in e.program.set(this.program),t)i[n].set(t[n])}}},{key:"setFogUniformValues",value:function(e,t){if(this.fogUniforms){var i=this.fogUniforms;if(!this.failedToCreate)for(var n in e.program.set(this.program),t)i[n].location&&i[n].set(t[n])}}},{key:"draw",value:function(e,t,i,r,a,o,s,l,u,c,h,d,f,m,v,y,g){var _,b=e.gl;if(!this.failedToCreate){e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(r),e.setColorMode(a),e.setCullFace(o);for(var x=0,w=Object.keys(this.fixedUniforms);x<w.length;x++){var k=w[x];this.fixedUniforms[k].set(s[k])}m&&m.setUniforms(e,this.binderUniforms,d,{zoom:f});var P,S=(_={},n(_,b.LINES,2),n(_,b.TRIANGLES,3),n(_,b.LINE_STRIP,1),_)[t],T=p(h.get());try{for(T.s();!(P=T.n()).done;){var E=P.value,C=E.vaos||(E.vaos={});(C[l]||(C[l]=new ki)).bind(e,this,u,m?m.getPaintVertexBuffers():[],c,E.vertexOffset,v,y,g),b.drawElements(t,E.primitiveLength*S,b.UNSIGNED_SHORT,E.primitiveOffset*S*2)}}catch(M){T.e(M)}finally{T.f()}}}}],[{key:"cacheKey",value:function(e,t,i){var n,r="".concat(e).concat(i?i.cacheKey:""),a=p(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+="/".concat(o)}}catch(s){a.e(s)}finally{a.f()}return r}}]),t}();function Gi(e,t,i){var n=1/Z(i,1,t.transform.tileZoom),r=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,t.transform.tileZoom)/r,o=a*(i.tileID.canonical.x+i.tileID.wrap*r),s=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}var Wi=e.create(),Hi=function(t,i,n,r,a,o,s,l,u){var c=i.style.light,h=c.properties.get("position"),p=[h.x,h.y,h.z],d=e.create$1();"viewport"===c.properties.get("anchor")&&(e.fromRotation(d,-i.transform.angle),e.transformMat3(p,p,d));var f=c.properties.get("color"),m=i.transform,v={u_matrix:t,u_lightpos:p,u_lightintensity:c.properties.get("intensity"),u_lightcolor:[f.r,f.g,f.b],u_vertical_gradient:+n,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Wi,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return"globe"===m.projection.name&&(v.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],v.u_zoom_transition=s,v.u_inv_rot_matrix=u,v.u_merc_center=l,v.u_up_dir=m.projection.upVector(new e.CanonicalTileID(0,0,0),l[0]*e.EXTENT,l[1]*e.EXTENT),v.u_height_lift=o),v},Zi=function(t,i,n,r,a,o,s,l,u,c,h){var p=Hi(t,i,n,r,a,l,u,c,h),d={u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8};return e.extend(p,Gi(o,i,s),d)},qi=function(e){return{u_matrix:e}},Xi=function(t,i,n,r){return e.extend(qi(t),Gi(n,i,r))},Ki=function(e,t){return{u_matrix:e,u_world:t}},Yi=function(t,i,n,r,a){return e.extend(Xi(t,i,n,r),{u_world:a})},$i=e.create(),Ji=function(t,i,n,r,a,o){var s,l=t.transform,u="globe"===l.projection.name;if("map"===o.paint.get("circle-pitch-alignment"))if(u){var c=e.globePixelsToTileUnits(l.zoom,i.canonical)*l._projectionScaler;s=Float32Array.from([c,0,0,c])}else s=l.calculatePixelsToTileUnitsMatrix(n);else s=new Float32Array([l.pixelsToGLUnits[0],0,0,l.pixelsToGLUnits[1]]);var h={u_camera_to_center_distance:l.cameraToCenterDistance,u_matrix:t.translatePosMatrix(i.projMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:s,u_inv_rot_matrix:$i,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){h.u_inv_rot_matrix=r,h.u_merc_center=a,h.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(l.zoom);var p=a[0]*e.EXTENT,d=a[1]*e.EXTENT;h.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),p,d)}return h},Qi=function(e){var t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},en=function(t,i,n,r){var a=e.EXTENT/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:i.getCameraToCenterDistance(r),u_extrude_scale:[i.pixelsToGLUnits[0]/a,i.pixelsToGLUnits[1]/a]}},tn=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},nn=e.create(),rn=function(t,i,n,r,a,o,s){var l=t.transform,u="globe"===l.projection.name,c=u?e.globePixelsToTileUnits(l.zoom,i.canonical)*l._projectionScaler:Z(n,1,o),h={u_matrix:i.projMatrix,u_extrude_scale:c,u_intensity:s,u_inv_rot_matrix:nn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){h.u_inv_rot_matrix=r,h.u_merc_center=a,h.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(l.zoom);var p=a[0]*e.EXTENT,d=a[1]*e.EXTENT;h.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),p,d)}return h},an=function(e,t,i,n,r,a,o,s){var l=e.transform,u=l.calculatePixelsToTileUnitsMatrix(t),c={u_matrix:ln(e,t,i,r),u_pixels_to_tile_units:u,u_device_pixel_ratio:o,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:a,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:s};if(un(i)){var h=sn(t,e.transform);c.u_texsize=t.lineAtlasTexture.size,c.u_scale=[h,n.fromScale,n.toScale],c.u_mix=n.t}return c},on=function(e,t,i,n,r,a){var o=e.transform,s=sn(t,o);return{u_matrix:ln(e,t,i,r),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:o.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:a,u_image:0,u_scale:[s,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function sn(e,t){return 1/Z(e,1,t.tileZoom)}function ln(e,t,i,n){return e.translatePosMatrix(n||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}function un(e){var t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}var cn=function(e,t,i,n,r,a){return{u_matrix:e,u_tl_parent:t,u_scale_parent:i,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(s=r.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:hn(r.paint.get("raster-hue-rotate")),u_perspective_transform:a};var o,s};function hn(e){e*=Math.PI/180;var t=Math.sin(e),i=Math.cos(e);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}var pn,dn=e.create(),fn=function(t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v){var y=a.transform,g={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_rotate_symbol:+n,u_aspect_ratio:y.width/y.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:dn,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:dn,u_up_vector:[0,-1,0]};return"globe"===v.name&&(g.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],g.u_zoom_transition=p,g.u_inv_rot_matrix=f,g.u_merc_center=d,g.u_camera_forward=y._camera.forward(),g.u_ecef_origin=e.globeECEFOrigin(y.globeMatrix,h.toUnwrapped()),g.u_tile_matrix=Float32Array.from(y.globeMatrix),g.u_up_vector=m),g},mn=function(t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y){return e.extend(fn(t,i,n,r,a,o,s,l,u,c,p,d,f,m,v,y),{u_gamma_scale:r?a.transform.cameraToCenterDistance*Math.cos(a.terrain?0:a.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+h})},vn=function(t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v){return e.extend(mn(t,i,n,r,a,o,s,l,!0,u,!0,h,p,d,f,m,v),{u_texsize_icon:c,u_texture_icon:1})},yn=function(e,t,i){return{u_matrix:e,u_opacity:t,u_color:i}},gn=function(t,i,n,r,a,o){return e.extend(function(e,t,i,n){var r=i.imageManager.getPattern(e.from.toString()),a=i.imageManager.getPattern(e.to.toString()),o=i.imageManager.getPixelSize(),s=o.width,l=o.height,u=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,i.transform.tileZoom)/u,h=c*(n.tileID.canonical.x+n.tileID.wrap*u),p=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,l],u_mix:t.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/Z(n,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(r,o,n,a),{u_matrix:t,u_opacity:i})},_n={fillExtrusion:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_lightpos:new e.Uniform3f(t,i.u_lightpos),u_lightintensity:new e.Uniform1f(t,i.u_lightintensity),u_lightcolor:new e.Uniform3f(t,i.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,i.u_vertical_gradient),u_opacity:new e.Uniform1f(t,i.u_opacity),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_up_dir:new e.Uniform3f(t,i.u_up_dir),u_height_lift:new e.Uniform1f(t,i.u_height_lift)}},fillExtrusionPattern:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_lightpos:new e.Uniform3f(t,i.u_lightpos),u_lightintensity:new e.Uniform1f(t,i.u_lightintensity),u_lightcolor:new e.Uniform3f(t,i.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,i.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,i.u_height_factor),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_up_dir:new e.Uniform3f(t,i.u_up_dir),u_height_lift:new e.Uniform1f(t,i.u_height_lift),u_image:new e.Uniform1i(t,i.u_image),u_texsize:new e.Uniform2f(t,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,i.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,i.u_scale),u_fade:new e.Uniform1f(t,i.u_fade),u_opacity:new e.Uniform1f(t,i.u_opacity)}},fill:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix)}},fillPattern:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_image:new e.Uniform1i(t,i.u_image),u_texsize:new e.Uniform2f(t,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,i.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,i.u_scale),u_fade:new e.Uniform1f(t,i.u_fade)}},fillOutline:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_world:new e.Uniform2f(t,i.u_world)}},fillOutlinePattern:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_world:new e.Uniform2f(t,i.u_world),u_image:new e.Uniform1i(t,i.u_image),u_texsize:new e.Uniform2f(t,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,i.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,i.u_scale),u_fade:new e.Uniform1f(t,i.u_fade)}},circle:function(t,i){return{u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_extrude_scale:new e.UniformMatrix2f(t,i.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,i.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_up_dir:new e.Uniform3f(t,i.u_up_dir)}},collisionBox:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_extrude_scale:new e.Uniform2f(t,i.u_extrude_scale)}},collisionCircle:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,i.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,i.u_viewport_size)}},debug:function(t,i){return{u_color:new e.UniformColor(t,i.u_color),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_overlay:new e.Uniform1i(t,i.u_overlay),u_overlay_scale:new e.Uniform1f(t,i.u_overlay_scale)}},clippingMask:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix)}},heatmap:function(t,i){return{u_extrude_scale:new e.Uniform1f(t,i.u_extrude_scale),u_intensity:new e.Uniform1f(t,i.u_intensity),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_up_dir:new e.Uniform3f(t,i.u_up_dir)}},heatmapTexture:function(t,i){return{u_image:new e.Uniform1i(t,i.u_image),u_color_ramp:new e.Uniform1i(t,i.u_color_ramp),u_opacity:new e.Uniform1f(t,i.u_opacity)}},hillshade:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_image:new e.Uniform1i(t,i.u_image),u_latrange:new e.Uniform2f(t,i.u_latrange),u_light:new e.Uniform2f(t,i.u_light),u_shadow:new e.UniformColor(t,i.u_shadow),u_highlight:new e.UniformColor(t,i.u_highlight),u_accent:new e.UniformColor(t,i.u_accent)}},hillshadePrepare:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_image:new e.Uniform1i(t,i.u_image),u_dimension:new e.Uniform2f(t,i.u_dimension),u_zoom:new e.Uniform1f(t,i.u_zoom),u_unpack:new e.Uniform4f(t,i.u_unpack)}},line:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_pixels_to_tile_units:new e.UniformMatrix2f(t,i.u_pixels_to_tile_units),u_device_pixel_ratio:new e.Uniform1f(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,i.u_units_to_pixels),u_dash_image:new e.Uniform1i(t,i.u_dash_image),u_gradient_image:new e.Uniform1i(t,i.u_gradient_image),u_image_height:new e.Uniform1f(t,i.u_image_height),u_texsize:new e.Uniform2f(t,i.u_texsize),u_scale:new e.Uniform3f(t,i.u_scale),u_mix:new e.Uniform1f(t,i.u_mix),u_alpha_discard_threshold:new e.Uniform1f(t,i.u_alpha_discard_threshold),u_trim_offset:new e.Uniform2f(t,i.u_trim_offset)}},linePattern:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_texsize:new e.Uniform2f(t,i.u_texsize),u_pixels_to_tile_units:new e.UniformMatrix2f(t,i.u_pixels_to_tile_units),u_device_pixel_ratio:new e.Uniform1f(t,i.u_device_pixel_ratio),u_image:new e.Uniform1i(t,i.u_image),u_units_to_pixels:new e.Uniform2f(t,i.u_units_to_pixels),u_scale:new e.Uniform3f(t,i.u_scale),u_fade:new e.Uniform1f(t,i.u_fade),u_alpha_discard_threshold:new e.Uniform1f(t,i.u_alpha_discard_threshold)}},raster:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_tl_parent:new e.Uniform2f(t,i.u_tl_parent),u_scale_parent:new e.Uniform1f(t,i.u_scale_parent),u_fade_t:new e.Uniform1f(t,i.u_fade_t),u_opacity:new e.Uniform1f(t,i.u_opacity),u_image0:new e.Uniform1i(t,i.u_image0),u_image1:new e.Uniform1i(t,i.u_image1),u_brightness_low:new e.Uniform1f(t,i.u_brightness_low),u_brightness_high:new e.Uniform1f(t,i.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,i.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,i.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,i.u_spin_weights),u_perspective_transform:new e.Uniform2f(t,i.u_perspective_transform)}},symbolIcon:function(t,i){return{u_is_size_zoom_constant:new e.Uniform1i(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,i.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,i.u_size_t),u_size:new e.Uniform1f(t,i.u_size),u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_rotate_symbol:new e.Uniform1i(t,i.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,i.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,i.u_fade_change),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,i.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,i.u_coord_matrix),u_is_text:new e.Uniform1i(t,i.u_is_text),u_pitch_with_map:new e.Uniform1i(t,i.u_pitch_with_map),u_texsize:new e.Uniform2f(t,i.u_texsize),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_camera_forward:new e.Uniform3f(t,i.u_camera_forward),u_tile_matrix:new e.UniformMatrix4f(t,i.u_tile_matrix),u_up_vector:new e.Uniform3f(t,i.u_up_vector),u_ecef_origin:new e.Uniform3f(t,i.u_ecef_origin),u_texture:new e.Uniform1i(t,i.u_texture)}},symbolSDF:function(t,i){return{u_is_size_zoom_constant:new e.Uniform1i(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,i.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,i.u_size_t),u_size:new e.Uniform1f(t,i.u_size),u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_rotate_symbol:new e.Uniform1i(t,i.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,i.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,i.u_fade_change),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,i.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,i.u_coord_matrix),u_is_text:new e.Uniform1i(t,i.u_is_text),u_pitch_with_map:new e.Uniform1i(t,i.u_pitch_with_map),u_texsize:new e.Uniform2f(t,i.u_texsize),u_texture:new e.Uniform1i(t,i.u_texture),u_gamma_scale:new e.Uniform1f(t,i.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,i.u_device_pixel_ratio),u_tile_id:new e.Uniform3f(t,i.u_tile_id),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_inv_rot_matrix:new e.UniformMatrix4f(t,i.u_inv_rot_matrix),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_camera_forward:new e.Uniform3f(t,i.u_camera_forward),u_tile_matrix:new e.UniformMatrix4f(t,i.u_tile_matrix),u_up_vector:new e.Uniform3f(t,i.u_up_vector),u_ecef_origin:new e.Uniform3f(t,i.u_ecef_origin),u_is_halo:new e.Uniform1i(t,i.u_is_halo)}},symbolTextAndIcon:function(t,i){return{u_is_size_zoom_constant:new e.Uniform1i(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,i.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,i.u_size_t),u_size:new e.Uniform1f(t,i.u_size),u_camera_to_center_distance:new e.Uniform1f(t,i.u_camera_to_center_distance),u_rotate_symbol:new e.Uniform1i(t,i.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,i.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,i.u_fade_change),u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,i.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,i.u_coord_matrix),u_is_text:new e.Uniform1i(t,i.u_is_text),u_pitch_with_map:new e.Uniform1i(t,i.u_pitch_with_map),u_texsize:new e.Uniform2f(t,i.u_texsize),u_texsize_icon:new e.Uniform2f(t,i.u_texsize_icon),u_texture:new e.Uniform1i(t,i.u_texture),u_texture_icon:new e.Uniform1i(t,i.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,i.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,i.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,i.u_is_halo)}},background:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_opacity:new e.Uniform1f(t,i.u_opacity),u_color:new e.UniformColor(t,i.u_color)}},backgroundPattern:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_opacity:new e.Uniform1f(t,i.u_opacity),u_image:new e.Uniform1i(t,i.u_image),u_pattern_tl_a:new e.Uniform2f(t,i.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,i.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,i.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,i.u_pattern_br_b),u_texsize:new e.Uniform2f(t,i.u_texsize),u_mix:new e.Uniform1f(t,i.u_mix),u_pattern_size_a:new e.Uniform2f(t,i.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,i.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,i.u_scale_a),u_scale_b:new e.Uniform1f(t,i.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,i.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,i.u_tile_units_to_pixels)}},terrainRaster:Ci,terrainDepth:Ci,skybox:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_sun_direction:new e.Uniform3f(t,i.u_sun_direction),u_cubemap:new e.Uniform1i(t,i.u_cubemap),u_opacity:new e.Uniform1f(t,i.u_opacity),u_temporal_offset:new e.Uniform1f(t,i.u_temporal_offset)}},skyboxGradient:function(t,i){return{u_matrix:new e.UniformMatrix4f(t,i.u_matrix),u_color_ramp:new e.Uniform1i(t,i.u_color_ramp),u_center_direction:new e.Uniform3f(t,i.u_center_direction),u_radius:new e.Uniform1f(t,i.u_radius),u_opacity:new e.Uniform1f(t,i.u_opacity),u_temporal_offset:new e.Uniform1f(t,i.u_temporal_offset)}},skyboxCapture:function(t,i){return{u_matrix_3f:new e.UniformMatrix3f(t,i.u_matrix_3f),u_sun_direction:new e.Uniform3f(t,i.u_sun_direction),u_sun_intensity:new e.Uniform1f(t,i.u_sun_intensity),u_color_tint_r:new e.Uniform4f(t,i.u_color_tint_r),u_color_tint_m:new e.Uniform4f(t,i.u_color_tint_m),u_luminance:new e.Uniform1f(t,i.u_luminance)}},globeRaster:function(t,i){return{u_proj_matrix:new e.UniformMatrix4f(t,i.u_proj_matrix),u_globe_matrix:new e.UniformMatrix4f(t,i.u_globe_matrix),u_normalize_matrix:new e.UniformMatrix4f(t,i.u_normalize_matrix),u_merc_matrix:new e.UniformMatrix4f(t,i.u_merc_matrix),u_zoom_transition:new e.Uniform1f(t,i.u_zoom_transition),u_merc_center:new e.Uniform2f(t,i.u_merc_center),u_image0:new e.Uniform1i(t,i.u_image0),u_grid_matrix:new e.UniformMatrix3f(t,i.u_grid_matrix),u_frustum_tl:new e.Uniform3f(t,i.u_frustum_tl),u_frustum_tr:new e.Uniform3f(t,i.u_frustum_tr),u_frustum_br:new e.Uniform3f(t,i.u_frustum_br),u_frustum_bl:new e.Uniform3f(t,i.u_frustum_bl),u_globe_pos:new e.Uniform3f(t,i.u_globe_pos),u_globe_radius:new e.Uniform1f(t,i.u_globe_radius),u_viewport:new e.Uniform2f(t,i.u_viewport)}},globeAtmosphere:function(t,i){return{u_frustum_tl:new e.Uniform3f(t,i.u_frustum_tl),u_frustum_tr:new e.Uniform3f(t,i.u_frustum_tr),u_frustum_br:new e.Uniform3f(t,i.u_frustum_br),u_frustum_bl:new e.Uniform3f(t,i.u_frustum_bl),u_horizon:new e.Uniform1f(t,i.u_horizon),u_transition:new e.Uniform1f(t,i.u_transition),u_fadeout_range:new e.Uniform1f(t,i.u_fadeout_range),u_color:new e.Uniform4f(t,i.u_color),u_high_color:new e.Uniform4f(t,i.u_high_color),u_space_color:new e.Uniform4f(t,i.u_space_color),u_star_intensity:new e.Uniform1f(t,i.u_star_intensity),u_star_density:new e.Uniform1f(t,i.u_star_density),u_star_size:new e.Uniform1f(t,i.u_star_size),u_temporal_offset:new e.Uniform1f(t,i.u_temporal_offset),u_horizon_angle:new e.Uniform1f(t,i.u_horizon_angle),u_rotation_matrix:new e.UniformMatrix4f(t,i.u_rotation_matrix)}}};function bn(t,i,n,r,a,o,s){for(var l=t.context,u=l.gl,c=t.transform,h=t.useProgram("collisionBox"),p=[],d=0,f=0,m=0;m<r.length;m++){var v=r[m],y=i.getTile(v),g=y.getBucket(n);if(g){var _=Lt(v,g,c),b=_;0===a[0]&&0===a[1]||(b=t.translatePosMatrix(_,y,a,o));var x=s?g.textCollisionBox:g.iconCollisionBox,w=g.collisionCircleArray;if(w.length>0){var k=e.create(),P=b;e.mul(k,g.placementInvProjMatrix,c.glCoordMatrix),e.mul(k,k,g.placementViewportMatrix),p.push({circleArray:w,circleOffset:f,transform:P,invTransform:k,projection:g.getProjection()}),f=d+=w.length/4}x&&(t.terrain&&t.terrain.setupElevationDraw(y,h),h.draw(l,u.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,en(b,c,y,g.getProjection()),n.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,c.zoom,null,x.collisionVertexBuffer,x.collisionVertexBufferExt))}}if(s&&p.length){var S=t.useProgram("collisionCircle"),T=new e.StructArrayLayout2f1f2i16;T.resize(4*d),T._trim();for(var E=0,C=0,M=p;C<M.length;C++)for(var I=M[C],O=0;O<I.circleArray.length/4;O++){var D=4*O,A=I.circleArray[D+0],L=I.circleArray[D+1],z=I.circleArray[D+2],R=I.circleArray[D+3];T.emplace(E++,A,L,z,R,0),T.emplace(E++,A,L,z,R,1),T.emplace(E++,A,L,z,R,2),T.emplace(E++,A,L,z,R,3)}(!pn||pn.length<2*d)&&(pn=function(t){var i=2*t,n=new e.StructArrayLayout3ui6;n.resize(i),n._trim();for(var r=0;r<i;r++){var a=6*r;n.uint16[a+0]=4*r+0,n.uint16[a+1]=4*r+1,n.uint16[a+2]=4*r+2,n.uint16[a+3]=4*r+2,n.uint16[a+4]=4*r+3,n.uint16[a+5]=4*r+0}return n}(d));for(var F,j=l.createIndexBuffer(pn,!0),B=l.createVertexBuffer(T,e.collisionCircleLayout.members,!0),V=0,N=p;V<N.length;V++){var U=N[V],G={u_matrix:U.transform,u_inv_matrix:U.invTransform,u_camera_to_center_distance:(F=c).getCameraToCenterDistance(U.projection),u_viewport_size:[F.width,F.height]};S.draw(l,u.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,G,n.id,B,j,e.SegmentVector.simpleSegment(0,2*U.circleOffset,U.circleArray.length,U.circleArray.length/2),null,c.zoom)}B.destroy(),j.destroy()}}var xn=e.create();function wn(t,i,n,r,a,o){var s=e.getAnchorAlignment(t),l=-(s.horizontalAlign-.5)*i,u=-(s.verticalAlign-.5)*n,c=e.evaluateVariableOffset(t,r);return new e.pointGeometry((l/a+c[0])*o,(u/a+c[1])*o)}function kn(t,i,n,r,a,o,s,l,u,c,h){var p=t.text.placedSymbolArray,d=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={},v=zt(l,t.getProjection(),o),y=o.elevation,g=t.getProjection().upVectorScale(l.canonical,o.center.lat,o.worldSize);d.clear();for(var _=0;_<p.length;_++){var b=p.get(_),x=t.allowVerticalPlacement&&!b.placedOrientation,w=b.hidden||!b.crossTileID||x?null:r[b.crossTileID];if(w){var k=new e.pointGeometry(b.tileAnchorX,b.tileAnchorY),P=t.getProjection().upVector(l.canonical,k.x,k.y),S=y?y.getAtTileOffset(l,k.x,k.y):0,T=gt([b.projectedAnchorX+S*P[0]*g.metersToTile,b.projectedAnchorY+S*P[1]*g.metersToTile,b.projectedAnchorZ+S*P[2]*g.metersToTile],n?v:s),E=_t(o.getCameraToCenterDistance(t.getProjection()),T.signedDistanceFromCamera),C=a.evaluateSizeForFeature(t.textSizeData,c,b)*E/e.ONE_EM;n&&(C*=t.tilePixelRatio/u);var M=w.width,I=w.height,O=wn(w.anchor,M,I,w.textOffset,w.textScale,C),D=void 0;if(n){var A=k.add(O),L=t.getProjection().projectTilePoint(A.x,A.y,l.canonical),z=L.x,R=L.y,F=L.z;D=gt([z+S*P[0]*g.metersToTile,R+S*P[1]*g.metersToTile,F+S*P[2]*g.metersToTile],s).point}else{var j=i?O.rotate(-o.angle):O;D=[T.point[0]+j.x,T.point[1]+j.y,0]}for(var B=t.allowVerticalPlacement&&b.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,V=0;V<b.numGlyphs;V++)e.addDynamicAttributes(d,D[0],D[1],D[2],B);h&&b.associatedIconIndex>=0&&(m[b.associatedIconIndex]={shiftedAnchor:D,angle:B})}else Mt(b.numGlyphs,d)}if(h){f.clear();for(var N=t.icon.placedSymbolArray,U=0;U<N.length;U++){var G=N.get(U);if(G.hidden)Mt(G.numGlyphs,f);else{var W=m[U];if(W)for(var H=0;H<G.numGlyphs;H++)e.addDynamicAttributes(f,W.shiftedAnchor[0],W.shiftedAnchor[1],W.shiftedAnchor[2],W.angle);else Mt(G.numGlyphs,f)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(d)}function Pn(e,t,i){return i.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Sn(t,i,n,r,a,o,s,l,u,c,h,d){var f=t.context,m=f.gl,v=t.transform,y="map"===l,g="map"===u,_=y&&"point"!==n.layout.get("symbol-placement"),b=y&&!g&&!_,x=void 0!==n.layout.get("symbol-sort-key").constantOr(1),w=!1,k=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),P=[e.mercatorXfromLng(v.center.lng),e.mercatorYfromLat(v.center.lat)],S=n.layout.get("text-variable-anchor"),T="globe"===v.projection.name,E=[],C=[0,-1,0],M=C;!T&&!v.mercatorFromTransition||y||(M=function(t){var i=t._camera.getWorldToCamera(t.worldSize,1),n=e.multiply([],i,t.globeMatrix);e.invert(n,n);var r=[0,0,0],a=[0,1,0,0];return e.transformMat4$1(a,a,n),r[0]=a[0],r[1]=a[1],r[2]=a[2],e.normalize(r,r),r}(v));var I,O=p(r);try{for(O.s();!(I=O.n()).done;){var D=I.value,A=i.getTile(D),L=A.getBucket(n);if(L&&("mercator"!==L.projection.name||!T)){var z=a?L.text:L.icon;if(z&&!L.fullyClipped&&z.segments.get().length){var R=z.programConfigurations.get(n.id),F=a||L.sdfIcons,j=a?L.textSizeData:L.iconSizeData,B=g||0!==v.pitch,V=e.evaluateSizeForZoom(j,v.zoom),N=void 0,U=void 0,G=void 0,W=void 0,H=[0,0],Z=null;if(a){if(U=A.glyphAtlasTexture,G=m.LINEAR,N=A.glyphAtlasTexture.size,L.iconsInText){H=A.imageAtlasTexture.size,Z=A.imageAtlasTexture;var q="composite"===j.kind||"camera"===j.kind;W=B||t.options.rotating||t.options.zooming||q?m.LINEAR:m.NEAREST}}else{var X=1!==n.layout.get("icon-size").constantOr(0)||L.iconsNeedLinear;U=A.imageAtlasTexture,G=F||t.options.rotating||t.options.zooming||X||B?m.LINEAR:m.NEAREST,N=A.imageAtlasTexture.size}var K="globe"===L.projection.name,Y=K?M:C,$=K?e.globeToMercatorTransition(v.zoom):0,J=zt(D,L.getProjection(),v),Q=v.calculatePixelsToTileUnitsMatrix(A),ee=ft(J,A.tileID.canonical,g,y,v,L.getProjection(),Q),te=t.terrain&&g&&_?e.invert(e.create(),ee):xn,ie=vt(J,A.tileID.canonical,g,y,v,L.getProjection(),Q),ne=S&&L.hasTextData(),re="none"!==n.layout.get("icon-text-fit")&&ne&&L.hasIconData();if(_){var ae=v.elevation,oe=ae?ae.getAtTileOffsetFunc(D,v.center.lat,v.worldSize,L.getProjection()):function(e){return[0,0,0]},se=mt(J,A.tileID.canonical,g,y,v,L.getProjection(),Q);xt(L,J,t,a,se,ie,g,c,oe,D)}var le=_||a&&S||re,ue=t.translatePosMatrix(J,A,o,s),ce=le?xn:ee,he=t.translatePosMatrix(ie,A,o,s,!0),pe=L.getProjection().createInversionMatrix(v,D.canonical),de=[];t.terrain&&g&&de.push("PITCH_WITH_MAP_TERRAIN"),K&&de.push("PROJECTION_GLOBE_VIEW"),le&&de.push("PROJECTED_POS_ON_VIEWPORT");var fe=F&&0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),me=void 0;me=F?L.iconsInText?vn(j.kind,V,b,g,t,ue,ce,he,N,H,D,$,P,pe,Y,L.getProjection()):mn(j.kind,V,b,g,t,ue,ce,he,a,N,!0,D,$,P,pe,Y,L.getProjection()):fn(j.kind,V,b,g,t,ue,ce,he,a,N,D,$,P,pe,Y,L.getProjection());var ve={program:t.useProgram(Pn(F,a,L),R,de),buffers:z,uniformValues:me,atlasTexture:U,atlasTextureIcon:Z,atlasInterpolation:G,atlasInterpolationIcon:W,isSDF:F,hasHalo:fe,tile:A,labelPlaneMatrixInv:te};if(x&&L.canOverlap){w=!0;var ye,ge=z.segments.get(),_e=p(ge);try{for(_e.s();!(ye=_e.n()).done;){var be=ye.value;E.push({segments:new e.SegmentVector([be]),sortKey:be.sortKey,state:ve})}}catch(Te){_e.e(Te)}finally{_e.f()}}else E.push({segments:z.segments,sortKey:0,state:ve})}}}}catch(Te){O.e(Te)}finally{O.f()}w&&E.sort((function(e,t){return e.sortKey-t.sortKey}));for(var xe=0,we=E;xe<we.length;xe++){var ke=we[xe],Pe=ke.state;if(t.terrain&&t.terrain.setupElevationDraw(Pe.tile,Pe.program,{useDepthForOcclusion:!T,labelPlaneMatrixInv:Pe.labelPlaneMatrixInv}),f.activeTexture.set(m.TEXTURE0),Pe.atlasTexture.bind(Pe.atlasInterpolation,m.CLAMP_TO_EDGE),Pe.atlasTextureIcon&&(f.activeTexture.set(m.TEXTURE1),Pe.atlasTextureIcon&&Pe.atlasTextureIcon.bind(Pe.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),Pe.isSDF){var Se=Pe.uniformValues;Pe.hasHalo&&(Se.u_is_halo=1,Tn(Pe.buffers,ke.segments,n,t,Pe.program,k,h,d,Se)),Se.u_is_halo=0}Tn(Pe.buffers,ke.segments,n,t,Pe.program,k,h,d,Pe.uniformValues)}}function Tn(t,i,n,r,a,o,s,l,u){var c=r.context;a.draw(c,c.gl.TRIANGLES,o,s,l,e.CullFaceMode.disabled,u,n.id,t.layoutVertexBuffer,t.indexBuffer,i,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer)}function En(t,i,n,r,a,o,s){var l,u,c,h,d,f=t.context.gl,m=n.paint.get("fill-pattern"),v=m&&m.constantOr(1),y=n.getCrossfadeParameters();s?(u=v&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",l=f.LINES):(u=v?"fillPattern":"fill",l=f.TRIANGLES);var g,_=p(r);try{for(_.s();!(g=_.n()).done;){var b=g.value,x=i.getTile(b);if(!v||x.patternsLoaded()){var w=x.getBucket(n);if(w){t.prepareDrawTile();var k=w.programConfigurations.get(n.id),P=t.useProgram(u,k);v&&(t.context.activeTexture.set(f.TEXTURE0),x.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),k.updatePaintBuffers(y));var S=m.constantOr(null);if(S&&x.imageAtlas){var T=x.imageAtlas,E=T.patternPositions[S.to.toString()],C=T.patternPositions[S.from.toString()];E&&C&&k.setConstantPatternPositions(E,C)}var M=t.translatePosMatrix(b.projMatrix,x,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(s){h=w.indexBuffer2,d=w.segments2;var I=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[f.drawingBufferWidth,f.drawingBufferHeight];c="fillOutlinePattern"===u&&v?Yi(M,t,y,x,I):Ki(M,I)}else h=w.indexBuffer,d=w.segments,c=v?Xi(M,t,y,x):qi(M);t.prepareDrawProgram(t.context,P,b.toUnwrapped()),P.draw(t.context,l,a,t.stencilModeForClipping(b),o,e.CullFaceMode.disabled,c,n.id,w.layoutVertexBuffer,h,d,n.paint,t.transform.zoom,k)}}}}catch(O){_.e(O)}finally{_.f()}}function Cn(t,i,n,r,a,o,s){var l=t.context,u=l.gl,c=t.transform,h=n.paint.get("fill-extrusion-pattern"),d=h.constantOr(1),f=n.getCrossfadeParameters(),m=n.paint.get("fill-extrusion-opacity"),v="globe"===c.projection.name?e.fillExtrusionHeightLift():0,y="globe"===c.projection.name,g=y?e.globeToMercatorTransition(c.zoom):0,_=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)],b=[];y&&b.push("PROJECTION_GLOBE_VIEW");var x,w=p(r);try{for(w.s();!(x=w.n()).done;){var k=x.value,P=i.getTile(k),S=P.getBucket(n);if(S&&S.projection.name===c.projection.name){var T=S.programConfigurations.get(n.id),E=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",T,b);if(t.terrain){var C=t.terrain;if(t.style.terrainSetForDrapingOnly())C.setupElevationDraw(P,E,{useMeterToDem:!0});else{if(!S.enableTerrain)continue;if(C.setupElevationDraw(P,E,{useMeterToDem:!0}),Mn(l,i,k,S,n,C),!S.centroidVertexBuffer){var M=E.attributes.a_centroid_pos;void 0!==M&&u.vertexAttrib2f(M,0,0)}}}d&&(t.context.activeTexture.set(u.TEXTURE0),P.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),T.updatePaintBuffers(f));var I=h.constantOr(null);if(I&&P.imageAtlas){var O=P.imageAtlas,D=O.patternPositions[I.to.toString()],A=O.patternPositions[I.from.toString()];D&&A&&T.setConstantPatternPositions(D,A)}var L=t.translatePosMatrix(k.projMatrix,P,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),z=c.projection.createInversionMatrix(c,k.canonical),R=n.paint.get("fill-extrusion-vertical-gradient"),F=d?Zi(L,t,R,m,k,f,P,v,g,_,z):Hi(L,t,R,m,k,v,g,_,z);t.prepareDrawProgram(l,E,k.toUnwrapped()),E.draw(l,l.gl.TRIANGLES,a,o,s,e.CullFaceMode.backCCW,F,n.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,n.paint,t.transform.zoom,T,t.terrain?S.centroidVertexBuffer:null,y?S.layoutVertexExtBuffer:null)}}}catch(j){w.e(j)}finally{w.f()}}function Mn(t,i,n,r,a,o){for(var s,l,u,c=[function(t){var i=t.canonical.x-1,n=t.wrap;return i<0&&(i=(1<<t.canonical.z)-1,n--),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},function(t){var i=t.canonical.x+1,n=t.wrap;return i===1<<t.canonical.z&&(i=0,n++),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)}],h=function(e){for(var t=i.getSource().minzoom,n=function(e){var t=i.getTileByID(e);if(t&&t.hasData())return t.getBucket(a)},r=0,o=[0,-1,1];r<o.length;r++){var s=o[r];if(!(e.overscaledZ+s<t)){var l=n(e.calculateScaledKey(e.overscaledZ+s));if(l)return l}}},d=[0,0,0],f=function(t,i){return d[0]=Math.min(t.min.y,i.min.y),d[1]=Math.max(t.max.y,i.max.y),d[2]=e.EXTENT-i.min.x>t.max.x?i.min.x-e.EXTENT:t.max.x,d},m=function(t,i){return d[0]=Math.min(t.min.x,i.min.x),d[1]=Math.max(t.max.x,i.max.x),d[2]=e.EXTENT-i.min.y>t.max.y?i.min.y-e.EXTENT:t.max.y,d},v=[function(e,t){return f(e,t)},function(e,t){return f(t,e)},function(e,t){return m(e,t)},function(e,t){return m(t,e)}],y=new e.pointGeometry(0,0),g=function(t,i,r,a,c){var h=[[a?r:t,a?t:r,0],[a?r:i,a?i:r,0]],p=c<0?e.EXTENT+c:c,d=[a?p:(t+i)/2,a?(t+i)/2:p,0];return 0===r&&c<0||0!==r&&c>0?o.getForTilePoints(u,[d],!0,l):h.push(d),o.getForTilePoints(n,h,!0,s),Math.max(h[0][2],h[1][2],d[2])/o.exaggeration()},_=0;_<4;_++){var b=(_<2?1:5)-_,x=r.borders[_];if(0!==x.length){var w=u=c[_](n),k=h(w);if(k&&k instanceof e.FillExtrusionBucket&&k.enableTerrain&&(r.borderDoneWithNeighborZ[_]!==k.canonical.z||k.borderDoneWithNeighborZ[b]!==r.canonical.z)&&(l=o.findDEMTileFor(w))&&l.dem){if(!s){var P=o.findDEMTileFor(n);if(!P||!P.dem)return;s=P}var S=k.borders[b],T=0,E=k.borderDoneWithNeighborZ[b]!==r.canonical.z;if(r.canonical.z===k.canonical.z){for(var C=0;C<x.length;C++){for(var M=r.featuresOnBorder[x[C]],I=M.borders[_],O=void 0;T<S.length&&!((O=k.featuresOnBorder[S[T]]).borders[b][1]>I[0]+3);)E&&k.encodeCentroid(void 0,O,!1),T++;if(O&&T<S.length){for(var D=T,A=0;!(O.borders[b][0]>I[1]-3)&&(A++,++T!==S.length);)O=k.featuresOnBorder[S[T]];if(O=k.featuresOnBorder[S[D]],M.intersectsCount()>1||O.intersectsCount()>1||1!==A){1!==A&&(T=D),r.encodeCentroid(void 0,M,!1),E&&k.encodeCentroid(void 0,O,!1);continue}var L=v[_](M,O),z=_%2?e.EXTENT-1:0;y.x=g(L[0],Math.min(e.EXTENT-1,L[1]),z,_<2,L[2]),y.y=0,r.encodeCentroid(y,M,!1),E&&k.encodeCentroid(y,O,!1)}else r.encodeCentroid(void 0,M,!1)}r.borderDoneWithNeighborZ[_]=k.canonical.z,r.needsCentroidUpdate=!0,E&&(k.borderDoneWithNeighborZ[b]=r.canonical.z,k.needsCentroidUpdate=!0)}else{var R,F=p(x);try{for(F.s();!(R=F.n()).done;){var j=R.value;r.encodeCentroid(void 0,r.featuresOnBorder[j],!1)}}catch(U){F.e(U)}finally{F.f()}if(E){var B,V=p(S);try{for(V.s();!(B=V.n()).done;){var N=B.value;k.encodeCentroid(void 0,k.featuresOnBorder[N],!1)}}catch(U){V.e(U)}finally{V.f()}k.borderDoneWithNeighborZ[b]=r.canonical.z,k.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[_]=k.canonical.z,r.needsCentroidUpdate=!0}}}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(t)}var In=new e.Color(1,0,0,1),On=new e.Color(0,1,0,1),Dn=new e.Color(0,0,1,1),An=new e.Color(1,0,1,1),Ln=new e.Color(0,1,1,1);function zn(e,t,i,n){Fn(e,0,t+i/2,e.transform.width,i,n)}function Rn(e,t,i,n){Fn(e,t-i/2,0,i,e.transform.height,n)}function Fn(t,i,n,r,a,o){var s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*e.exported.devicePixelRatio,n*e.exported.devicePixelRatio,r*e.exported.devicePixelRatio,a*e.exported.devicePixelRatio),s.clear({color:o}),l.disable(l.SCISSOR_TEST)}function jn(t,i,n){var r=t.context,a=r.gl,o="globe"===t.transform.projection.name,s=n.projMatrix,l=t.useProgram("debug",null,o?["PROJECTION_GLOBE_VIEW"]:null),u=i.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(u,l);var c=e.DepthMode.disabled,h=e.StencilMode.disabled,p=t.colorModeForRenderPass(),d="$debug";r.activeTexture.set(a.TEXTURE0),t.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),o?u._makeGlobeTileDebugBuffers(t.context,t.transform.projection):u._makeDebugTileBoundsBuffers(t.context,t.transform.projection);var f=u._tileDebugBuffer||t.debugBuffer,m=u._tileDebugIndexBuffer||t.debugIndexBuffer,v=u._tileDebugSegments||t.debugSegments;l.draw(r,a.LINE_STRIP,c,h,p,e.CullFaceMode.disabled,tn(s,e.Color.red),d,f,m,v,null,null,null,u._globeTileDebugBorderBuffer);var y=u.latestRawTileData,g=Math.floor((y&&y.byteLength||0)/1024),_=i.getTile(n).tileSize,b=512/Math.min(_,512)*(n.overscaledZ/t.transform.zoom)*.5,x=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(x+=" => ".concat(n.overscaledZ)),function(e,t){e.initDebugOverlayCanvas();var i=e.debugOverlayCanvas,n=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(i),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,"".concat(x," ").concat(g,"kb"));var w=u._tileDebugTextBuffer||t.debugBuffer,k=u._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,P=u._tileDebugTextSegments||t.debugSegments;l.draw(r,a.TRIANGLES,c,h,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,tn(s,e.Color.transparent,b),d,w,k,P,null,null,null,u._globeTileDebugTextBuffer)}var Bn=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]).members;function Vn(e,t,i,n){e.emplaceBack(t,i,n)}var Nn=y((function t(i){v(this,t),this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,Vn(this.vertexArray,-1,-1,1),Vn(this.vertexArray,1,-1,1),Vn(this.vertexArray,-1,1,1),Vn(this.vertexArray,1,1,1),Vn(this.vertexArray,-1,-1,-1),Vn(this.vertexArray,1,-1,-1),Vn(this.vertexArray,-1,1,-1),Vn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Bn),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}));function Un(t,i,n,r,a,o){var s=t.gl,l=i.paint.get("sky-atmosphere-color"),u=i.paint.get("sky-atmosphere-halo-color"),c=i.paint.get("sky-atmosphere-sun-intensity"),h=function(e,t,i,n,r){return{u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:i,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}}(e.fromMat4(e.create$1(),r),a,c,l,u);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+o,i.skyboxTexture,0),n.draw(t,s.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,h,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}var Gn=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),Wn=function(){function t(i){v(this,t);var n=new e.StructArrayLayout5f20;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);var r=new e.StructArrayLayout3ui6;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(n,Gn.members),this.indexBuffer=i.createIndexBuffer(r),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}return y(t,[{key:"destroy",value:function(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}]),t}(),Hn={symbol:function(t,i,n,r,a){if("translucent"===t.renderPass){var o=e.StencilMode.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,i,n,r,a,o,s){var l,u=i.transform,c="map"===a,h="map"===o,d=p(t);try{for(d.s();!(l=d.n()).done;){var f=l.value,m=r.getTile(f),v=m.getBucket(n);if(v&&v.text&&v.text.segments.get().length){var y=e.evaluateSizeForZoom(v.textSizeData,u.zoom),g=zt(f,v.getProjection(),u),_=u.calculatePixelsToTileUnitsMatrix(m),b=ft(g,m.tileID.canonical,h,c,u,v.getProjection(),_),x="none"!==n.layout.get("icon-text-fit")&&v.hasIconData();if(y){var w=Math.pow(2,u.zoom-m.tileID.overscaledZ);kn(v,c,h,s,e.symbolSize,u,b,f,w,y,x)}}}}catch(k){d.e(k)}finally{d.f()}}(r,t,n,i,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),a),0!==n.paint.get("icon-opacity").constantOr(1)&&Sn(t,i,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,s),0!==n.paint.get("text-opacity").constantOr(1)&&Sn(t,i,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,s),i.map.showCollisionBoxes&&(bn(t,i,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),bn(t,i,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(t,i,n,r){if("translucent"===t.renderPass){var a=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0!==a.constantOr(1)||0!==o.constantOr(1)&&0!==s.constantOr(1)){for(var u=t.context,c=u.gl,h=t.transform,d=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),f=e.StencilMode.disabled,m=t.colorModeForRenderPass(),v="globe"===h.projection.name,y=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],g=[],_=0;_<r.length;_++){var b=r[_],x=i.getTile(b),w=x.getBucket(n);if(w&&w.projection.name===h.projection.name){var k=w.programConfigurations.get(n.id),P=Qi(n);v&&P.push("PROJECTION_GLOBE_VIEW");var S=t.useProgram("circle",k,P),T=w.layoutVertexBuffer,E=w.globeExtVertexBuffer,C=w.indexBuffer,M=h.projection.createInversionMatrix(h,b.canonical),I={programConfiguration:k,program:S,layoutVertexBuffer:T,globeExtVertexBuffer:E,indexBuffer:C,uniformValues:Ji(t,b,x,M,y,n),tile:x};if(l){var O,D=w.segments.get(),A=p(D);try{for(A.s();!(O=A.n()).done;){var L=O.value;g.push({segments:new e.SegmentVector([L]),sortKey:L.sortKey,state:I})}}catch(X){A.e(X)}finally{A.f()}}else g.push({segments:w.segments,sortKey:0,state:I})}}l&&g.sort((function(e,t){return e.sortKey-t.sortKey}));for(var z={useDepthForOcclusion:!v},R=0,F=g;R<F.length;R++){var j=F[R],B=j.state,V=B.programConfiguration,N=B.program,U=B.layoutVertexBuffer,G=B.globeExtVertexBuffer,W=B.indexBuffer,H=B.uniformValues,Z=B.tile,q=j.segments;t.terrain&&t.terrain.setupElevationDraw(Z,N,z),t.prepareDrawProgram(u,N,Z.tileID.toUnwrapped()),N.draw(u,c.TRIANGLES,d,f,m,e.CullFaceMode.disabled,H,n.id,U,W,q,n.paint,h.zoom,V,v?G:null)}}}},heatmap:function(t,i,n,r){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var a=t.context,o=a.gl,s=e.StencilMode.disabled,l=new e.ColorMode([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,i,n){var r=e.gl,a=t.width*n,o=t.height*n;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,a,o]);var s=i.heatmapFbo;if(!s||s&&(s.width!==a||s.height!==o)){s&&s.destroy();var l=r.createTexture();r.bindTexture(r.TEXTURE_2D,l),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),s=i.heatmapFbo=e.createFramebuffer(a,o,!1),function(e,t,i,n,r,a){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,r,a,0,o.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(i)}(e,0,l,s,a,o)}else r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),e.bindFramebuffer.set(s.framebuffer)}(a,t,n,"globe"===t.transform.projection.name?.5:.25),a.clear({color:e.Color.transparent});for(var u=t.transform,c="globe"===u.projection.name,h=c?["PROJECTION_GLOBE_VIEW"]:null,p=c?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,d=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],f=0;f<r.length;f++){var m=r[f];if(!i.hasRenderableParent(m)){var v=i.getTile(m),y=v.getBucket(n);if(y&&y.projection.name===u.projection.name){var g=y.programConfigurations.get(n.id),_=t.useProgram("heatmap",g,h),b=t.transform.zoom;t.terrain&&t.terrain.setupElevationDraw(v,_),t.prepareDrawProgram(a,_,m.toUnwrapped());var x=u.projection.createInversionMatrix(u,m.canonical);_.draw(a,o.TRIANGLES,e.DepthMode.disabled,s,l,p,rn(t,m,v,x,d,b,n.paint.get("heatmap-intensity")),n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,t.transform.zoom,g,c?y.globeExtVertexBuffer:null)}}}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){var n=t.context,r=n.gl,a=i.heatmapFbo;if(a){n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(r.TEXTURE1);var o=i.colorRampTexture;o||(o=i.colorRampTexture=new e.Texture(n,i.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,r.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,function(e,t,i,n){return{u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}}(0,i),i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}}(t,n))},line:function(t,i,n,r){if("translucent"===t.renderPass){var a=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0!==a.constantOr(1)&&0!==o.constantOr(1)){var s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,c=n.paint.get("line-dasharray"),d=c.constantOr(1),f=n.layout.get("line-cap"),m=n.paint.get("line-pattern"),v=m.constantOr(1),y=n.paint.get("line-gradient"),g=n.getCrossfadeParameters(),_=v?"linePattern":"line",b=t.context,x=b.gl,w=function(e){var t=[];un(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");var i=e.paint.get("line-trim-offset");0===i[0]&&0===i[1]||t.push("RENDER_LINE_TRIM_OFFSET");var n=e.paint.get("line-pattern").constantOr(1),r=1!==e.paint.get("line-opacity").constantOr(1);return!n&&r&&t.push("RENDER_LINE_ALPHA_DISCARD"),t}(n),k=w.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(k=!1);var P,S=p(r);try{var T=function(){var r=P.value,a=i.getTile(r);if(v&&!a.patternsLoaded())return"continue";var o=a.getBucket(n);if(!o)return"continue";t.prepareDrawTile();var p=o.programConfigurations.get(n.id),S=t.useProgram(_,p,w),T=m.constantOr(null);if(T&&a.imageAtlas){var E=a.imageAtlas,C=E.patternPositions[T.to.toString()],M=E.patternPositions[T.from.toString()];C&&M&&p.setConstantPatternPositions(C,M)}var I=c.constantOr(null),O=f.constantOr(null);if(!v&&I&&O&&a.lineAtlas){var D=a.lineAtlas,A=D.getDash(I.to,O),L=D.getDash(I.from,O);A&&L&&p.setConstantPatternPositions(A,L)}var z=n.paint.get("line-trim-offset"),R=h(z,2),F=R[0],j=R[1];if("round"===O||"square"===O){var B=1;F!==j&&(0===F&&(F-=B),1===j&&(j+=B))}var V=t.terrain?r.projMatrix:null,N=v?on(t,a,n,g,V,u):an(t,a,n,g,V,o.lineClipsArray.length,u,[F,j]);if(y){var U=o.gradients[n.id],G=U.texture;if(n.gradientVersion!==U.version){var W=256;if(n.stepInterpolant){var H=i.getSource().maxzoom,Z=r.canonical.z===H?Math.ceil(1<<t.transform.maxZoom-r.canonical.z):1;W=e.clamp(e.nextPowerOfTwo(o.maxLineLength/e.EXTENT*1024*Z),256,b.maxTextureSize)}U.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:W,image:U.gradient||void 0,clips:o.lineClipsArray}),U.texture?U.texture.update(U.gradient):U.texture=new e.Texture(b,U.gradient,x.RGBA),U.version=n.gradientVersion,G=U.texture}b.activeTexture.set(x.TEXTURE1),G.bind(n.stepInterpolant?x.NEAREST:x.LINEAR,x.CLAMP_TO_EDGE)}d&&(b.activeTexture.set(x.TEXTURE0),a.lineAtlasTexture.bind(x.LINEAR,x.REPEAT),p.updatePaintBuffers(g)),v&&(b.activeTexture.set(x.TEXTURE0),a.imageAtlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),p.updatePaintBuffers(g)),t.prepareDrawProgram(b,S,r.toUnwrapped());var q=function(i){S.draw(b,x.TRIANGLES,s,i,l,e.CullFaceMode.disabled,N,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,n.paint,t.transform.zoom,p,o.layoutVertexBuffer2)};if(k){var X=t.stencilModeForClipping(r).ref;0===X&&t.terrain&&b.clear({stencil:0});var K={func:x.EQUAL,mask:255};N.u_alpha_discard_threshold=.8,q(new e.StencilMode(K,X,255,x.KEEP,x.KEEP,x.INVERT)),N.u_alpha_discard_threshold=0,q(new e.StencilMode(K,X,255,x.KEEP,x.KEEP,x.KEEP))}else q(t.stencilModeForClipping(r))};for(S.s();!(P=S.n()).done;)T()}catch(E){S.e(E)}finally{S.f()}k&&(t.resetStencilClippingMasks(),t.terrain&&b.clear({stencil:0}))}}},fill:function(t,i,n,r){var a=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===u){var c=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);En(t,i,n,r,c,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){var h=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);En(t,i,n,r,h,s,!0)}}},"fill-extrusion":function(t,i,n,r){var a=n.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===t.renderPass){var o=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==a||n.paint.get("fill-extrusion-pattern").constantOr(1))Cn(t,i,n,r,o,e.StencilMode.disabled,e.ColorMode.disabled),Cn(t,i,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{var s=t.colorModeForRenderPass();Cn(t,i,n,r,o,e.StencilMode.disabled,s)}}},hillshade:function(t,i,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var a,o=t.context,s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture,c="translucent"!==t.renderPass||u?[{},r]:t.stencilConfigForOverlap(r),d=h(c,2),f=d[0],m=d[1],v=p(m);try{for(v.s();!(a=v.n()).done;){var y=a.value,g=i.getTile(y);if(g.needsHillshadePrepare&&"offscreen"===t.renderPass)Ei(t,g,n,s,e.StencilMode.disabled,l);else if("translucent"===t.renderPass){var _=u&&t.terrain?t.terrain.stencilModeForRTTOverlap(y):f[y.overscaledZ];Si(t,y,g,n,s,_,l)}}}catch(b){v.e(b)}finally{v.f()}o.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()}},raster:function(t,i,n,r,a,o){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&r.length){var s,l=t.context,u=l.gl,c=i.getSource(),d=t.useProgram("raster"),f=t.colorModeForRenderPass(),m=t.terrain&&t.terrain.renderingToTexture,v=c instanceof Ge||m?[{},r]:t.stencilConfigForOverlap(r),y=h(v,2),g=y[0],_=y[1],b=_[_.length-1].overscaledZ,x=!t.options.moving,w=p(_);try{for(w.s();!(s=w.n()).done;){var k=s.value,P=m?e.DepthMode.disabled:t.depthModeForSublayer(k.overscaledZ-b,1===n.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,u.LESS),S=k.toUnwrapped(),T=i.getTile(k);if(!m||T&&T.hasData()){var E=m?k.projMatrix:t.transform.calculateProjMatrix(S,x),C=t.terrain&&m?t.terrain.stencilModeForRTTOverlap(k):g[k.overscaledZ],M=o?0:n.paint.get("raster-fade-duration");T.registerFadeDuration(M);var I=i.findLoadedParent(k,0),O=Ri(T,I,i,t.transform,M),D=void 0,A=void 0;t.terrain&&t.terrain.prepareDrawTile();var L="nearest"===n.paint.get("raster-resampling")?u.NEAREST:u.LINEAR;l.activeTexture.set(u.TEXTURE0),T.texture.bind(L,u.CLAMP_TO_EDGE),l.activeTexture.set(u.TEXTURE1),I?(I.texture.bind(L,u.CLAMP_TO_EDGE),D=Math.pow(2,I.tileID.overscaledZ-T.tileID.overscaledZ),A=[T.tileID.canonical.x*D%1,T.tileID.canonical.y*D%1]):T.texture.bind(L,u.CLAMP_TO_EDGE);var z=cn(E,A||[0,0],D||1,O,n,c instanceof Ge?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(l,d,S),c instanceof Ge)c.boundsBuffer&&c.boundsSegments&&d.draw(l,u.TRIANGLES,P,e.StencilMode.disabled,f,e.CullFaceMode.disabled,z,n.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{var R=t.getTileBoundsBuffers(T),F=R.tileBoundsBuffer,j=R.tileBoundsIndexBuffer,B=R.tileBoundsSegments;d.draw(l,u.TRIANGLES,P,C,f,e.CullFaceMode.disabled,z,n.id,F,j,B)}}}}catch(V){w.e(V)}finally{w.f()}t.resetStencilClippingMasks()}},background:function(t,i,n,r){var a=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0!==o){var s=t.context,l=s.gl,u=t.transform,c=u.tileSize,h=n.paint.get("background-pattern");if(!t.isPatternMissing(h)){var d=!h&&1===a.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===d){var f,m=e.StencilMode.disabled,v=t.depthModeForSublayer(0,"opaque"===d?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),y=t.colorModeForRenderPass(),g=t.useProgram(h?"backgroundPattern":"background"),_=r;_||(f=t.getBackgroundTiles(),_=Object.values(f).map((function(e){return e.tileID}))),h&&(s.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));var b,x=n.getCrossfadeParameters(),w=p(_);try{for(w.s();!(b=w.n()).done;){var k=b.value,P=k.toUnwrapped(),S=r?k.projMatrix:t.transform.calculateProjMatrix(P);t.prepareDrawTile();var T=i?i.getTile(k):f?f[k.key]:new e.Tile(k,c,u.zoom,t),E=h?gn(S,o,t,h,{tileID:k,tileSize:c},x):yn(S,o,a);t.prepareDrawProgram(s,g,P);var C=t.getTileBoundsBuffers(T),M=C.tileBoundsBuffer,I=C.tileBoundsIndexBuffer,O=C.tileBoundsSegments;g.draw(s,l.TRIANGLES,v,m,y,e.CullFaceMode.disabled,E,n.id,M,I,O)}}catch(D){w.e(D)}finally{w.f()}}}}},sky:function(t,i,n){var r=t.transform,a="mercator"===r.projection.name||"globe"===r.projection.name?1:e.smoothstep(7,8,r.zoom),o=n.paint.get("sky-opacity")*a;if(0!==o){var s=t.context,l=n.paint.get("sky-type"),u=new e.DepthMode(s.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),c=t.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===t.renderPass?n.needsSkyboxCapture(t)&&(function(t,i,n,r){var a=t.context,o=a.gl,s=i.skyboxFbo;if(!s){s=i.skyboxFbo=a.createFramebuffer(32,32,!1),i.skyboxGeometry=new Nn(a),i.skyboxTexture=a.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,i.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(var l=0;l<6;++l)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}a.bindFramebuffer.set(s.framebuffer),a.viewport.set([0,0,32,32]);var u=i.getCenter(t,!0),c=t.useProgram("skyboxCapture"),h=new Float64Array(16);e.identity(h),e.rotateY(h,h,.5*-Math.PI),Un(a,i,c,h,u,0),e.identity(h),e.rotateY(h,h,.5*Math.PI),Un(a,i,c,h,u,1),e.identity(h),e.rotateX(h,h,.5*-Math.PI),Un(a,i,c,h,u,2),e.identity(h),e.rotateX(h,h,.5*Math.PI),Un(a,i,c,h,u,3),e.identity(h),Un(a,i,c,h,u,4),e.identity(h),e.rotateY(h,h,Math.PI),Un(a,i,c,h,u,5),a.viewport.set([0,0,t.width,t.height])}(t,n),n.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,i,n,r,a){var o=t.context,s=o.gl,l=t.transform,u=t.useProgram("skybox");o.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,i.skyboxTexture);var c=function(e,t,i,n,r){return{u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:n,u_temporal_offset:r}}(l.skyboxMatrix,i.getCenter(t,!1),0,r,a);t.prepareDrawProgram(o,u),u.draw(o,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,c,"skybox",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,u,o,c):"gradient"===l&&"sky"===t.renderPass&&function(t,i,n,r,a){var o=t.context,s=o.gl,l=t.transform,u=t.useProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new Nn(o)),o.activeTexture.set(s.TEXTURE0);var c=i.colorRampTexture;c||(c=i.colorRampTexture=new e.Texture(o,i.colorRamp,s.RGBA)),c.bind(s.LINEAR,s.CLAMP_TO_EDGE);var h=function(t,i,n,r,a){return{u_matrix:t,u_color_ramp:0,u_center_direction:i,u_radius:e.degToRad(n),u_opacity:r,u_temporal_offset:a}}(l.skyboxMatrix,i.getCenter(t,!1),i.paint.get("sky-gradient-radius"),r,a);t.prepareDrawProgram(o,u),u.draw(o,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,u,o,c)}},debug:function(e,t,i){for(var n=0;n<i.length;n++)jn(e,t,i[n])},custom:function(t,i,n){var r=t.context,a=n.implementation;if(t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes("custom"))e.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===t.renderPass){var o=a.prerender;o&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),o.call(a,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(e.StencilMode.disabled);var s="3d"===a.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);r.setDepthMode(s),a.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},Zn=function(){function t(i,n){v(this,t),this.context=new Ve(i),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new si,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}return y(t,[{key:"updateTerrain",value:function(e,t){var i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(i||this._terrain&&this._terrain.enabled){this._terrain||(this._terrain=new Vi(this,e));var n=this._terrain;this.transform.elevation=i?n:null,n.update(e,this.transform,t)}}},{key:"_updateFog",value:function(e){var t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)this.transform.fogCullDistSq=null;else{var i=t.getFovAdjustedRange(this.transform._fov),n=h(i,2),r=n[0],a=n[1];if(r>a)this.transform.fogCullDistSq=null;else{var o=r+.78*(a-r);this.transform.fogCullDistSq=o*o}}}},{key:"terrain",get:function(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}},{key:"resize",value:function(t,i){if(this.width=t*e.exported.devicePixelRatio,this.height=i*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style){var n,r=p(this.style.order);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.style._layers[a].resize()}}catch(o){r.e(o)}finally{r.f()}}}},{key:"setup",value:function(){var t=this.context,i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var r=new e.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout4i8;a.emplaceBack(0,0,0,0),a.emplaceBack(e.EXTENT,0,e.EXTENT,0),a.emplaceBack(0,e.EXTENT,0,e.EXTENT),a.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(a,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);for(var s=new e.StructArrayLayout1ui2,l=0,u=[0,1,3,2,0];l<u.length;l++){var c=u[l];s.emplaceBack(c)}this.debugIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();var h=this.context.gl;this.stencilClearMode=new e.StencilMode({func:h.ALWAYS,mask:0},0,255,h.ZERO,h.ZERO,h.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new Wn(this.context)}},{key:"getMercatorTileBoundsBuffers",value:function(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}},{key:"getTileBoundsBuffers",value:function(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}},{key:"clearStencil",value:function(){var t=this.context,i=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,i.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,zi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}},{key:"resetStencilClippingMasks",value:function(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}},{key:"_renderTileClippingMasks",value:function(t,i,n){if(i&&this.currentStencilSource!==i.id&&t.isTileClipped()&&n&&0!==n.length){if(this._tileClippingMaskIDs&&!this.terrain){var r,a=!1,o=p(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(void 0===this._tileClippingMaskIDs[s.key]){a=!0;break}}}catch(x){o.e(x)}finally{o.f()}if(!a)return}this.currentStencilSource=i.id;var l=this.context,u=l.gl;this.nextStencilID+n.length>256&&this.clearStencil(),l.setColorMode(e.ColorMode.disabled),l.setDepthMode(e.DepthMode.disabled);var c=this.useProgram("clippingMask");this._tileClippingMaskIDs={};var h,d=p(n);try{for(d.s();!(h=d.n()).done;){var f=h.value,m=i.getTile(f),v=this._tileClippingMaskIDs[f.key]=this.nextStencilID++,y=this.getTileBoundsBuffers(m),g=y.tileBoundsBuffer,_=y.tileBoundsIndexBuffer,b=y.tileBoundsSegments;c.draw(l,u.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:u.ALWAYS,mask:0},v,255,u.KEEP,u.KEEP,u.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,zi(f.projMatrix),"$clipping",g,_,b)}}catch(x){d.e(x)}finally{d.f()}}}},{key:"stencilModeFor3D",value:function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,i=this.context.gl;return new e.StencilMode({func:i.NOTEQUAL,mask:255},t,255,i.KEEP,i.KEEP,i.REPLACE)}},{key:"stencilModeForClipping",value:function(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);var i=this.context.gl;return new e.StencilMode({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,i.KEEP,i.KEEP,i.REPLACE)}},{key:"stencilConfigForOverlap",value:function(t){var i=this.context.gl,r=t.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),a=r[r.length-1].overscaledZ,o=r[0].overscaledZ-a+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var s={},l=0;l<o;l++)s[l+a]=new e.StencilMode({func:i.GEQUAL,mask:255},l+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=o,[s,r]}return[n({},a,e.StencilMode.disabled),r]}},{key:"colorModeForRenderPass",value:function(){var t=this.context.gl;if(this._showOverdrawInspector){var i=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}},{key:"depthModeForSublayer",value:function(t,i,n){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(n||this.context.gl.LEQUAL,i,[r,r])}},{key:"opaquePassEnabledForLayer",value:function(){return this.currentLayer<this.opaquePassCutoff}},{key:"render",value:function(t,i){var n=this;this.style=t,this.options=i,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();var r=this.style.order,a=this.style._sourceCaches;for(var o in a){var s=a[o];s.used&&s.prepare(this.context)}var l={},u={},c={};for(var h in a){var d=a[h];l[h]=d.getVisibleCoordinates(),u[h]=l[h].slice().reverse(),c[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var f=0;f<r.length;f++)if(this.style._layers[r[f]].is3D()){this.opaquePassCutoff=f;break}if(this.terrain&&(this.terrain.updateTileBinding(c),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),e.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";var m,v=p(r);try{for(v.s();!(m=v.n()).done;){var y=m.value,g=this.style._layers[y],_=t._getLayerSourceCache(g);if(g.hasOffscreenPass()&&!g.isHidden(this.transform.zoom)){var b=_?u[_.id]:void 0;("custom"===g.type||g.isSky()||b&&b.length)&&this.renderLayer(this,_,g,b)}}}catch(I){v.e(I)}finally{v.f()}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:i.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var x=this.style._layers[r[this.currentLayer]],w=t._getLayerSourceCache(x);if(!x.isSky()){var k=w?u[w.id]:void 0;this._renderTileClippingMasks(x,w,k),this.renderLayer(this,w,x,k)}}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,i){var n=t.context,r=n.gl,a=t.transform,o=new e.DepthMode(r.LEQUAL,e.DepthMode.ReadOnly,[0,1]),s=t.useProgram("globeAtmosphere",null,"globe"===a.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=e.globeToMercatorTransition(a.zoom),u=i.properties.get("color").toArray01(),c=i.properties.get("high-color").toArray01(),h=i.properties.get("space-color").toArray01PremultipliedAlpha(),p=e.identity$1([]);e.rotateY$1(p,p,-e.degToRad(a._center.lng)),e.rotateX$1(p,p,e.degToRad(a._center.lat)),e.rotateZ$1(p,p,a.angle),e.rotateX$1(p,p,-a._pitch);var d=e.fromQuat(new Float32Array(16),p),f=e.mapValue(i.properties.get("star-intensity"),0,1,0,.25),m=5e-4,v=e.mapValue(i.properties.get("horizon-blend"),0,1,m,.25),y=e.globeUseCustomAntiAliasing(t,n,a)&&v===m?a.worldSize/(2*Math.PI*1.025)-1:a.globeRadius,g=t.frameCounter/1e3%1,_=e.length(a.globeCenterInViewSpace),b=Math.sqrt(Math.pow(_,2)-Math.pow(y,2)),x=Math.acos(b/_),w=function(t,i,n,r,a,o,s,l,u,c,h,p,d,f){return{u_frustum_tl:t,u_frustum_tr:i,u_frustum_br:n,u_frustum_bl:r,u_horizon:a,u_transition:o,u_fadeout_range:s,u_color:l,u_high_color:u,u_space_color:c,u_star_intensity:h,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:p,u_horizon_angle:d,u_rotation_matrix:f}}(a.frustumCorners.TL,a.frustumCorners.TR,a.frustumCorners.BR,a.frustumCorners.BL,a.frustumCorners.horizon,l,v,u,c,h,f,g,x,d);t.prepareDrawProgram(n,s);var k=t.atmosphereBuffer;k&&s.draw(n,r.TRIANGLES,o,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",k.vertexBuffer,k.indexBuffer,k.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var P=this.style._layers[r[this.currentLayer]],S=t._getLayerSourceCache(P);P.isSky()&&this.renderLayer(this,S,P,S?u[S.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;){var T=this.style._layers[r[this.currentLayer]],E=t._getLayerSourceCache(T);if(T.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(T)){if(T.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer)}else{var C=E?("symbol"===T.type?c:u)[E.id]:void 0;this._renderTileClippingMasks(T,E,E?l[E.id]:void 0),this.renderLayer(this,E,T,C),++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){var M=null;e.values(this.style._layers).forEach((function(e){var i=t._getLayerSourceCache(e);i&&!e.isHidden(n.transform.zoom)&&(!M||M.getSource().maxzoom<i.getSource().maxzoom)&&(M=i)})),M&&this.options.showTileBoundaries&&Hn.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(e){var t=e.transform.padding;zn(e,e.transform.height-(t.top||0),3,In),zn(e,t.bottom||0,3,On),Rn(e,t.left||0,3,Dn),Rn(e,e.transform.width-(t.right||0),3,An);var i=e.transform.centerPoint;!function(e,t,i,n){Fn(e,t-1,i-10,2,20,n),Fn(e,t-10,i-1,20,2,n)}(e,i.x,e.transform.height-i.y,Ln)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}}},{key:"renderLayer",value:function(e,t,i,n){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||n&&n.length)&&(this.id=i.id,this.gpuTimingStart(i),e.transform.projection.unsupportedLayers&&e.transform.projection.unsupportedLayers.includes(i.type)||Hn[i.type](e,t,i,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}},{key:"gpuTimingStart",value:function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,i=this.gpuTimers[e.id];i||(i=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),i.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,i.query)}}},{key:"gpuTimingDeferredRenderStart",value:function(){if(this.options.gpuTimingDeferredRender){var e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}},{key:"gpuTimingDeferredRenderEnd",value:function(){if(this.options.gpuTimingDeferredRender){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}}},{key:"gpuTimingEnd",value:function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}}},{key:"collectGpuTimers",value:function(){var e=this.gpuTimers;return this.gpuTimers={},e}},{key:"collectDeferredRenderGpuQueries",value:function(){var e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}},{key:"queryGpuTimers",value:function(e){var t={};for(var i in e){var n=e[i],r=this.context.extTimerQuery,a=r.getQueryObjectEXT(n.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n.query),t[i]=a}return t}},{key:"queryGpuTimeDeferredRender",value:function(e){if(!this.options.gpuTimingDeferredRender)return 0;var t,i=this.context.extTimerQuery,n=0,r=p(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=i.getQueryObjectEXT(a,i.QUERY_RESULT_EXT)/1e6,i.deleteQueryEXT(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"translatePosMatrix",value:function(t,i,n,r,a){if(!n[0]&&!n[1])return t;var o=a?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){var s=Math.sin(o),l=Math.cos(o);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[a?n[0]:Z(i,n[0],this.transform.zoom),a?n[1]:Z(i,n[1],this.transform.zoom),0],c=new Float32Array(16);return e.translate(c,t,u),c}},{key:"saveTileTexture",value:function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}},{key:"getTileTexture",value:function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null}},{key:"isPatternMissing",value:function(e){if(!e)return!1;if(!e.from||!e.to)return!0;var t=this.imageManager.getPattern(e.from.toString()),i=this.imageManager.getPattern(e.to.toString());return!t||!i}},{key:"currentGlobalDefines",value:function(){var e=this.terrain&&this.terrain.renderingToTexture,t=this.style&&this.style.fog,i=[];return this.terrain&&!this.terrain.renderingToTexture&&i.push("TERRAIN"),t&&!e&&0!==t.getOpacity(this.transform.pitch)&&i.push("FOG"),e&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}},{key:"useProgram",value:function(e,t,i){this.cache=this.cache||{};var n=i||[],r=this.currentGlobalDefines().concat(n),a=Ui.cacheKey(e,r,t);return this.cache[a]||(this.cache[a]=new Ui(this.context,e,xi[e],t,_n[e],r)),this.cache[a]}},{key:"setCustomLayerDefaults",value:function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}},{key:"setBaseState",value:function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}},{key:"initDebugOverlayCanvas",value:function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}},{key:"destroy",value:function(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}},{key:"prepareDrawTile",value:function(){this.terrain&&this.terrain.prepareDrawTile()}},{key:"prepareDrawProgram",value:function(t,i,n){if(!this.terrain||!this.terrain.renderingToTexture){var r=this.style.fog;if(r){var a=r.getOpacity(this.transform.pitch),o=function(t,i,n,r,a,o,s,l,u,c,h){var p=t.transform,d=i.properties.get("color").toArray01();d[3]=r;var f=t.frameCounter/1e3%1;return{u_fog_matrix:n?p.calculateFogTileMatrix(n):t.identityMat,u_fog_range:i.getFovAdjustedRange(p._fov),u_fog_color:d,u_fog_horizon_blend:i.properties.get("horizon-blend"),u_fog_temporal_offset:f,u_frustum_tl:a,u_frustum_tr:o,u_frustum_br:s,u_frustum_bl:l,u_globe_pos:u,u_globe_radius:c,u_viewport:h,u_globe_transition:e.globeToMercatorTransition(p.zoom),u_is_globe:+("globe"===p.projection.name)}}(this,r,n,a,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);i.setFogUniformValues(t,o)}}}},{key:"setTileLoadedFlag",value:function(e){this.tileLoaded=e}},{key:"saveCanvasCopy",value:function(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}},{key:"canvasCopy",value:function(){var e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}},{key:"getCanvasCopiesAndTimestamps",value:function(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}},{key:"averageElevationNeedsEasing",value:function(){if(!this.transform._elevation)return!1;var e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}},{key:"getBackgroundTiles",value:function(){var t,i=this._backgroundTiles,n=this._backgroundTiles={},r=this.transform.coveringTiles({tileSize:512}),a=p(r);try{for(a.s();!(t=a.n()).done;){var o=t.value;n[o.key]=i[o.key]||new e.Tile(o,512,this.transform.tileZoom,this)}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"clearBackgroundTiles",value:function(){this._backgroundTiles={}}}]),t}(),qn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(v(this,t),isNaN(e)||e<0||isNaN(i)||i<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=n,this.right=r}return y(t,[{key:"interpolate",value:function(t,i,n){return null!=i.top&&null!=t.top&&(this.top=e.number(t.top,i.top,n)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,i.bottom,n)),null!=i.left&&null!=t.left&&(this.left=e.number(t.left,i.left,n)),null!=i.right&&null!=t.right&&(this.right=e.number(t.right,i.right,n)),this}},{key:"getCenter",value:function(t,i){var n=e.clamp((this.left+t-this.right)/2,0,t),r=e.clamp((this.top+i-this.bottom)/2,0,i);return new e.pointGeometry(n,r)}},{key:"equals",value:function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}},{key:"clone",value:function(){return new t(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),t}();function Xn(t,i){var n=e.getColumn(t,3);e.fromQuat(t,i),e.setColumn(t,3,n)}function Kn(t,i){var n=e.identity$1([]);return e.rotateZ$1(n,n,-i),e.rotateX$1(n,n,-t),n}function Yn(t,i){var n=[t[0],t[1],0],r=[i[0],i[1],0];if(e.length(n)>=1e-15){var a=e.normalize([],n);e.scale$2(r,a,e.dot(r,a)),i[0]=r[0],i[1]=r[1]}var o=e.cross([],i,t);if(e.len(o)<1e-15)return null;var s=Math.atan2(-o[1],o[0]);return Kn(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}var $n=function(){function t(e,i){v(this,t),this.position=e,this.orientation=i}return y(t,[{key:"position",get:function(){return this._position},set:function(t){if(t){var i=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(i.x=e.wrap(i.x,0,1)),this._position=i}else this._position=null}},{key:"lookAtPoint",value:function(t,i){if(this.orientation=null,this.position){var n=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,r=this.position,a=e.MercatorCoordinate.fromLngLat(t,n),o=[a.x-r.x,a.y-r.y,a.z-r.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=Yn(o,i)}}},{key:"setPitchBearing",value:function(t,i){this.orientation=Kn(e.degToRad(t),e.degToRad(-i))}}]),t}(),Jn=function(){function t(i,n){v(this,t),this._transform=e.identity([]),this.orientation=n,this.position=i}return y(t,[{key:"mercatorPosition",get:function(){var t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}},{key:"position",get:function(){var t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]},set:function(t){var i;t&&e.setColumn(this._transform,3,[(i=t)[0],i[1],i[2],1])}},{key:"orientation",get:function(){return this._orientation},set:function(t){this._orientation=t||e.identity$1([]),t&&Xn(this._transform,this._orientation)}},{key:"getPitchBearing",value:function(){var e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}},{key:"setPitchBearing",value:function(e,t){this._orientation=Kn(e,t),Xn(this._transform,this._orientation)}},{key:"forward",value:function(){var t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}},{key:"up",value:function(){var t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}},{key:"right",value:function(){var t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}},{key:"getCameraToWorld",value:function(t,i){var n=new Float64Array(16);return e.invert(n,this.getWorldToCamera(t,i)),n}},{key:"getWorldToCameraPosition",value:function(t,i,n){var r=this.position;e.scale$2(r,r,-t);var a=new Float64Array(16);return e.fromScaling(a,[n,n,n]),e.translate(a,a,r),a[10]*=i,a}},{key:"getWorldToCamera",value:function(t,i){var n=new Float64Array(16),r=new Float64Array(4),a=this.position;return e.conjugate(r,this._orientation),e.scale$2(a,a,-t),e.fromQuat(n,r),e.translate(n,n,a),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i,n}},{key:"getCameraToClipPerspective",value:function(t,i,n,r){var a=new Float64Array(16);return e.perspective(a,t,i,n,r),a}},{key:"getDistanceToElevation",value:function(t){var i=0===t?0:e.mercatorZfromAltitude(t,this.position[1]),n=this.forward();return(i-this.position[2])/n[2]}},{key:"clone",value:function(){return new t(c(this.position),c(this.orientation))}}]),t}();function Qn(t,i){var n=tr(t.projection,t.zoom,t.width,t.height),r=function(t,i,n,r,a){var o=new e.LngLat(n.lng-180*ir,n.lat),s=new e.LngLat(n.lng+180*ir,n.lat),l=t.project(o.lng,o.lat),u=t.project(s.lng,s.lat),c=-Math.atan2(u.y-l.y,u.x-l.x),h=e.MercatorCoordinate.fromLngLat(n);h.y=e.clamp(h.y,-.999975,.999975);var p=h.toLngLat(),d=t.project(p.lng,p.lat),f=e.MercatorCoordinate.fromLngLat(p);f.x+=ir;var m=f.toLngLat(),v=t.project(m.lng,m.lat),y=rr(v.x-d.x,v.y-d.y,c),g=e.MercatorCoordinate.fromLngLat(p);g.y+=ir;var _=g.toLngLat(),b=t.project(_.lng,_.lat),x=rr(b.x-d.x,b.y-d.y,c),w=Math.abs(y.x)/Math.abs(x.y),k=e.identity([]);e.rotateZ(k,k,-c*(1-(a?0:r)));var P=e.identity([]);return e.scale(P,P,[1,1-(1-w)*r,1]),P[4]=-x.x/x.y*r,e.rotateZ(P,P,c),e.multiply(P,k,P),P}(t.projection,0,t.center,n,i),a=er(t);return e.scale(r,r,[a,a,1]),r}function er(t){var i=t.projection,n=tr(t.projection,t.zoom,t.width,t.height),r=nr(i,t.center),a=nr(i,e.LngLat.convert(i.center));return Math.pow(2,r*n+(1-n)*a)}function tr(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=t.range;if(!o)return 0;var s=Math.min(a,Math.max(n,r)),l=Math.log(s/1024)/Math.LN2;return e.smoothstep(o[0]+l,o[1]+l,i)}var ir=1/4e4;function nr(t,i){var n=e.clamp(i.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),r=new e.LngLat(i.lng-180*ir,n),a=new e.LngLat(i.lng+180*ir,n),o=t.project(r.lng,n),s=t.project(a.lng,n),l=e.MercatorCoordinate.fromLngLat(r),u=e.MercatorCoordinate.fromLngLat(a),c=s.x-o.x,h=s.y-o.y,p=u.x-l.x,d=u.y-l.y,f=Math.sqrt((p*p+d*d)/(c*c+h*h));return Math.log(f)/Math.LN2}function rr(e,t,i){var n=Math.cos(i),r=Math.sin(i);return{x:e*n-t*r,y:e*r+t*n}}var ar=function(){function i(t,n,r,a,o,s,l){v(this,i),this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==a?60:a,this.setProjection(s),this.setMaxBounds(l),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new qn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Jn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}return y(i,[{key:"clone",value:function(){var e=new i(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}},{key:"elevation",get:function(){return this._elevation},set:function(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}},{key:"updateElevation",value:function(e){var t=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||t)&&this._updateCameraOnTerrain(),(e||t)&&this._constrainCameraAltitude(),this._calcMatrices()}},{key:"getProjection",value:function(){return e.pick(this.projection,["name","center","parallels"])}},{key:"setProjection",value:function(i){this.projectionOptions=i||{name:"mercator"};var n=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);var r=!t(n,this.getProjection());return r&&this._calcMatrices(),r}},{key:"minZoom",get:function(){return this._minZoom},set:function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}},{key:"minPitch",get:function(){return this._minPitch},set:function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies},set:function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"cameraWorldSize",get:function(){var e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}},{key:"pixelsPerMeter",get:function(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}},{key:"cameraPixelsPerMeter",get:function(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new e.pointGeometry(this.width,this.height)}},{key:"bearing",get:function(){return e.wrap(this.rotation,-180,180)},set:function(e){this.rotation=e}},{key:"rotation",get:function(){return-this.angle/Math.PI*180},set:function(t){var i,n=-t*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(i=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i),function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);e[0]=n*l+a*s,e[1]=r*l+o*s,e[2]=n*-s+a*l,e[3]=r*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var i=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}},{key:"averageElevation",get:function(){return this._averageElevation},set:function(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}},{key:"zoom",get:function(){return this._zoom},set:function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}},{key:"_setZoom",value:function(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}},{key:"_updateCameraOnTerrain",value:function(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);var e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}},{key:"_updateSeaLevelZoom",value:function(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}},{key:"sampleAverageElevation",value:function(){if(!this._elevation)return 0;for(var t=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop(),r=0,a=0,o=0;o<i.length;o++){var s=new e.pointGeometry(i[o][0]*this.width,n+i[o][1]*(this.height-n)),l=t.pointCoordinate(s);if(l){var u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*u,a+=u}}return 0===a?NaN:r/a}},{key:"center",get:function(){return this._center},set:function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}},{key:"_updateZoomFromElevation",value:function(){if(null!=this._seaLevelZoom&&this._elevation){var e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*t,n=this._mercatorZfromZoom(e),r=this._mercatorZfromZoom(this._maxZoom),a=Math.max(n-i,r);this._setZoom(this._zoomFromMercatorZ(a))}}},{key:"padding",get:function(){return this._edgeInsets.toJSON()},set:function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}},{key:"computeZoomRelativeTo",value:function(t){var i,n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));i=t.z<this._camera.position[2]?[n.x,n.y,n.z]:[t.x,t.y,t.z];var r=e.length(e.sub([],this._camera.position,i));return e.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}},{key:"setFreeCameraOptions",value:function(t){if(this.height&&(t.position||t.orientation)){this._updateCameraState();var i=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(t.orientation)),t.position){var n=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}}},{key:"getFreeCameraOptions",value:function(){this._updateCameraState();var t=this._camera.position,i=new $n;return i.position=new e.MercatorCoordinate(t[0],t[1],t[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}},{key:"_setCameraOrientation",value:function(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);var i=e.transformQuat([],[0,0,-1],t),n=e.transformQuat([],[0,-1,0],t);if(n[2]<0)return!1;var r=Yn(i,n);return!!r&&(this._camera.orientation=r,!0)}},{key:"_setCameraPosition",value:function(t){var i=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;t[2]=e.clamp(t[2],r/n,r/i),this._camera.position=t}},{key:"centerPoint",get:function(){return this._edgeInsets.getCenter(this.width,this.height)}},{key:"fovAboveCenter",get:function(){return this._fov*(.5+this.centerOffset.y/this.height)}},{key:"isPaddingEqual",value:function(e){return this._edgeInsets.equals(e)}},{key:"interpolatePadding",value:function(e,t,i){this._unmodified=!1,this._edgeInsets.interpolate(e,t,i),this._constrain(),this._calcMatrices()}},{key:"coveringZoomLevel",value:function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}},{key:"getVisibleUnwrappedCoordinates",value:function(t){var i=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies)for(var n=this.pointCoordinate(new e.pointGeometry(0,0)),r=this.pointCoordinate(new e.pointGeometry(this.width,0)),a=this.pointCoordinate(new e.pointGeometry(this.width,this.height)),o=this.pointCoordinate(new e.pointGeometry(0,this.height)),s=Math.floor(Math.min(n.x,r.x,a.x,o.x)),l=Math.floor(Math.max(n.x,r.x,a.x,o.x)),u=1,c=s-u;c<=l+u;c++)0!==c&&i.push(new e.UnwrappedTileID(c,t));return i}},{key:"coveringTiles",value:function(t){var i=this,n=this.coveringZoomLevel(t),r=n,a=this.elevation&&!t.isTerrainDEM,o="mercator"===this.projection.name;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);var s=this.locationCoordinate(this.center),l=this.center.lat,u=1<<n,c=[u*s.x,u*s.y,0],h="globe"===this.projection.name,p=!h,d=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,p),f=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=u*e.mercatorZfromAltitude(1,this.center.lat),v=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),y=[u*f.x,u*f.y,v*(p?1:m)],g=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),_=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?n:0,b=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,x=t.isTerrainDEM?-b:this._elevation?this._elevation.getMinElevationBelowMSL():0,w=this.projection.isReprojectedInTileSpace?er(this):1,k=function(t){var n=1/4e4,r=new e.MercatorCoordinate(t.x+n,t.y,t.z),a=new e.MercatorCoordinate(t.x,t.y+n,t.z),o=t.toLngLat(),s=r.toLngLat(),l=a.toLngLat(),u=i.locationCoordinate(o),c=i.locationCoordinate(s),h=i.locationCoordinate(l),p=Math.hypot(c.x-u.x,c.y-u.y),d=Math.hypot(h.x-u.x,h.y-u.y);return Math.sqrt(p*d)*w/n},P=function(t){var n=b,r=x;return{aabb:e.tileAABB(i,u,0,0,0,t,r,n,i.projection),zoom:0,x:0,y:0,minZ:r,maxZ:n,wrap:t,fullyVisible:!1}},S=[],T=[],E=n,C=t.reparseOverscaled?r:n,M=function(e){return e*e},I=M((v-this._centerAltitude)*m),O=function(e){if(i._elevation&&e.tileID&&o){var t=i._elevation.getMinMaxForTile(e.tileID),n=e.aabb;t?(n.min[2]=t.min,n.max[2]=t.max,n.center[2]=(n.min[2]+n.max[2])/2):(e.shouldSplit=D(e),e.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=i._centerAltitude))}},D=function(t){if(t.zoom<_)return!0;if(t.zoom===E)return!1;if(null!=t.shouldSplit)return t.shouldSplit;var n=t.aabb.distanceX(y),o=t.aabb.distanceY(y),s=I,u=1;if(h){s=M(t.aabb.distanceZ(y));var c=Math.pow(2,t.zoom),p=e.latFromMercatorY((t.y+1)/c),d=e.latFromMercatorY(t.y/c),f=Math.min(Math.max(l,p),d),v=e.circumferenceAtLatitude(f)/e.circumferenceAtLatitude(l);if(u=f===l?1/Math.max(1,i._mercatorScaleRatio-.3):Math.min(1,v/i._mercatorScaleRatio),i.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===E-1&&v>=.9)return!0}else if(a&&(s=M(t.aabb.distanceZ(y)*m)),i.projection.isReprojectedInTileSpace&&r<=5){var b=Math.pow(2,t.zoom),x=k(new e.MercatorCoordinate((t.x+.5)/b,(t.y+.5)/b));u=x>.85?1:x}var w=n*n+o*o+s;return w<M((1<<E-t.zoom)*g*u*function(e,t){if(t*M(.707)<e)return 1;var i=Math.sqrt(t/e);return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)}(Math.max(s,I),w))};if(this.renderWorldCopies)for(var A=1;A<=3;A++)S.push(P(-A)),S.push(P(A));for(S.push(P(0));S.length>0;){var L=S.pop(),z=L.x,R=L.y,F=L.fullyVisible;if(!F){var j=L.aabb.intersects(d);if(0===j)continue;F=2===j}if(L.zoom!==E&&D(L))for(var B=0;B<4;B++){var V=(z<<1)+B%2,N=(R<<1)+(B>>1),U={aabb:o?L.aabb.quadrant(B):e.tileAABB(this,u,L.zoom+1,V,N,L.wrap,L.minZ,L.maxZ,this.projection),zoom:L.zoom+1,x:V,y:N,wrap:L.wrap,fullyVisible:F,tileID:void 0,shouldSplit:void 0,minZ:L.minZ,maxZ:L.maxZ};a&&!h&&(U.tileID=new e.OverscaledTileID(L.zoom+1===E?C:L.zoom+1,L.wrap,L.zoom+1,V,N),O(U)),S.push(U)}else{var G=L.zoom===E?C:L.zoom;if(t.minzoom&&t.minzoom>G)continue;var W=c[0]-(.5+z+(L.wrap<<L.zoom))*(1<<n-L.zoom),H=c[1]-.5-R,Z=L.tileID?L.tileID:new e.OverscaledTileID(G,L.wrap,L.zoom,z,R);T.push({tileID:Z,distanceSq:W*W+H*H})}}if(this.fogCullDistSq){var q=this.fogCullDistSq,X=this.horizonLineFromTop();T=T.filter((function(n){var r=[0,0,0,1],a=[e.EXTENT,e.EXTENT,0,1],o=i.calculateFogTileMatrix(n.tileID.toUnwrapped());e.transformMat4$1(r,r,o),e.transformMat4$1(a,a,o);var s=e.getAABBPointSquareDist(r,a);if(0===s)return!0;var l=!1,u=i._elevation;if(u&&s>q&&0!==X){var c,h=i.calculateProjMatrix(n.tileID.toUnwrapped());t.isTerrainDEM||(c=u.getMinMaxForTile(n.tileID)),c||(c={min:x,max:b});var p=e.furthestTileCorner(i.rotation),d=[p[0]*e.EXTENT,p[1]*e.EXTENT,c.max];e.transformMat4(d,d,h),l=(1-d[1])*i.height*.5<X}return s<q||l}))}return T.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}},{key:"unmodified",get:function(){return this._unmodified}},{key:"zoomScale",value:function(e){return Math.pow(2,e)}},{key:"scaleZoom",value:function(e){return Math.log(e)/Math.LN2}},{key:"project",value:function(t){var i=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),n=this.projection.project(t.lng,i);return new e.pointGeometry(n.x*this.worldSize,n.y*this.worldSize)}},{key:"unproject",value:function(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}},{key:"point",get:function(){return this.project(this.center)}},{key:"setLocationAtPoint",value:function(t,i){var n,r,a=this.centerPoint;if("globe"===this.projection.name){var o=this.worldSize;n=(i.x-a.x)/o,r=(i.y-a.y)/o}else{var s=this.pointCoordinate(i),l=this.pointCoordinate(a);n=s.x-l.x,r=s.y-l.y}var u=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(u.x-n,u.y-r))}},{key:"setLocation",value:function(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}},{key:"locationPoint",value:function(e){return this.projection.locationPoint(this,e)}},{key:"locationPoint3D",value:function(e){return this.projection.locationPoint(this,e,!0)}},{key:"pointLocation",value:function(e){return this.coordinateLocation(this.pointCoordinate(e))}},{key:"pointLocation3D",value:function(e){return this.coordinateLocation(this.pointCoordinate3D(e))}},{key:"locationCoordinate",value:function(t,i){var n=i?e.mercatorZfromAltitude(i,t.lat):void 0,r=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(r.x,r.y,n)}},{key:"coordinateLocation",value:function(e){return this.projection.unproject(e.x,e.y)}},{key:"pointRayIntersection",value:function(t,i){var n=null!=i?i:this._centerAltitude,r=[t.x,t.y,0,1],a=[t.x,t.y,1,1];e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(a,a,this.pixelMatrixInverse);var o=a[3];e.scale$1(r,r,1/r[3]),e.scale$1(a,a,1/o);var s=r[2],l=a[2];return{p0:r,p1:a,t:s===l?0:(n-s)/(l-s)}}},{key:"screenPointToMercatorRay",value:function(t){var i=[t.x,t.y,0,1],n=[t.x,t.y,1,1];return e.transformMat4$1(i,i,this.pixelMatrixInverse),e.transformMat4$1(n,n,this.pixelMatrixInverse),e.scale$1(i,i,1/i[3]),e.scale$1(n,n,1/n[3]),i[2]=e.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,e.scale$1(i,i,1/this.worldSize),e.scale$1(n,n,1/this.worldSize),new e.Ray([i[0],i[1],i[2]],e.normalize([],e.sub([],n,i)))}},{key:"rayIntersectionCoordinate",value:function(t){var i=t.p0,n=t.p1,r=t.t,a=e.mercatorZfromAltitude(i[2],this._center.lat),o=e.mercatorZfromAltitude(n[2],this._center.lat);return new e.MercatorCoordinate(e.number(i[0],n[0],r)/this.worldSize,e.number(i[1],n[1],r)/this.worldSize,e.number(a,o,r))}},{key:"pointCoordinate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,e.x,e.y,t)}},{key:"pointCoordinate3D",value:function(t){if(!this.elevation)return this.pointCoordinate(t);var i=this.projection.pointCoordinate3D(this,t.x,t.y);if(i)return new e.MercatorCoordinate(i[0],i[1],i[2]);var n=0,r=this.horizonLineFromTop();if(t.y>r)return this.pointCoordinate(t);for(var a=.02*r,o=t.clone(),s=0;s<10&&r-n>a;s++){o.y=e.number(n,r,.66);var l=this.projection.pointCoordinate3D(this,o.x,o.y);l?(r=o.y,i=l):n=o.y}return i?new e.MercatorCoordinate(i[0],i[1],i[2]):this.pointCoordinate(t)}},{key:"isPointAboveHorizon",value:function(e){return this.projection.isPointAboveHorizon(this,e)}},{key:"_coordinatePoint",value:function(t,i){var n=i&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,r=[t.x*this.worldSize,t.y*this.worldSize,n+t.toAltitude(),1];return e.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new e.pointGeometry(r[0]/r[3],r[1]/r[3]):new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}},{key:"_getBounds",value:function(t,i){var n=new e.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),r=new e.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),a=new e.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),o=new e.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom),s=this.pointCoordinate(n,t),l=this.pointCoordinate(r,t),u=this.pointCoordinate(a,i),c=this.pointCoordinate(o,i),h=function(e,t){return(t.y-e.y)/(t.x-e.x)};return s.y>1&&l.y>=0?s=new e.MercatorCoordinate((1-c.y)/h(c,s)+c.x,1):s.y<0&&l.y<=1&&(s=new e.MercatorCoordinate(-c.y/h(c,s)+c.x,0)),l.y>1&&s.y>=0?l=new e.MercatorCoordinate((1-u.y)/h(u,l)+u.x,1):l.y<0&&s.y<=1&&(l=new e.MercatorCoordinate(-u.y/h(u,l)+u.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(s)).extend(this.coordinateLocation(l)).extend(this.coordinateLocation(c)).extend(this.coordinateLocation(u))}},{key:"_getBounds3D",value:function(){var e=this.elevation;if(!e.visibleDemTiles.length)return this._getBounds(0,0);var t=e.visibleDemTiles.reduce((function(e,t){if(t.dem){var i=t.dem.tree;e.min=Math.min(e.min,i.minimums[0]),e.max=Math.max(e.max,i.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBounds(t.min*e.exaggeration(),t.max*e.exaggeration())}},{key:"getBounds",value:function(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}},{key:"horizonLineFromTop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,i):i}},{key:"getMaxBounds",value:function(){return this.maxBounds}},{key:"setMaxBounds",value:function(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}},{key:"calculatePosMatrix",value:function(e,t){return this.projection.createTileMatrix(this,t,e)}},{key:"calculateDistanceTileData",value:function(t){var i=t.key,n=this._distanceTileDataCache;if(n[i])return n[i];var r=t.canonical,a=1/this.height,o=this.cameraWorldSize/this.zoomScale(r.z),s=(r.x+Math.pow(2,r.z)*t.wrap)*o,l=r.y*o,u=this.point,c=this.angle,h=Math.sin(-c),p=-Math.cos(-c);return n[i]={bearing:[h,p],center:[(u.x-s)*a,(u.y-l)*a],scale:o/e.EXTENT*a},n[i]}},{key:"calculateFogTileMatrix",value:function(t){var i=t.key,n=this._fogTileMatrixCache;if(n[i])return n[i];var r=this.projection.createTileMatrix(this,this.cameraWorldSize,t);return e.multiply(r,this.worldToFogMatrix,r),n[i]=new Float32Array(r),n[i]}},{key:"calculateProjMatrix",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.key,r=i?this._alignedProjMatrixCache:this._projMatrixCache;if(r[n])return r[n];var a=this.calculatePosMatrix(t,this.worldSize);return e.multiply(a,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.alignedProjMatrix:this.projMatrix,a),r[n]=new Float32Array(a),r[n]}},{key:"calculatePixelsToTileUnitsMatrix",value:function(t){var i=t.tileID.key,n=this._pixelsToTileUnitsCache;if(n[i])return n[i];var r=function(t,i){var n,r,a,o,s,l,u,c,h=t.tileTransform.scale*e.EXTENT/(t.tileSize*Math.pow(2,i.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return n=new Float32Array(4),o=(r=i.inverseAdjustmentMatrix)[1],s=r[2],l=r[3],c=(a=[h,h])[1],n[0]=r[0]*(u=a[0]),n[1]=o*u,n[2]=s*c,n[3]=l*c,n}(t,this);return n[i]=r,n[i]}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"recenterOnTerrain",value:function(){if(this._elevation&&"globe"!==this.projection.name){var t=this._elevation;this._updateCameraState();var i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(i),r=this._camera.forward(),a=e.mercatorZfromAltitude(1,this._center.lat);n[2]/=a,r[2]/=a,e.normalize(r,r);var o=t.raycast(n,r,t.exaggeration());if(o){var s=e.scaleAndAdd([],n,r,o),l=new e.MercatorCoordinate(s[0],s[1],e.mercatorZfromAltitude(s[2],e.latFromMercatorY(s[1]))),u=(l.z+e.length([l.x-n[0],l.y-n[1],l.z-n[2]*a]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(u),this._centerAltitude=l.toAltitude(),this._center=this.coordinateLocation(l),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}}},{key:"_constrainCameraAltitude",value:function(){if(this._elevation){var t=this._elevation;this._updateCameraState();var i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(i),r=t.getAtPointOrZero(a(e.MercatorCoordinate,c(n))),o=this._minimumHeightOverTerrain()*Math.cos(e.degToRad(this._maxPitch)),s=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*r;if(s<o){var l=this.locationCoordinate(this._center,this._centerAltitude),u=[l.x-n[0],l.y-n[1],l.z-n[2]],h=e.length(u);u[2]-=(o-s)/this._projectionScaler;var p=e.length(u);if(0===p)return;e.scale$2(u,u,h/p*this._projectionScaler),this._camera.position=[l.x-u[0],l.y-u[1],l.z*this._projectionScaler-u[2]],this._camera.orientation=Yn(u,this._camera.up()),this._updateStateFromCamera()}}}},{key:"_constrain",value:function(){if(this.center&&this.width&&this.height&&!this._constraining){if(this._constraining=!0,this.projection.isReprojectedInTileSpace){var t=this.center;return t.lat=e.clamp(t.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(t.lng=e.clamp(t.lng,this.minLng,this.maxLng)),this.center=t,void(this._constraining=!1)}var i=this._unmodified,n=this.point,r=n.x,a=n.y,o=0,s=r,l=a,u=this.width/2,c=this.height/2,h=this.worldMinY*this.scale,p=this.worldMaxY*this.scale;if(a-c<h&&(l=h+c),a+c>p&&(l=p-c),p-h<this.height&&(o=Math.max(o,this.height/(p-h)),l=(p+h)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){var d=this.worldMinX*this.scale,f=this.worldMaxX*this.scale,m=this.worldSize/2-(d+f)/2;(s=(r+m+this.worldSize)%this.worldSize-m)-u<d&&(s=d+u),s+u>f&&(s=f-u),f-d<this.width&&(o=Math.max(o,this.width/(f-d)),s=(f+d)/2)}s===r&&l===a||(this.center=this.unproject(new e.pointGeometry(s,l))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCameraAltitude(),this._unmodified=i,this._constraining=!1}}},{key:"_minZoomForBounds",value:function(){var e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}},{key:"_maxCameraBoundsDistance",value:function(){return this._mercatorZfromZoom(this._minZoomForBounds())}},{key:"_calcMatrices",value:function(){if(this.height){var t=this.centerOffset,i=this.pixelsPerMeter;if("globe"===this.projection.name){var n=e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,r=e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE)*this.worldSize;this._mercatorScaleRatio=n/r}var a=tr(this.projection,this.zoom,this.width,this.height,1024);this._projectionScaler=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,a),this.cameraToCenterDistance=this.getCameraToCenterDistance(this.projection),this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;var o=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?i:1),s=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);s[8]=2*-t.x/this.width,s[9]=2*t.y/this.height;var l=e.mul([],s,o);if(this.projection.isReprojectedInTileSpace){var u=this.locationCoordinate(this.center),c=e.identity([]);e.translate(c,c,[u.x*this.worldSize,u.y*this.worldSize,0]),e.multiply(c,c,Qn(this)),e.translate(c,c,[-u.x*this.worldSize,-u.y*this.worldSize,0]),e.multiply(l,l,c),this.inverseAdjustmentMatrix=function(e){var t=Qn(e,!0);return O([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],l,[this.worldSize,this.worldSize,this.worldSize/i,1]),this.projMatrix=l,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);var h=e.invert([],s);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(h,this.horizonLineFromTop(),this.height);var p=new Float32Array(16);e.identity(p),e.scale(p,p,[1,-1,1]),e.rotateX(p,p,this._pitch),e.rotateZ(p,p,this.angle);var d=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;d[8]=2*-t.x/this.width,d[9]=2*(t.y+f)/this.height,this.skyboxMatrix=e.multiply(p,d,p);var m=this.point,v=m.x,y=m.y,g=this.width%2/2,_=this.height%2/2,b=Math.cos(this.angle),x=Math.sin(this.angle),w=v-Math.round(v)+b*g+x*_,k=y-Math.round(y)+b*_+x*g,P=new Float64Array(l);if(e.translate(P,P,[w>.5?w-1:w,k>.5?k-1:k,0]),this.alignedProjMatrix=P,l=e.create(),e.scale(l,l,[this.width/2,-this.height/2,1]),e.translate(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=e.create(),e.scale(l,l,[1,-1,1]),e.translate(l,l,[-1,-1,0]),e.scale(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},!(l=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=l,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);var S=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(S,S,o),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=l;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}}},{key:"_calcFogMatrices",value:function(){this._fogTileMatrixCache={};var t=this.cameraWorldSize,i=this.cameraPixelsPerMeter,n=this._camera.position,r=1/this.height/this._projectionScaler,a=[t,t,i];e.scale$2(a,a,r),e.scale$2(n,n,-1),e.multiply$2(n,n,a);var o=e.create();e.translate(o,o,n),e.scale(o,o,a),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,i,r)}},{key:"_computeCameraPosition",value:function(e){var t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),n=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[n.x/this.worldSize-i[0]*r,n.y/this.worldSize-i[1]*r,e/this.worldSize*this._centerAltitude-i[2]*r]}},{key:"_updateCameraState",value:function(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}},{key:"_translateCameraConstrained",value:function(t){var i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=t[2],r=1;n>0&&(r=Math.min((i-this._camera.position[2])/n,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,r),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}},{key:"_updateStateFromCamera",value:function(){var t=this._camera.position,i=this._camera.forward(),n=this._camera.getPitchBearing(),r=n.pitch,a=n.bearing,o=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),l=Math.max((t[2]-o)/Math.cos(r),s),u=this._zoomFromMercatorZ(l);e.scaleAndAdd(t,t,i,l),this._pitch=e.clamp(r,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(a,-Math.PI,Math.PI),this._setZoom(e.clamp(u,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}},{key:"_worldSizeFromZoom",value:function(e){return Math.pow(2,e)*this.tileSize}},{key:"_mercatorZfromZoom",value:function(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}},{key:"_minimumHeightOverTerrain",value:function(){var e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(e)}},{key:"_zoomFromMercatorZ",value:function(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}},{key:"_terrainEnabled",value:function(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}},{key:"anyCornerOffEdge",value:function(t,i){var n=Math.min(t.x,i.x),r=Math.max(t.x,i.x),a=Math.min(t.y,i.y),o=Math.max(t.y,i.y);if(a<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;for(var s=[new e.pointGeometry(n,a),new e.pointGeometry(r,o),new e.pointGeometry(n,o),new e.pointGeometry(r,a)],l=this.renderWorldCopies?-3:0,u=this.renderWorldCopies?4:1,c=0,h=s;c<h.length;c++){var p=h[c],d=this.pointRayIntersection(p);if(d.t<0)return!0;var f=this.rayIntersectionCoordinate(d);if(f.x<l||f.y<0||f.x>u||f.y>1)return!0}return!1}},{key:"isHorizonVisible",value:function(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.pointGeometry(0,0),new e.pointGeometry(this.width,this.height))}},{key:"zoomDeltaToMovement",value:function(t,i){var n=e.length(e.sub([],this._camera.position,t)),r=this._zoomFromMercatorZ(n)+i;return n-this._mercatorZfromZoom(r)}},{key:"getCameraPoint",value:function(){if("globe"===this.projection.name){var t=function(t,i){var n=[t[0],t[1],t[2],1];e.transformMat4$1(n,n,i);var r=Math.max(n[3],1e-6);return[n[0]/r,n[1]/r,n[2]/r,r]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.pointGeometry(t[0],t[1])}var i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.pointGeometry(0,i))}},{key:"getCameraToCenterDistance",value:function(e){var t=tr(e,this.zoom,this.width,this.height,1024),i=e.pixelSpaceConversion(this.center.lat,this.worldSize,t);return.5/Math.tan(.5*this._fov)*this.height*i}}]),i}();function or(e,t){var i=!1,n=null,r=function r(){n=null,i&&(e(),n=setTimeout(r,t),i=!1)};return function(){return i=!0,n||r(),n}}var sr=function(){function t(i){v(this,t),this._hashName=i&&encodeURIComponent(i),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=or(this._updateHashUnthrottled.bind(this),300)}return y(t,[{key:"addTo",value:function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}},{key:"remove",value:function(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}},{key:"getHashString",value:function(t){var i=this._map;if(!i)return"";var n=i.getCenter(),r=Math.round(100*i.getZoom())/100,a=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,a),s=Math.round(n.lng*o)/o,l=Math.round(n.lat*o)/o,u=i.getBearing(),c=i.getPitch(),h="";if(h+=t?"/".concat(s,"/").concat(l,"/").concat(r):"".concat(r,"/").concat(l,"/").concat(s),(u||c)&&(h+="/"+Math.round(10*u)/10),c&&(h+="/".concat(Math.round(c))),this._hashName){var p=this._hashName,d=!1,f=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===p?(d=!0,"".concat(t,"=").concat(h)):e})).filter((function(e){return e}));return d||f.push("".concat(p,"=").concat(h)),"#".concat(f.join("&"))}return"#".concat(h)}},{key:"_getCurrentHash",value:function(){var t,i=this,n=e.window.location.hash.replace("#","");return this._hashName?(n.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===i._hashName&&(t=e)})),(t&&t[1]||"").split("/")):n.split("/")}},{key:"_onHashChange",value:function(){var e=this._map;if(!e)return!1;var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(e){return isNaN(e)}))){var i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:i,pitch:+(t[4]||0)}),!0}return!1}},{key:"_updateHashUnthrottled",value:function(){var t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}]),t}(),lr={linearity:.3,easing:e.bezier(0,0,.3,1)},ur=e.extend({deceleration:2500,maxSpeed:1400},lr),cr=e.extend({deceleration:20,maxSpeed:1400},lr),hr=e.extend({deceleration:1e3,maxSpeed:360},lr),pr=e.extend({deceleration:1e3,maxSpeed:90},lr),dr=function(){function t(e){v(this,t),this._map=e,this.clear()}return y(t,[{key:"clear",value:function(){this._inertiaBuffer=[]}},{key:"record",value:function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}},{key:"_drainInertiaBuffer",value:function(){for(var t=this._inertiaBuffer,i=e.exported.now();t.length>0&&i-t[0].time>160;)t.shift()}},{key:"_onMoveEnd",value:function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){var i,n={zoom:0,bearing:0,pitch:0,pan:new e.pointGeometry(0,0),pinchAround:void 0,around:void 0},r=p(this._inertiaBuffer);try{for(r.s();!(i=r.n()).done;){var a=i.value.settings;n.zoom+=a.zoomDelta||0,n.bearing+=a.bearingDelta||0,n.pitch+=a.pitchDelta||0,a.panDelta&&n.pan._add(a.panDelta),a.around&&(n.around=a.around),a.pinchAround&&(n.pinchAround=a.pinchAround)}}catch(f){r.e(f)}finally{r.f()}var o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(n.pan.mag()){var l=mr(n.pan.mag(),o,e.extend({},ur,t||{}));s.offset=n.pan.mult(l.amount/n.pan.mag()),s.center=this._map.transform.center,fr(s,l)}if(n.zoom){var u=mr(n.zoom,o,cr);s.zoom=this._map.transform.zoom+u.amount,fr(s,u)}if(n.bearing){var c=mr(n.bearing,o,hr);s.bearing=this._map.transform.bearing+e.clamp(c.amount,-179,179),fr(s,c)}if(n.pitch){var h=mr(n.pitch,o,pr);s.pitch=this._map.transform.pitch+h.amount,fr(s,h)}if(s.zoom||s.bearing){var d=void 0===n.pinchAround?n.around:n.pinchAround;s.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),s.noMoveStart=!0,s}}}]),t}();function fr(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function mr(t,i,n){var r=n.maxSpeed,a=n.linearity,o=n.deceleration,s=e.clamp(t*a/(i/1e3),-r,r),l=Math.abs(s)/(o*a);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}var vr=function(t){f(n,t);var i=m(n);function n(t,r,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};v(this,n);var l=E(r.getCanvasContainer(),a),u=r.unproject(l);return(o=i.call(this,t,e.extend({point:l,lngLat:u,originalEvent:a},s)))._defaultPrevented=!1,o.target=r,o}return y(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),yr=function(t){f(n,t);var i=m(n);function n(t,r,a){var o;v(this,n);var s="touchend"===t?a.changedTouches:a.touches,l=C(r.getCanvasContainer(),s),u=l.map((function(e){return r.unproject(e)})),c=l.reduce((function(e,t,i,n){return e.add(t.div(n.length))}),new e.pointGeometry(0,0));return(o=i.call(this,t,{points:l,point:c,lngLats:u,lngLat:r.unproject(c),originalEvent:a}))._defaultPrevented=!1,o}return y(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),gr=function(e){f(i,e);var t=m(i);function i(e,n,r){var a;return v(this,i),(a=t.call(this,e,{originalEvent:r}))._defaultPrevented=!1,a}return y(i,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),i}(e.Event),_r=function(){function t(e,i){v(this,t),this._map=e,this._clickTolerance=i.clickTolerance}return y(t,[{key:"reset",value:function(){this._mousedownPos=void 0}},{key:"wheel",value:function(e){return this._firePreventable(new gr(e.type,this._map,e))}},{key:"mousedown",value:function(e,t){return this._mousedownPos=t,this._firePreventable(new vr(e.type,this._map,e))}},{key:"mouseup",value:function(e){this._map.fire(new vr(e.type,this._map,e))}},{key:"preclick",value:function(t){var i=e.extend({},t);i.type="preclick",this._map.fire(new vr(i.type,this._map,i))}},{key:"click",value:function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new vr(e.type,this._map,e)))}},{key:"dblclick",value:function(e){return this._firePreventable(new vr(e.type,this._map,e))}},{key:"mouseover",value:function(e){this._map.fire(new vr(e.type,this._map,e))}},{key:"mouseout",value:function(e){this._map.fire(new vr(e.type,this._map,e))}},{key:"touchstart",value:function(e){return this._firePreventable(new yr(e.type,this._map,e))}},{key:"touchmove",value:function(e){this._map.fire(new yr(e.type,this._map,e))}},{key:"touchend",value:function(e){this._map.fire(new yr(e.type,this._map,e))}},{key:"touchcancel",value:function(e){this._map.fire(new yr(e.type,this._map,e))}},{key:"_firePreventable",value:function(e){if(this._map.fire(e),e.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),t}(),br=function(){function e(t){v(this,e),this._map=t}return y(e,[{key:"reset",value:function(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}},{key:"mousemove",value:function(e){this._map.fire(new vr(e.type,this._map,e))}},{key:"mousedown",value:function(){this._delayContextMenu=!0}},{key:"mouseup",value:function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}},{key:"contextmenu",value:function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new vr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),e}(),xr=function(){function t(e,i){v(this,t),this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}return y(t,[{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active}},{key:"enable",value:function(){this.isEnabled()||(this._enabled=!0)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"mousedown",value:function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(k(),this._startPos=this._lastPos=t,this._active=!0)}},{key:"mousemoveWindow",value:function(e,t){var i=this;if(this._active){var n=t;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=n,this._box||(this._box=g("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var a=Math.min(r.x,n.x),o=Math.max(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.y,n.y);this._map._requestDomTask((function(){i._box&&(i._box.style.transform="translate(".concat(a,"px,").concat(s,"px)"),i._box.style.width=o-a+"px",i._box.style.height=l-s+"px")}))}}}},{key:"mouseupWindow",value:function(t,i){var n=this;if(this._active&&0===t.button){var r=this._startPos,a=i;if(this.reset(),T(),r.x!==a.x||r.y!==a.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(r,a,n._map.getBearing(),{linear:!1})}};this._fireEvent("boxzoomcancel",t)}}},{key:"keydown",value:function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}},{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),P(),delete this._startPos,delete this._lastPos}},{key:"_fireEvent",value:function(t,i){return this._map.fire(new e.Event(t,{originalEvent:i}))}}]),t}();function wr(e,t){for(var i={},n=0;n<e.length;n++)i[e[n].identifier]=t[n];return i}var kr=function(){function t(e){v(this,t),this.reset(),this.numTouches=e.numTouches}return y(t,[{key:"reset",value:function(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}},{key:"touchstart",value:function(t,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){var i,n=new e.pointGeometry(0,0),r=p(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;n._add(a)}}catch(o){r.e(o)}finally{r.f()}return n.div(t.length)}(i),this.touches=wr(n,i)))}},{key:"touchmove",value:function(e,t,i){if(!this.aborted&&this.centroid){var n=wr(i,t);for(var r in this.touches){var a=this.touches[r],o=n[r];(!o||o.dist(a)>30)&&(this.aborted=!0)}}}},{key:"touchend",value:function(e,t,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){var n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}}]),t}(),Pr=function(){function e(t){v(this,e),this.singleTap=new kr(t),this.numTaps=t.numTaps,this.reset()}return y(e,[{key:"reset",value:function(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(e,t,i){this.singleTap.touchstart(e,t,i)}},{key:"touchmove",value:function(e,t,i){this.singleTap.touchmove(e,t,i)}},{key:"touchend",value:function(e,t,i){var n=this.singleTap.touchend(e,t,i);if(n){var r=e.timeStamp-this.lastTime<500,a=!this.lastTap||this.lastTap.dist(n)<30;if(r&&a||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}]),e}(),Sr=function(){function e(){v(this,e),this._zoomIn=new Pr({numTouches:1,numTaps:2}),this._zoomOut=new Pr({numTouches:2,numTaps:1}),this.reset()}return y(e,[{key:"reset",value:function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}},{key:"touchstart",value:function(e,t,i){this._zoomIn.touchstart(e,t,i),this._zoomOut.touchstart(e,t,i)}},{key:"touchmove",value:function(e,t,i){this._zoomIn.touchmove(e,t,i),this._zoomOut.touchmove(e,t,i)}},{key:"touchend",value:function(e,t,i){var n=this,r=this._zoomIn.touchend(e,t,i),a=this._zoomOut.touchend(e,t,i);return r?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(r)},{originalEvent:e})}}):a?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(a)},{originalEvent:e})}}):void 0}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Tr={0:1,2:2},Er=function(){function e(t){v(this,e),this.reset(),this._clickTolerance=t.clickTolerance||1}return y(e,[{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}},{key:"_correctButton",value:function(e,t){return!1}},{key:"_move",value:function(e,t){return{}}},{key:"mousedown",value:function(e,t){if(!this._lastPoint){var i=M(e);this._correctButton(e,i)&&(this._lastPoint=t,this._eventButton=i)}}},{key:"mousemoveWindow",value:function(e,t){var i=this._lastPoint;if(i)if(e.preventDefault(),null!=this._eventButton&&function(e,t){var i=Tr[t];return void 0===e.buttons||(e.buttons&i)!==i}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(i,t)}},{key:"mouseupWindow",value:function(e){this._lastPoint&&M(e)===this._eventButton&&(this._moved&&T(),this.reset())}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Cr=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"mousedown",value:function(e,t){o(s(i.prototype),"mousedown",this).call(this,e,t),this._lastPoint&&(this._active=!0)}},{key:"_correctButton",value:function(e,t){return 0===t&&!e.ctrlKey}},{key:"_move",value:function(e,t){return{around:t,panDelta:t.sub(e)}}}]),i}(Er),Mr=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var i=.8*(t.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),i}(Er),Ir=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var i=-.5*(t.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),i}(Er),Or=function(){function t(i,n){v(this,t),this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}return y(t,[{key:"reset",value:function(){this._active=!1,this._touches={},this._sum=new e.pointGeometry(0,0)}},{key:"touchstart",value:function(e,t,i){return this._calculateTransform(e,t,i)}},{key:"touchmove",value:function(e,t,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length)return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.preventDefault(),this._calculateTransform(e,t,i)}}},{key:"touchend",value:function(e,t,i){this._calculateTransform(e,t,i),this._active&&i.length<this._minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"_calculateTransform",value:function(t,i,n){n.length>0&&(this._active=!0);var r=wr(n,i),a=new e.pointGeometry(0,0),o=new e.pointGeometry(0,0),s=0;for(var l in r){var u=r[l],c=this._touches[l];c&&(a._add(u),o._add(u.sub(c)),s++,r[l]=u)}if(this._touches=r,!(s<this._minTouches)&&o.mag()){var h=o.div(s);return this._sum._add(h),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:h}}}},{key:"enable",value:function(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}},{key:"disable",value:function(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}},{key:"_addTouchPanBlocker",value:function(){this._map&&!this._alertContainer&&(this._alertContainer=g("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}},{key:"_showTouchPanBlockerAlert",value:function(){var e=this;"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((function(){e._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")}),500)}}]),t}(),Dr=function(){function e(){v(this,e),this.reset()}return y(e,[{key:"reset",value:function(){this._active=!1,this._firstTwoTouches=void 0}},{key:"_start",value:function(e){}},{key:"_move",value:function(e,t,i){return{}}},{key:"touchstart",value:function(e,t,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([t[0],t[1]]))}},{key:"touchmove",value:function(e,t,i){var n=this._firstTwoTouches;if(n){e.preventDefault();var r=h(n,2),a=r[0],o=r[1],s=Ar(i,t,a),l=Ar(i,t,o);if(s&&l){var u=this._aroundCenter?null:s.add(l).div(2);return this._move([s,l],u,e)}}}},{key:"touchend",value:function(e,t,i){if(this._firstTwoTouches){var n=h(this._firstTwoTouches,2),r=n[0],a=n[1],o=Ar(i,t,r),s=Ar(i,t,a);o&&s||(this._active&&T(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}();function Ar(e,t,i){for(var n=0;n<e.length;n++)if(e[n].identifier===i)return t[n]}function Lr(e,t){return Math.log(e/t)/Math.LN2}var zr=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"reset",value:function(){o(s(i.prototype),"reset",this).call(this),this._distance=0,this._startDistance=0}},{key:"_start",value:function(e){this._startDistance=this._distance=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Lr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lr(this._distance,i),pinchAround:t}}}]),i}(Dr);function Rr(e,t){return 180*e.angleWith(t)/Math.PI}var Fr=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i,[{key:"reset",value:function(){o(s(i.prototype),"reset",this).call(this),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}},{key:"_start",value:function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var i=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Rr(this._vector,i),pinchAround:t}}},{key:"_isBelowThreshold",value:function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,i=Rr(e,this._startVector);return Math.abs(i)<t}}]),i}(Dr);function jr(e){return Math.abs(e.y)>Math.abs(e.x)}var Br=function(e){f(i,e);var t=m(i);function i(e){var n;return v(this,i),(n=t.call(this))._map=e,n}return y(i,[{key:"reset",value:function(){o(s(i.prototype),"reset",this).call(this),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}},{key:"_start",value:function(e){this._lastPoints=e,jr(e[0].sub(e[1]))&&(this._valid=!1)}},{key:"_move",value:function(e,t,i){var n=this._lastPoints;if(n){var r=e[0].sub(n[0]),a=e[1].sub(n[1]);return this._map._cooperativeGestures&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(r,a,i.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(r.y+a.y)/2*-.5})}}},{key:"gestureBeginsVertically",value:function(e,t,i){if(void 0!==this._valid)return this._valid;var n=e.mag()>=2,r=t.mag()>=2;if(n||r){if(!n||!r)return null==this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;var a=e.y>0==t.y>0;return jr(e)&&jr(t)&&a}}}]),i}(Dr),Vr={panStep:100,bearingStep:15,pitchStep:10},Nr=function(){function e(){v(this,e);var t=Vr;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}return y(e,[{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1}},{key:"keydown",value:function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var i=0,n=0,r=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Ur,zoom:i?Math.round(l)+i*(e.shiftKey?2:1):l,bearing:s.getBearing()+n*t._bearingStep,pitch:s.getPitch()+r*t._pitchStep,offset:[-a*t._panStep,-o*t._panStep],center:s.getCenter()},{originalEvent:e})}}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}},{key:"disableRotation",value:function(){this._rotationDisabled=!0}},{key:"enableRotation",value:function(){this._rotationDisabled=!1}}]),e}();function Ur(e){return e*(2-e)}var Gr=4.000244140625,Wr=function(){function t(i,n){v(this,t),this._map=i,this._el=i.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}return y(t,[{key:"setZoomRate",value:function(e){this._defaultZoomRate=e}},{key:"setWheelZoomRate",value:function(e){this._wheelZoomRate=e}},{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active||void 0!==this._finishTimeout}},{key:"isZooming",value:function(){return!!this._zooming}},{key:"enable",value:function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}},{key:"wheel",value:function(t){if(this.isEnabled()){if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}var i=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,n=e.exported.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==i&&i%Gr==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}}},{key:"_onTimeout",value:function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}},{key:"_start",value:function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var t=E(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}}},{key:"renderFrame",value:function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform,n=function(){return i._terrainEnabled()&&t._aroundCoord?i.computeZoomRelativeTo(t._aroundCoord):i.zoom};if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>Gr?this._wheelZoomRate:this._defaultZoomRate,a=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==a&&(a=1/a);var o=n(),s=Math.pow(2,o),l="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(l*a))),"wheel"===this._type&&(this._startZoom=n(),this._easing=this._smoothOutEasing(200)),this._delta=0}var u,c="number"==typeof this._targetZoom?this._targetZoom:n(),h=this._startZoom,p=this._easing,d=!1;if("wheel"===this._type&&h&&p){var f=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),m=p(f);u=e.number(h,c,m),f<1?this._frameId||(this._frameId=!0):d=!0}else u=c,d=!0;return this._active=!0,d&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!d,zoomDelta:u-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}}},{key:"_smoothOutEasing",value:function(t){var i=e.ease;if(this._prevEase){var n=this._prevEase,r=(e.exported.now()-n.start)/n.duration,a=n.easing(r+.01)-n.easing(r),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.0729-o*o);i=e.bezier(o,s,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:i},i}},{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1}},{key:"_addScrollZoomBlocker",value:function(){this._map&&!this._alertContainer&&(this._alertContainer=g("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}},{key:"_isFullscreen",value:function(){return!!e.window.document.fullscreenElement||!!e.window.document.webkitFullscreenElement}},{key:"_showBlockerAlert",value:function(){var e=this;"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((function(){e._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")}),200)}}]),t}(),Hr=function(){function e(t,i){v(this,e),this._clickZoom=t,this._tapZoom=i}return y(e,[{key:"enable",value:function(){this._clickZoom.enable(),this._tapZoom.enable()}},{key:"disable",value:function(){this._clickZoom.disable(),this._tapZoom.disable()}},{key:"isEnabled",value:function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}},{key:"isActive",value:function(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}]),e}(),Zr=function(){function e(){v(this,e),this.reset()}return y(e,[{key:"reset",value:function(){this._active=!1}},{key:"blur",value:function(){this.reset()}},{key:"dblclick",value:function(e,t){return e.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(t)},{originalEvent:e})}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),qr=function(){function e(){v(this,e),this._tap=new Pr({numTouches:1,numTaps:1}),this.reset()}return y(e,[{key:"reset",value:function(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}},{key:"touchstart",value:function(e,t,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=t[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,t,i))}},{key:"touchmove",value:function(e,t,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var n=t[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,i)}},{key:"touchend",value:function(e,t,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(e,t,i)&&(this._tapTime=e.timeStamp)}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Xr=function(){function e(t,i,n){v(this,e),this._el=t,this._mousePan=i,this._touchPan=n}return y(e,[{key:"enable",value:function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}},{key:"disable",value:function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}},{key:"isEnabled",value:function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}},{key:"isActive",value:function(){return this._mousePan.isActive()||this._touchPan.isActive()}}]),e}(),Kr=function(){function e(t,i,n){v(this,e),this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=i,this._mousePitch=n}return y(e,[{key:"enable",value:function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}},{key:"disable",value:function(){this._mouseRotate.disable(),this._mousePitch.disable()}},{key:"isEnabled",value:function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}},{key:"isActive",value:function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}]),e}(),Yr=function(){function e(t,i,n,r){v(this,e),this._el=t,this._touchZoom=i,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}return y(e,[{key:"enable",value:function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}},{key:"disable",value:function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this._rotationDisabled=!0,this._touchRotate.disable()}},{key:"enableRotation",value:function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}]),e}(),$r=function(e){return e.zoom||e.drag||e.pitch||e.rotate},Jr=function(e){f(i,e);var t=m(i);function i(){return v(this,i),t.apply(this,arguments)}return y(i)}(e.Event),Qr=function(){function t(){v(this,t),this.constants=[1,1,.01],this.radius=0}return y(t,[{key:"setup",value:function(t,i){var n=e.sub([],i,t);this.radius=e.length(n[2]<0?e.div([],n,this.constants):[n[0],n[1],0])}},{key:"projectRay",value:function(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);var i=e.scale$2([],t,this.radius);if(i[2]>0){var n=e.scale$2([],[0,0,1],e.dot(i,[0,0,1])),r=e.scale$2([],e.normalize([],[i[0],i[1],0]),this.radius),a=e.add([],i,e.scale$2([],e.sub([],e.add([],r,n),i),2));i[0]=a[0],i[1]=a[1]}return i}}]),t}();function ea(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var ta=function(){function t(i,n){v(this,t),this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new dr(i),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Qr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),e.bindAll(["handleEvent","handleWindowEvent"],this);var r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[e.window,"blur",void 0]];var a,o=p(this._listeners);try{for(o.s();!(a=o.n()).done;){var s=h(a.value,3),l=s[0],u=s[1],c=s[2];l.addEventListener(u,l===e.window.document?this.handleWindowEvent:this.handleEvent,c)}}catch(d){o.e(d)}finally{o.f()}}return y(t,[{key:"destroy",value:function(){var t,i=p(this._listeners);try{for(i.s();!(t=i.n()).done;){var n=h(t.value,3),r=n[0],a=n[1],o=n[2];r.removeEventListener(a,r===e.window.document?this.handleWindowEvent:this.handleEvent,o)}}catch(s){i.e(s)}finally{i.f()}}},{key:"_addDefaultHandlers",value:function(e){var t=this._map,i=t.getCanvasContainer();this._add("mapEvent",new _r(t,e));var n=t.boxZoom=new xr(t,e);this._add("boxZoom",n);var r=new Sr,a=new Zr;t.doubleClickZoom=new Hr(a,r),this._add("tapZoom",r),this._add("clickZoom",a);var o=new qr;this._add("tapDragZoom",o);var s=t.touchPitch=new Br(t);this._add("touchPitch",s);var l=new Mr(e),u=new Ir(e);t.dragRotate=new Kr(e,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new Cr(e),h=new Or(t,e);t.dragPan=new Xr(i,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);var p=new Fr,d=new zr;t.touchZoomRotate=new Yr(i,d,p,o),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new br(t));var f=t.scrollZoom=new Wr(t,this);this._add("scrollZoom",f,["mousePan"]);var m=t.keyboard=new Nr;this._add("keyboard",m);for(var v=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];v<y.length;v++){var g=y[v];e.interactive&&e[g]&&t[g].enable(e[g])}}},{key:"_add",value:function(e,t,i){this._handlers.push({handlerName:e,handler:t,allowed:i}),this._handlersById[e]=t}},{key:"stop",value:function(e){if(!this._updatingCamera){var t,i=p(this._handlers);try{for(i.s();!(t=i.n()).done;)t.value.handler.reset()}catch(n){i.e(n)}finally{i.f()}this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}},{key:"isActive",value:function(){var e,t=p(this._handlers);try{for(t.s();!(e=t.n()).done;)if(e.value.handler.isActive())return!0}catch(i){t.e(i)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this._eventsInProgress.rotate}},{key:"isMoving",value:function(){return!!$r(this._eventsInProgress)||this.isZooming()}},{key:"_blockedByActive",value:function(e,t,i){for(var n in e)if(n!==i&&(!t||t.indexOf(n)<0))return!0;return!1}},{key:"handleWindowEvent",value:function(e){this.handleEvent(e,"".concat(e.type,"Window"))}},{key:"_getMapTouches",value:function(e){var t,i=[],n=p(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this._el.contains(r.target)&&i.push(r)}}catch(a){n.e(a)}finally{n.f()}return i}},{key:"handleEvent",value:function(e,t){this._updatingCamera=!0;var i,n="renderFrame"===e.type,r=n?void 0:e,a={needsRenderFrame:!1},o={},s={},l=e.touches?this._getMapTouches(e.touches):void 0,u=l?C(this._el,l):n?void 0:E(this._el,e),c=p(this._handlers);try{for(c.s();!(i=c.n()).done;){var h=i.value,d=h.handlerName,f=h.handler,m=h.allowed;if(f.isEnabled()){var v=void 0;this._blockedByActive(s,m,d)?f.reset():f[t||e.type]&&(v=f[t||e.type](e,u,l),this.mergeHandlerResult(a,o,v,d,r),v&&v.needsRenderFrame&&this._triggerRenderFrame()),(v||f.isActive())&&(s[d]=f)}}}catch(b){c.e(b)}finally{c.f()}var y={};for(var g in this._previousActiveHandlers)s[g]||(y[g]=r);this._previousActiveHandlers=s,(Object.keys(y).length||ea(a))&&(this._changes.push([a,o,y]),this._triggerRenderFrame()),(Object.keys(s).length||ea(a))&&this._map._stop(!0),this._updatingCamera=!1;var _=a.cameraAnimation;_&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_(this._map))}},{key:"mergeHandlerResult",value:function(t,i,n,r,a){if(n){e.extend(t,n);var o={handlerName:r,originalEvent:n.originalEvent||a};void 0!==n.zoomDelta&&(i.zoom=o),void 0!==n.panDelta&&(i.drag=o),void 0!==n.pitchDelta&&(i.pitch=o),void 0!==n.bearingDelta&&(i.rotate=o)}}},{key:"_applyChanges",value:function(){var t,i={},n={},r={},a=p(this._changes);try{for(a.s();!(t=a.n()).done;){var o=h(t.value,3),s=o[0],l=o[1],u=o[2];s.panDelta&&(i.panDelta=(i.panDelta||new e.pointGeometry(0,0))._add(s.panDelta)),s.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(i.around=s.around),void 0!==s.aroundCoord&&(i.aroundCoord=s.aroundCoord),void 0!==s.pinchAround&&(i.pinchAround=s.pinchAround),s.noInertia&&(i.noInertia=s.noInertia),e.extend(n,l),e.extend(r,u)}}catch(c){a.e(c)}finally{a.f()}this._updateMapTransform(i,n,r),this._changes=[]}},{key:"_updateMapTransform",value:function(t,i,n){var r=this,a=this._map,o=a.transform,s=function(e){return[e.x,e.y,e.z]};if(function(e){var t=r._eventsInProgress.drag;return t&&!r._handlersById[t.handlerName].isActive()}()&&!ea(t)){var l=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",l!==o.zoom&&this._map._update(!0)}if(ea(t)){var u=t.panDelta,c=t.zoomDelta,h=t.bearingDelta,p=t.pitchDelta,d=t.around,f=t.aroundCoord,m=t.pinchAround;void 0!==m&&(d=m),i.drag&&!r._eventsInProgress.drag&&d&&(this._dragOrigin=s(o.pointCoordinate3D(d)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",a._stop(!0),d=d||a.transform.centerPoint,h&&(o.bearing+=h),p&&(o.pitch+=p),o._updateCameraState();var v=[0,0,0];if(u){var y=o.pointCoordinate(d);if("globe"===o.projection.name){var g=e.latFromMercatorY(y.y),_=o.center.lat,b=Math.min(e.mercatorZfromAltitude(1,g)/e.mercatorZfromAltitude(1,_),2);u=u.rotate(-o.angle),v[0]=-u.x/o.worldSize*b,v[1]=-u.y/o.worldSize*b}else{var x=o.pointCoordinate(d.sub(u));y&&x&&(v[0]=x.x-y.x,v[1]=x.y-y.y)}}var w=o.zoom,k=[0,0,0];if(c){var P=s(f||o.pointCoordinate3D(d)),S={dir:e.normalize([],e.sub([],P,o._camera.position))};if(S.dir[2]<0){var T=o.zoomDeltaToMovement(P,c);e.scale$2(k,S.dir,T)}}var E=e.add(v,v,k);o._translateCameraConstrained(E),c&&Math.abs(o.zoom-w)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(i,n,!0)}else this._fireEvents(i,n,!0)}},{key:"_fireEvents",value:function(t,i,n){var r=this,a=$r(this._eventsInProgress),o=$r(t),s={};for(var l in t){var u=t[l].originalEvent;this._eventsInProgress[l]||(s["".concat(l,"start")]=u),this._eventsInProgress[l]=t[l]}for(var c in!a&&o&&this._fireEvent("movestart",o.originalEvent),s)this._fireEvent(c,s[c]);for(var h in o&&this._fireEvent("move",o.originalEvent),t){var p=t[h].originalEvent;this._fireEvent(h,p)}var d,f={};for(var m in this._eventsInProgress){var v=this._eventsInProgress[m],y=v.handlerName,g=v.originalEvent;this._handlersById[y].isActive()||(delete this._eventsInProgress[m],d=i[y]||g,f["".concat(m,"end")]=d)}for(var _ in f)this._fireEvent(_,f[_]);var b=$r(this._eventsInProgress);if(n&&(a||o)&&!b){this._updatingCamera=!0;var x=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),w=function(e){return 0!==e&&-r._bearingSnap<e&&e<r._bearingSnap};x?(w(x.bearing||this._map.getBearing())&&(x.bearing=0),this._map.easeTo(x,{originalEvent:d})):(this._map.fire(new e.Event("moveend",{originalEvent:d})),w(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}},{key:"_fireEvent",value:function(t,i){this._map.fire(new e.Event(t,i?{originalEvent:i}:{}))}},{key:"_requestFrame",value:function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(t){e._frameId=void 0,e.handleEvent(new Jr("renderFrame",{timeStamp:t})),e._applyChanges()}))}},{key:"_triggerRenderFrame",value:function(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}]),t}(),ia="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.",na=function(t){f(n,t);var i=m(n);function n(t,a){var o;return v(this,n),(o=i.call(this))._moving=!1,o._zooming=!1,o.transform=t,o._bearingSnap=a.bearingSnap,e.bindAll(["_renderFrameCallback"],r(o)),o}return y(n,[{key:"getCenter",value:function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}},{key:"setCenter",value:function(e,t){return this.jumpTo({center:e},t)}},{key:"panBy",value:function(t,i,n){return t=e.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},i),n)}},{key:"panTo",value:function(t,i,n){return this.easeTo(e.extend({center:t},i),n)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"setZoom",value:function(e,t){return this.jumpTo({zoom:e},t),this}},{key:"zoomTo",value:function(t,i,n){return this.easeTo(e.extend({zoom:t},i),n)}},{key:"zoomIn",value:function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}},{key:"zoomOut",value:function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"setBearing",value:function(e,t){return this.jumpTo({bearing:e},t),this}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(e,t){return this.jumpTo({padding:e},t),this}},{key:"rotateTo",value:function(t,i,n){return this.easeTo(e.extend({bearing:t},i),n)}},{key:"resetNorth",value:function(t,i){return this.rotateTo(0,e.extend({duration:1e3},t),i),this}},{key:"resetNorthPitch",value:function(t,i){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),i),this}},{key:"snapToNorth",value:function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setPitch",value:function(e,t){return this.jumpTo({pitch:e},t),this}},{key:"cameraForBounds",value:function(t,i){"globe"===this.transform.projection.name&&e.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),t=e.LngLatBounds.convert(t);var n=i&&i.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,i)}},{key:"_extendCameraOptions",value:function(t){var i={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){var n=t.padding;t.padding={top:n,bottom:n,right:n,left:n}}return t.padding=e.extend(i,t.padding),t}},{key:"_cameraForBoxAndBearing",value:function(t,i,n,r){var a=this._extendCameraOptions(r),o=this.transform,s=o.padding,l=o.project(e.LngLat.convert(t)),u=o.project(e.LngLat.convert(i)),c=new e.pointGeometry(l.x,u.y),h=new e.pointGeometry(u.x,l.y),p=-e.degToRad(n),d=l.rotate(p),f=u.rotate(p),m=c.rotate(p),v=h.rotate(p),y=new e.pointGeometry(Math.max(d.x,f.x,m.x,v.x),Math.max(d.y,f.y,m.y,v.y)),g=new e.pointGeometry(Math.min(d.x,f.x,m.x,v.x),Math.min(d.y,f.y,m.y,v.y)),_=y.sub(g),b=(o.width-((s.left||0)+(s.right||0)+a.padding.left+a.padding.right))/_.x,x=(o.height-((s.top||0)+(s.bottom||0)+a.padding.top+a.padding.bottom))/_.y;if(!(x<0||b<0)){var w=Math.min(o.scaleZoom(o.scale*Math.min(b,x)),a.maxZoom),k="number"==typeof a.offset.x&&"number"==typeof a.offset.y?new e.pointGeometry(a.offset.x,a.offset.y):e.pointGeometry.convert(a.offset),P=new e.pointGeometry((a.padding.left-a.padding.right)/2,(a.padding.top-a.padding.bottom)/2).rotate(n*Math.PI/180),S=k.add(P).mult(o.scale/o.zoomScale(w));return{center:o.unproject(l.add(u).div(2).sub(S)),zoom:w,bearing:n}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}},{key:"_cameraForBox",value:function(t,i,n,r,a){var o=this._extendCameraOptions(a);n=n||0,r=r||0,t=e.LngLat.convert(t),i=e.LngLat.convert(i);var s=this.transform.clone();s.padding=o.padding;var l=this.getFreeCameraOptions(),u=new e.LngLat(.5*(t.lng+i.lng),.5*(t.lat+i.lat)),c=.5*(n+r);if(!(s._camera.position[2]<e.mercatorZfromAltitude(c,u.lat))){l.lookAtPoint(u),s.setFreeCameraOptions(l);var h,p,d=e.MercatorCoordinate.fromLngLat(t),f=e.MercatorCoordinate.fromLngLat(i),m=s.pointRayIntersection(s.centerPoint,c),v=[(h=s.rayIntersectionCoordinate(m)).x,h.y,h.z],y=s.screenPointToMercatorRay(s.centerPoint),g="globe"!==s.projection.name,_=0;do{var b=Math.floor(s.zoom),x=1<<b,w=Math.min(x*d.x,x*f.x),k=Math.min(x*d.y,x*f.y),P=Math.max(x*d.x,x*f.x),S=Math.max(x*d.y,x*f.y),T=new e.Aabb([w,k,n],[P,S,r]),E=e.Frustum.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,b,g);if(2!==T.intersects(E)){p&&(s._camera.position=e.scaleAndAdd([],s._camera.position,y.dir,-p),s._updateStateFromCamera());break}var C=e.sub([],s._camera.position,v);p=.5*e.length(C),s._camera.position=e.scaleAndAdd([],s._camera.position,y.dir,p);try{s._updateStateFromCamera()}catch(t){return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++_<10);return{center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}},{key:"fitBounds",value:function(t,i,n){return"globe"===this.transform.projection.name&&e.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(t,i),i,n)}},{key:"_raycastElevationBox",value:function(t,i){var n=this.transform.elevation;if(n){var r=new e.pointGeometry(t.x,i.y),a=new e.pointGeometry(i.x,t.y),o=n.pointCoordinate(t);if(o){var s=n.pointCoordinate(i);if(s){var l=n.pointCoordinate(r);if(l){var u=n.pointCoordinate(a);if(u){var c=new e.MercatorCoordinate(o[0],o[1]).toLngLat(),h=new e.MercatorCoordinate(s[0],s[1]).toLngLat(),p=new e.MercatorCoordinate(l[0],l[1]).toLngLat(),d=new e.MercatorCoordinate(u[0],u[1]).toLngLat(),f=Math.min(c.lng,Math.min(h.lng,Math.min(p.lng,d.lng))),m=Math.min(c.lat,Math.min(h.lat,Math.min(p.lat,d.lat))),v=Math.max(c.lng,Math.max(h.lng,Math.max(p.lng,d.lng))),y=Math.max(c.lat,Math.max(h.lat,Math.max(p.lat,d.lat))),g=Math.min(o[3],Math.min(s[3],Math.min(l[3],u[3]))),_=Math.max(o[3],Math.max(s[3],Math.max(l[3],u[3])));return{minLngLat:new e.LngLat(f,m),maxLngLat:new e.LngLat(v,y),minAltitude:g,maxAltitude:_}}}}}}}},{key:"fitScreenCoordinates",value:function(t,i,n,r,a){var o,s,l,u;"globe"===this.transform.projection.name&&e.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");var c=e.pointGeometry.convert(t),h=e.pointGeometry.convert(i),p=this._raycastElevationBox(c,h);if(p)o=p.minLngLat,s=p.maxLngLat,l=p.minAltitude,u=p.maxAltitude;else{if(this.transform.anyCornerOffEdge(c,h))return this;o=this.transform.pointLocation(c),s=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(e.pointGeometry.convert(t)),this.transform.pointLocation(e.pointGeometry.convert(i)),n,r):this._cameraForBox(o,s,l,u,r),r,a)}},{key:"_fitInternal",value:function(t,i,n){return t?(delete(i=e.extend(t,i)).padding,i.linear?this.easeTo(i,n):this.flyTo(i,n)):this}},{key:"jumpTo",value:function(t,i){this.stop();var n=t.preloadOnly?this.transform.clone():this.transform,r=!1,a=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(r=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(a=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),t.preloadOnly?(this._preloadTiles(n),this):(this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),r&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),a&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),o&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)))}},{key:"getFreeCameraOptions",value:function(){return this.transform.projection.supportsFreeCamera||e.warnOnce(ia),this.transform.getFreeCameraOptions()}},{key:"setFreeCameraOptions",value:function(t,i){var n=this.transform;if(!n.projection.supportsFreeCamera)return e.warnOnce(ia),this;this.stop();var r=n.zoom,a=n.pitch,o=n.bearing;n.setFreeCameraOptions(t);var s=r!==n.zoom,l=a!==n.pitch,u=o!==n.bearing;return this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),s&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),u&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),l&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)),this}},{key:"easeTo",value:function(t,i){var n=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.exported.prefersReducedMotion)&&(t.duration=0);var r,a,o,s=this.transform,l=this.getZoom(),u=this.getBearing(),c=this.getPitch(),h=this.getPadding(),p="zoom"in t?+t.zoom:l,d="bearing"in t?this._normalizeBearing(t.bearing,u):u,f="pitch"in t?+t.pitch:c,m="padding"in t?t.padding:s.padding,v=e.pointGeometry.convert(t.offset);if("globe"===s.projection.name){var y=e.MercatorCoordinate.fromLngLat(s.center),g=v.rotate(-s.angle);y.x+=g.x/s.worldSize,y.y+=g.y/s.worldSize;var _=y.toLngLat(),b=e.LngLat.convert(t.center||_);this._normalizeCenter(b),r=s.centerPoint.add(g),a=new e.pointGeometry(y.x,y.y).mult(s.worldSize),o=new e.pointGeometry(e.mercatorXfromLng(b.lng),e.mercatorYfromLat(b.lat)).mult(s.worldSize).sub(a)}else{r=s.centerPoint.add(v);var x=s.pointLocation(r),w=e.LngLat.convert(t.center||x);this._normalizeCenter(w),a=s.project(x),o=s.project(w).sub(a)}var k,P,S=s.zoomScale(p-l);t.around&&(k=e.LngLat.convert(t.around),P=s.locationPoint(k));var T=this._zooming||p!==l,E=this._rotating||u!==d,C=this._pitching||f!==c,M=!s.isPaddingEqual(m),I=function(s){return function(y){if(T&&(s.zoom=e.number(l,p,y)),E&&(s.bearing=e.number(u,d,y)),C&&(s.pitch=e.number(c,f,y)),M&&(s.interpolatePadding(h,m,y),r=s.centerPoint.add(v)),k)s.setLocationAtPoint(k,P);else{var g=s.zoomScale(s.zoom-l),_=p>l?Math.min(2,S):Math.max(.5,S),b=Math.pow(_,1-y),x=s.unproject(a.add(o.mult(y*b)).mult(g));s.setLocationAtPoint(s.renderWorldCopies?x.wrap():x,r)}return t.preloadOnly||n._fireMoveEvents(i),s}};if(t.preloadOnly){var O=this._emulate(I,t.duration,s);return this._preloadTiles(O),this}var D={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=T,this._rotating=E,this._pitching=C,this._padding=M,this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,D),this._ease(I(s),(function(e){s.recenterOnTerrain(),n._afterEase(i,e)}),t),this}},{key:"_prepareEase",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",i||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}},{key:"_fireMoveEvents",value:function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}},{key:"_afterEase",value:function(t,i){if(!this._easeId||!i||this._easeId!==i){this._easeId=void 0,this.transform.cameraElevationReference="ground";var n=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),a&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}}},{key:"flyTo",value:function(t,i){var n=this;if(!t.essential&&e.exported.prefersReducedMotion){var r=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,i)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var a=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in t?e.clamp(+t.zoom,a.minZoom,a.maxZoom):o,h="bearing"in t?this._normalizeBearing(t.bearing,s):s,p="pitch"in t?+t.pitch:l,d="padding"in t?t.padding:a.padding,f=a.zoomScale(c-o),m=e.pointGeometry.convert(t.offset),v=a.centerPoint.add(m),y=a.pointLocation(v),g=e.LngLat.convert(t.center||y);this._normalizeCenter(g);var _=a.project(y),b=a.project(g).sub(_),x=t.curve,w=Math.max(a.width,a.height),k=w/f,P=b.mag();if("minZoom"in t){var S=e.clamp(Math.min(t.minZoom,o,c),a.minZoom,a.maxZoom),T=w/a.zoomScale(S-o);x=Math.sqrt(T/P*2)}var E=x*x;function C(e){var t=(k*k-w*w+(e?-1:1)*E*E*P*P)/(2*(e?k:w)*E*P);return Math.log(Math.sqrt(t*t+1)-t)}function M(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}var O=C(0),D=function(e){return I(O)/I(O+x*e)},A=function(e){return w*((I(O)*(M(t=O+x*e)/I(t))-M(O))/E)/P;var t},L=(C(1)-O)/x;if(Math.abs(P)<1e-6||!isFinite(L)){if(Math.abs(w-k)<1e-6)return this.easeTo(t,i);var z=k<w?-1:1;L=Math.abs(Math.log(k/w))/x,A=function(){return 0},D=function(e){return Math.exp(z*x*e)}}t.duration="duration"in t?+t.duration:1e3*L/("screenSpeed"in t?+t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);var R=s!==h,F=p!==l,j=!a.isPaddingEqual(d),B=function(r){return function(a){var f=a*L,y=1/D(f);r.zoom=1===a?c:o+r.scaleZoom(y),R&&(r.bearing=e.number(s,h,a)),F&&(r.pitch=e.number(l,p,a)),j&&(r.interpolatePadding(u,d,a),v=r.centerPoint.add(m));var x=1===a?g:r.unproject(_.add(b.mult(A(f))).mult(y));return r.setLocationAtPoint(r.renderWorldCopies?x.wrap():x,v),r._updateCameraOnTerrain(),t.preloadOnly||n._fireMoveEvents(i),r}};if(t.preloadOnly){var V=this._emulate(B,t.duration,a);return this._preloadTiles(V),this}return this._zooming=!0,this._rotating=R,this._pitching=F,this._padding=j,this._prepareEase(i,!1),this._ease(B(a),(function(){return n._afterEase(i)}),t),this}},{key:"isEasing",value:function(){return!!this._easeFrameId}},{key:"stop",value:function(){return this._stop()}},{key:"_stop",value:function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){var i=this._onEaseEnd;this._onEaseEnd=void 0,i.call(this,t)}if(!e){var n=this.handlers;n&&n.stop(!1)}return this}},{key:"_ease",value:function(t,i,n){!1===n.animate||0===n.duration?(t(1),i()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}},{key:"_renderFrameCallback",value:function(){var t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}},{key:"_normalizeBearing",value:function(t,i){t=e.wrap(t,-180,180);var n=Math.abs(t-i);return Math.abs(t-360-i)<n&&(t-=360),Math.abs(t+360-i)<n&&(t+=360),t}},{key:"_normalizeCenter",value:function(e){var t=this.transform;if(t.renderWorldCopies&&!t.maxBounds){var i=e.lng-t.center.lng;e.lng+=i>180?-360:i<-180?360:0}}},{key:"_emulate",value:function(e,t,i){for(var n=Math.ceil(15*t/1e3),r=[],a=e(i.clone()),o=0;o<=n;o++){var s=a(o/n);r.push(s.clone())}return r}}]),n}(e.Evented),ra=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t),this.options=i,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}return y(t,[{key:"getDefaultPosition",value:function(){return"bottom-right"}},{key:"onAdd",value:function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=g("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=g("button","mapboxgl-ctrl-attrib-button",this._container),g("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=g("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}},{key:"_setElementTitle",value:function(e,t){var i=this._map._getUIString("AttributionControl.".concat(t));e.setAttribute("aria-label",i),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}},{key:"_toggleAttribution",value:function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}},{key:"_updateEditLink",value:function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var n=i.reduce((function(e,t,n){return t.value&&(e+="".concat(t.key,"=").concat(t.value).concat(n<i.length-1?"&":"")),e}),"?");t.href="".concat(e.config.FEEDBACK_URL,"/").concat(n).concat(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}},{key:"_updateData",value:function(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}},{key:"_updateAttributions",value:function(){if(this._map.style){var e=[];if(this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var i=this._map.style._sourceCaches;for(var n in i){var r=i[n];if(r.used){var a=r.getSource();a.attribution&&e.indexOf(a.attribution)<0&&e.push(a.attribution)}}e.sort((function(e,t){return e.length-t.length})),e=e.filter((function(t,i){for(var n=i+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[].concat(c(this.options.customAttribution),c(e)):e.unshift(this.options.customAttribution));var o=e.join(" | ");o!==this._attribHTML&&(this._attribHTML=o,e.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}}},{key:"_updateCompact",value:function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}]),t}(),aa=function(){function t(){v(this,t),e.bindAll(["_updateLogo","_updateCompact"],this)}return y(t,[{key:"onAdd",value:function(e){this._map=e,this._container=g("div","mapboxgl-ctrl");var t=g("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}},{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_updateLogo",value:function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}},{key:"_logoRequired",value:function(){if(!this._map.style)return!0;var e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(var t in e){var i=e[t].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}},{key:"_updateCompact",value:function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}]),t}(),oa=function(){function e(){v(this,e),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return y(e,[{key:"add",value:function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}},{key:"remove",value:function(e){var t,i=this._currentlyRunning,n=i?this._queue.concat(i):this._queue,r=p(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.id===e)return void(a.cancelled=!0)}}catch(o){r.e(o)}finally{r.f()}}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._currentlyRunning=this._queue;this._queue=[];var i,n=p(t);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!r.cancelled&&(r.callback(e),this._cleared))break}}catch(a){n.e(a)}finally{n.f()}this._cleared=!1,this._currentlyRunning=!1}},{key:"clear",value:function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}]),e}();function sa(t,i,n){if(t=new e.LngLat(t.lng,t.lat),i){var r=new e.LngLat(t.lng-360,t.lat),a=new e.LngLat(t.lng+360,t.lat),o=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),s=n.locationPoint(t).distSqr(i),l=i.x<0||i.y<0||i.x>n.width||i.y>n.height;n.locationPoint(r).distSqr(i)<s&&(l||Math.abs(r.lng-n.center.lng)<o)?t=r:n.locationPoint(a).distSqr(i)<s&&(l||Math.abs(a.lng-n.center.lng)<o)&&(t=a)}for(;Math.abs(t.lng-n.center.lng)>180;){var u=n.locationPoint(t);if(u.x>=0&&u.y>=0&&u.x<=n.width&&u.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}var la={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ua=function(t){f(n,t);var i=m(n);function n(t,a){var o;if(v(this,n),o=i.call(this),(t instanceof e.window.HTMLElement||a)&&(t=e.extend({element:t},a)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],r(o)),o._anchor=t&&t.anchor||"center",o._color=t&&t.color||"#3FB1CE",o._scale=t&&t.scale||1,o._draggable=t&&t.draggable||!1,o._clickTolerance=t&&t.clickTolerance||0,o._isDragging=!1,o._state="inactive",o._rotation=t&&t.rotation||0,o._rotationAlignment=t&&t.rotationAlignment||"auto",o._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",o._updateMoving=function(){return o._update(!0)},t&&t.element)o._element=t.element,o._offset=e.pointGeometry.convert(t&&t.offset||[0,0]);else{o._defaultMarker=!0,o._element=g("div");var s=41,u=27,c=_("svg",{display:"block",height:s*o._scale+"px",width:u*o._scale+"px",viewBox:"0 0 ".concat(u," ").concat(s)},o._element),h=_("radialGradient",{id:"shadowGradient"},_("defs",{},c));_("stop",{offset:"10%","stop-opacity":.4},h),_("stop",{offset:"100%","stop-opacity":.05},h),_("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},c),_("path",{fill:o._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},c),_("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},c),_("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},c),o._offset=e.pointGeometry.convert(t&&t.offset||[0,-14])}o._element.hasAttribute("aria-label")||o._element.setAttribute("aria-label","Map marker"),o._element.classList.add("mapboxgl-marker"),o._element.addEventListener("dragstart",(function(e){e.preventDefault()})),o._element.addEventListener("mousedown",(function(e){e.preventDefault()}));var p=o._element.classList;for(var d in la)p.remove("mapboxgl-marker-anchor-".concat(d));return p.add("mapboxgl-marker-anchor-".concat(o._anchor)),o._popup=null,l(o)}return y(n,[{key:"addTo",value:function(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}},{key:"remove",value:function(){var e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}},{key:"getElement",value:function(){return this._element}},{key:"setPopup",value:function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=38.1,i=13.5,n=Math.sqrt(Math.pow(i,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-i+n)],"bottom-right":[-n,-1*(t-i+n)],left:[i,-1*(t-i)],right:[-i,-1*(t-i)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}},{key:"_onKeyPress",value:function(e){var t=e.code,i=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==i&&13!==i||this.togglePopup()}},{key:"_onMapClick",value:function(e){var t=e.originalEvent.target,i=this._element;this._popup&&(t===i||i.contains(t))&&this.togglePopup()}},{key:"getPopup",value:function(){return this._popup}},{key:"togglePopup",value:function(){var e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}},{key:"_behindTerrain",value:function(){var e=this._map;if(!e)return!1;var t=e.unproject(this._pos),i=e.getFreeCameraOptions();if(!i.position)return!1;var n=i.position.toLngLat();return n.distanceTo(t)<.9*n.distanceTo(this._lngLat)}},{key:"_evaluateOpacity",value:function(){var t=this._map;if(t){var i=this._pos;if(!i||i.x<0||i.x>t.transform.width||i.y<0||i.y>t.transform.height)this._clearFadeTimer();else{var n,r=t.unproject(i);t._usingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?n=0:(n=1-t._queryFogOpacity(r),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(n*=.2)),this._element.style.opacity="".concat(n),this._element.style.pointerEvents=n>0?"auto":"none",this._popup&&this._popup._setOpacity(n),this._fadeTimer=null}}}},{key:"_clearFadeTimer",value:function(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}},{key:"_updateDOM",value:function(){var e=this._pos;if(e&&this._map){var t=this._calculateXYTransform()+this._calculateZTransform(),i=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(e.x,"px,").concat(e.y,"px) ").concat(la[this._anchor],"\n            ").concat(t,"\n            translate(").concat(i.x,"px,").concat(i.y,"px)\n        ")}}},{key:"_calculateXYTransform",value:function(){var t=this._pos,i=this._map;if("map"!==this.getPitchAlignment()||!i||!t)return"";if(!i._usingGlobe()){var n=i.getPitch();return n?"rotateX(".concat(n,"deg)"):""}var r=e.radToDeg(e.globeTiltAtLngLat(i.transform,this._lngLat)),a=t.sub(e.globeCenterToScreenPoint(i.transform)),o=r/(Math.abs(a.x)+Math.abs(a.y)),s=a.x*o,l=-a.y*o;return l||s?"rotateX(".concat(l,"deg) rotateY(").concat(s,"deg)"):""}},{key:"_calculateZTransform",value:function(){var e=this._calculateRotation();return e?"rotateZ(".concat(e,"deg)"):""}},{key:"_calculateRotation",value:function(){if("viewport"===this._rotationAlignment||"auto"===this._rotationAlignment)return this._rotation;if(this._map&&"map"===this._rotationAlignment){var t=this._map;if(this._pos&&t&&t._usingGlobe()){var i=t.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),n=t.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(i);return this._rotation+e.radToDeg(Math.atan2(n.y,n.x))-90}return this._rotation-this._map.getBearing()}return 0}},{key:"_update",value:function(t){var i=this;e.window.cancelAnimationFrame(this._updateFrameId);var n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=sa(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame((function(){i._element&&i._pos&&i._anchor&&(i._pos=i._pos.round(),i._updateDOM())})):this._pos=this._pos.round(),n._requestDomTask((function(){i._map&&(i._element&&i._pos&&i._anchor&&i._updateDOM(),(n._usingGlobe()||n.getTerrain()||n.getFog())&&!i._fadeTimer&&(i._fadeTimer=setTimeout(i._evaluateOpacity.bind(i),60)))})))}},{key:"getOffset",value:function(){return this._offset}},{key:"setOffset",value:function(t){return this._offset=e.pointGeometry.convert(t),this._update(),this}},{key:"_onMove",value:function(t){var i=this._map;if(i){if(!this._isDragging){var n=this._clickTolerance||i._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=n}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag")))}}},{key:"_onUp",value:function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;var t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}},{key:"_addDragHandler",value:function(e){var t=this._map;t&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}},{key:"setDraggable",value:function(e){this._draggable=!!e;var t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}},{key:"isDraggable",value:function(){return this._draggable}},{key:"setRotation",value:function(e){return this._rotation=e||0,this._update(),this}},{key:"getRotation",value:function(){return this._rotation}},{key:"setRotationAlignment",value:function(e){return this._rotationAlignment=e||"auto",this._update(),this}},{key:"getRotationAlignment",value:function(){return"auto"===this._rotationAlignment?"viewport":this._rotationAlignment}},{key:"setPitchAlignment",value:function(e){return this._pitchAlignment=e||"auto",this._update(),this}},{key:"getPitchAlignment",value:function(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}}]),n}(e.Evented),ca=function(){function t(e){v(this,t),this.jumpTo(e)}return y(t,[{key:"getValue",value:function(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;var i=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}},{key:"isEasing",value:function(e){return e>=this._startTime&&e<=this._endTime}},{key:"jumpTo",value:function(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}},{key:"easeTo",value:function(e,t,i){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+i}}]),t}(),ha={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},pa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function da(e){e.parentNode&&e.parentNode.removeChild(e)}var fa={showCompass:!0,showZoom:!0,visualizePitch:!1},ma=function(){function t(i,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];v(this,t),this._clickTolerance=10,this.element=n,this.mouseRotate=new Mr({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,r&&(this.mousePitch=new Ir({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}return y(t,[{key:"down",value:function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),k()}},{key:"move",value:function(e,t){var i=this.map,n=this.mouseRotate.mousemoveWindow(e,t),r=n&&n.bearingDelta;if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){var a=this.mousePitch.mousemoveWindow(e,t),o=a&&a.pitchDelta;o&&i.setPitch(i.getPitch()+o)}}},{key:"off",value:function(){var e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}},{key:"offTemp",value:function(){P(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}},{key:"mousedown",value:function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),E(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}},{key:"mousemove",value:function(e){this.move(e,E(this.element,e))}},{key:"mouseup",value:function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}},{key:"touchstart",value:function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=C(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))}},{key:"touchmove",value:function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=C(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))}},{key:"touchend",value:function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}},{key:"reset",value:function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}]),t}(),va={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ya={maxWidth:100,unit:"metric"};function ga(e,t,i){var n=this,r=_a(t),a=r/t,o={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[i];this._map._requestDomTask((function(){n._container.style.width=e*a+"px",n._container.innerHTML="".concat(r,"&nbsp;").concat(o)}))}function _a(e){var t=Math.pow(10,"".concat(Math.floor(e)).length-1),i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(i),t*i}var ba={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xa=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.pointGeometry(0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof t){var n=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(i){case"top":return new e.pointGeometry(0,t);case"top-left":return new e.pointGeometry(n,n);case"top-right":return new e.pointGeometry(-n,n);case"bottom":return new e.pointGeometry(0,-t);case"bottom-left":return new e.pointGeometry(n,-n);case"bottom-right":return new e.pointGeometry(-n,-n);case"left":return new e.pointGeometry(t,0);case"right":return new e.pointGeometry(-t,0)}return new e.pointGeometry(0,0)}return t instanceof e.pointGeometry||Array.isArray(t)?e.pointGeometry.convert(t):e.pointGeometry.convert(t[i]||[0,0])}var ka={version:e.version,supported:i,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:function(t){f(c,t);var a=m(c);function c(t){var i;if(v(this,c),null!=(t=e.extend({},pa,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),(i=a.call(this,new ar(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t))._interactive=t.interactive,i._minTileCacheSize=t.minTileCacheSize,i._maxTileCacheSize=t.maxTileCacheSize,i._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,i._preserveDrawingBuffer=t.preserveDrawingBuffer,i._antialias=t.antialias,i._trackResize=t.trackResize,i._bearingSnap=t.bearingSnap,i._refreshExpiredTiles=t.refreshExpiredTiles,i._fadeDuration=t.fadeDuration,i._isInitialLoad=!0,i._crossSourceCollisions=t.crossSourceCollisions,i._crossFadingFactor=1,i._collectResourceTiming=t.collectResourceTiming,i._optimizeForTerrain=t.optimizeForTerrain,i._language="auto"===t.language?e.window.navigator.language:t.language,i._worldview=t.worldview,i._renderTaskQueue=new oa,i._domRenderTaskQueue=new oa,i._controls=[],i._markers=[],i._mapId=e.uniqueId(),i._locale=e.extend({},ha,t.locale),i._clickTolerance=t.clickTolerance,i._cooperativeGestures=t.cooperativeGestures,i._containerWidth=0,i._containerHeight=0,i._averageElevationLastSampledAt=-1/0,i._averageElevationExaggeration=0,i._averageElevation=new ca(0),i._explicitProjection=null,i._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),i._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(i._container=e.window.document.getElementById(t.container),!i._container)throw new Error("Container '".concat(t.container,"' not found."))}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");i._container=t.container}if(i._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&i.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],r(i)),i._setupContainer(),i._setupPainter(),void 0===i.painter)throw new Error("Failed to initialize WebGL.");return i.on("move",(function(){return i._update(!1)})),i.on("moveend",(function(){return i._update(!1)})),i.on("zoom",(function(){return i._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",i._onWindowOnline,!1),e.window.addEventListener("resize",i._onWindowResize,!1),e.window.addEventListener("orientationchange",i._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",i._onWindowResize,!1)),i.handlers=new ta(r(i),t),i._localFontFamily=t.localFontFamily,i._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&i.setStyle(t.style,{localFontFamily:i._localFontFamily,localIdeographFontFamily:i._localIdeographFontFamily}),t.projection&&i.setProjection(t.projection),i._hash=t.hash&&new sr("string"==typeof t.hash&&t.hash||void 0).addTo(r(i)),i._hash&&i._hash._onHashChange()||(i.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(i.resize(),i.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),i.resize(),t.attributionControl&&i.addControl(new ra({customAttribution:t.customAttribution})),i._logoControl=new aa,i.addControl(i._logoControl,t.logoPosition),i.on("style.load",(function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)})),i.on("data",(function(t){i._update("style"===t.dataType),i.fire(new e.Event("".concat(t.dataType,"data"),t))})),i.on("dataloading",(function(t){i.fire(new e.Event("".concat(t.dataType,"dataloading"),t))})),l(i)}return y(c,[{key:"_getMapId",value:function(){return this._mapId}},{key:"addControl",value:function(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=t.onAdd(this);this._controls.push(t);var r=this._controlPositions[i];return-1!==i.indexOf("bottom")?r.insertBefore(n,r.firstChild):r.appendChild(n),this}},{key:"removeControl",value:function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}},{key:"hasControl",value:function(e){return this._controls.indexOf(e)>-1}},{key:"getContainer",value:function(){return this._container}},{key:"getCanvasContainer",value:function(){return this._canvasContainer}},{key:"getCanvas",value:function(){return this._canvas}},{key:"resize",value:function(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));var i=!this._moving;return i&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),i&&this.fire(new e.Event("moveend",t)),this}},{key:"getBounds",value:function(){return"globe"===this.transform.projection.name&&e.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()||null}},{key:"setMaxBounds",value:function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}},{key:"setMinZoom",value:function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(e){return this.transform.renderWorldCopies=e,this._update()}},{key:"getLanguage",value:function(){return this._language}},{key:"setLanguage",value:function(t){if(this._language="auto"===t?e.window.navigator.language:t,this.style)for(var i in this.style._sourceCaches){var n=this.style._sourceCaches[i]._source;n._setLanguage&&n._setLanguage(this._language)}var r,a=p(this._controls);try{for(a.s();!(r=a.n()).done;){var o=r.value;o._setLanguage&&o._setLanguage(this._language)}}catch(s){a.e(s)}finally{a.f()}return this}},{key:"getWorldview",value:function(){return this._worldview}},{key:"setWorldview",value:function(e){if(this._worldview=e,this.style)for(var t in this.style._sourceCaches){var i=this.style._sourceCaches[t]._source;i._setWorldview&&i._setWorldview(e)}return this}},{key:"getProjection",value:function(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}},{key:"_usingGlobe",value:function(){return"globe"===this.transform.projection.name}},{key:"setProjection",value:function(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._updateProjection(e)}},{key:"_updateProjection",value:function(t){var i=this.getProjection();null===t&&(this._explicitProjection=null);var n,r=t||this.getProjection();if(r&&"globe"===r.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(n=this.transform.setProjection({name:"mercator"}),this.transform.mercatorFromTransition=!0):(n=this.transform.setProjection(r),this.transform.mercatorFromTransition=!1),t&&(this._explicitProjection="globe"===t.name?{name:"globe",center:[0,0]}:this.transform.getProjection()),this.style.applyProjectionUpdate(),n){if("globe"===i.name&&"globe"===this.getProjection().name)this.style._forceSymbolLayerUpdate();else for(var a in this.painter.clearBackgroundTiles(),this.style._sourceCaches)this.style._sourceCaches[a].clearTiles();this._update(!0)}return this}},{key:"project",value:function(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}},{key:"unproject",value:function(t){return this.transform.pointLocation3D(e.pointGeometry.convert(t))}},{key:"isMoving",value:function(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}},{key:"isZooming",value:function(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}},{key:"isRotating",value:function(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}},{key:"_createDelegatedListener",value:function(e,t,i){var r=this;if("mouseenter"===e||"mouseover"===e){var a=!1,o=function(n){var o=t.filter((function(e){return r.getLayer(e)})),s=o.length?r.queryRenderedFeatures(n.point,{layers:o}):[];s.length?a||(a=!0,i.call(r,new vr(e,r,n.originalEvent,{features:s}))):a=!1},s=function(){a=!1};return{layers:new Set(t),listener:i,delegates:{mousemove:o,mouseout:s}}}if("mouseleave"===e||"mouseout"===e){var l=!1,u=function(n){var a=t.filter((function(e){return r.getLayer(e)}));(a.length?r.queryRenderedFeatures(n.point,{layers:a}):[]).length?l=!0:l&&(l=!1,i.call(r,new vr(e,r,n.originalEvent)))},c=function(t){l&&(l=!1,i.call(r,new vr(e,r,t.originalEvent)))};return{layers:new Set(t),listener:i,delegates:{mousemove:u,mouseout:c}}}var h=function(e){var n=t.filter((function(e){return r.getLayer(e)})),a=n.length?r.queryRenderedFeatures(e.point,{layers:n}):[];a.length&&(e.features=a,i.call(r,e),delete e.features)};return{layers:new Set(t),listener:i,delegates:n({},e,h)}}},{key:"on",value:function(e,t,i){if(void 0===i)return o(s(c.prototype),"on",this).call(this,e,t);Array.isArray(t)||(t=[t]);var n=this._createDelegatedListener(e,t,i);for(var r in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n),n.delegates)this.on(r,n.delegates[r]);return this}},{key:"once",value:function(e,t,i){if(void 0===i)return o(s(c.prototype),"once",this).call(this,e,t);Array.isArray(t)||(t=[t]);var n=this._createDelegatedListener(e,t,i);for(var r in n.delegates)this.once(r,n.delegates[r]);return this}},{key:"off",value:function(e,t,i){var n=this;if(void 0===i)return o(s(c.prototype),"off",this).call(this,e,t);t=new Set(Array.isArray(t)?t:[t]);var r=function(e,t){if(e.size!==t.size)return!1;var i,n=p(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!t.has(r))return!1}}catch(a){n.e(a)}finally{n.f()}return!0},a=this._delegatedListeners?this._delegatedListeners[e]:void 0;return a&&function(e){for(var a=0;a<e.length;a++){var o=e[a];if(o.listener===i&&r(o.layers,t)){for(var s in o.delegates)n.off(s,o.delegates[s]);return e.splice(a,1),n}}}(a),this}},{key:"queryRenderedFeatures",value:function(t,i){return this.style?(void 0!==i||void 0===t||t instanceof e.pointGeometry||Array.isArray(t)||(i=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}},{key:"querySourceFeatures",value:function(e,t){return this.style.querySourceFeatures(e,t)}},{key:"queryTerrainElevation",value:function(t,i){var n=this.transform.elevation;return n?(i=e.extend({},{exaggerated:!0},i),n.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,i.exaggerated)):null}},{key:"setStyle",value:function(t,i){return!1!==(i=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(t,i))}},{key:"_getUIString",value:function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}},{key:"_updateStyle",value:function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new di(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}},{key:"_lazyInitEmptyStyle",value:function(){this.style||(this.style=new di(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}},{key:"_diffStyle",value:function(t,i){var n=this;if("string"==typeof t){var r=this._requestManager.normalizeStyleURL(t),a=this._requestManager.transformRequest(r,e.ResourceType.Style);e.getJSON(a,(function(t,r){t?n.fire(new e.ErrorEvent(t)):r&&n._updateDiff(r,i)}))}else"object"==typeof t&&this._updateDiff(t,i)}},{key:"_updateDiff",value:function(t,i){try{this.style.setState(t)&&this._update(!0)}catch(u){e.warnOnce("Unable to perform style diff: ".concat(u.message||u.error||u,".  Rebuilding the style from scratch.")),this._updateStyle(t,i)}}},{key:"getStyle",value:function(){if(this.style)return this.style.serialize()}},{key:"isStyleLoaded",value:function(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}},{key:"addSource",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}},{key:"isSourceLoaded",value:function(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}},{key:"areTilesLoaded",value:function(){var e=this.style&&this.style._sourceCaches;for(var t in e){var i=e[t]._tiles;for(var n in i){var r=i[n];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0}},{key:"addSourceType",value:function(e,t,i){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,i)}},{key:"removeSource",value:function(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}},{key:"getSource",value:function(e){return this.style.getSource(e)}},{key:"addImage",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.pixelRatio,a=void 0===r?1:r,o=n.sdf,s=void 0!==o&&o,l=n.stretchX,u=n.stretchY,c=n.content;if(this._lazyInitEmptyStyle(),i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap){var h=e.exported.getImageData(i),p=h.width,d=h.height,f=h.data;this.style.addImage(t,{data:new e.RGBAImage({width:p,height:d},f),pixelRatio:a,stretchX:l,stretchY:u,content:c,sdf:s,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{var m=i.width,v=i.height,y=i;this.style.addImage(t,{data:new e.RGBAImage({width:m,height:v},new Uint8Array(y.data)),pixelRatio:a,stretchX:l,stretchY:u,content:c,sdf:s,version:0,userImage:y}),y.onAdd&&y.onAdd(this,t)}}},{key:"updateImage",value:function(t,i){var n=this.style.getImage(t);if(n){var r=i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap?e.exported.getImageData(i):i,a=r.width,o=r.height;void 0!==a&&void 0!==o?a===n.data.width&&o===n.data.height?(n.data.replace(r.data,!(i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap)),this.style.updateImage(t,n)):this.fire(new e.ErrorEvent(new Error("The width and height of the updated image (".concat(a,", ").concat(o,")\n                must be that same as the previous version of the image\n                (").concat(n.data.width,", ").concat(n.data.height,")")))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}else this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")))}},{key:"hasImage",value:function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}},{key:"removeImage",value:function(e){this.style.removeImage(e)}},{key:"loadImage",value:function(t,i){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),(function(t,n){i(t,n instanceof e.window.HTMLImageElement?e.exported.getImageData(n):n)}))}},{key:"listImages",value:function(){return this.style.listImages()}},{key:"addLayer",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}},{key:"moveLayer",value:function(e,t){return this.style.moveLayer(e,t),this._update(!0)}},{key:"removeLayer",value:function(e){return this.style.removeLayer(e),this._update(!0)}},{key:"getLayer",value:function(e){return this.style.getLayer(e)}},{key:"setLayerZoomRange",value:function(e,t,i){return this.style.setLayerZoomRange(e,t,i),this._update(!0)}},{key:"setFilter",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,i),this._update(!0)}},{key:"getFilter",value:function(e){return this.style.getFilter(e)}},{key:"setPaintProperty",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,i,n),this._update(!0)}},{key:"getPaintProperty",value:function(e,t){return this.style.getPaintProperty(e,t)}},{key:"setLayoutProperty",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,i,n),this._update(!0)}},{key:"getLayoutProperty",value:function(e,t){return this.style.getLayoutProperty(e,t)}},{key:"setLight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}},{key:"getLight",value:function(){return this.style.getLight()}},{key:"setTerrain",value:function(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}},{key:"getTerrain",value:function(){return this.style?this.style.getTerrain():null}},{key:"setFog",value:function(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}},{key:"getFog",value:function(){return this.style?this.style.getFog():null}},{key:"_queryFogOpacity",value:function(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}},{key:"setFeatureState",value:function(e,t){return this.style.setFeatureState(e,t),this._update()}},{key:"removeFeatureState",value:function(e,t){return this.style.removeFeatureState(e,t),this._update()}},{key:"getFeatureState",value:function(e){return this.style.getFeatureState(e)}},{key:"_updateContainerDimensions",value:function(){if(this._container){for(var t,i,n,r=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300,o=this._container;o&&(!i||!n);){var s=e.window.getComputedStyle(o).transform;s&&"none"!==s&&((t=s.match(/matrix.*\((.+)\)/)[1].split(", "))[0]&&"0"!==t[0]&&"1"!==t[0]&&(i=t[0]),t[3]&&"0"!==t[3]&&"1"!==t[3]&&(n=t[3])),o=o.parentElement}this._containerWidth=i?Math.abs(r/i):r,this._containerHeight=n?Math.abs(a/n):a}}},{key:"_detectMissingCSS",value:function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}},{key:"_setupContainer",value:function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=g("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=g("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=g("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);var i=this._controlContainer=g("div","mapboxgl-control-container",e),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){n[e]=g("div","mapboxgl-ctrl-".concat(e),i)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}},{key:"_resizeCanvas",value:function(t,i){var n=e.exported.devicePixelRatio||1;this._canvas.width=n*Math.ceil(t),this._canvas.height=n*Math.ceil(i),this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(i,"px")}},{key:"_addMarker",value:function(e){this._markers.push(e)}},{key:"_removeMarker",value:function(e){var t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}},{key:"_setupPainter",value:function(){var t=this,n=e.extend({},i.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(e.storeAuthState(r,!0),this.painter=new Zn(r,this.transform),this.on("data",(function(e){"source"===e.dataType&&t.painter.setTileLoadedFlag(!0)})),e.exported$1.testSupport(r)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}},{key:"_contextLost",value:function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}},{key:"_contextRestored",value:function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}},{key:"_onMapScroll",value:function(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}},{key:"loaded",value:function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}},{key:"_update",value:function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}},{key:"_requestRenderFrame",value:function(e){return this._update(),this._renderTaskQueue.add(e)}},{key:"_cancelRenderFrame",value:function(e){this._renderTaskQueue.remove(e)}},{key:"_requestDomTask",value:function(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}},{key:"_render",value:function(t){var i,n=this,r=this.painter.context.extTimerQuery,a=e.exported.now();if(this.listens("gpu-timing-frame")&&(i=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),!this._removed){"globe"===this.getProjection().name&&(this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?"globe"===this.transform.projection.name&&this._updateProjection():"mercator"===this.transform.projection.name&&this._updateProjection());var o=!1,s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;var l=this.transform.zoom,u=this.transform.pitch,c=e.exported.now();this.style.zoomHistory.update(l,c);var h=new e.EvaluationParameters(l,{now:c,fadeDuration:s,pitch:u,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),p=h.crossFadingFactor();1===p&&p===this._crossFadingFactor||(o=!0,this._crossFadingFactor=p),this.style.update(h)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);var d=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),d=this._updateAverageElevation(a),this.style._updateSources(this.transform),this._forceMarkerUpdate()):d=this._updateAverageElevation(a),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){var f=e.exported.now()-a;r.endQueryEXT(r.TIME_ELAPSED_EXT,i),setTimeout((function(){var t=r.getQueryObjectEXT(i,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i),n.fire(new e.Event("gpu-timing-frame",{cpuTime:f,gpuTime:t})),e.window.performance.mark("frame-gpu",{startTime:a,detail:{gpuTime:t}})}),50)}if(this.listens("gpu-timing-layer")){var m=this.painter.collectGpuTimers();setTimeout((function(){var t=n.painter.queryGpuTimers(m);n.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}if(this.listens("gpu-timing-deferred-render")){var v=this.painter.collectDeferredRenderGpuQueries();setTimeout((function(){var t=n.painter.queryGpuTimeDeferredRender(v);n.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:t}))}),50)}var y=this._sourcesDirty||this._styleDirty||this._placementDirty||d;if(y||this._repaint)this.triggerRepaint();else{var g=!this.isMoving()&&this.loaded();if(g&&(d=this._updateAverageElevation(a,!0)),d)this.triggerRepaint();else if(this._triggerFrame(!1),g&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){var _=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:_})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||y||(this._fullyLoaded=!0,this._authenticate())}}},{key:"_forceMarkerUpdate",value:function(){var e,t=p(this._markers);try{for(t.s();!(e=t.n()).done;)e.value._update()}catch(i){t.e(i)}finally{t.f()}}},{key:"_updateAverageElevation",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(e){return t.transform.averageElevation=e,t._update(!1),!0};if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((i||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){var r=this.transform.averageElevation,a=this.transform.sampleAverageElevation(),o=!1;this.transform.elevation&&(o=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(a)?a=0:this._averageElevationLastSampledAt=e;var s=Math.abs(r-a);if(s>1){if(this._isInitialLoad||o)return this._averageElevation.jumpTo(a),n(a);this._averageElevation.easeTo(a,e,300)}else if(s>1e-4)return this._averageElevation.jumpTo(a),n(a)}return!!this._averageElevation.isEasing(e)&&n(this._averageElevation.getValue(e))}},{key:"_authenticate",value:function(){var t=this;e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(i){if(i&&(i.message===e.AUTH_ERR_MSG||401===i.status)){var n=t.painter.context.gl;e.storeAuthState(n,!1),t._logoControl instanceof aa&&t._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),t._silenceAuthErrors||t.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(){}))}},{key:"_updateTerrain",value:function(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}},{key:"_calculateSpeedIndex",value:function(){var e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());var i=this.painter.context.gl,n=i.createFramebuffer();function r(e){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0);var t=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,t),t}return i.bindFramebuffer(i.FRAMEBUFFER,n),this._canvasPixelComparison(r(e),t.canvasCopies.map(r),t.timeStamps)}},{key:"_canvasPixelComparison",value:function(e,t,i){for(var n=i[1]-i[0],r=e.length/4,a=0;a<t.length;a++){for(var o=t[a],s=0,l=0;l<o.length;l+=4)o[l]===e[l]&&o[l+1]===e[l+1]&&o[l+2]===e[l+2]&&o[l+3]===e[l+3]&&(s+=1);n+=(i[a+2]-i[a+1])*(1-s/r)}return n}},{key:"remove",value:function(){this._hash&&this._hash.remove();var t,i=p(this._controls);try{for(i.s();!(t=i.n()).done;)t.value.onRemove(this)}catch(r){i.e(r)}finally{i.f()}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),da(this._canvasContainer),da(this._controlContainer),da(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}},{key:"triggerRepaint",value:function(){this._triggerFrame(!0)}},{key:"_triggerFrame",value:function(t){var i=this;this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame((function(e){var t=!!i._renderNextFrame;i._frame=null,i._renderNextFrame=null,t&&i._render(e)})))}},{key:"_preloadTiles",value:function(t){var i=this,n=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(n,(function(e,i){return e._preloadTiles(t,i)}),(function(){i.triggerRepaint()})),this}},{key:"_onWindowOnline",value:function(){this._update()}},{key:"_onWindowResize",value:function(e){this._trackResize&&this.resize({originalEvent:e})._update()}},{key:"showTileBoundaries",get:function(){return!!this._showTileBoundaries},set:function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}},{key:"showTerrainWireframe",get:function(){return!!this._showTerrainWireframe},set:function(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}},{key:"speedIndexTiming",get:function(){return!!this._speedIndexTiming},set:function(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}},{key:"showPadding",get:function(){return!!this._showPadding},set:function(e){this._showPadding!==e&&(this._showPadding=e,this._update())}},{key:"showCollisionBoxes",get:function(){return!!this._showCollisionBoxes},set:function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}},{key:"showOverdrawInspector",get:function(){return!!this._showOverdrawInspector},set:function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}},{key:"repaint",get:function(){return!!this._repaint},set:function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}},{key:"vertices",get:function(){return!!this._vertices},set:function(e){this._vertices=e,this._update()}},{key:"_setCacheLimits",value:function(t,i){e.setCacheLimits(t,i)}},{key:"version",get:function(){return e.version}}]),c}(na),NavigationControl:function(){function t(i){var n=this;v(this,t),this.options=e.extend({},fa,i),this._container=g("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){n._map&&n._map.zoomIn({},{originalEvent:e})})),g("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){n._map&&n._map.zoomOut({},{originalEvent:e})})),g("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){var t=n._map;t&&(n.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=g("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}return y(t,[{key:"_updateZoomButtons",value:function(){var e=this._map;if(e){var t=e.getZoom(),i=t===e.getMaxZoom(),n=t===e.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}}},{key:"_rotateCompassArrow",value:function(){var e=this,t=this._map;if(t){var i=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(t.transform.pitch,"deg) rotateZ(").concat(t.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(t.transform.angle*(180/Math.PI),"deg)");t._requestDomTask((function(){e._compassIcon&&(e._compassIcon.style.transform=i)}))}}},{key:"onAdd",value:function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ma(e,this._compass,this.options.visualizePitch)),this._container}},{key:"onRemove",value:function(){var e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}},{key:"_createButton",value:function(e,t){var i=g("button",e,this._container);return i.type="button",i.addEventListener("click",t),i}},{key:"_setButtonTitle",value:function(e,t){if(this._map){var i=this._map._getUIString("NavigationControl.".concat(t));e.setAttribute("aria-label",i),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}}}]),t}(),GeolocateControl:function(t){f(n,t);var i=m(n);function n(t){var a;return v(this,n),(a=i.call(this)).options=e.extend({geolocation:e.window.navigator.geolocation},va,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],r(a)),a._updateMarkerRotationThrottled=or(a._updateMarkerRotation,20),a._numberOfWatches=0,a}return y(n,[{key:"onAdd",value:function(e){return this._map=e,this._container=g("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}},{key:"onRemove",value:function(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}},{key:"_checkGeolocationSupport",value:function(t){var i=this;void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){i._supportsGeolocation="denied"!==e.state,t(i._supportsGeolocation)})):(this._supportsGeolocation=!!this.options.geolocation,t(this._supportsGeolocation))}},{key:"_isOutOfMapMaxBounds",value:function(e){var t=this._map.getMaxBounds(),i=e.coords;return!!t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}},{key:"_setErrorState",value:function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}},{key:"_onSuccess",value:function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}},{key:"_updateCamera",value:function(t){var i=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=this._map.getBearing(),a=e.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(n),a,{geolocateSource:!0})}},{key:"_updateMarker",value:function(t){if(t){var i=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}},{key:"_updateCircleRadius",value:function(){var t=this._map.transform,i=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,n=Math.ceil(2*this._accuracy*i);this._circleElement.style.width="".concat(n,"px"),this._circleElement.style.height="".concat(n,"px")}},{key:"_onZoom",value:function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}},{key:"_updateMarkerRotation",value:function(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}},{key:"_onError",value:function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}},{key:"_finish",value:function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}},{key:"_setupUI",value:function(t){var i=this;if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=g("button","mapboxgl-ctrl-geolocate",this._container),g("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{var r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=g("div","mapboxgl-user-location"),this._dotElement.appendChild(g("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(g("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ua({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=g("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ua({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==i._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new e.Event("trackuserlocationend")))}))}},{key:"_onDeviceOrientation",value:function(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}},{key:"trigger",value:function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}},{key:"_addDeviceOrientationListener",value:function(){var t=this,i=function(){e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",t._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&i()})).catch(console.error):i()}},{key:"_clearWatch",value:function(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}}]),n}(e.Evented),AttributionControl:ra,ScaleControl:function(){function t(i){v(this,t),this.options=e.extend({},ya,i),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch(e){return!1}}()||(this._setScale=ga.bind(this)),e.bindAll(["_update","_setScale","setUnit"],this)}return y(t,[{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_update",value:function(){var e=this.options.maxWidth||100,t=this._map,i=t._containerHeight/2,n=t._containerWidth/2-e/2,r=t.unproject([n,i]),a=t.unproject([n+e,i]),o=r.distanceTo(a);if("imperial"===this.options.unit){var s=3.2808*o;s>5280?this._setScale(e,s/5280,"mile"):this._setScale(e,s,"foot")}else"nautical"===this.options.unit?this._setScale(e,o/1852,"nautical-mile"):o>=1e3?this._setScale(e,o/1e3,"kilometer"):this._setScale(e,o,"meter")}},{key:"_setScale",value:function(e,t,i){var n=this,r=_a(t),a=r/t;this._map._requestDomTask((function(){n._container.style.width=e*a+"px",n._container.innerHTML="nautical-mile"!==i?new Intl.NumberFormat(n._language,{style:"unit",unitDisplay:"narrow",unit:i}).format(r):"".concat(r,"&nbsp;nm")}))}},{key:"onAdd",value:function(e){return this._map=e,this._language=e.getLanguage(),this._container=g("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}},{key:"_setLanguage",value:function(e){this._language=e,this._update()}},{key:"setUnit",value:function(e){this.options.unit=e,this._update()}}]),t}(),FullscreenControl:function(){function t(i){v(this,t),this._fullscreen=!1,i&&i.container&&(i.container instanceof e.window.HTMLElement?this._container=i.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}return y(t,[{key:"onAdd",value:function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=g("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}},{key:"onRemove",value:function(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_checkFullscreenSupport",value:function(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}},{key:"_setupUI",value:function(){var t=this._fullscreenButton=g("button","mapboxgl-ctrl-fullscreen",this._controlContainer);g("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_updateTitle",value:function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}},{key:"_getTitle",value:function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}},{key:"_isFullscreen",value:function(){return this._fullscreen}},{key:"_changeIcon",value:function(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}},{key:"_onClickFullscreen",value:function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}}]),t}(),Popup:function(t){f(n,t);var i=m(n);function n(t){var a;return v(this,n),(a=i.call(this)).options=e.extend(Object.create(ba),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],r(a)),a._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[]),a}return y(n,[{key:"addTo",value:function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}},{key:"isOpen",value:function(){return!!this._map}},{key:"remove",value:function(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);var t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new e.Event("close")),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();var i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}},{key:"trackPointer",value:function(){this._trackPointer=!0,this._pos=null,this._update();var e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}},{key:"getElement",value:function(){return this._container}},{key:"setText",value:function(t){return this.setDOMContent(e.window.document.createTextNode(t))}},{key:"setHTML",value:function(t){var i,n=e.window.document.createDocumentFragment(),r=e.window.document.createElement("body");for(r.innerHTML=t;i=r.firstChild;)n.appendChild(i);return this.setDOMContent(n)}},{key:"getMaxWidth",value:function(){return this._container&&this._container.style.maxWidth}},{key:"setMaxWidth",value:function(e){return this.options.maxWidth=e,this._update(),this}},{key:"setDOMContent",value:function(e){var t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=g("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){var i=this._closeButton=g("button","mapboxgl-popup-close-button",t);i.type="button",i.setAttribute("aria-label","Close popup"),i.setAttribute("aria-hidden","true"),i.innerHTML="&#215;",i.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}},{key:"addClassName",value:function(e){return this._classList.add(e),this._updateClassList(),this}},{key:"removeClassName",value:function(e){return this._classList.delete(e),this._updateClassList(),this}},{key:"setOffset",value:function(e){return this.options.offset=e,this._update(),this}},{key:"toggleClassName",value:function(e){var t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}},{key:"_onMouseEvent",value:function(e){this._update(e.point)}},{key:"_getAnchor",value:function(e){if(this.options.anchor)return this.options.anchor;var t=this._map,i=this._container,n=this._pos;if(!t||!i||!n)return"bottom";var r=i.offsetWidth,a=i.offsetHeight,o=n.x<r/2,s=n.x>t.transform.width-r/2;if(n.y+e<a)return o?"top-left":s?"top-right":"top";if(n.y>t.transform.height-a){if(o)return"bottom-left";if(s)return"bottom-right"}return o?"left":s?"right":"bottom"}},{key:"_updateClassList",value:function(){var e=this._container;if(e){var t=c(this._classList);t.push("mapboxgl-popup"),this._anchor&&t.push("mapboxgl-popup-anchor-".concat(this._anchor)),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}}},{key:"_update",value:function(t){var i=this,n=this._map,r=this._content;if(n&&(this._lngLat||this._trackPointer)&&r){var a=this._container;if(a||(a=this._container=g("div","mapboxgl-popup",n.getContainer()),this._tip=g("div","mapboxgl-popup-tip",a),a.appendChild(r)),this.options.maxWidth&&a.style.maxWidth!==this.options.maxWidth&&(a.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=sa(this._lngLat,this._pos,n.transform)),!this._trackPointer||t){var o=this._pos=this._trackPointer&&t?t:n.project(this._lngLat),s=wa(this.options.offset),l=this._anchor=this._getAnchor(s.y),u=wa(this.options.offset,l),c=o.add(u).round();n._requestDomTask((function(){i._container&&l&&(i._container.style.transform="".concat(la[l]," translate(").concat(c.x,"px,").concat(c.y,"px)"))}))}if(!this._marker&&n._usingGlobe()){var h=e.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(h)}this._updateClassList()}}},{key:"_focusFirstElement",value:function(){if(this.options.focusAfterOpen&&this._container){var e=this._container.querySelector(xa);e&&e.focus()}}},{key:"_onClose",value:function(){this.remove()}},{key:"_setOpacity",value:function(e){this._container&&(this._container.style.opacity="".concat(e)),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}}]),n}(e.Evented),Marker:ua,Style:di,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.pointGeometry,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:$n,Evented:e.Evented,config:e.config,prewarm:function(){et().acquire(Je)},clearPrewarmedResources:function(){var e=$e;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Je),$e=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Qe.workerCount},set workerCount(e){Qe.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return ka})),i}()},1423:function(e,t,i){"use strict";var n=i(4613);function r(e,t,i){var r,s,l,u;t=t||1;for(var c=0;c<e[0].length;c++){var h=e[0][c];(!c||h[0]<r)&&(r=h[0]),(!c||h[1]<s)&&(s=h[1]),(!c||h[0]>l)&&(l=h[0]),(!c||h[1]>u)&&(u=h[1])}var p=l-r,d=u-s,f=Math.min(p,d),m=f/2;if(0===f){var v=[r,s];return v.distance=0,v}for(var y=new n(void 0,a),g=r;g<l;g+=f)for(var _=s;_<u;_+=f)y.push(new o(g+m,_+m,m,e));var b=function(e){for(var t=0,i=0,n=0,r=e[0],a=0,s=r.length,l=s-1;a<s;l=a++){var u=r[a],c=r[l],h=u[0]*c[1]-c[0]*u[1];i+=(u[0]+c[0])*h,n+=(u[1]+c[1])*h,t+=3*h}return 0===t?new o(r[0][0],r[0][1],0,e):new o(i/t,n/t,0,e)}(e),x=new o(r+p/2,s+d/2,0,e);x.d>b.d&&(b=x);for(var w=y.length;y.length;){var k=y.pop();k.d>b.d&&(b=k,i&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,w)),k.max-b.d<=t||(m=k.h/2,y.push(new o(k.x-m,k.y-m,m,e)),y.push(new o(k.x+m,k.y-m,m,e)),y.push(new o(k.x-m,k.y+m,m,e)),y.push(new o(k.x+m,k.y+m,m,e)),w+=4)}i&&(console.log("num probes: "+w),console.log("best distance: "+b.d));var P=[b.x,b.y];return P.distance=b.d,P}function a(e,t){return t.max-e.max}function o(e,t,i,n){this.x=e,this.y=t,this.h=i,this.d=function(e,t,i){for(var n=!1,r=1/0,a=0;a<i.length;a++)for(var o=i[a],l=0,u=o.length,c=u-1;l<u;c=l++){var h=o[l],p=o[c];h[1]>t!==p[1]>t&&e<(p[0]-h[0])*(t-h[1])/(p[1]-h[1])+h[0]&&(n=!n),r=Math.min(r,s(e,t,h,p))}return 0===r?0:(n?1:-1)*Math.sqrt(r)}(e,t,n),this.max=this.d+this.h*Math.SQRT2}function s(e,t,i,n){var r=i[0],a=i[1],o=n[0]-r,s=n[1]-a;if(0!==o||0!==s){var l=((e-r)*o+(t-a)*s)/(o*o+s*s);l>1?(r=n[0],a=n[1]):l>0&&(r+=o*l,a+=s*l)}return(o=e-r)*o+(s=t-a)*s}n.default&&(n=n.default),e.exports=r,e.exports.default=r},4501:function(e,t){"use strict";var i="function"===typeof Symbol&&Symbol.for,n=i?Symbol.for("react.element"):60103,r=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,o=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,u=i?Symbol.for("react.context"):60110,c=i?Symbol.for("react.async_mode"):60111,h=i?Symbol.for("react.concurrent_mode"):60111,p=i?Symbol.for("react.forward_ref"):60112,d=i?Symbol.for("react.suspense"):60113,f=i?Symbol.for("react.suspense_list"):60120,m=i?Symbol.for("react.memo"):60115,v=i?Symbol.for("react.lazy"):60116,y=i?Symbol.for("react.block"):60121,g=i?Symbol.for("react.fundamental"):60117,_=i?Symbol.for("react.responder"):60118,b=i?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case c:case h:case a:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case u:case p:case v:case m:case l:return e;default:return t}}case r:return t}}}function w(e){return x(e)===h}t.isFragment=function(e){return x(e)===a},t.isMemo=function(e){return x(e)===m}},3873:function(e,t,i){"use strict";e.exports=i(4501)},4463:function(e,t,i){"use strict";var n=i(2791),r=i(5296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function m(e,t,i,n,r,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function _(e,t,i,n){var r=v.hasOwnProperty(t)?v[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!h.call(f,e)||!h.call(d,e)&&(p.test(e)?f[e]=!0:(d[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,g);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,g);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,g);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var R,F=Object.assign;function j(e){if(void 0===R)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var B=!1;function V(e,t){if(!e||B)return"";B=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&"string"===typeof u.stack){for(var r=u.stack.split("\n"),a=n.stack.split("\n"),o=r.length-1,s=a.length-1;1<=o&&0<=s&&r[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(r[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||r[o]!==a[s]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?j(e):""}function N(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case w:return"Portal";case S:return"Profiler";case P:return"StrictMode";case M:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(i){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,a=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=H(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var i=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function Y(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=W(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function J(e,t){$(e,t);var i=W(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&X(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+W(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(a(92));if(te(i)){if(1<i.length)throw Error(a(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:W(i)}}function ae(e,t){var i=W(t.value),n=W(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function pe(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ve(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=me(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(de).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,ke=null,Pe=null;function Se(e){if(e=_r(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=xr(t),we(e.stateNode,e.type,t))}}function Te(e){ke?Pe?Pe.push(e):Pe=[e]:ke=e}function Ee(){if(ke){var e=ke,t=Pe;if(Pe=ke=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ce(e,t){return e(t)}function Me(){}var Ie=!1;function Oe(e,t,i){if(Ie)return e(t,i);Ie=!0;try{return Ce(e,t,i)}finally{Ie=!1,(null!==ke||null!==Pe)&&(Me(),Ee())}}function De(e,t){var i=e.stateNode;if(null===i)return null;var n=xr(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(a(231,t,typeof i));return i}var Ae=!1;if(c)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ce){Ae=!1}function ze(e,t,i,n,r,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(i,u)}catch(c){this.onError(c)}}var Re=!1,Fe=null,je=!1,Be=null,Ve={onError:function(e){Re=!0,Fe=e}};function Ne(e,t,i,n,r,a,o,s,l){Re=!1,Fe=null,ze.apply(Ve,arguments)}function Ue(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(a(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(n=r.return)){i=n;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===i)return We(r),e;if(o===n)return We(r),t;o=o.sibling}throw Error(a(188))}if(i.return!==n.return)i=r,n=o;else{for(var s=!1,l=r.child;l;){if(l===i){s=!0,i=r,n=o;break}if(l===n){s=!0,n=r,i=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===i){s=!0,i=o,n=r;break}if(l===n){s=!0,n=o,i=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(i.alternate!==n)throw Error(a(190))}if(3!==i.tag)throw Error(a(188));return i.stateNode.current===i?e:t}(e))?Ze(e):null}function Ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ze(e);if(null!==t)return t;e=e.sibling}return null}var qe=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,Ye=r.unstable_requestPaint,$e=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,it=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,a=e.pingedLanes,o=268435455&i;if(0!==o){var s=o&~r;0!==s?n=ht(s):0!==(a&=o)&&(n=ht(a))}else 0!==(o=i&~r)?n=ht(o):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(a=t&-t)||16===r&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-ot(t)),n|=e[i],t&=~r;return n}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function vt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function yt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=i}function gt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-ot(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,kt,Pt,St,Tt=!1,Et=[],Ct=null,Mt=null,It=null,Ot=new Map,Dt=new Map,At=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Rt(e,t,i,n,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=_r(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=gr(e.target);if(null!==t){var i=Ue(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ge(i)))return e.blockedOn=t,void St(e.priority,(function(){kt(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=_r(i))&&wt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);be=n,i.target.dispatchEvent(n),be=null,t.shift()}return!0}function Bt(e,t,i){jt(e)&&i.delete(t)}function Vt(){Tt=!1,null!==Ct&&jt(Ct)&&(Ct=null),null!==Mt&&jt(Mt)&&(Mt=null),null!==It&&jt(It)&&(It=null),Ot.forEach(Bt),Dt.forEach(Bt)}function Nt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vt)))}function Ut(e){function t(t){return Nt(t,e)}if(0<Et.length){Nt(Et[0],e);for(var i=1;i<Et.length;i++){var n=Et[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&Nt(Ct,e),null!==Mt&&Nt(Mt,e),null!==It&&Nt(It,e),Ot.forEach(t),Dt.forEach(t),i=0;i<At.length;i++)(n=At[i]).blockedOn===e&&(n.blockedOn=null);for(;0<At.length&&null===(i=At[0]).blockedOn;)Ft(i),null===i.blockedOn&&At.shift()}var Gt=b.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,i,n){var r=_t,a=Gt.transition;Gt.transition=null;try{_t=1,qt(e,t,i,n)}finally{_t=r,Gt.transition=a}}function Zt(e,t,i,n){var r=_t,a=Gt.transition;Gt.transition=null;try{_t=4,qt(e,t,i,n)}finally{_t=r,Gt.transition=a}}function qt(e,t,i,n){if(Wt){var r=Kt(e,t,i,n);if(null===r)Wn(e,t,n,Xt,i),zt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return Ct=Rt(Ct,e,t,i,n,r),!0;case"dragenter":return Mt=Rt(Mt,e,t,i,n,r),!0;case"mouseover":return It=Rt(It,e,t,i,n,r),!0;case"pointerover":var a=r.pointerId;return Ot.set(a,Rt(Ot.get(a)||null,e,t,i,n,r)),!0;case"gotpointercapture":return a=r.pointerId,Dt.set(a,Rt(Dt.get(a)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(zt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var a=_r(r);if(null!==a&&xt(a),null===(a=Kt(e,t,i,n))&&Wn(e,t,n,Xt,i),a===r)break;r=a}null!==r&&n.stopPropagation()}else Wn(e,t,n,null,i)}}var Xt=null;function Kt(e,t,i,n){if(Xt=null,null!==(e=gr(e=xe(n))))if(null===(t=Ue(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Qt=null;function ei(){if(Qt)return Qt;var e,t,i=Jt,n=i.length,r="value"in $t?$t.value:$t.textContent,a=r.length;for(e=0;e<n&&i[e]===r[e];e++);var o=n-e;for(t=1;t<=o&&i[n-t]===r[a-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ri(e){function t(t,i,n,r,a){for(var o in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var ai,oi,si,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ui=ri(li),ci=F({},li,{view:0,detail:0}),hi=ri(ci),pi=F({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==si&&(si&&"mousemove"===e.type?(ai=e.screenX-si.screenX,oi=e.screenY-si.screenY):oi=ai=0,si=e),ai)},movementY:function(e){return"movementY"in e?e.movementY:oi}}),di=ri(pi),fi=ri(F({},pi,{dataTransfer:0})),mi=ri(F({},ci,{relatedTarget:0})),vi=ri(F({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=F({},li,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gi=ri(yi),_i=ri(F({},li,{data:0})),bi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ki(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wi[e])&&!!t[e]}function Pi(){return ki}var Si=F({},ci,{key:function(e){if(e.key){var t=bi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pi,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ti=ri(Si),Ei=ri(F({},pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ci=ri(F({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pi})),Mi=ri(F({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ii=F({},pi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Oi=ri(Ii),Di=[9,13,27,32],Ai=c&&"CompositionEvent"in window,Li=null;c&&"documentMode"in document&&(Li=document.documentMode);var zi=c&&"TextEvent"in window&&!Li,Ri=c&&(!Ai||Li&&8<Li&&11>=Li),Fi=String.fromCharCode(32),ji=!1;function Bi(e,t){switch(e){case"keyup":return-1!==Di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vi(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ni=!1;var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ui[e.type]:"textarea"===t}function Wi(e,t,i,n){Te(n),0<(t=Zn(t,"onChange")).length&&(i=new ui("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Hi=null,Zi=null;function qi(e){jn(e,0)}function Xi(e){if(q(br(e)))return e}function Ki(e,t){if("change"===e)return t}var Yi=!1;if(c){var $i;if(c){var Ji="oninput"in document;if(!Ji){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),Ji="function"===typeof Qi.oninput}$i=Ji}else $i=!1;Yi=$i&&(!document.documentMode||9<document.documentMode)}function en(){Hi&&(Hi.detachEvent("onpropertychange",tn),Zi=Hi=null)}function tn(e){if("value"===e.propertyName&&Xi(Zi)){var t=[];Wi(t,Zi,e,xe(e)),Oe(qi,t)}}function nn(e,t,i){"focusin"===e?(en(),Zi=i,(Hi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xi(Zi)}function an(e,t){if("click"===e)return Xi(t)}function on(e,t){if("input"===e||"change"===e)return Xi(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!h.call(t,r)||!sn(e[r],t[r]))return!1}return!0}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cn(e,t){var i,n=un(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=un(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pn(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=X((e=t.contentWindow).document)}return t}function dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=pn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&hn(i.ownerDocument.documentElement,i)){if(null!==n&&dn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,a=Math.min(n.start,r);n=void 0===n.end?a:Math.min(n.end,r),!e.extend&&a>n&&(r=n,n=a,a=r),r=cn(i,a);var o=cn(i,n);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=c&&"documentMode"in document&&11>=document.documentMode,vn=null,yn=null,gn=null,_n=!1;function bn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;_n||null==vn||vn!==X(n)||("selectionStart"in(n=vn)&&dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},gn&&ln(gn,n)||(gn=n,0<(n=Zn(yn,"onSelect")).length&&(t=new ui("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=vn)))}function xn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wn={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionend:xn("Transition","TransitionEnd")},kn={},Pn={};function Sn(e){if(kn[e])return kn[e];if(!wn[e])return e;var t,i=wn[e];for(t in i)if(i.hasOwnProperty(t)&&t in Pn)return kn[e]=i[t];return e}c&&(Pn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Tn=Sn("animationend"),En=Sn("animationiteration"),Cn=Sn("animationstart"),Mn=Sn("transitionend"),In=new Map,On="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dn(e,t){In.set(e,t),l(t,[e])}for(var An=0;An<On.length;An++){var Ln=On[An];Dn(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}Dn(Tn,"onAnimationEnd"),Dn(En,"onAnimationIteration"),Dn(Cn,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(Mn,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rn=new Set("cancel close invalid load scroll toggle".split(" ").concat(zn));function Fn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,o,s,l,u){if(Ne.apply(this,arguments),Re){if(!Re)throw Error(a(198));var c=Fe;Re=!1,Fe=null,je||(je=!0,Be=c)}}(n,t,void 0,e),e.currentTarget=null}function jn(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&r.isPropagationStopped())break e;Fn(r,s,u),a=l}else for(o=0;o<n.length;o++){if(l=(s=n[o]).instance,u=s.currentTarget,s=s.listener,l!==a&&r.isPropagationStopped())break e;Fn(r,s,u),a=l}}}if(je)throw e=Be,je=!1,Be=null,e}function Bn(e,t){var i=t[mr];void 0===i&&(i=t[mr]=new Set);var n=e+"__bubble";i.has(n)||(Gn(t,e,2,!1),i.add(n))}function Vn(e,t,i){var n=0;t&&(n|=4),Gn(i,e,n,t)}var Nn="_reactListening"+Math.random().toString(36).slice(2);function Un(e){if(!e[Nn]){e[Nn]=!0,o.forEach((function(t){"selectionchange"!==t&&(Rn.has(t)||Vn(t,!1,e),Vn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Nn]||(t[Nn]=!0,Vn("selectionchange",!1,t))}}function Gn(e,t,i,n){switch(Yt(t)){case 1:var r=Ht;break;case 4:r=Zt;break;default:r=qt}i=r.bind(null,t,i,e),r=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Wn(e,t,i,n,r){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===o)for(o=n.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==s;){if(null===(o=gr(s)))return;if(5===(l=o.tag)||6===l){n=a=o;continue e}s=s.parentNode}}n=n.return}Oe((function(){var n=a,r=xe(i),o=[];e:{var s=In.get(e);if(void 0!==s){var l=ui,u=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":l=Ti;break;case"focusin":u="focus",l=mi;break;case"focusout":u="blur",l=mi;break;case"beforeblur":case"afterblur":l=mi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=di;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ci;break;case Tn:case En:case Cn:l=vi;break;case Mn:l=Mi;break;case"scroll":l=hi;break;case"wheel":l=Oi;break;case"copy":case"cut":case"paste":l=gi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ei}var c=0!==(4&t),h=!c&&"scroll"===e,p=c?null!==s?s+"Capture":null:s;c=[];for(var d,f=n;null!==f;){var m=(d=f).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==p&&(null!=(m=De(f,p))&&c.push(Hn(f,m,d)))),h)break;f=f.return}0<c.length&&(s=new l(s,u,null,i,r),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||i===be||!(u=i.relatedTarget||i.fromElement)||!gr(u)&&!u[fr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(u=(u=i.relatedTarget||i.toElement)?gr(u):null)&&(u!==(h=Ue(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=n),l!==u)){if(c=di,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Ei,m="onPointerLeave",p="onPointerEnter",f="pointer"),h=null==l?s:br(l),d=null==u?s:br(u),(s=new c(m,f+"leave",l,i,r)).target=h,s.relatedTarget=d,m=null,gr(r)===n&&((c=new c(p,f+"enter",u,i,r)).target=d,c.relatedTarget=h,m=c),h=m,l&&u)e:{for(p=u,f=0,d=c=l;d;d=qn(d))f++;for(d=0,m=p;m;m=qn(m))d++;for(;0<f-d;)c=qn(c),f--;for(;0<d-f;)p=qn(p),d--;for(;f--;){if(c===p||null!==p&&c===p.alternate)break e;c=qn(c),p=qn(p)}c=null}else c=null;null!==l&&Xn(o,s,l,c,!1),null!==u&&null!==h&&Xn(o,h,u,c,!0)}if("select"===(l=(s=n?br(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var v=Ki;else if(Gi(s))if(Yi)v=on;else{v=rn;var y=nn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=an);switch(v&&(v=v(e,n))?Wi(o,v,i,r):(y&&y(e,s,n),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=n?br(n):window,e){case"focusin":(Gi(y)||"true"===y.contentEditable)&&(vn=y,yn=n,gn=null);break;case"focusout":gn=yn=vn=null;break;case"mousedown":_n=!0;break;case"contextmenu":case"mouseup":case"dragend":_n=!1,bn(o,i,r);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":bn(o,i,r)}var g;if(Ai)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Ni?Bi(e,i)&&(_="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(_="onCompositionStart");_&&(Ri&&"ko"!==i.locale&&(Ni||"onCompositionStart"!==_?"onCompositionEnd"===_&&Ni&&(g=ei()):(Jt="value"in($t=r)?$t.value:$t.textContent,Ni=!0)),0<(y=Zn(n,_)).length&&(_=new _i(_,e,null,i,r),o.push({event:_,listeners:y}),g?_.data=g:null!==(g=Vi(i))&&(_.data=g))),(g=zi?function(e,t){switch(e){case"compositionend":return Vi(t);case"keypress":return 32!==t.which?null:(ji=!0,Fi);case"textInput":return(e=t.data)===Fi&&ji?null:e;default:return null}}(e,i):function(e,t){if(Ni)return"compositionend"===e||!Ai&&Bi(e,t)?(e=ei(),Qt=Jt=$t=null,Ni=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ri&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Zn(n,"onBeforeInput")).length&&(r=new _i("onBeforeInput","beforeinput",null,i,r),o.push({event:r,listeners:n}),r.data=g))}jn(o,t)}))}function Hn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Zn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=De(e,i))&&n.unshift(Hn(e,a,r)),null!=(a=De(e,t))&&n.push(Hn(e,a,r))),e=e.return}return n}function qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xn(e,t,i,n,r){for(var a=t._reactName,o=[];null!==i&&i!==n;){var s=i,l=s.alternate,u=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==u&&(s=u,r?null!=(l=De(i,a))&&o.unshift(Hn(i,l,s)):r||null!=(l=De(i,a))&&o.push(Hn(i,l,s))),i=i.return}0!==o.length&&e.push({event:t,listeners:o})}var Kn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function $n(e){return("string"===typeof e?e:""+e).replace(Kn,"\n").replace(Yn,"")}function Jn(e,t,i){if(t=$n(t),$n(e)!==t&&i)throw Error(a(425))}function Qn(){}var er=null,tr=null;function ir(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(sr)}:nr;function sr(e){setTimeout((function(){throw e}))}function lr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Ut(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Ut(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),pr="__reactFiber$"+hr,dr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,vr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function gr(e){var t=e[pr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[fr]||i[pr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=cr(e);null!==e;){if(i=e[pr])return i;e=cr(e)}return t}i=(e=i).parentNode}return null}function _r(e){return!(e=e[pr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function xr(e){return e[dr]||null}var wr=[],kr=-1;function Pr(e){return{current:e}}function Sr(e){0>kr||(e.current=wr[kr],wr[kr]=null,kr--)}function Tr(e,t){kr++,wr[kr]=e.current,e.current=t}var Er={},Cr=Pr(Er),Mr=Pr(!1),Ir=Er;function Or(e,t){var i=e.type.contextTypes;if(!i)return Er;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in i)a[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ar(){Sr(Mr),Sr(Cr)}function Lr(e,t,i){if(Cr.current!==Er)throw Error(a(168));Tr(Cr,t),Tr(Mr,i)}function zr(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(a(108,G(e)||"Unknown",r));return F({},i,n)}function Rr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Er,Ir=Cr.current,Tr(Cr,e),Tr(Mr,Mr.current),!0}function Fr(e,t,i){var n=e.stateNode;if(!n)throw Error(a(169));i?(e=zr(e,t,Ir),n.__reactInternalMemoizedMergedChildContext=e,Sr(Mr),Sr(Cr),Tr(Cr,e)):Sr(Mr),Tr(Mr,i)}var jr=null,Br=!1,Vr=!1;function Nr(e){null===jr?jr=[e]:jr.push(e)}function Ur(){if(!Vr&&null!==jr){Vr=!0;var e=0,t=_t;try{var i=jr;for(_t=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}jr=null,Br=!1}catch(r){throw null!==jr&&(jr=jr.slice(e+1)),qe(Qe,Ur),r}finally{_t=t,Vr=!1}}return null}var Gr=[],Wr=0,Hr=null,Zr=0,qr=[],Xr=0,Kr=null,Yr=1,$r="";function Jr(e,t){Gr[Wr++]=Zr,Gr[Wr++]=Hr,Hr=e,Zr=t}function Qr(e,t,i){qr[Xr++]=Yr,qr[Xr++]=$r,qr[Xr++]=Kr,Kr=e;var n=Yr;e=$r;var r=32-ot(n)-1;n&=~(1<<r),i+=1;var a=32-ot(t)+r;if(30<a){var o=r-r%5;a=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Yr=1<<32-ot(t)+r|i<<r|n,$r=a+e}else Yr=1<<a|i<<r|n,$r=e}function ea(e){null!==e.return&&(Jr(e,1),Qr(e,1,0))}function ta(e){for(;e===Hr;)Hr=Gr[--Wr],Gr[Wr]=null,Zr=Gr[--Wr],Gr[Wr]=null;for(;e===Kr;)Kr=qr[--Xr],qr[Xr]=null,$r=qr[--Xr],qr[Xr]=null,Yr=qr[--Xr],qr[Xr]=null}var ia=null,na=null,ra=!1,aa=null;function oa(e,t){var i=Ou(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function sa(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ia=e,na=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ia=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Kr?{id:Yr,overflow:$r}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Ou(18,null,null,0)).stateNode=t,i.return=e,e.child=i,ia=e,na=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ua(e){if(ra){var t=na;if(t){var i=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=ur(i.nextSibling);var n=ia;t&&sa(e,t)?oa(n,i):(e.flags=-4097&e.flags|2,ra=!1,ia=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ra=!1,ia=e}}}function ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ia=e}function ha(e){if(e!==ia)return!1;if(!ra)return ca(e),ra=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ir(e.type,e.memoizedProps)),t&&(t=na)){if(la(e))throw pa(),Error(a(418));for(;t;)oa(e,t),t=ur(t.nextSibling)}if(ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){na=ur(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}na=null}}else na=ia?ur(e.stateNode.nextSibling):null;return!0}function pa(){for(var e=na;e;)e=ur(e.nextSibling)}function da(){na=ia=null,ra=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=b.ReactCurrentBatchConfig;function va(e,t){if(e&&e.defaultProps){for(var i in t=F({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var ya=Pr(null),ga=null,_a=null,ba=null;function xa(){ba=_a=ga=null}function wa(e){var t=ya.current;Sr(ya),e._currentValue=t}function ka(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Pa(e,t){ga=e,ba=_a=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(ba!==e)if(e={context:e,memoizedValue:t,next:null},null===_a){if(null===ga)throw Error(a(308));_a=e,ga.dependencies={lanes:0,firstContext:e}}else _a=_a.next=e;return t}var Ta=null;function Ea(e){null===Ta?Ta=[e]:Ta.push(e)}function Ca(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,Ea(t)):(i.next=r.next,r.next=i),t.interleaved=i,Ma(e,n)}function Ma(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Ia=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Da(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Cl)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Ma(e,i)}return null===(r=n.interleaved)?(t.next=t,Ea(n)):(t.next=r.next,r.next=t),n.interleaved=t,Ma(e,i)}function za(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,gt(e,i)}}function Ra(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===a?r=a=o:a=a.next=o,i=i.next}while(null!==i);null===a?r=a=t:a=a.next=t}else r=a=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Fa(e,t,i,n){var r=e.updateQueue;Ia=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,u=l.next;l.next=null,null===o?a=u:o.next=u,o=l;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==a){var h=r.baseState;for(o=0,c=u=l=null,s=a;;){var p=s.lane,d=s.eventTime;if((n&p)===p){null!==c&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(p=t,d=i,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(d,h,p);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(d,h,p):f)||void 0===p)break e;h=F({},h,p);break e;case 2:Ia=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[s]:p.push(s))}else d={eventTime:d,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=d,l=h):c=c.next=d,o|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(p=s).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Rl|=o,e.lanes=o,e.memoizedState=h}}function ja(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(a(191,r));r.call(n)}}}var Ba=(new n.Component).refs;function Va(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:F({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var Na={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=eu(),r=tu(e),a=Aa(n,r);a.payload=t,void 0!==i&&null!==i&&(a.callback=i),null!==(t=La(e,a,r))&&(iu(t,e,r,n),za(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=eu(),r=tu(e),a=Aa(n,r);a.tag=1,a.payload=t,void 0!==i&&null!==i&&(a.callback=i),null!==(t=La(e,a,r))&&(iu(t,e,r,n),za(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=eu(),n=tu(e),r=Aa(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=La(e,r,n))&&(iu(t,e,n,i),za(t,e,n))}};function Ua(e,t,i,n,r,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ln(i,n)||!ln(r,a))}function Ga(e,t,i){var n=!1,r=Er,a=t.contextType;return"object"===typeof a&&null!==a?a=Sa(a):(r=Dr(t)?Ir:Cr.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?Or(e,r):Er),t=new t(i,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Na,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wa(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Na.enqueueReplaceState(t,t.state,null)}function Ha(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=Ba,Oa(e);var a=t.contextType;"object"===typeof a&&null!==a?r.context=Sa(a):(a=Dr(t)?Ir:Cr.current,r.context=Or(e,a)),r.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Va(e,t,a,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Na.enqueueReplaceState(r,r.state,null),Fa(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Za(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(a(309));var n=i.stateNode}if(!n)throw Error(a(147,e));var r=n,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===Ba&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!i._owner)throw Error(a(290,e))}return e}function qa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xa(e){return(0,e._init)(e._payload)}function Ka(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Au(e,t)).index=0,e.sibling=null,e}function o(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=Fu(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function u(e,t,i,n){var a=i.type;return a===k?h(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&Xa(a)===t.type)?((n=r(t,i.props)).ref=Za(e,t,i),n.return=e,n):((n=Lu(i.type,i.key,i.props,null,e.mode,n)).ref=Za(e,t,i),n.return=e,n)}function c(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=ju(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function h(e,t,i,n,a){return null===t||7!==t.tag?((t=zu(i,e.mode,n,a)).return=e,t):((t=r(t,i)).return=e,t)}function p(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fu(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(i=Lu(t.type,t.key,t.props,null,e.mode,i)).ref=Za(e,null,t),i.return=e,i;case w:return(t=ju(t,e.mode,i)).return=e,t;case D:return p(e,(0,t._init)(t._payload),i)}if(te(t)||z(t))return(t=zu(t,e.mode,i,null)).return=e,t;qa(e,t)}return null}function d(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:l(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return i.key===r?u(e,t,i,n):null;case w:return i.key===r?c(e,t,i,n):null;case D:return d(e,t,(r=i._init)(i._payload),n)}if(te(i)||z(i))return null!==r?null:h(e,t,i,n,null);qa(e,i)}return null}function f(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return u(t,e=e.get(null===n.key?i:n.key)||null,n,r);case w:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case D:return f(e,t,i,(0,n._init)(n._payload),r)}if(te(n)||z(n))return h(t,e=e.get(i)||null,n,r,null);qa(t,n)}return null}function m(r,a,s,l){for(var u=null,c=null,h=a,m=a=0,v=null;null!==h&&m<s.length;m++){h.index>m?(v=h,h=null):v=h.sibling;var y=d(r,h,s[m],l);if(null===y){null===h&&(h=v);break}e&&h&&null===y.alternate&&t(r,h),a=o(y,a,m),null===c?u=y:c.sibling=y,c=y,h=v}if(m===s.length)return i(r,h),ra&&Jr(r,m),u;if(null===h){for(;m<s.length;m++)null!==(h=p(r,s[m],l))&&(a=o(h,a,m),null===c?u=h:c.sibling=h,c=h);return ra&&Jr(r,m),u}for(h=n(r,h);m<s.length;m++)null!==(v=f(h,r,m,s[m],l))&&(e&&null!==v.alternate&&h.delete(null===v.key?m:v.key),a=o(v,a,m),null===c?u=v:c.sibling=v,c=v);return e&&h.forEach((function(e){return t(r,e)})),ra&&Jr(r,m),u}function v(r,s,l,u){var c=z(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var h=c=null,m=s,v=s=0,y=null,g=l.next();null!==m&&!g.done;v++,g=l.next()){m.index>v?(y=m,m=null):y=m.sibling;var _=d(r,m,g.value,u);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(r,m),s=o(_,s,v),null===h?c=_:h.sibling=_,h=_,m=y}if(g.done)return i(r,m),ra&&Jr(r,v),c;if(null===m){for(;!g.done;v++,g=l.next())null!==(g=p(r,g.value,u))&&(s=o(g,s,v),null===h?c=g:h.sibling=g,h=g);return ra&&Jr(r,v),c}for(m=n(r,m);!g.done;v++,g=l.next())null!==(g=f(m,r,v,g.value,u))&&(e&&null!==g.alternate&&m.delete(null===g.key?v:g.key),s=o(g,s,v),null===h?c=g:h.sibling=g,h=g);return e&&m.forEach((function(e){return t(r,e)})),ra&&Jr(r,v),c}return function e(n,a,o,l){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var u=o.key,c=a;null!==c;){if(c.key===u){if((u=o.type)===k){if(7===c.tag){i(n,c.sibling),(a=r(c,o.props.children)).return=n,n=a;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===D&&Xa(u)===c.type){i(n,c.sibling),(a=r(c,o.props)).ref=Za(n,c,o),a.return=n,n=a;break e}i(n,c);break}t(n,c),c=c.sibling}o.type===k?((a=zu(o.props.children,n.mode,l,o.key)).return=n,n=a):((l=Lu(o.type,o.key,o.props,null,n.mode,l)).ref=Za(n,a,o),l.return=n,n=l)}return s(n);case w:e:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){i(n,a.sibling),(a=r(a,o.children||[])).return=n,n=a;break e}i(n,a);break}t(n,a),a=a.sibling}(a=ju(o,n.mode,l)).return=n,n=a}return s(n);case D:return e(n,a,(c=o._init)(o._payload),l)}if(te(o))return m(n,a,o,l);if(z(o))return v(n,a,o,l);qa(n,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(i(n,a.sibling),(a=r(a,o)).return=n,n=a):(i(n,a),(a=Fu(o,n.mode,l)).return=n,n=a),s(n)):i(n,a)}}var Ya=Ka(!0),$a=Ka(!1),Ja={},Qa=Pr(Ja),eo=Pr(Ja),to=Pr(Ja);function io(e){if(e===Ja)throw Error(a(174));return e}function no(e,t){switch(Tr(to,t),Tr(eo,e),Tr(Qa,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sr(Qa),Tr(Qa,t)}function ro(){Sr(Qa),Sr(eo),Sr(to)}function ao(e){io(to.current);var t=io(Qa.current),i=le(t,e.type);t!==i&&(Tr(eo,e),Tr(Qa,i))}function oo(e){eo.current===e&&(Sr(Qa),Sr(eo))}var so=Pr(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uo=[];function co(){for(var e=0;e<uo.length;e++)uo[e]._workInProgressVersionPrimary=null;uo.length=0}var ho=b.ReactCurrentDispatcher,po=b.ReactCurrentBatchConfig,fo=0,mo=null,vo=null,yo=null,go=!1,_o=!1,bo=0,xo=0;function wo(){throw Error(a(321))}function ko(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!sn(e[i],t[i]))return!1;return!0}function Po(e,t,i,n,r,o){if(fo=o,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?ss:ls,e=i(n,r),_o){o=0;do{if(_o=!1,bo=0,25<=o)throw Error(a(301));o+=1,yo=vo=null,t.updateQueue=null,ho.current=us,e=i(n,r)}while(_o)}if(ho.current=os,t=null!==vo&&null!==vo.next,fo=0,yo=vo=mo=null,go=!1,t)throw Error(a(300));return e}function So(){var e=0!==bo;return bo=0,e}function To(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?mo.memoizedState=yo=e:yo=yo.next=e,yo}function Eo(){if(null===vo){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=vo.next;var t=null===yo?mo.memoizedState:yo.next;if(null!==t)yo=t,vo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(vo=e).memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},null===yo?mo.memoizedState=yo=e:yo=yo.next=e}return yo}function Co(e,t){return"function"===typeof t?t(e):t}function Mo(e){var t=Eo(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=vo,r=n.baseQueue,o=i.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}n.baseQueue=r=o,i.pending=null}if(null!==r){o=r.next,n=n.baseState;var l=s=null,u=null,c=o;do{var h=c.lane;if((fo&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var p={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=p,s=n):u=u.next=p,mo.lanes|=h,Rl|=h}c=c.next}while(null!==c&&c!==o);null===u?s=n:u.next=l,sn(n,t.memoizedState)||(bs=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{o=r.lane,mo.lanes|=o,Rl|=o,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Io(e){var t=Eo(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,o=t.memoizedState;if(null!==r){i.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);sn(o,t.memoizedState)||(bs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,n]}function Oo(){}function Do(e,t){var i=mo,n=Eo(),r=t(),o=!sn(n.memoizedState,r);if(o&&(n.memoizedState=r,bs=!0),n=n.queue,Wo(zo.bind(null,i,n,e),[e]),n.getSnapshot!==t||o||null!==yo&&1&yo.memoizedState.tag){if(i.flags|=2048,Bo(9,Lo.bind(null,i,n,r,t),void 0,null),null===Ml)throw Error(a(349));0!==(30&fo)||Ao(i,t,r)}return r}function Ao(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Lo(e,t,i,n){t.value=i,t.getSnapshot=n,Ro(t)&&Fo(e)}function zo(e,t,i){return i((function(){Ro(t)&&Fo(e)}))}function Ro(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!sn(e,i)}catch(n){return!0}}function Fo(e){var t=Ma(e,1);null!==t&&iu(t,e,1,-1)}function jo(e){var t=To();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=is.bind(null,mo,e),[t.memoizedState,e]}function Bo(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Vo(){return Eo().memoizedState}function No(e,t,i,n){var r=To();mo.flags|=e,r.memoizedState=Bo(1|t,i,void 0,void 0===n?null:n)}function Uo(e,t,i,n){var r=Eo();n=void 0===n?null:n;var a=void 0;if(null!==vo){var o=vo.memoizedState;if(a=o.destroy,null!==n&&ko(n,o.deps))return void(r.memoizedState=Bo(t,i,a,n))}mo.flags|=e,r.memoizedState=Bo(1|t,i,a,n)}function Go(e,t){return No(8390656,8,e,t)}function Wo(e,t){return Uo(2048,8,e,t)}function Ho(e,t){return Uo(4,2,e,t)}function Zo(e,t){return Uo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Uo(4,4,qo.bind(null,t,e),i)}function Ko(){}function Yo(e,t){var i=Eo();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&ko(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function $o(e,t){var i=Eo();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&ko(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Jo(e,t,i){return 0===(21&fo)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=i):(sn(i,t)||(i=mt(),mo.lanes|=i,Rl|=i,e.baseState=!0),t)}function Qo(e,t){var i=_t;_t=0!==i&&4>i?i:4,e(!0);var n=po.transition;po.transition={};try{e(!1),t()}finally{_t=i,po.transition=n}}function es(){return Eo().memoizedState}function ts(e,t,i){var n=tu(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},ns(e))rs(t,i);else if(null!==(i=Ca(e,t,i,n))){iu(i,e,n,eu()),as(i,t,n)}}function is(e,t,i){var n=tu(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(ns(e))rs(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,i);if(r.hasEagerState=!0,r.eagerState=s,sn(s,o)){var l=t.interleaved;return null===l?(r.next=r,Ea(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(u){}null!==(i=Ca(e,t,r,n))&&(iu(i,e,n,r=eu()),as(i,t,n))}}function ns(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function rs(e,t){_o=go=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function as(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,gt(e,i)}}var os={readContext:Sa,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},ss={readContext:Sa,useCallback:function(e,t){return To().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:Go,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,No(4194308,4,qo.bind(null,t,e),i)},useLayoutEffect:function(e,t){return No(4194308,4,e,t)},useInsertionEffect:function(e,t){return No(4,2,e,t)},useMemo:function(e,t){var i=To();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=To();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ts.bind(null,mo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},To().memoizedState=e},useState:jo,useDebugValue:Ko,useDeferredValue:function(e){return To().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=Qo.bind(null,e[1]),To().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=mo,r=To();if(ra){if(void 0===i)throw Error(a(407));i=i()}else{if(i=t(),null===Ml)throw Error(a(349));0!==(30&fo)||Ao(n,t,i)}r.memoizedState=i;var o={value:i,getSnapshot:t};return r.queue=o,Go(zo.bind(null,n,o,e),[e]),n.flags|=2048,Bo(9,Lo.bind(null,n,o,i,t),void 0,null),i},useId:function(){var e=To(),t=Ml.identifierPrefix;if(ra){var i=$r;t=":"+t+"R"+(i=(Yr&~(1<<32-ot(Yr)-1)).toString(32)+i),0<(i=bo++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=xo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:Sa,useCallback:Yo,useContext:Sa,useEffect:Wo,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:Zo,useMemo:$o,useReducer:Mo,useRef:Vo,useState:function(){return Mo(Co)},useDebugValue:Ko,useDeferredValue:function(e){return Jo(Eo(),vo.memoizedState,e)},useTransition:function(){return[Mo(Co)[0],Eo().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1},us={readContext:Sa,useCallback:Yo,useContext:Sa,useEffect:Wo,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:Zo,useMemo:$o,useReducer:Io,useRef:Vo,useState:function(){return Io(Co)},useDebugValue:Ko,useDeferredValue:function(e){var t=Eo();return null===vo?t.memoizedState=e:Jo(t,vo.memoizedState,e)},useTransition:function(){return[Io(Co)[0],Eo().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var i="",n=t;do{i+=N(n),n=n.return}while(n);var r=i}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function hs(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,i){(i=Aa(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Wl||(Wl=!0,Hl=n),ps(0,t)},i}function ms(e,t,i){(i=Aa(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){ps(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(i.callback=function(){ps(0,t),"function"!==typeof n&&(null===Zl?Zl=new Set([this]):Zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function vs(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new ds;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=Su.bind(null,e,t,i),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,i,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=Aa(-1,1)).tag=2,La(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var _s=b.ReactCurrentOwner,bs=!1;function xs(e,t,i,n){t.child=null===e?$a(t,null,i,n):Ya(t,e.child,i,n)}function ws(e,t,i,n,r){i=i.render;var a=t.ref;return Pa(t,r),n=Po(e,t,i,n,a,r),i=So(),null===e||bs?(ra&&i&&ea(t),t.flags|=1,xs(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ws(e,t,r))}function ks(e,t,i,n,r){if(null===e){var a=i.type;return"function"!==typeof a||Du(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Lu(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ps(e,t,a,n,r))}if(a=e.child,0===(e.lanes&r)){var o=a.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(o,n)&&e.ref===t.ref)return Ws(e,t,r)}return t.flags|=1,(e=Au(a,n)).ref=t.ref,e.return=t,t.child=e}function Ps(e,t,i,n,r){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(bs=!1,t.pendingProps=n=a,0===(e.lanes&r))return t.lanes=e.lanes,Ws(e,t,r);0!==(131072&e.flags)&&(bs=!0)}}return Es(e,t,i,n,r)}function Ss(e,t,i){var n=t.pendingProps,r=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Al,Dl),Dl|=i;else{if(0===(1073741824&i))return e=null!==a?a.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tr(Al,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:i,Tr(Al,Dl),Dl|=n}else null!==a?(n=a.baseLanes|i,t.memoizedState=null):n=i,Tr(Al,Dl),Dl|=n;return xs(e,t,r,i),t.child}function Ts(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Es(e,t,i,n,r){var a=Dr(i)?Ir:Cr.current;return a=Or(t,a),Pa(t,r),i=Po(e,t,i,n,a,r),n=So(),null===e||bs?(ra&&n&&ea(t),t.flags|=1,xs(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ws(e,t,r))}function Cs(e,t,i,n,r){if(Dr(i)){var a=!0;Rr(t)}else a=!1;if(Pa(t,r),null===t.stateNode)Gs(e,t),Ga(t,i,n),Ha(t,i,n,r),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=i.contextType;"object"===typeof u&&null!==u?u=Sa(u):u=Or(t,u=Dr(i)?Ir:Cr.current);var c=i.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||l!==u)&&Wa(t,o,n,u),Ia=!1;var p=t.memoizedState;o.state=p,Fa(t,n,o,r),l=t.memoizedState,s!==n||p!==l||Mr.current||Ia?("function"===typeof c&&(Va(t,i,c,n),l=t.memoizedState),(s=Ia||Ua(t,i,s,n,p,l,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Da(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:va(t.type,s),o.props=u,h=t.pendingProps,p=o.context,"object"===typeof(l=i.contextType)&&null!==l?l=Sa(l):l=Or(t,l=Dr(i)?Ir:Cr.current);var d=i.getDerivedStateFromProps;(c="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||p!==l)&&Wa(t,o,n,l),Ia=!1,p=t.memoizedState,o.state=p,Fa(t,n,o,r);var f=t.memoizedState;s!==h||p!==f||Mr.current||Ia?("function"===typeof d&&(Va(t,i,d,n),f=t.memoizedState),(u=Ia||Ua(t,i,u,n,p,f,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),o.props=n,o.state=f,o.context=l,n=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Ms(e,t,i,n,a,r)}function Ms(e,t,i,n,r,a){Ts(e,t);var o=0!==(128&t.flags);if(!n&&!o)return r&&Fr(t,i,!1),Ws(e,t,a);n=t.stateNode,_s.current=t;var s=o&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,s,a)):xs(e,t,s,a),t.memoizedState=n.state,r&&Fr(t,i,!0),t.child}function Is(e){var t=e.stateNode;t.pendingContext?Lr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lr(0,t.context,!1),no(e,t.containerInfo)}function Os(e,t,i,n,r){return da(),fa(r),t.flags|=256,xs(e,t,i,n),t.child}var Ds,As,Ls,zs={dehydrated:null,treeContext:null,retryLane:0};function Rs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fs(e,t,i){var n,r=t.pendingProps,o=so.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Tr(so,1&o),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,s?(r=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Ru(l,r,0,null),e=zu(e,r,i,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Rs(i),t.memoizedState=zs,e):js(t,l));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return function(e,t,i,n,r,o,s){if(i)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,n=hs(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,r=t.mode,n=Ru({mode:"visible",children:n.children},r,0,null),(o=zu(o,r,s,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,0!==(1&t.mode)&&Ya(t,e.child,null,s),t.child.memoizedState=Rs(s),t.memoizedState=zs,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Bs(e,t,s,n=hs(o=Error(a(419)),n,void 0))}if(l=0!==(s&e.childLanes),bs||l){if(null!==(n=Ml)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|s))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ma(e,r),iu(n,e,r,-1))}return mu(),Bs(e,t,s,n=hs(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Eu.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,na=ur(r.nextSibling),ia=t,ra=!0,aa=null,null!==e&&(qr[Xr++]=Yr,qr[Xr++]=$r,qr[Xr++]=Kr,Yr=e.id,$r=e.overflow,Kr=t),(t=js(t,n.children)).flags|=4096,t)}(e,t,l,r,n,o,i);if(s){s=r.fallback,l=t.mode,n=(o=e.child).sibling;var u={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=u,t.deletions=null):(r=Au(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==n?s=Au(n,s):(s=zu(s,l,i,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,l=null===(l=e.child.memoizedState)?Rs(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~i,t.memoizedState=zs,r}return e=(s=e.child).sibling,r=Au(s,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function js(e,t){return(t=Ru({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,i,n){return null!==n&&fa(n),Ya(t,e.child,null,i),(e=js(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vs(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ka(e.return,t,i)}function Ns(e,t,i,n,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=i,a.tailMode=r)}function Us(e,t,i){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(xs(e,t,n.children,i),0!==(2&(n=so.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,i,t);else if(19===e.tag)Vs(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Tr(so,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===lo(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),Ns(t,!1,r,i,a);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===lo(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}Ns(t,!0,i,null,a);break;case"together":Ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Rl|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(i=Au(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Au(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Hs(e,t){if(!ra)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Zs(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function qs(e,t,i){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(t),null;case 1:case 17:return Dr(t.type)&&Ar(),Zs(t),null;case 3:return n=t.stateNode,ro(),Sr(Mr),Sr(Cr),co(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ou(aa),aa=null))),Zs(t),null;case 5:oo(t);var r=io(to.current);if(i=t.type,null!==e&&null!=t.stateNode)As(e,t,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Zs(t),null}if(e=io(Qa.current),ha(t)){n=t.stateNode,i=t.type;var o=t.memoizedProps;switch(n[pr]=t,n[dr]=o,e=0!==(1&t.mode),i){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(r=0;r<zn.length;r++)Bn(zn[r],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":Y(n,o),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Bn("invalid",n);break;case"textarea":re(n,o),Bn("invalid",n)}for(var l in ge(i,o),r=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?n.textContent!==u&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,u,e),r=["children",u]):"number"===typeof u&&n.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,u,e),r=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Bn("scroll",n)}switch(i){case"input":Z(n),Q(n,o,!0);break;case"textarea":Z(n),oe(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Qn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i),e[pr]=t,e[dr]=n,Ds(e,t),t.stateNode=e;e:{switch(l=_e(i,n),i){case"dialog":Bn("cancel",e),Bn("close",e),r=n;break;case"iframe":case"object":case"embed":Bn("load",e),r=n;break;case"video":case"audio":for(r=0;r<zn.length;r++)Bn(zn[r],e);r=n;break;case"source":Bn("error",e),r=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),r=n;break;case"details":Bn("toggle",e),r=n;break;case"input":Y(e,n),r=K(e,n),Bn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=F({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),Bn("invalid",e)}for(o in ge(i,r),u=r)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?ve(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==i||""!==c)&&pe(e,c):"number"===typeof c&&pe(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Bn("scroll",e):null!=c&&_(e,o,c,l))}switch(i){case"input":Z(e),Q(e,n,!1);break;case"textarea":Z(e),oe(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?ie(e,!!n.multiple,o,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Zs(t),null;case 6:if(e&&null!=t.stateNode)Ls(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(i=io(to.current),io(Qa.current),ha(t)){if(n=t.stateNode,i=t.memoizedProps,n[pr]=t,(o=n.nodeValue!==i)&&null!==(e=ia))switch(e.tag){case 3:Jn(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,i,0!==(1&e.mode))}o&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[pr]=t,t.stateNode=n}return Zs(t),null;case 13:if(Sr(so),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ra&&null!==na&&0!==(1&t.mode)&&0===(128&t.flags))pa(),da(),t.flags|=98560,o=!1;else if(o=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[pr]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Zs(t),o=!1}else null!==aa&&(ou(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Ll&&(Ll=3):mu())),null!==t.updateQueue&&(t.flags|=4),Zs(t),null);case 4:return ro(),null===e&&Un(t.stateNode.containerInfo),Zs(t),null;case 10:return wa(t.type._context),Zs(t),null;case 19:if(Sr(so),null===(o=t.memoizedState))return Zs(t),null;if(n=0!==(128&t.flags),null===(l=o.rendering))if(n)Hs(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,Hs(o,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(o=i).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Tr(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Ul&&(t.flags|=128,n=!0,Hs(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=lo(l))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ra)return Zs(t),null}else 2*$e()-o.renderingStartTime>Ul&&1073741824!==i&&(t.flags|=128,n=!0,Hs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=o.last)?i.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,i=so.current,Tr(so,n?1&i|2:1&i),t):(Zs(t),null);case 22:case 23:return hu(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Zs(t),6&t.subtreeFlags&&(t.flags|=8192)):Zs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Xs(e,t){switch(ta(t),t.tag){case 1:return Dr(t.type)&&Ar(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ro(),Sr(Mr),Sr(Cr),co(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Sr(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sr(so),null;case 4:return ro(),null;case 10:return wa(t.type._context),null;case 22:case 23:return hu(),null;default:return null}}Ds=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},As=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,io(Qa.current);var a,o=null;switch(i){case"input":r=K(e,r),n=K(e,n),o=[];break;case"select":r=F({},r,{value:void 0}),n=F({},n,{value:void 0}),o=[];break;case"textarea":r=ne(e,r),n=ne(e,n),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=Qn)}for(c in ge(i,n),i=null,r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(a in l)l.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in n){var u=n[c];if(l=null!=r?r[c]:void 0,n.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(i||(i={}),i[a]=u[a])}else i||(o||(o=[]),o.push(c,i)),i=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Bn("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}i&&(o=o||[]).push("style",i);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Ls=function(e,t,i,n){i!==n&&(t.flags|=4)};var Ks=!1,Ys=!1,$s="function"===typeof WeakSet?WeakSet:Set,Js=null;function Qs(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Pu(e,t,n)}else i.current=null}function el(e,t,i){try{i()}catch(n){Pu(e,t,n)}}var tl=!1;function il(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&el(t,i,a)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pr],delete t[dr],delete t[mr],delete t[vr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Qn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,i),e=e.sibling;null!==e;)ll(e,t,i),e=e.sibling}function ul(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(ul(e,t,i),e=e.sibling;null!==e;)ul(e,t,i),e=e.sibling}var cl=null,hl=!1;function pl(e,t,i){for(i=i.child;null!==i;)dl(e,t,i),i=i.sibling}function dl(e,t,i){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(rt,i)}catch(s){}switch(i.tag){case 5:Ys||Qs(i,t);case 6:var n=cl,r=hl;cl=null,pl(e,t,i),hl=r,null!==(cl=n)&&(hl?(e=cl,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):cl.removeChild(i.stateNode));break;case 18:null!==cl&&(hl?(e=cl,i=i.stateNode,8===e.nodeType?lr(e.parentNode,i):1===e.nodeType&&lr(e,i),Ut(e)):lr(cl,i.stateNode));break;case 4:n=cl,r=hl,cl=i.stateNode.containerInfo,hl=!0,pl(e,t,i),cl=n,hl=r;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var a=r,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&el(i,t,o),r=r.next}while(r!==n)}pl(e,t,i);break;case 1:if(!Ys&&(Qs(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(s){Pu(i,t,s)}pl(e,t,i);break;case 21:pl(e,t,i);break;case 22:1&i.mode?(Ys=(n=Ys)||null!==i.memoizedState,pl(e,t,i),Ys=n):pl(e,t,i);break;default:pl(e,t,i)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new $s),t.forEach((function(t){var n=Cu.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function ml(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,hl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===cl)throw Error(a(160));dl(o,s,r),cl=null,hl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(c){Pu(r,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&n){try{il(3,e,e.return),nl(3,e)}catch(v){Pu(e,e.return,v)}try{il(5,e,e.return)}catch(v){Pu(e,e.return,v)}}break;case 1:ml(t,e),yl(e),512&n&&null!==i&&Qs(i,i.return);break;case 5:if(ml(t,e),yl(e),512&n&&null!==i&&Qs(i,i.return),32&e.flags){var r=e.stateNode;try{pe(r,"")}catch(v){Pu(e,e.return,v)}}if(4&n&&null!=(r=e.stateNode)){var o=e.memoizedProps,s=null!==i?i.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&$(r,o),_e(l,s);var c=_e(l,o);for(s=0;s<u.length;s+=2){var h=u[s],p=u[s+1];"style"===h?ve(r,p):"dangerouslySetInnerHTML"===h?he(r,p):"children"===h?pe(r,p):_(r,h,p,c)}switch(l){case"input":J(r,o);break;case"textarea":ae(r,o);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ie(r,!!o.multiple,f,!1):d!==!!o.multiple&&(null!=o.defaultValue?ie(r,!!o.multiple,o.defaultValue,!0):ie(r,!!o.multiple,o.multiple?[]:"",!1))}r[dr]=o}catch(v){Pu(e,e.return,v)}}break;case 6:if(ml(t,e),yl(e),4&n){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(v){Pu(e,e.return,v)}}break;case 3:if(ml(t,e),yl(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(v){Pu(e,e.return,v)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Nl=$e())),4&n&&fl(e);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&e.mode?(Ys=(c=Ys)||h,ml(t,e),Ys=c):ml(t,e),yl(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(p=Js=h;null!==Js;){switch(f=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:il(4,d,d.return);break;case 1:Qs(d,d.return);var m=d.stateNode;if("function"===typeof m.componentWillUnmount){n=d,i=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){Pu(n,i,v)}}break;case 5:Qs(d,d.return);break;case 22:if(null!==d.memoizedState){xl(p);continue}}null!==f?(f.return=d,Js=f):xl(p)}h=h.sibling}e:for(h=null,p=e;;){if(5===p.tag){if(null===h){h=p;try{r=p.stateNode,c?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=p.stateNode,s=void 0!==(u=p.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",s))}catch(v){Pu(e,e.return,v)}}}else if(6===p.tag){if(null===h)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(v){Pu(e,e.return,v)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ml(t,e),yl(e),4&n&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(ol(i)){var n=i;break e}i=i.return}throw Error(a(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(pe(r,""),n.flags&=-33),ul(e,sl(e),r);break;case 3:case 4:var o=n.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(a(161))}}catch(s){Pu(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gl(e,t,i){Js=e,_l(e,t,i)}function _l(e,t,i){for(var n=0!==(1&e.mode);null!==Js;){var r=Js,a=r.child;if(22===r.tag&&n){var o=null!==r.memoizedState||Ks;if(!o){var s=r.alternate,l=null!==s&&null!==s.memoizedState||Ys;s=Ks;var u=Ys;if(Ks=o,(Ys=l)&&!u)for(Js=r;null!==Js;)l=(o=Js).child,22===o.tag&&null!==o.memoizedState?wl(r):null!==l?(l.return=o,Js=l):wl(r);for(;null!==a;)Js=a,_l(a,t,i),a=a.sibling;Js=r,Ks=s,Ys=u}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==a?(a.return=r,Js=a):bl(e)}}function bl(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ys)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:va(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ja(t,o,n);break;case 3:var s=t.updateQueue;if(null!==s){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}ja(t,s,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&i.focus();break;case"img":u.src&&(i.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var p=h.dehydrated;null!==p&&Ut(p)}}}break;default:throw Error(a(163))}Ys||512&t.flags&&rl(t)}catch(d){Pu(t,t.return,d)}}if(t===e){Js=null;break}if(null!==(i=t.sibling)){i.return=t.return,Js=i;break}Js=t.return}}function xl(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Js=i;break}Js=t.return}}function wl(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{nl(4,t)}catch(l){Pu(t,i,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(l){Pu(t,r,l)}}var a=t.return;try{rl(t)}catch(l){Pu(t,a,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Pu(t,o,l)}}}catch(l){Pu(t,t.return,l)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var kl,Pl=Math.ceil,Sl=b.ReactCurrentDispatcher,Tl=b.ReactCurrentOwner,El=b.ReactCurrentBatchConfig,Cl=0,Ml=null,Il=null,Ol=0,Dl=0,Al=Pr(0),Ll=0,zl=null,Rl=0,Fl=0,jl=0,Bl=null,Vl=null,Nl=0,Ul=1/0,Gl=null,Wl=!1,Hl=null,Zl=null,ql=!1,Xl=null,Kl=0,Yl=0,$l=null,Jl=-1,Ql=0;function eu(){return 0!==(6&Cl)?$e():-1!==Jl?Jl:Jl=$e()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Ol?Ol&-Ol:null!==ma.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function iu(e,t,i,n){if(50<Yl)throw Yl=0,$l=null,Error(a(185));yt(e,i,n),0!==(2&Cl)&&e===Ml||(e===Ml&&(0===(2&Cl)&&(Fl|=i),4===Ll&&su(e,Ol)),nu(e,n),1===i&&0===Cl&&0===(1&t.mode)&&(Ul=$e()+500,Br&&Ur()))}function nu(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,l=r[o];-1===l?0!==(s&i)&&0===(s&n)||(r[o]=dt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var n=pt(e,e===Ml?Ol:0);if(0===n)null!==i&&Xe(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&Xe(i),1===t)0===e.tag?function(e){Br=!0,Nr(e)}(lu.bind(null,e)):Nr(lu.bind(null,e)),or((function(){0===(6&Cl)&&Ur()})),i=null;else{switch(bt(n)){case 1:i=Qe;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=Mu(i,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function ru(e,t){if(Jl=-1,Ql=0,0!==(6&Cl))throw Error(a(327));var i=e.callbackNode;if(wu()&&e.callbackNode!==i)return null;var n=pt(e,e===Ml?Ol:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=vu(e,n);else{t=n;var r=Cl;Cl|=2;var o=fu();for(Ml===e&&Ol===t||(Gl=null,Ul=$e()+500,pu(e,t));;)try{gu();break}catch(l){du(e,l)}xa(),Sl.current=o,Cl=r,null!==Il?t=0:(Ml=null,Ol=0,t=Ll)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(n=r,t=au(e,r))),1===t)throw i=zl,pu(e,0),su(e,n),nu(e,$e()),i;if(6===t)su(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],a=r.getSnapshot;r=r.value;try{if(!sn(a(),r))return!1}catch(s){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=vu(e,n))&&(0!==(o=ft(e))&&(n=o,t=au(e,o))),1===t))throw i=zl,pu(e,0),su(e,n),nu(e,$e()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:xu(e,Vl,Gl);break;case 3:if(su(e,n),(130023424&n)===n&&10<(t=Nl+500-$e())){if(0!==pt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){eu(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(xu.bind(null,e,Vl,Gl),t);break}xu(e,Vl,Gl);break;case 4:if(su(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var s=31-ot(n);o=1<<s,(s=t[s])>r&&(r=s),n&=~o}if(n=r,10<(n=(120>(n=$e()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Pl(n/1960))-n)){e.timeoutHandle=nr(xu.bind(null,e,Vl,Gl),n);break}xu(e,Vl,Gl);break;default:throw Error(a(329))}}}return nu(e,$e()),e.callbackNode===i?ru.bind(null,e):null}function au(e,t){var i=Bl;return e.current.memoizedState.isDehydrated&&(pu(e,t).flags|=256),2!==(e=vu(e,t))&&(t=Vl,Vl=i,null!==t&&ou(t)),e}function ou(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function su(e,t){for(t&=~jl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-ot(t),n=1<<i;e[i]=-1,t&=~n}}function lu(e){if(0!==(6&Cl))throw Error(a(327));wu();var t=pt(e,0);if(0===(1&t))return nu(e,$e()),null;var i=vu(e,t);if(0!==e.tag&&2===i){var n=ft(e);0!==n&&(t=n,i=au(e,n))}if(1===i)throw i=zl,pu(e,0),su(e,t),nu(e,$e()),i;if(6===i)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xu(e,Vl,Gl),nu(e,$e()),null}function uu(e,t){var i=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=i)&&(Ul=$e()+500,Br&&Ur())}}function cu(e){null!==Xl&&0===Xl.tag&&0===(6&Cl)&&wu();var t=Cl;Cl|=1;var i=El.transition,n=_t;try{if(El.transition=null,_t=1,e)return e()}finally{_t=n,El.transition=i,0===(6&(Cl=t))&&Ur()}}function hu(){Dl=Al.current,Sr(Al)}function pu(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,rr(i)),null!==Il)for(i=Il.return;null!==i;){var n=i;switch(ta(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Ar();break;case 3:ro(),Sr(Mr),Sr(Cr),co();break;case 5:oo(n);break;case 4:ro();break;case 13:case 19:Sr(so);break;case 10:wa(n.type._context);break;case 22:case 23:hu()}i=i.return}if(Ml=e,Il=e=Au(e.current,null),Ol=Dl=t,Ll=0,zl=null,jl=Fl=Rl=0,Vl=Bl=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(n=(i=Ta[t]).interleaved)){i.interleaved=null;var r=n.next,a=i.pending;if(null!==a){var o=a.next;a.next=r,n.next=o}i.pending=n}Ta=null}return e}function du(e,t){for(;;){var i=Il;try{if(xa(),ho.current=os,go){for(var n=mo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}go=!1}if(fo=0,yo=vo=mo=null,_o=!1,bo=0,Tl.current=null,null===i||null===i.return){Ll=1,zl=t,Il=null;break}e:{var o=e,s=i.return,l=i,u=t;if(t=Ol,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,p=h.tag;if(0===(1&h.mode)&&(0===p||11===p||15===p)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=ys(s);if(null!==f){f.flags&=-257,gs(f,s,l,0,t),1&f.mode&&vs(o,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var v=new Set;v.add(u),t.updateQueue=v}else m.add(u);break e}if(0===(1&t)){vs(o,c,t),mu();break e}u=Error(a(426))}else if(ra&&1&l.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),gs(y,s,l,0,t),fa(cs(u,l));break e}}o=u=cs(u,l),4!==Ll&&(Ll=2),null===Bl?Bl=[o]:Bl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ra(o,fs(0,u,t));break e;case 1:l=u;var g=o.type,_=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Zl||!Zl.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,Ra(o,ms(o,l,t));break e}}o=o.return}while(null!==o)}bu(i)}catch(b){t=b,Il===i&&null!==i&&(Il=i=i.return);continue}break}}function fu(){var e=Sl.current;return Sl.current=os,null===e?os:e}function mu(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Ml||0===(268435455&Rl)&&0===(268435455&Fl)||su(Ml,Ol)}function vu(e,t){var i=Cl;Cl|=2;var n=fu();for(Ml===e&&Ol===t||(Gl=null,pu(e,t));;)try{yu();break}catch(r){du(e,r)}if(xa(),Cl=i,Sl.current=n,null!==Il)throw Error(a(261));return Ml=null,Ol=0,Ll}function yu(){for(;null!==Il;)_u(Il)}function gu(){for(;null!==Il&&!Ke();)_u(Il)}function _u(e){var t=kl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bu(e):Il=t,Tl.current=null}function bu(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=qs(i,t,Dl)))return void(Il=i)}else{if(null!==(i=Xs(i,t)))return i.flags&=32767,void(Il=i);if(null===e)return Ll=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ll&&(Ll=5)}function xu(e,t,i){var n=_t,r=El.transition;try{El.transition=null,_t=1,function(e,t,i,n){do{wu()}while(null!==Xl);if(0!==(6&Cl))throw Error(a(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-ot(i),a=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~a}}(e,o),e===Ml&&(Il=Ml=null,Ol=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||ql||(ql=!0,Mu(tt,(function(){return wu(),null}))),o=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||o){o=El.transition,El.transition=null;var s=_t;_t=1;var l=Cl;Cl|=4,Tl.current=null,function(e,t){if(er=Wt,dn(e=pn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{i.nodeType,o.nodeType}catch(x){i=null;break e}var s=0,l=-1,u=-1,c=0,h=0,p=e,d=null;t:for(;;){for(var f;p!==i||0!==r&&3!==p.nodeType||(l=s+r),p!==o||0!==n&&3!==p.nodeType||(u=s+n),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)d=p,p=f;for(;;){if(p===e)break t;if(d===i&&++c===r&&(l=s),d===o&&++h===n&&(u=s),null!==(f=p.nextSibling))break;d=(p=d).parentNode}p=f}i=-1===l||-1===u?null:{start:l,end:u}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:e,selectionRange:i},Wt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var v=m.memoizedProps,y=m.memoizedState,g=t.stateNode,_=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:va(t.type,v),y);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(x){Pu(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=tl,tl=!1}(e,i),vl(i,e),fn(tr),Wt=!!er,tr=er=null,e.current=i,gl(i,e,r),Ye(),Cl=l,_t=s,El.transition=o}else e.current=i;if(ql&&(ql=!1,Xl=e,Kl=r),0===(o=e.pendingLanes)&&(Zl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),nu(e,$e()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n((r=t[i]).value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Hl,Hl=null,e;0!==(1&Kl)&&0!==e.tag&&wu(),0!==(1&(o=e.pendingLanes))?e===$l?Yl++:(Yl=0,$l=e):Yl=0,Ur()}(e,t,i,n)}finally{El.transition=r,_t=n}return null}function wu(){if(null!==Xl){var e=bt(Kl),t=El.transition,i=_t;try{if(El.transition=null,_t=16>e?16:e,null===Xl)var n=!1;else{if(e=Xl,Xl=null,Kl=0,0!==(6&Cl))throw Error(a(331));var r=Cl;for(Cl|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Js=c;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:il(8,h,o)}var p=h.child;if(null!==p)p.return=h,Js=p;else for(;null!==Js;){var d=(h=Js).sibling,f=h.return;if(al(h),h===c){Js=null;break}if(null!==d){d.return=f,Js=d;break}Js=f}}}var m=o.alternate;if(null!==m){var v=m.child;if(null!==v){m.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(null!==v)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:il(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Js=g;break e}Js=o.return}}var _=e.current;for(Js=_;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=_;null!==Js;){if(0!==(2048&(l=Js).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){Pu(l,l.return,w)}if(l===s){Js=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Js=x;break e}Js=l.return}}if(Cl=r,Ur(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{_t=i,El.transition=t}}return!1}function ku(e,t,i){e=La(e,t=fs(0,t=cs(i,t),1),1),t=eu(),null!==e&&(yt(e,1,t),nu(e,t))}function Pu(e,t,i){if(3===e.tag)ku(e,e,i);else for(;null!==t;){if(3===t.tag){ku(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Zl||!Zl.has(n))){t=La(t,e=ms(t,e=cs(i,e),1),1),e=eu(),null!==t&&(yt(t,1,e),nu(t,e));break}}t=t.return}}function Su(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&i,Ml===e&&(Ol&i)===i&&(4===Ll||3===Ll&&(130023424&Ol)===Ol&&500>$e()-Nl?pu(e,0):jl|=i),nu(e,t)}function Tu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var i=eu();null!==(e=Ma(e,t))&&(yt(e,t,i),nu(e,i))}function Eu(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Tu(e,i)}function Cu(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Tu(e,i)}function Mu(e,t){return qe(e,t)}function Iu(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ou(e,t,i,n){return new Iu(e,t,i,n)}function Du(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Au(e,t){var i=e.alternate;return null===i?((i=Ou(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Lu(e,t,i,n,r,o){var s=2;if(n=e,"function"===typeof e)Du(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return zu(i.children,r,o,t);case P:s=8,r|=8;break;case S:return(e=Ou(12,i,t,2|r)).elementType=S,e.lanes=o,e;case M:return(e=Ou(13,i,t,r)).elementType=M,e.lanes=o,e;case I:return(e=Ou(19,i,t,r)).elementType=I,e.lanes=o,e;case A:return Ru(i,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case E:s=9;break e;case C:s=11;break e;case O:s=14;break e;case D:s=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ou(s,i,t,r)).elementType=e,t.type=n,t.lanes=o,t}function zu(e,t,i,n){return(e=Ou(7,e,n,t)).lanes=i,e}function Ru(e,t,i,n){return(e=Ou(22,e,n,t)).elementType=A,e.lanes=i,e.stateNode={isHidden:!1},e}function Fu(e,t,i){return(e=Ou(6,e,null,t)).lanes=i,e}function ju(e,t,i){return(t=Ou(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bu(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vu(e,t,i,n,r,a,o,s,l){return e=new Bu(e,t,i,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ou(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(a),e}function Nu(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}function Uu(e){if(!e)return Er;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var i=e.type;if(Dr(i))return zr(e,i,t)}return t}function Gu(e,t,i,n,r,a,o,s,l){return(e=Vu(i,n,!0,e,0,a,0,s,l)).context=Uu(null),i=e.current,(a=Aa(n=eu(),r=tu(i))).callback=void 0!==t&&null!==t?t:null,La(i,a,r),e.current.lanes=r,yt(e,r,n),nu(e,n),e}function Wu(e,t,i,n){var r=t.current,a=eu(),o=tu(r);return i=Uu(i),null===t.context?t.context=i:t.pendingContext=i,(t=Aa(a,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=La(r,t,o))&&(iu(e,r,o,a),za(e,r,o)),o}function Hu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Zu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function qu(e,t){Zu(e,t),(e=e.alternate)&&Zu(e,t)}kl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mr.current)bs=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return bs=!1,function(e,t,i){switch(t.tag){case 3:Is(t),da();break;case 5:ao(t);break;case 1:Dr(t.type)&&Rr(t);break;case 4:no(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Tr(ya,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Tr(so,1&so.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Fs(e,t,i):(Tr(so,1&so.current),null!==(e=Ws(e,t,i))?e.sibling:null);Tr(so,1&so.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Us(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(so,so.current),n)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,i)}return Ws(e,t,i)}(e,t,i);bs=0!==(131072&e.flags)}else bs=!1,ra&&0!==(1048576&t.flags)&&Qr(t,Zr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Gs(e,t),e=t.pendingProps;var r=Or(t,Cr.current);Pa(t,i),r=Po(null,t,n,e,r,i);var o=So();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(n)?(o=!0,Rr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Oa(t),r.updater=Na,t.stateNode=r,r._reactInternals=t,Ha(t,n,e,i),t=Ms(null,t,n,!0,o,i)):(t.tag=0,ra&&o&&ea(t),xs(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return Du(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===O)return 14}return 2}(n),e=va(n,e),r){case 0:t=Es(null,t,n,e,i);break e;case 1:t=Cs(null,t,n,e,i);break e;case 11:t=ws(null,t,n,e,i);break e;case 14:t=ks(null,t,n,va(n.type,e),i);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Es(e,t,n,r=t.elementType===n?r:va(n,r),i);case 1:return n=t.type,r=t.pendingProps,Cs(e,t,n,r=t.elementType===n?r:va(n,r),i);case 3:e:{if(Is(t),null===e)throw Error(a(387));n=t.pendingProps,r=(o=t.memoizedState).element,Da(e,t),Fa(t,n,null,i);var s=t.memoizedState;if(n=s.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Os(e,t,n,i,r=cs(Error(a(423)),t));break e}if(n!==r){t=Os(e,t,n,i,r=cs(Error(a(424)),t));break e}for(na=ur(t.stateNode.containerInfo.firstChild),ia=t,ra=!0,aa=null,i=$a(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(da(),n===r){t=Ws(e,t,i);break e}xs(e,t,n,i)}t=t.child}return t;case 5:return ao(t),null===e&&ua(t),n=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,s=r.children,ir(n,r)?s=null:null!==o&&ir(n,o)&&(t.flags|=32),Ts(e,t),xs(e,t,s,i),t.child;case 6:return null===e&&ua(t),null;case 13:return Fs(e,t,i);case 4:return no(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ya(t,null,n,i):xs(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,ws(e,t,n,r=t.elementType===n?r:va(n,r),i);case 7:return xs(e,t,t.pendingProps,i),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,o=t.memoizedProps,s=r.value,Tr(ya,n._currentValue),n._currentValue=s,null!==o)if(sn(o.value,s)){if(o.children===r.children&&!Mr.current){t=Ws(e,t,i);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var u=l.firstContext;null!==u;){if(u.context===n){if(1===o.tag){(u=Aa(-1,i&-i)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}o.lanes|=i,null!==(u=o.alternate)&&(u.lanes|=i),ka(o.return,i,t),l.lanes|=i;break}u=u.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=i,null!==(l=s.alternate)&&(l.lanes|=i),ka(s,i,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}xs(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Pa(t,i),n=n(r=Sa(r)),t.flags|=1,xs(e,t,n,i),t.child;case 14:return r=va(n=t.type,t.pendingProps),ks(e,t,n,r=va(n.type,r),i);case 15:return Ps(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:va(n,r),Gs(e,t),t.tag=1,Dr(n)?(e=!0,Rr(t)):e=!1,Pa(t,i),Ga(t,n,r),Ha(t,n,r,i),Ms(null,t,n,!0,e,i);case 19:return Us(e,t,i);case 22:return Ss(e,t,i)}throw Error(a(156,t.tag))};var Xu="function"===typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Yu(e){this._internalRoot=e}function $u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ju(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qu(){}function ec(e,t,i,n,r){var a=i._reactRootContainer;if(a){var o=a;if("function"===typeof r){var s=r;r=function(){var e=Hu(o);s.call(e)}}Wu(t,o,e,r)}else o=function(e,t,i,n,r){if(r){if("function"===typeof n){var a=n;n=function(){var e=Hu(o);a.call(e)}}var o=Gu(t,n,e,0,null,!1,0,"",Qu);return e._reactRootContainer=o,e[fr]=o.current,Un(8===e.nodeType?e.parentNode:e),cu(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var s=n;n=function(){var e=Hu(l);s.call(e)}}var l=Vu(e,0,!1,null,0,!1,0,"",Qu);return e._reactRootContainer=l,e[fr]=l.current,Un(8===e.nodeType?e.parentNode:e),cu((function(){Wu(t,l,i,n)})),l}(i,t,e,r,n);return Hu(o)}Yu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wu(e,t,null,null)},Yu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Wu(null,e,null,null)})),t[fr]=null}},Yu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<At.length&&0!==t&&t<At[i].priority;i++);At.splice(i,0,e),0===i&&Ft(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ht(t.pendingLanes);0!==i&&(gt(t,1|i),nu(t,$e()),0===(6&Cl)&&(Ul=$e()+500,Ur()))}break;case 13:cu((function(){var t=Ma(e,1);if(null!==t){var i=eu();iu(t,e,1,i)}})),qu(e,1)}},wt=function(e){if(13===e.tag){var t=Ma(e,134217728);if(null!==t)iu(t,e,134217728,eu());qu(e,134217728)}},kt=function(e){if(13===e.tag){var t=tu(e),i=Ma(e,t);if(null!==i)iu(i,e,t,eu());qu(e,t)}},Pt=function(){return _t},St=function(e,t){var i=_t;try{return _t=e,t()}finally{_t=i}},we=function(e,t,i){switch(t){case"input":if(J(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=xr(n);if(!r)throw Error(a(90));q(n),J(n,r)}}}break;case"textarea":ae(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Ce=uu,Me=cu;var tc={usingClientEntryPoint:!1,Events:[_r,br,xr,Te,Ee,uu]},ic={findFiberByHostInstance:gr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nc={bundleType:ic.bundleType,version:ic.version,rendererPackageName:ic.rendererPackageName,rendererConfig:ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:ic.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{rt=rc.inject(nc),at=rc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$u(t))throw Error(a(200));return Nu(e,t,null,i)},t.createRoot=function(e,t){if(!$u(e))throw Error(a(299));var i=!1,n="",r=Xu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Vu(e,1,!1,null,0,i,0,n,r),e[fr]=t.current,Un(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,i){if(!Ju(t))throw Error(a(200));return ec(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!$u(e))throw Error(a(405));var n=null!=i&&i.hydratedSources||null,r=!1,o="",s=Xu;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(o=i.identifierPrefix),void 0!==i.onRecoverableError&&(s=i.onRecoverableError)),t=Gu(t,null,e,1,null!=i?i:null,r,0,o,s),e[fr]=t.current,Un(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Yu(t)},t.render=function(e,t,i){if(!Ju(t))throw Error(a(200));return ec(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Ju(e))throw Error(a(40));return!!e._reactRootContainer&&(cu((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Ju(i))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ec(e,t,i,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,i){"use strict";var n=i(4164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4164:function(e,t,i){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(4463)},6374:function(e,t,i){"use strict";var n=i(2791),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,i){var n,a={},u=null,c=null;for(n in void 0!==i&&(u=""+i),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:r,type:e,key:u,ref:c,props:a,_owner:s.current}}t.jsx=u,t.jsxs=u},9117:function(e,t){"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),d=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function y(e,t,i){this.props=e,this.context=t,this.refs=v,this.updater=i||f}function g(){}function _(e,t,i){this.props=e,this.context=t,this.refs=v,this.updater=i||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=y.prototype;var b=_.prototype=new g;b.constructor=_,m(b,y.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,k={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var r,a={},o=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&!P.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:i,type:e,key:o,ref:s,props:a,_owner:k.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function M(e,t,r,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case n:l=!0}}if(l)return o=o(l=e),e=""===a?"."+C(l,0):a,x(o)?(r="",null!=e&&(r=e.replace(E,"$&/")+"/"),M(o,t,r,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(l=0,a=""===a?".":a+":",x(e))for(var u=0;u<e.length;u++){var c=a+C(s=e[u],u);l+=M(s,t,r,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=M(s=s.value,t,r,c=a+C(s,u++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,i){if(null==e)return e;var n=[],r=0;return M(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},A={transition:null},L={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:A,ReactCurrentOwner:k};t.Children={map:I,forEach:function(e,t,i){I(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return I(e,(function(){t++})),t},toArray:function(e){return I(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=o,t.PureComponent=_,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!P.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:i,type:e.type,key:a,ref:o,props:r,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,i){return D.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,i){return D.current.useReducer(e,t,i)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return D.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return D.current.useTransition()},t.version="18.2.0"},2791:function(e,t,i){"use strict";e.exports=i(9117)},184:function(e,t,i){"use strict";e.exports=i(6374)},6813:function(e,t){"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<a(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,o=r>>>1;n<o;){var s=2*(n+1)-1,l=e[s],u=s+1,c=e[u];if(0>a(l,i))u<r&&0>a(c,l)?(e[n]=c,e[u]=i,n=u):(e[n]=l,e[s]=i,n=s);else{if(!(u<r&&0>a(c,i)))break e;e[n]=c,e[u]=i,n=u}}}return t}function a(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var u=[],c=[],h=1,p=null,d=3,f=!1,m=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(c);null!==t;){if(null===t.callback)r(c);else{if(!(t.startTime<=e))break;r(c),t.sortIndex=t.expirationTime,i(u,t)}t=n(c)}}function x(e){if(v=!1,b(e),!m)if(null!==n(u))m=!0,A(w);else{var t=n(c);null!==t&&L(x,t.startTime-e)}}function w(e,i){m=!1,v&&(v=!1,g(T),T=-1),f=!0;var a=d;try{for(b(i),p=n(u);null!==p&&(!(p.expirationTime>i)||e&&!M());){var o=p.callback;if("function"===typeof o){p.callback=null,d=p.priorityLevel;var s=o(p.expirationTime<=i);i=t.unstable_now(),"function"===typeof s?p.callback=s:p===n(u)&&r(u),b(i)}else r(u);p=n(u)}if(null!==p)var l=!0;else{var h=n(c);null!==h&&L(x,h.startTime-i),l=!1}return l}finally{p=null,d=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,P=!1,S=null,T=-1,E=5,C=-1;function M(){return!(t.unstable_now()-C<E)}function I(){if(null!==S){var e=t.unstable_now();C=e;var i=!0;try{i=S(!0,e)}finally{i?k():(P=!1,S=null)}}else P=!1}if("function"===typeof _)k=function(){_(I)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,D=O.port2;O.port1.onmessage=I,k=function(){D.postMessage(null)}}else k=function(){y(I,0)};function A(e){S=e,P||(P=!0,k())}function L(e,i){T=y((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,A(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var i=d;d=t;try{return e()}finally{d=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=d;d=e;try{return t()}finally{d=i}},t.unstable_scheduleCallback=function(e,r,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,i(c,e),null===n(u)&&e===n(c)&&(v?(g(T),T=-1):v=!0,L(x,a-o))):(e.sortIndex=s,i(u,e),m||f||(m=!0,A(w))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=d;return function(){var i=d;d=t;try{return e.apply(this,arguments)}finally{d=i}}}},5296:function(e,t,i){"use strict";e.exports=i(6813)},9613:function(e){e.exports=function(e,t,i,n){var r=i?i.call(n,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<a.length;l++){var u=a[l];if(!s(u))return!1;var c=e[u],h=t[u];if(!1===(r=i?i.call(n,c,h,u):void 0)||void 0===r&&c!==h)return!1}return!0}},4613:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return a}});var n=i(5671),r=i(3144),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if((0,n.Z)(this,e),this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}return(0,r.Z)(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,i=this.compare,n=t[e];e>0;){var r=e-1>>1,a=t[r];if(i(n,a)>=0)break;t[e]=a,e=r}t[e]=n}},{key:"_down",value:function(e){for(var t=this.data,i=this.compare,n=this.length>>1,r=t[e];e<n;){var a=1+(e<<1),o=t[a],s=a+1;if(s<this.length&&i(t[s],o)<0&&(a=s,o=t[s]),i(o,r)>=0)break;t[e]=o,e=a}t[e]=r}}]),e}();function o(e,t){return e<t?-1:e>t?1:0}},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,i){var n=i(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,i){var n=i(6015),r=i(9617);function a(t,i,o){return r()?(e.exports=a=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,i){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return i&&n(a,i.prototype),a},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(null,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e){function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,i){var n=i(6116);e.exports=function(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,i){var n=i(3808),r=i(9617),a=i(4993);e.exports=function(e){var t=r();return function(){var i,r=n(e);if(t){var o=n(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return a(this,i)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,i){var n=i(1753);function r(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(e,t,i){var r=n(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:i):a.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(i){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,i){var n=i(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(l){s=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,i){var n=i(8698).default,r=i(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(i,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(i,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,i){var n=i(5372),r=i(8872),a=i(6116),o=i(2218);e.exports=function(e,t){return n(e)||r(e,t)||a(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,i){var n=i(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},1589:function(e,t,i){var n=i(5372),r=i(9498),a=i(6116),o=i(2218);e.exports=function(e){return n(e)||r(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,i){var n=i(3405),r=i(9498),a=i(6116),o=i(2281);e.exports=function(e){return n(e)||r(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(i){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,i){var n=i(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,i){var n=i(3808),r=i(6015),a=i(6035),o=i(3515);function s(t){var i="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!a(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof i){if(i.has(e))return i.get(e);i.set(e,t)}function t(){return o(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},907:function(e,t,i){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i.d(t,{Z:function(){return n}})},7326:function(e,t,i){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}i.d(t,{Z:function(){return n}})},5861:function(e,t,i){"use strict";function n(e,t,i,n,r,a,o){try{var s=e[a](o),l=s.value}catch(u){return void i(u)}s.done?t(l):Promise.resolve(l).then(n,r)}function r(e){return function(){var t=this,i=arguments;return new Promise((function(r,a){var o=e.apply(t,i);function s(e){n(o,r,a,s,l,"next",e)}function l(e){n(o,r,a,s,l,"throw",e)}s(void 0)}))}}i.d(t,{Z:function(){return r}})},5671:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.d(t,{Z:function(){return n}})},3144:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}i.d(t,{Z:function(){return r}})},4942:function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{Z:function(){return n}})},1120:function(e,t,i){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}i.d(t,{Z:function(){return n}})},9340:function(e,t,i){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}i.d(t,{Z:function(){return r}})},2963:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(1002),r=i(7326);function a(e,t){if(t&&("object"===(0,n.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(e)}},885:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var n=i(181);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(l){s=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}}(e,t)||(0,n.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2982:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var n=i(907);var r=i(181);function a(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,r.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1002:function(e,t,i){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}i.d(t,{Z:function(){return n}})},181:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var n=i(907);function r(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?(0,n.Z)(e,t):void 0}}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=e,i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var a=Object.create(null);i.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return n[e]}}));return o.default=function(){return n},i.d(a,o),a}}(),i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,n){return i.f[n](e,t),t}),[]))},i.u=function(e){return"static/js/"+({265:"canvg",297:"xlsx",643:"pdfmake"}[e]||e)+"."+{265:"cd16f39d",297:"b84eb5bd",458:"26c0958c",643:"6d59ef04"}[e]+".chunk.js"},i.miniCssF=function(e){},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="my-app:";i.l=function(n,r,a,o){if(e[n])e[n].push(r);else{var s,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+a){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var p=function(t,i){s.onerror=s.onload=null,clearTimeout(d);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(i)})),t)return t(i)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},i.p="/NextPanelTest/",function(){var e={179:0};i.f.j=function(t,n){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(i,n){r=e[t]=[i,n]}));n.push(r[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,(function(n){if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=function(t,n){var r,a,o=n[0],s=n[1],l=n[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(l)l(i)}for(t&&t(n);u<o.length;u++)a=o[u],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkmy_app=self.webpackChunkmy_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){"use strict";var e,t=i(2791),n=i(1250),r=i(885);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},a.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var o=function(e){return e};var s="beforeunload",l="popstate";function u(e){e.preventDefault(),e.returnValue=""}function c(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function h(){return Math.random().toString(36).substr(2,8)}function p(e){var t=e.pathname,i=void 0===t?"/":t,n=e.search,r=void 0===n?"":n,a=e.hash,o=void 0===a?"":a;return r&&"?"!==r&&(i+="?"===r.charAt(0)?r:"?"+r),o&&"#"!==o&&(i+="#"===o.charAt(0)?o:"#"+o),i}function d(e){var t={};if(e){var i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));var n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}var f=(0,t.createContext)(null);var m=(0,t.createContext)(null);var v=(0,t.createContext)({outlet:null,matches:[]});function y(e,t){if(!e)throw new Error(t)}function g(e,t,i){void 0===i&&(i="/");var n=T(("string"===typeof t?d(t):t).pathname||"/",i);if(null==n)return null;var r=_(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var i=e.length===t.length&&e.slice(0,-1).every((function(e,i){return e===t[i]}));return i?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(r);for(var a=null,o=0;null==a&&o<r.length;++o)a=k(r[o],n);return a}function _(e,t,i,n){return void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===n&&(n=""),e.forEach((function(e,r){var a={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(a.relativePath.startsWith(n)||y(!1),a.relativePath=a.relativePath.slice(n.length));var o=E([n,a.relativePath]),s=i.concat(a);e.children&&e.children.length>0&&(!0===e.index&&y(!1),_(e.children,t,s,o)),(null!=e.path||e.index)&&t.push({path:o,score:w(o,e.index),routesMeta:s})})),t}var b=/^:\w+$/,x=function(e){return"*"===e};function w(e,t){var i=e.split("/"),n=i.length;return i.some(x)&&(n+=-2),t&&(n+=2),i.filter((function(e){return!x(e)})).reduce((function(e,t){return e+(b.test(t)?3:""===t?1:10)}),n)}function k(e,t){for(var i=e.routesMeta,n={},r="/",a=[],o=0;o<i.length;++o){var s=i[o],l=o===i.length-1,u="/"===r?t:t.slice(r.length)||"/",c=P({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},u);if(!c)return null;Object.assign(n,c.params);var h=s.route;a.push({params:n,pathname:E([r,c.pathname]),pathnameBase:C(E([r,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(r=E([r,c.pathnameBase]))}return a}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var i=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!0);var n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return n.push(t),"([^\\/]+)"}));e.endsWith("*")?(n.push("*"),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r+=i?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)";return[new RegExp(r,t?void 0:"i"),n]}(e.path,e.caseSensitive,e.end),n=(0,r.Z)(i,2),a=n[0],o=n[1],s=t.match(a);if(!s)return null;var l=s[0],u=l.replace(/(.)\/+$/,"$1"),c=s.slice(1),h=o.reduce((function(e,t,i){if("*"===t){var n=c[i]||"";u=l.slice(0,l.length-n.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(i){return e}}(c[i]||""),e}),{});return{params:h,pathname:l,pathnameBase:u,pattern:e}}function S(e,t,i){var n,r="string"===typeof e?d(e):e,a=""===e||""===r.pathname?"/":r.pathname;if(null==a)n=i;else{var o=t.length-1;if(a.startsWith("..")){for(var s=a.split("/");".."===s[0];)s.shift(),o-=1;r.pathname=s.join("/")}n=o>=0?t[o]:"/"}var l=function(e,t){void 0===t&&(t="/");var i="string"===typeof e?d(e):e,n=i.pathname,r=i.search,a=void 0===r?"":r,o=i.hash,s=void 0===o?"":o,l=n?n.startsWith("/")?n:function(e,t){var i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?i.length>1&&i.pop():"."!==e&&i.push(e)})),i.length>1?i.join("/"):"/"}(n,t):t;return{pathname:l,search:M(a),hash:I(s)}}(r,n);return a&&"/"!==a&&a.endsWith("/")&&!l.pathname.endsWith("/")&&(l.pathname+="/"),l}function T(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var i=e.charAt(t.length);return i&&"/"!==i?null:e.slice(t.length)||"/"}var E=function(e){return e.join("/").replace(/\/\/+/g,"/")},C=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},M=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},I=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""};function O(e){D()||y(!1);var i=(0,t.useContext)(f),n=i.basename,r=i.navigator,a=z(e),o=a.hash,s=a.pathname,l=a.search,u=s;if("/"!==n){var c=function(e){return""===e||""===e.pathname?"/":"string"===typeof e?d(e).pathname:e.pathname}(e),h=null!=c&&c.endsWith("/");u="/"===s?n+(h?"/":""):E([n,s])}return r.createHref({pathname:u,search:l,hash:o})}function D(){return null!=(0,t.useContext)(m)}function A(){return D()||y(!1),(0,t.useContext)(m).location}function L(){D()||y(!1);var e=(0,t.useContext)(f),i=e.basename,n=e.navigator,r=(0,t.useContext)(v).matches,a=A().pathname,o=JSON.stringify(r.map((function(e){return e.pathnameBase}))),s=(0,t.useRef)(!1);(0,t.useEffect)((function(){s.current=!0}));var l=(0,t.useCallback)((function(e,t){if(void 0===t&&(t={}),s.current)if("number"!==typeof e){var r=S(e,JSON.parse(o),a);"/"!==i&&(r.pathname=E([i,r.pathname])),(t.replace?n.replace:n.push)(r,t.state)}else n.go(e)}),[i,n,o,a]);return l}function z(e){var i=(0,t.useContext)(v).matches,n=A().pathname,r=JSON.stringify(i.map((function(e){return e.pathnameBase})));return(0,t.useMemo)((function(){return S(e,JSON.parse(r),n)}),[e,r,n])}function R(e,i){return void 0===i&&(i=[]),null==e?null:e.reduceRight((function(n,r,a){return(0,t.createElement)(v.Provider,{children:void 0!==r.route.element?r.route.element:n,value:{outlet:n,matches:i.concat(e.slice(0,a+1))}})}),null)}function F(e){y(!1)}function j(i){var n=i.basename,r=void 0===n?"/":n,a=i.children,o=void 0===a?null:a,s=i.location,l=i.navigationType,u=void 0===l?e.Pop:l,c=i.navigator,h=i.static,p=void 0!==h&&h;D()&&y(!1);var v=C(r),g=(0,t.useMemo)((function(){return{basename:v,navigator:c,static:p}}),[v,c,p]);"string"===typeof s&&(s=d(s));var _=s,b=_.pathname,x=void 0===b?"/":b,w=_.search,k=void 0===w?"":w,P=_.hash,S=void 0===P?"":P,E=_.state,M=void 0===E?null:E,I=_.key,O=void 0===I?"default":I,A=(0,t.useMemo)((function(){var e=T(x,v);return null==e?null:{pathname:e,search:k,hash:S,state:M,key:O}}),[v,x,k,S,M,O]);return null==A?null:(0,t.createElement)(f.Provider,{value:g},(0,t.createElement)(m.Provider,{children:o,value:{location:A,navigationType:u}}))}function B(e){var i=e.children,n=e.location;return function(e,i){D()||y(!1);var n,r=(0,t.useContext)(v).matches,a=r[r.length-1],o=a?a.params:{},s=(a&&a.pathname,a?a.pathnameBase:"/"),l=(a&&a.route,A());if(i){var u,c="string"===typeof i?d(i):i;"/"===s||(null==(u=c.pathname)?void 0:u.startsWith(s))||y(!1),n=c}else n=l;var h=n.pathname||"/",p=g(e,{pathname:"/"===s?h:h.slice(s.length)||"/"});return R(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},o,e.params),pathname:E([s,e.pathname]),pathnameBase:"/"===e.pathnameBase?s:E([s,e.pathnameBase])})})),r)}(V(i),n)}function V(e){var i=[];return t.Children.forEach(e,(function(e){if((0,t.isValidElement)(e))if(e.type!==t.Fragment){e.type!==F&&y(!1);var n={caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path};e.props.children&&(n.children=V(e.props.children)),i.push(n)}else i.push.apply(i,V(e.props.children))})),i}function N(){return N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},N.apply(this,arguments)}function U(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}var G=["onClick","reloadDocument","replace","state","target","to"];function W(i){var n=i.basename,f=i.children,m=i.window,v=(0,t.useRef)();null==v.current&&(v.current=function(t){void 0===t&&(t={});var i=t.window,n=void 0===i?document.defaultView:i,r=n.history;function f(){var e=n.location,t=e.pathname,i=e.search,a=e.hash,s=r.state||{};return[s.idx,o({pathname:t,search:i,hash:a,state:s.usr||null,key:s.key||"default"})]}var m=null;n.addEventListener(l,(function(){if(m)x.call(m),m=null;else{var t=e.Pop,i=f(),n=i[0],r=i[1];if(x.length){if(null!=n){var a=g-n;a&&(m={action:t,location:r,retry:function(){E(-1*a)}},E(a))}}else T(t)}}));var v=e.Pop,y=f(),g=y[0],_=y[1],b=c(),x=c();function w(e){return"string"===typeof e?e:p(e)}function k(e,t){return void 0===t&&(t=null),o(a({pathname:_.pathname,hash:"",search:""},"string"===typeof e?d(e):e,{state:t,key:h()}))}function P(e,t){return[{usr:e.state,key:e.key,idx:t},w(e)]}function S(e,t,i){return!x.length||(x.call({action:e,location:t,retry:i}),!1)}function T(e){v=e;var t=f();g=t[0],_=t[1],b.call({action:v,location:_})}function E(e){r.go(e)}null==g&&(g=0,r.replaceState(a({},r.state,{idx:g}),""));var C={get action(){return v},get location(){return _},createHref:w,push:function t(i,a){var o=e.Push,s=k(i,a);if(S(o,s,(function(){t(i,a)}))){var l=P(s,g+1),u=l[0],c=l[1];try{r.pushState(u,"",c)}catch(h){n.location.assign(c)}T(o)}},replace:function t(i,n){var a=e.Replace,o=k(i,n);if(S(a,o,(function(){t(i,n)}))){var s=P(o,g),l=s[0],u=s[1];r.replaceState(l,"",u),T(a)}},go:E,back:function(){E(-1)},forward:function(){E(1)},listen:function(e){return b.push(e)},block:function(e){var t=x.push(e);return 1===x.length&&n.addEventListener(s,u),function(){t(),x.length||n.removeEventListener(s,u)}}};return C}({window:m}));var y=v.current,g=(0,t.useState)({action:y.action,location:y.location}),_=(0,r.Z)(g,2),b=_[0],x=_[1];return(0,t.useLayoutEffect)((function(){return y.listen(x)}),[y]),(0,t.createElement)(j,{basename:n,children:f,location:b.location,navigationType:b.action,navigator:y})}var H=(0,t.forwardRef)((function(e,i){var n=e.onClick,r=e.reloadDocument,a=e.replace,o=void 0!==a&&a,s=e.state,l=e.target,u=e.to,c=U(e,G),h=O(u),d=function(e,i){var n=void 0===i?{}:i,r=n.target,a=n.replace,o=n.state,s=L(),l=A(),u=z(e);return(0,t.useCallback)((function(t){if(0===t.button&&(!r||"_self"===r)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(t)){t.preventDefault();var i=!!a||p(l)===p(u);s(e,{replace:i,state:o})}}),[l,s,u,a,o,r,e])}(u,{replace:o,state:s,target:l});return(0,t.createElement)("a",N({},c,{href:h,onClick:function(e){n&&n(e),e.defaultPrevented||r||d(e)},ref:i,target:l}))}));var Z=i.p+"static/media/logo.4036a41313c0fff7aba5ddf663b039ce.svg",q=i(4942);function X(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function K(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?X(Object(i),!0).forEach((function(t){(0,q.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};function $(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var J=i(1694),Q=i.n(J),ee=(0,t.createContext)({}),te=i(1002);function ie(e,t){(function(e){return"string"===typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var i=function(e){return"string"===typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function ne(e){return e<=1?"".concat(100*Number(e),"%"):e}function re(e){return 1===e.length?"0"+e:String(e)}function ae(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*i*(t-e):i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function oe(e){return se(e)/255}function se(e){return parseInt(e,16)}var le={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ue(e){var t,i,n,r={r:0,g:0,b:0},a=1,o=null,s=null,l=null,u=!1,c=!1;return"string"===typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(le[e])e=le[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var i=de.rgb.exec(e);if(i)return{r:i[1],g:i[2],b:i[3]};if(i=de.rgba.exec(e))return{r:i[1],g:i[2],b:i[3],a:i[4]};if(i=de.hsl.exec(e))return{h:i[1],s:i[2],l:i[3]};if(i=de.hsla.exec(e))return{h:i[1],s:i[2],l:i[3],a:i[4]};if(i=de.hsv.exec(e))return{h:i[1],s:i[2],v:i[3]};if(i=de.hsva.exec(e))return{h:i[1],s:i[2],v:i[3],a:i[4]};if(i=de.hex8.exec(e))return{r:se(i[1]),g:se(i[2]),b:se(i[3]),a:oe(i[4]),format:t?"name":"hex8"};if(i=de.hex6.exec(e))return{r:se(i[1]),g:se(i[2]),b:se(i[3]),format:t?"name":"hex"};if(i=de.hex4.exec(e))return{r:se(i[1]+i[1]),g:se(i[2]+i[2]),b:se(i[3]+i[3]),a:oe(i[4]+i[4]),format:t?"name":"hex8"};if(i=de.hex3.exec(e))return{r:se(i[1]+i[1]),g:se(i[2]+i[2]),b:se(i[3]+i[3]),format:t?"name":"hex"};return!1}(e)),"object"===typeof e&&(fe(e.r)&&fe(e.g)&&fe(e.b)?(t=e.r,i=e.g,n=e.b,r={r:255*ie(t,255),g:255*ie(i,255),b:255*ie(n,255)},u=!0,c="%"===String(e.r).substr(-1)?"prgb":"rgb"):fe(e.h)&&fe(e.s)&&fe(e.v)?(o=ne(e.s),s=ne(e.v),r=function(e,t,i){e=6*ie(e,360),t=ie(t,100),i=ie(i,100);var n=Math.floor(e),r=e-n,a=i*(1-t),o=i*(1-r*t),s=i*(1-(1-r)*t),l=n%6;return{r:255*[i,o,a,a,s,i][l],g:255*[s,i,i,o,a,a][l],b:255*[a,a,s,i,i,o][l]}}(e.h,o,s),u=!0,c="hsv"):fe(e.h)&&fe(e.s)&&fe(e.l)&&(o=ne(e.s),l=ne(e.l),r=function(e,t,i){var n,r,a;if(e=ie(e,360),t=ie(t,100),i=ie(i,100),0===t)r=i,a=i,n=i;else{var o=i<.5?i*(1+t):i+t-i*t,s=2*i-o;n=ae(s,o,e+1/3),r=ae(s,o,e),a=ae(s,o,e-1/3)}return{r:255*n,g:255*r,b:255*a}}(e.h,o,l),u=!0,c="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(a),{ok:u,format:e.format||c,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:a}}var ce="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),he="[\\s|\\(]+(".concat(ce,")[,|\\s]+(").concat(ce,")[,|\\s]+(").concat(ce,")\\s*\\)?"),pe="[\\s|\\(]+(".concat(ce,")[,|\\s]+(").concat(ce,")[,|\\s]+(").concat(ce,")[,|\\s]+(").concat(ce,")\\s*\\)?"),de={CSS_UNIT:new RegExp(ce),rgb:new RegExp("rgb"+he),rgba:new RegExp("rgba"+pe),hsl:new RegExp("hsl"+he),hsla:new RegExp("hsla"+pe),hsv:new RegExp("hsv"+he),hsva:new RegExp("hsva"+pe),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function fe(e){return Boolean(de.CSS_UNIT.exec(String(e)))}var me=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ve(e){var t=function(e,t,i){e=ie(e,255),t=ie(t,255),i=ie(i,255);var n=Math.max(e,t,i),r=Math.min(e,t,i),a=0,o=n,s=n-r,l=0===n?0:s/n;if(n===r)a=0;else{switch(n){case e:a=(t-i)/s+(t<i?6:0);break;case t:a=(i-e)/s+2;break;case i:a=(e-t)/s+4}a/=6}return{h:a,s:l,v:o}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function ye(e){var t=e.r,i=e.g,n=e.b;return"#".concat(function(e,t,i,n){var r=[re(Math.round(e).toString(16)),re(Math.round(t).toString(16)),re(Math.round(i).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}(t,i,n,!1))}function ge(e,t,i){var n=i/100;return{r:(t.r-e.r)*n+e.r,g:(t.g-e.g)*n+e.g,b:(t.b-e.b)*n+e.b}}function _e(e,t,i){var n;return(n=Math.round(e.h)>=60&&Math.round(e.h)<=240?i?Math.round(e.h)-2*t:Math.round(e.h)+2*t:i?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?n+=360:n>=360&&(n-=360),n}function be(e,t,i){return 0===e.h&&0===e.s?e.s:((n=i?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(n=1),i&&5===t&&n>.1&&(n=.1),n<.06&&(n=.06),Number(n.toFixed(2)));var n}function xe(e,t,i){var n;return(n=i?e.v+.05*t:e.v-.15*t)>1&&(n=1),Number(n.toFixed(2))}function we(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],n=ue(e),r=5;r>0;r-=1){var a=ve(n),o=ye(ue({h:_e(a,r,!0),s:be(a,r,!0),v:xe(a,r,!0)}));i.push(o)}i.push(ye(n));for(var s=1;s<=4;s+=1){var l=ve(n),u=ye(ue({h:_e(l,s),s:be(l,s),v:xe(l,s)}));i.push(u)}return"dark"===t.theme?me.map((function(e){var n=e.index,r=e.opacity;return ye(ge(ue(t.backgroundColor||"#141414"),ue(i[n]),100*r))})):i}var ke={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Pe={},Se={};Object.keys(ke).forEach((function(e){Pe[e]=we(ke[e]),Pe[e].primary=Pe[e][5],Se[e]=we(ke[e],{theme:"dark",backgroundColor:"#141414"}),Se[e].primary=Se[e][5]}));Pe.red,Pe.volcano,Pe.gold,Pe.orange,Pe.yellow,Pe.lime,Pe.green,Pe.cyan,Pe.blue,Pe.geekblue,Pe.purple,Pe.magenta,Pe.grey;var Te={};function Ee(e,t){0}function Ce(e,t,i){t||Te[i]||(e(!1,i),Te[i]=!0)}var Me=function(e,t){Ce(Ee,e,t)};function Ie(){return!("undefined"===typeof window||!window.document||!window.document.createElement)}var Oe="rc-util-key";function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):Oe}function Ae(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function Le(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Ie())return null;var n,r=document.createElement("style");(null===(t=i.csp)||void 0===t?void 0:t.nonce)&&(r.nonce=null===(n=i.csp)||void 0===n?void 0:n.nonce);r.innerHTML=e;var a=Ae(i),o=a.firstChild;return i.prepend&&a.prepend?a.prepend(r):i.prepend&&o?a.insertBefore(r,o):a.appendChild(r),r}var ze=new Map;function Re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Ae(t);return Array.from(ze.get(i).children).find((function(i){return"STYLE"===i.tagName&&i.getAttribute(De(t))===e}))}function Fe(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Ae(i);if(!ze.has(n)){var r=Le("",i),a=r.parentNode;ze.set(n,a),a.removeChild(r)}var o=Re(t,i);if(o){var s,l,u;if((null===(s=i.csp)||void 0===s?void 0:s.nonce)&&o.nonce!==(null===(l=i.csp)||void 0===l?void 0:l.nonce))o.nonce=null===(u=i.csp)||void 0===u?void 0:u.nonce;return o.innerHTML!==e&&(o.innerHTML=e),o}var c=Le(e,i);return c.setAttribute(De(i),t),c}function je(e){return"object"===(0,te.Z)(e)&&"string"===typeof e.name&&"string"===typeof e.theme&&("object"===(0,te.Z)(e.icon)||"function"===typeof e.icon)}function Be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,i){var n=e[i];if("class"===i)t.className=n,delete t.class;else t[i]=n;return t}),{})}function Ve(e,i,n){return n?t.createElement(e.tag,K(K({key:i},Be(e.attrs)),n),(e.children||[]).map((function(t,n){return Ve(t,"".concat(i,"-").concat(e.tag,"-").concat(n))}))):t.createElement(e.tag,K({key:i},Be(e.attrs)),(e.children||[]).map((function(t,n){return Ve(t,"".concat(i,"-").concat(e.tag,"-").concat(n))})))}function Ne(e){return we(e)[0]}function Ue(e){return e?Array.isArray(e)?e:[e]:[]}var Ge="\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",We=["icon","className","onClick","style","primaryColor","secondaryColor"],He={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var Ze=function(e){var i,n,r=e.icon,a=e.className,o=e.onClick,s=e.style,l=e.primaryColor,u=e.secondaryColor,c=$(e,We),h=He;if(l&&(h={primaryColor:l,secondaryColor:u||Ne(l)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,i=(0,t.useContext)(ee).csp;(0,t.useEffect)((function(){Fe(e,"@ant-design-icons",{prepend:!0,csp:i})}),[])}(),i=je(r),n="icon should be icon definiton, but got ".concat(r),Me(i,"[@ant-design/icons] ".concat(n)),!je(r))return null;var p=r;return p&&"function"===typeof p.icon&&(p=K(K({},p),{},{icon:p.icon(h.primaryColor,h.secondaryColor)})),Ve(p.icon,"svg-".concat(p.name),K({className:a,onClick:o,style:s,"data-icon":p.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},c))};Ze.displayName="IconReact",Ze.getTwoToneColors=function(){return K({},He)},Ze.setTwoToneColors=function(e){var t=e.primaryColor,i=e.secondaryColor;He.primaryColor=t,He.secondaryColor=i||Ne(t),He.calculated=!!i};var qe=Ze;function Xe(e){var t=Ue(e),i=(0,r.Z)(t,2),n=i[0],a=i[1];return qe.setTwoToneColors({primaryColor:n,secondaryColor:a})}var Ke=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Xe("#1890ff");var Ye=t.forwardRef((function(e,i){var n,a=e.className,o=e.icon,s=e.spin,l=e.rotate,u=e.tabIndex,c=e.onClick,h=e.twoToneColor,p=$(e,Ke),d=t.useContext(ee).prefixCls,f=void 0===d?"anticon":d,m=Q()(f,(n={},(0,q.Z)(n,"".concat(f,"-").concat(o.name),!!o.name),(0,q.Z)(n,"".concat(f,"-spin"),!!s||"loading"===o.name),n),a),v=u;void 0===v&&c&&(v=-1);var y=l?{msTransform:"rotate(".concat(l,"deg)"),transform:"rotate(".concat(l,"deg)")}:void 0,g=Ue(h),_=(0,r.Z)(g,2),b=_[0],x=_[1];return t.createElement("span",K(K({role:"img","aria-label":o.name},p),{},{ref:i,tabIndex:v,onClick:c,className:m}),t.createElement(qe,{icon:o,primaryColor:b,secondaryColor:x,style:y}))}));Ye.displayName="AntdIcon",Ye.getTwoToneColor=function(){var e=qe.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},Ye.setTwoToneColor=Xe;var $e=Ye,Je=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:Y}))};Je.displayName="MoreOutlined";var Qe=t.forwardRef(Je),et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"},tt=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:et}))};tt.displayName="CloseOutlined";var it=t.forwardRef(tt),nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M705.6 124.9a8 8 0 00-11.6 7.2v64.2c0 5.5 2.9 10.6 7.5 13.6a352.2 352.2 0 0162.2 49.8c32.7 32.8 58.4 70.9 76.3 113.3a355 355 0 0127.9 138.7c0 48.1-9.4 94.8-27.9 138.7a355.92 355.92 0 01-76.3 113.3 353.06 353.06 0 01-113.2 76.4c-43.8 18.6-90.5 28-138.5 28s-94.7-9.4-138.5-28a353.06 353.06 0 01-113.2-76.4A355.92 355.92 0 01184 650.4a355 355 0 01-27.9-138.7c0-48.1 9.4-94.8 27.9-138.7 17.9-42.4 43.6-80.5 76.3-113.3 19-19 39.8-35.6 62.2-49.8 4.7-2.9 7.5-8.1 7.5-13.6V132c0-6-6.3-9.8-11.6-7.2C178.5 195.2 82 339.3 80 506.3 77.2 745.1 272.5 943.5 511.2 944c239 .5 432.8-193.3 432.8-432.4 0-169.2-97-315.7-238.4-386.7zM480 560h64c4.4 0 8-3.6 8-8V88c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8z"}}]},name:"poweroff",theme:"outlined"},rt=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:nt}))};rt.displayName="PoweroffOutlined";var at=t.forwardRef(rt),ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"},st=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:ot}))};st.displayName="MessageOutlined";var lt=t.forwardRef(st),ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},ct=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:ut}))};ct.displayName="SearchOutlined";var ht=t.forwardRef(ct);var pt=i.p+"static/media/notification-icon.50eaa43826d3b4ed0f258d04237b72da.svg";var dt=i.p+"static/media/setting-icon.1b0ff6d707211ca893f6f364b4bfb276.svg";var ft=i.p+"static/media/profile-icon.bcfd4beba4324e56ab72bb91f8e31dc1.svg",mt=i(184),vt=function(){var e=(0,t.useState)(!1),i=(0,r.Z)(e,2),n=i[0],a=i[1],o=function(){a(!n)};return(0,mt.jsxs)("div",{className:"header",children:[(0,mt.jsx)("div",{className:"menu-icon",children:(0,mt.jsx)(Qe,{className:"menu",onClick:o})}),(0,mt.jsx)("nav",{className:n?"sliders actives":"sliders",children:(0,mt.jsxs)("ul",{children:[(0,mt.jsx)("div",{className:"closed",children:(0,mt.jsx)(it,{className:"close",onClick:o})}),(0,mt.jsx)("div",{className:"navbar-icons",children:(0,mt.jsxs)("ul",{children:[(0,mt.jsx)("li",{children:(0,mt.jsx)(at,{style:{fontSize:"21px"}})}),(0,mt.jsx)("li",{className:"navbar-bell",children:(0,mt.jsx)("img",{src:pt,alt:"bell"})}),(0,mt.jsx)("li",{className:"navbar-setting",children:(0,mt.jsx)("img",{src:dt,alt:"setting"})}),(0,mt.jsx)("li",{children:(0,mt.jsx)(lt,{style:{fontSize:"21px",marginTop:"30px"}})}),(0,mt.jsx)("li",{className:"navbar-profile",children:(0,mt.jsx)("img",{src:ft,alt:"profile"})}),(0,mt.jsx)("li",{children:(0,mt.jsx)(ht,{style:{fontSize:"23px",marginTop:"30px"}})})]})})]})})]})},yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]},name:"menu",theme:"outlined"},gt=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:yt}))};gt.displayName="MenuOutlined";var _t=t.forwardRef(gt),bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},xt=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:bt}))};xt.displayName="EyeOutlined";var wt=t.forwardRef(xt),kt=i(5671),Pt=i(3144),St=i(9340),Tt=i(1120);var Et=i(2963);function Ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=(0,Tt.Z)(e);if(t){var r=(0,Tt.Z)(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return(0,Et.Z)(this,i)}}var Mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},It=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:Mt}))};It.displayName="EllipsisOutlined";var Ot=t.forwardRef(It),Dt=i(2982),At=i(9613),Lt=i.n(At);function zt(e){var i=t.useRef();i.current=e;var n=t.useCallback((function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null===(e=i.current)||void 0===e?void 0:e.call.apply(e,[i].concat(n))}),[]);return n}var Rt,Ft=Ie()?t.useLayoutEffect:t.useEffect,jt=Ft;function Bt(e){var i=t.useRef(!1),n=t.useState(e),a=(0,r.Z)(n,2),o=a[0],s=a[1];return t.useEffect((function(){return i.current=!1,function(){i.current=!0}}),[]),[o,function(e,t){t&&i.current||s(e)}]}function Vt(e){return void 0!==e}function Nt(e,i){var n=i||{},a=n.defaultValue,o=n.value,s=n.onChange,l=n.postState,u=Bt((function(){var t,i=void 0;return Vt(o)?(i=o,t=Rt.PROP):Vt(a)?(i="function"===typeof a?a():a,t=Rt.PROP):(i="function"===typeof e?e():e,t=Rt.INNER),[i,t,i]})),c=(0,r.Z)(u,2),h=c[0],p=c[1],d=Vt(o)?o:h[0],f=l?l(d):d;!function(e,i){var n=t.useRef(!0);Ft((function(){if(!n.current)return e()}),i),Ft((function(){return n.current=!1,function(){n.current=!0}}),[])}((function(){p((function(e){var t=(0,r.Z)(e,1)[0];return[o,Rt.PROP,t]}))}),[o]);var m=t.useRef(),v=zt((function(e,t){p((function(t){var i=(0,r.Z)(t,3),n=i[0],a=i[1],o=i[2],s="function"===typeof e?e(n):e;if(s===n)return t;var l=a===Rt.INNER&&m.current!==o?o:n;return[s,Rt.INNER,l]}),t)})),y=zt(s);return jt((function(){var e=(0,r.Z)(h,3),t=e[0],i=e[1],n=e[2];t!==n&&i===Rt.INNER&&(y(t,n),m.current=n)}),[h]),[f,v]}!function(e){e[e.INNER=0]="INNER",e[e.PROP=1]="PROP"}(Rt||(Rt={}));var Ut=i(3873);function Gt(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return t.Children.forEach(e,(function(e){(void 0!==e&&null!==e||i.keepEmpty)&&(Array.isArray(e)?n=n.concat(Gt(e)):(0,Ut.isFragment)(e)&&e.props?n=n.concat(Gt(e.props.children,i)):n.push(e))})),n}function Wt(e,t){"function"===typeof e?e(t):"object"===(0,te.Z)(e)&&e&&"current"in e&&(e.current=t)}function Ht(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.filter((function(e){return e}));return n.length<=1?n[0]:function(e){t.forEach((function(t){Wt(t,e)}))}}function Zt(e){var t,i,n=(0,Ut.isMemo)(e)?e.type.type:e.type;return!("function"===typeof n&&!(null===(t=n.prototype)||void 0===t?void 0:t.render))&&!("function"===typeof e&&!(null===(i=e.prototype)||void 0===i?void 0:i.render))}var qt=i(4164);function Xt(e){return e instanceof HTMLElement?e:qt.findDOMNode(e)}var Kt=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var i=-1;return e.some((function(e,n){return e[0]===t&&(i=n,!0)})),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var i=e(this.__entries__,t),n=this.__entries__[i];return n&&n[1]},t.prototype.set=function(t,i){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,n=e(i,t);~n&&i.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];e.call(t,r[1],r[0])}},t}()}(),Yt="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,$t="undefined"!==typeof i.g&&i.g.Math===Math?i.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),Jt="function"===typeof requestAnimationFrame?requestAnimationFrame.bind($t):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var Qt=["top","right","bottom","left","width","height","size","weight"],ei="undefined"!==typeof MutationObserver,ti=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var i=!1,n=!1,r=0;function a(){i&&(i=!1,e()),n&&s()}function o(){Jt(a)}function s(){var e=Date.now();if(i){if(e-r<2)return;n=!0}else i=!0,n=!1,setTimeout(o,t);r=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){Yt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),ei?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){Yt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=void 0===t?"":t;Qt.some((function(e){return!!~i.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ii=function(e,t){for(var i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];Object.defineProperty(e,r,{value:t[r],enumerable:!1,writable:!1,configurable:!0})}return e},ni=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||$t},ri=ci(0,0,0,0);function ai(e){return parseFloat(e)||0}function oi(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce((function(t,i){return t+ai(e["border-"+i+"-width"])}),0)}function si(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return ri;var n=ni(e).getComputedStyle(e),r=function(e){for(var t={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i],a=e["padding-"+r];t[r]=ai(a)}return t}(n),a=r.left+r.right,o=r.top+r.bottom,s=ai(n.width),l=ai(n.height);if("border-box"===n.boxSizing&&(Math.round(s+a)!==t&&(s-=oi(n,"left","right")+a),Math.round(l+o)!==i&&(l-=oi(n,"top","bottom")+o)),!function(e){return e===ni(e).document.documentElement}(e)){var u=Math.round(s+a)-t,c=Math.round(l+o)-i;1!==Math.abs(u)&&(s-=u),1!==Math.abs(c)&&(l-=c)}return ci(r.left,r.top,s,l)}var li="undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof ni(e).SVGGraphicsElement}:function(e){return e instanceof ni(e).SVGElement&&"function"===typeof e.getBBox};function ui(e){return Yt?li(e)?function(e){var t=e.getBBox();return ci(0,0,t.width,t.height)}(e):si(e):ri}function ci(e,t,i,n){return{x:e,y:t,width:i,height:n}}var hi=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=ci(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=ui(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),pi=function(e,t){var i=function(e){var t=e.x,i=e.y,n=e.width,r=e.height,a="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(a.prototype);return ii(o,{x:t,y:i,width:n,height:r,top:i,right:t+n,bottom:r+i,left:t}),o}(t);ii(this,{target:e,contentRect:i})},di=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new Kt,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof ni(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new hi(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof ni(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new pi(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),fi="undefined"!==typeof WeakMap?new WeakMap:new Kt,mi=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=ti.getInstance(),n=new di(t,i,this);fi.set(this,n)};["observe","unobserve","disconnect"].forEach((function(e){mi.prototype[e]=function(){var t;return(t=fi.get(this))[e].apply(t,arguments)}}));var vi="undefined"!==typeof $t.ResizeObserver?$t.ResizeObserver:mi,yi=new Map;var gi=new vi((function(e){e.forEach((function(e){var t,i=e.target;null===(t=yi.get(i))||void 0===t||t.forEach((function(e){return e(i)}))}))}));var _i=function(e){(0,St.Z)(i,e);var t=Ct(i);function i(){return(0,kt.Z)(this,i),t.apply(this,arguments)}return(0,Pt.Z)(i,[{key:"render",value:function(){return this.props.children}}]),i}(t.Component),bi=t.createContext(null);function xi(e){var i=e.children,n=e.disabled,r=t.useRef(null),a=t.useRef(null),o=t.useContext(bi),s="function"===typeof i,l=s?i(r):i,u=t.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),c=!s&&t.isValidElement(l)&&Zt(l),h=c?l.ref:null,p=t.useMemo((function(){return Ht(h,r)}),[h,r]),d=t.useRef(e);d.current=e;var f=t.useCallback((function(e){var t=d.current,i=t.onResize,n=t.data,r=e.getBoundingClientRect(),a=r.width,s=r.height,l=e.offsetWidth,c=e.offsetHeight,h=Math.floor(a),p=Math.floor(s);if(u.current.width!==h||u.current.height!==p||u.current.offsetWidth!==l||u.current.offsetHeight!==c){var f={width:h,height:p,offsetWidth:l,offsetHeight:c};u.current=f;var m=l===Math.round(a)?a:l,v=c===Math.round(s)?s:c,y=K(K({},f),{},{offsetWidth:m,offsetHeight:v});null===o||void 0===o||o(y,e,n),i&&Promise.resolve().then((function(){i(y,e)}))}}),[]);return t.useEffect((function(){var e,t,i=Xt(r.current)||Xt(a.current);return i&&!n&&(e=i,t=f,yi.has(e)||(yi.set(e,new Set),gi.observe(e)),yi.get(e).add(t)),function(){return function(e,t){yi.has(e)&&(yi.get(e).delete(t),yi.get(e).size||(gi.unobserve(e),yi.delete(e)))}(i,f)}}),[r.current,n]),t.createElement(_i,{ref:a},c?t.cloneElement(l,{ref:p}):l)}function wi(e){var i=e.children;return("function"===typeof i?[i]:Gt(i)).map((function(i,n){var r=(null===i||void 0===i?void 0:i.key)||"".concat("rc-observer-key","-").concat(n);return t.createElement(xi,a({},e,{key:r}),i)}))}wi.Collection=function(e){var i=e.children,n=e.onBatchResize,r=t.useRef(0),a=t.useRef([]),o=t.useContext(bi),s=t.useCallback((function(e,t,i){r.current+=1;var s=r.current;a.current.push({size:e,element:t,data:i}),Promise.resolve().then((function(){s===r.current&&(null===n||void 0===n||n(a.current),a.current=[])})),null===o||void 0===o||o(e,t,i)}),[n,o]);return t.createElement(bi.Provider,{value:s},i)};var ki=wi,Pi=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Si=void 0;function Ti(e,i){var n=e.prefixCls,r=e.invalidate,o=e.item,s=e.renderItem,l=e.responsive,u=e.responsiveDisabled,c=e.registerSize,h=e.itemKey,p=e.className,d=e.style,f=e.children,m=e.display,v=e.order,y=e.component,g=void 0===y?"div":y,_=$(e,Pi),b=l&&!m;function x(e){c(h,e)}t.useEffect((function(){return function(){x(null)}}),[]);var w,k=s&&o!==Si?s(o):f;r||(w={opacity:b?0:1,height:b?0:Si,overflowY:b?"hidden":Si,order:l?v:Si,pointerEvents:b?"none":Si,position:b?"absolute":Si});var P={};b&&(P["aria-hidden"]=!0);var S=t.createElement(g,a({className:Q()(!r&&n,p),style:K(K({},w),d)},P,_,{ref:i}),k);return l&&(S=t.createElement(ki,{onResize:function(e){x(e.offsetWidth)},disabled:u},S)),S}var Ei=t.forwardRef(Ti);Ei.displayName="Item";var Ci=Ei,Mi=function(e){return+setTimeout(e,16)},Ii=function(e){return clearTimeout(e)};"undefined"!==typeof window&&"requestAnimationFrame"in window&&(Mi=function(e){return window.requestAnimationFrame(e)},Ii=function(e){return window.cancelAnimationFrame(e)});var Oi=0,Di=new Map;function Ai(e){Di.delete(e)}function Li(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=Oi+=1;function n(t){if(0===t)Ai(i),e();else{var r=Mi((function(){n(t-1)}));Di.set(i,r)}}return n(t),i}Li.cancel=function(e){var t=Di.get(e);return Ai(t),Ii(t)};var zi=["component"],Ri=["className"],Fi=["className"],ji=function(e,i){var n=t.useContext(Ui);if(!n){var r=e.component,o=void 0===r?"div":r,s=$(e,zi);return t.createElement(o,a({},s,{ref:i}))}var l=n.className,u=$(n,Ri),c=e.className,h=$(e,Fi);return t.createElement(Ui.Provider,{value:null},t.createElement(Ci,a({ref:i,className:Q()(l,c)},u,h)))},Bi=t.forwardRef(ji);Bi.displayName="RawItem";var Vi=Bi,Ni=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],Ui=t.createContext(null),Gi="responsive",Wi="invalidate";function Hi(e){return"+ ".concat(e.length," ...")}function Zi(e,i){var n=e.prefixCls,o=void 0===n?"rc-overflow":n,s=e.data,l=void 0===s?[]:s,u=e.renderItem,c=e.renderRawItem,h=e.itemKey,p=e.itemWidth,d=void 0===p?10:p,f=e.ssr,m=e.style,v=e.className,y=e.maxCount,g=e.renderRest,_=e.renderRawRest,b=e.suffix,x=e.component,w=void 0===x?"div":x,k=e.itemComponent,P=e.onVisibleChange,S=$(e,Ni),T=function(){var e=Bt({}),i=(0,r.Z)(e,2)[1],n=(0,t.useRef)([]),a=0,o=0;return function(e){var t=a;return a+=1,n.current.length<t+1&&(n.current[t]=e),[n.current[t],function(e){n.current[t]="function"===typeof e?e(n.current[t]):e,Li.cancel(o),o=Li((function(){i({},!0)}))}]}}(),E="full"===f,C=T(null),M=(0,r.Z)(C,2),I=M[0],O=M[1],D=I||0,A=T(new Map),L=(0,r.Z)(A,2),z=L[0],R=L[1],F=T(0),j=(0,r.Z)(F,2),B=j[0],V=j[1],N=T(0),U=(0,r.Z)(N,2),G=U[0],W=U[1],H=T(0),Z=(0,r.Z)(H,2),q=Z[0],X=Z[1],Y=(0,t.useState)(null),J=(0,r.Z)(Y,2),ee=J[0],te=J[1],ie=(0,t.useState)(null),ne=(0,r.Z)(ie,2),re=ne[0],ae=ne[1],oe=t.useMemo((function(){return null===re&&E?Number.MAX_SAFE_INTEGER:re||0}),[re,I]),se=(0,t.useState)(!1),le=(0,r.Z)(se,2),ue=le[0],ce=le[1],he="".concat(o,"-item"),pe=Math.max(B,G),de=y===Gi,fe=l.length&&de,me=y===Wi,ve=fe||"number"===typeof y&&l.length>y,ye=(0,t.useMemo)((function(){var e=l;return fe?e=null===I&&E?l:l.slice(0,Math.min(l.length,D/d)):"number"===typeof y&&(e=l.slice(0,y)),e}),[l,d,I,y,fe]),ge=(0,t.useMemo)((function(){return fe?l.slice(oe+1):l.slice(ye.length)}),[l,ye,fe,oe]),_e=(0,t.useCallback)((function(e,t){var i;return"function"===typeof h?h(e):null!==(i=h&&(null===e||void 0===e?void 0:e[h]))&&void 0!==i?i:t}),[h]),be=(0,t.useCallback)(u||function(e){return e},[u]);function xe(e,t){ae(e),t||(ce(e<l.length-1),null===P||void 0===P||P(e))}function we(e,t){R((function(i){var n=new Map(i);return null===t?n.delete(e):n.set(e,t),n}))}function ke(e){return z.get(_e(ye[e],e))}jt((function(){if(D&&pe&&ye){var e=q,t=ye.length,i=t-1;if(!t)return xe(0),void te(null);for(var n=0;n<t;n+=1){var r=ke(n);if(E&&(r=r||0),void 0===r){xe(n-1,!0);break}if(e+=r,0===i&&e<=D||n===i-1&&e+ke(i)<=D){xe(i),te(null);break}if(e+pe>D){xe(n-1),te(e-r-q+G);break}}b&&ke(0)+q>D&&te(null)}}),[D,z,G,q,_e,ye]);var Pe=ue&&!!ge.length,Se={};null!==ee&&fe&&(Se={position:"absolute",left:ee,top:0});var Te,Ee={prefixCls:he,responsive:fe,component:k,invalidate:me},Ce=c?function(e,i){var n=_e(e,i);return t.createElement(Ui.Provider,{key:n,value:K(K({},Ee),{},{order:i,item:e,itemKey:n,registerSize:we,display:i<=oe})},c(e,i))}:function(e,i){var n=_e(e,i);return t.createElement(Ci,a({},Ee,{order:i,key:n,item:e,renderItem:be,itemKey:n,registerSize:we,display:i<=oe}))},Me={order:Pe?oe:Number.MAX_SAFE_INTEGER,className:"".concat(he,"-rest"),registerSize:function(e,t){W(t),V(G)},display:Pe};if(_)_&&(Te=t.createElement(Ui.Provider,{value:K(K({},Ee),Me)},_(ge)));else{var Ie=g||Hi;Te=t.createElement(Ci,a({},Ee,Me),"function"===typeof Ie?Ie(ge):Ie)}var Oe=t.createElement(w,a({className:Q()(!me&&o,v),style:m,ref:i},S),ye.map(Ce),ve?Te:null,b&&t.createElement(Ci,a({},Ee,{responsive:de,responsiveDisabled:!fe,order:oe,className:"".concat(he,"-suffix"),registerSize:function(e,t){X(t)},display:!0,style:Se}),b));return de&&(Oe=t.createElement(ki,{onResize:function(e,t){O(t.clientWidth)},disabled:!fe},Oe)),Oe}var qi=t.forwardRef(Zi);qi.displayName="Overflow",qi.Item=Vi,qi.RESPONSIVE=Gi,qi.INVALIDATE=Wi;var Xi=qi,Ki={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=Ki.F1&&t<=Ki.F12)return!1;switch(t){case Ki.ALT:case Ki.CAPS_LOCK:case Ki.CONTEXT_MENU:case Ki.CTRL:case Ki.DOWN:case Ki.END:case Ki.ESC:case Ki.HOME:case Ki.INSERT:case Ki.LEFT:case Ki.MAC_FF_META:case Ki.META:case Ki.NUMLOCK:case Ki.NUM_CENTER:case Ki.PAGE_DOWN:case Ki.PAGE_UP:case Ki.PAUSE:case Ki.PRINT_SCREEN:case Ki.RIGHT:case Ki.SHIFT:case Ki.UP:case Ki.WIN_KEY:case Ki.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Ki.ZERO&&e<=Ki.NINE)return!0;if(e>=Ki.NUM_ZERO&&e<=Ki.NUM_MULTIPLY)return!0;if(e>=Ki.A&&e<=Ki.Z)return!0;if(-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case Ki.SPACE:case Ki.QUESTION_MARK:case Ki.NUM_PLUS:case Ki.NUM_MINUS:case Ki.NUM_PERIOD:case Ki.NUM_DIVISION:case Ki.SEMICOLON:case Ki.DASH:case Ki.EQUALS:case Ki.COMMA:case Ki.PERIOD:case Ki.SLASH:case Ki.APOSTROPHE:case Ki.SINGLE_QUOTE:case Ki.OPEN_SQUARE_BRACKET:case Ki.BACKSLASH:case Ki.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Yi=Ki;function $i(e,t){var i=K({},e);return Array.isArray(t)&&t.forEach((function(e){delete i[e]})),i}var Ji=["children","locked"],Qi=t.createContext(null);function en(e){var i=e.children,n=e.locked,r=$(e,Ji),a=t.useContext(Qi),o=function(e,i,n){var r=t.useRef({});return"value"in r.current&&!n(r.current.condition,i)||(r.current.value=e(),r.current.condition=i),r.current.value}((function(){return function(e,t){var i=K({},e);return Object.keys(t).forEach((function(e){var n=t[e];void 0!==n&&(i[e]=n)})),i}(a,r)}),[a,r],(function(e,t){return!n&&(e[0]!==t[0]||!Lt()(e[1],t[1]))}));return t.createElement(Qi.Provider,{value:o},i)}function tn(e,i,n,r){var a=t.useContext(Qi),o=a.activeKey,s=a.onActive,l=a.onInactive,u={active:o===e};return i||(u.onMouseEnter=function(t){null===n||void 0===n||n({key:e,domEvent:t}),s(e)},u.onMouseLeave=function(t){null===r||void 0===r||r({key:e,domEvent:t}),l(e)}),u}var nn=["item"];function rn(e){var t=e.item,i=$(e,nn);return Object.defineProperty(i,"item",{get:function(){return Me(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),i}function an(e){var i=e.icon,n=e.props,r=e.children;return("function"===typeof i?t.createElement(i,K({},n)):i)||r||null}function on(e){var i=t.useContext(Qi),n=i.mode,r=i.rtl,a=i.inlineIndent;if("inline"!==n)return null;return r?{paddingRight:e*a}:{paddingLeft:e*a}}var sn=[],ln=t.createContext(null);function un(){return t.useContext(ln)}var cn=t.createContext(sn);function hn(e){var i=t.useContext(cn);return t.useMemo((function(){return void 0!==e?[].concat((0,Dt.Z)(i),[e]):i}),[i,e])}var pn=t.createContext(null),dn=t.createContext(null);function fn(e,t){return void 0===e?null:"".concat(e,"-").concat(t)}function mn(e){return fn(t.useContext(dn),e)}var vn=t.createContext({}),yn=["title","attribute","elementRef"],gn=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],_n=["active"],bn=function(e){(0,St.Z)(n,e);var i=Ct(n);function n(){return(0,kt.Z)(this,n),i.apply(this,arguments)}return(0,Pt.Z)(n,[{key:"render",value:function(){var e=this.props,i=e.title,n=e.attribute,r=e.elementRef,o=$i($(e,yn),["eventKey"]);return Me(!n,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),t.createElement(Xi.Item,a({},n,{title:"string"===typeof i?i:void 0},o,{ref:r}))}}]),n}(t.Component),xn=function(e){var i,n=e.style,r=e.className,o=e.eventKey,s=(e.warnKey,e.disabled),l=e.itemIcon,u=e.children,c=e.role,h=e.onMouseEnter,p=e.onMouseLeave,d=e.onClick,f=e.onKeyDown,m=e.onFocus,v=$(e,gn),y=mn(o),g=t.useContext(Qi),_=g.prefixCls,b=g.onItemClick,x=g.disabled,w=g.overflowDisabled,k=g.itemIcon,P=g.selectedKeys,S=g.onActive,T=t.useContext(vn)._internalRenderMenuItem,E="".concat(_,"-item"),C=t.useRef(),M=t.useRef(),I=x||s,O=hn(o);var D=function(e){return{key:o,keyPath:(0,Dt.Z)(O).reverse(),item:C.current,domEvent:e}},A=l||k,L=tn(o,I,h,p),z=L.active,R=$(L,_n),F=P.includes(o),j=on(O.length),B={};"option"===e.role&&(B["aria-selected"]=F);var V=t.createElement(bn,a({ref:C,elementRef:M,role:null===c?"none":c||"menuitem",tabIndex:s?null:-1,"data-menu-id":w&&y?null:y},v,R,B,{component:"li","aria-disabled":s,style:K(K({},j),n),className:Q()(E,(i={},(0,q.Z)(i,"".concat(E,"-active"),z),(0,q.Z)(i,"".concat(E,"-selected"),F),(0,q.Z)(i,"".concat(E,"-disabled"),I),i),r),onClick:function(e){if(!I){var t=D(e);null===d||void 0===d||d(rn(t)),b(t)}},onKeyDown:function(e){if(null===f||void 0===f||f(e),e.which===Yi.ENTER){var t=D(e);null===d||void 0===d||d(rn(t)),b(t)}},onFocus:function(e){S(o),null===m||void 0===m||m(e)}}),u,t.createElement(an,{props:K(K({},e),{},{isSelected:F}),icon:A}));return T&&(V=T(V,e,{selected:F})),V};var wn=function(e){var i=e.eventKey,n=un(),r=hn(i);return t.useEffect((function(){if(n)return n.registerPath(i,r),function(){n.unregisterPath(i,r)}}),[r]),n?null:t.createElement(xn,e)},kn=["label","children","key","type"];function Pn(e,i){return Gt(e).map((function(e,n){if(t.isValidElement(e)){var r,a,o=e.key,s=null!==(r=null===(a=e.props)||void 0===a?void 0:a.eventKey)&&void 0!==r?r:o;(null===s||void 0===s)&&(s="tmp_key-".concat([].concat((0,Dt.Z)(i),[n]).join("-")));var l={key:s,eventKey:s};return t.cloneElement(e,l)}return e}))}function Sn(e){return(e||[]).map((function(e,i){if(e&&"object"===(0,te.Z)(e)){var n=e.label,r=e.children,o=e.key,s=e.type,l=$(e,kn),u=null!==o&&void 0!==o?o:"tmp-".concat(i);return r||"group"===s?"group"===s?t.createElement(zo,a({key:u},l,{title:n}),Sn(r)):t.createElement(so,a({key:u},l,{title:n}),Sn(r)):"divider"===s?t.createElement(Ro,a({key:u},l)):t.createElement(wn,a({key:u},l),n)}return null})).filter((function(e){return e}))}function Tn(e,t,i){var n=e;return t&&(n=Sn(t)),Pn(n,i)}function En(e){var i=t.useRef(e);i.current=e;var n=t.useCallback((function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null===(e=i.current)||void 0===e?void 0:e.call.apply(e,[i].concat(n))}),[]);return e?n:void 0}var Cn=["className","children"],Mn=function(e,i){var n=e.className,r=e.children,o=$(e,Cn),s=t.useContext(Qi),l=s.prefixCls,u=s.mode,c=s.rtl;return t.createElement("ul",a({className:Q()(l,c&&"".concat(l,"-rtl"),"".concat(l,"-sub"),"".concat(l,"-").concat("inline"===u?"inline":"vertical"),n)},o,{"data-menu-list":!0,ref:i}),r)},In=t.forwardRef(Mn);In.displayName="SubMenuList";var On=In,Dn=i(7326);function An(e,t){return!!e&&e.contains(t)}function Ln(e,t,i,n){var r=qt.unstable_batchedUpdates?function(e){qt.unstable_batchedUpdates(i,e)}:i;return e.addEventListener&&e.addEventListener(t,r,n),{remove:function(){e.removeEventListener&&e.removeEventListener(t,r,n)}}}var zn=(0,t.forwardRef)((function(e,i){var n=e.didUpdate,r=e.getContainer,a=e.children,o=(0,t.useRef)(),s=(0,t.useRef)();(0,t.useImperativeHandle)(i,(function(){return{}}));var l=(0,t.useRef)(!1);return!l.current&&Ie()&&(s.current=r(),o.current=s.current.parentNode,l.current=!0),(0,t.useEffect)((function(){null===n||void 0===n||n(e)})),(0,t.useEffect)((function(){return null===s.current.parentNode&&null!==o.current&&o.current.appendChild(s.current),function(){var e,t;null===(e=s.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(s.current)}}),[]),s.current?qt.createPortal(a,s.current):null})),Rn=zn;function Fn(e,t,i){return i?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function jn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit".concat(e)]="webkit".concat(t),i["Moz".concat(e)]="moz".concat(t),i["ms".concat(e)]="MS".concat(t),i["O".concat(e)]="o".concat(t.toLowerCase()),i}var Bn=function(e,t){var i={animationend:jn("Animation","AnimationEnd"),transitionend:jn("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete i.animationend.animation,"TransitionEvent"in t||delete i.transitionend.transition),i}(Ie(),"undefined"!==typeof window?window:{}),Vn={};if(Ie()){var Nn=document.createElement("div");Vn=Nn.style}var Un={};function Gn(e){if(Un[e])return Un[e];var t=Bn[e];if(t)for(var i=Object.keys(t),n=i.length,r=0;r<n;r+=1){var a=i[r];if(Object.prototype.hasOwnProperty.call(t,a)&&a in Vn)return Un[e]=t[a],Un[e]}return""}var Wn=Gn("animationend"),Hn=Gn("transitionend"),Zn=!(!Wn||!Hn),qn=Wn||"animationend",Xn=Hn||"transitionend";function Kn(e,t){return e?"object"===(0,te.Z)(e)?e[t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}))]:"".concat(e,"-").concat(t):null}var Yn="none",$n="appear",Jn="enter",Qn="leave",er="none",tr="prepare",ir="start",nr="active",rr="end",ar=Ie()?t.useLayoutEffect:t.useEffect,or=[tr,ir,nr,rr];function sr(e){return e===nr||e===rr}var lr=function(e,i){var n=Bt(er),a=(0,r.Z)(n,2),o=a[0],s=a[1],l=function(){var e=t.useRef(null);function i(){Li.cancel(e.current)}return t.useEffect((function(){return function(){i()}}),[]),[function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;i();var a=Li((function(){r<=1?n({isCanceled:function(){return a!==e.current}}):t(n,r-1)}));e.current=a},i]}(),u=(0,r.Z)(l,2),c=u[0],h=u[1];return ar((function(){if(o!==er&&o!==rr){var e=or.indexOf(o),t=or[e+1],n=i(o);false===n?s(t,!0):c((function(e){function i(){e.isCanceled()||s(t,!0)}!0===n?i():Promise.resolve(n).then(i)}))}}),[e,o]),t.useEffect((function(){return function(){h()}}),[]),[function(){s(tr,!0)},o]};function ur(e,i,n,a){var o=a.motionEnter,s=void 0===o||o,l=a.motionAppear,u=void 0===l||l,c=a.motionLeave,h=void 0===c||c,p=a.motionDeadline,d=a.motionLeaveImmediately,f=a.onAppearPrepare,m=a.onEnterPrepare,v=a.onLeavePrepare,y=a.onAppearStart,g=a.onEnterStart,_=a.onLeaveStart,b=a.onAppearActive,x=a.onEnterActive,w=a.onLeaveActive,k=a.onAppearEnd,P=a.onEnterEnd,S=a.onLeaveEnd,T=a.onVisibleChanged,E=Bt(),C=(0,r.Z)(E,2),M=C[0],I=C[1],O=Bt(Yn),D=(0,r.Z)(O,2),A=D[0],L=D[1],z=Bt(null),R=(0,r.Z)(z,2),F=R[0],j=R[1],B=(0,t.useRef)(!1),V=(0,t.useRef)(null);function N(){return n()}var U=(0,t.useRef)(!1);function G(e){var t=N();if(!e||e.deadline||e.target===t){var i,n=U.current;A===$n&&n?i=null===k||void 0===k?void 0:k(t,e):A===Jn&&n?i=null===P||void 0===P?void 0:P(t,e):A===Qn&&n&&(i=null===S||void 0===S?void 0:S(t,e)),A!==Yn&&n&&!1!==i&&(L(Yn,!0),j(null,!0))}}var W=function(e){var i=(0,t.useRef)(),n=(0,t.useRef)(e);n.current=e;var r=t.useCallback((function(e){n.current(e)}),[]);function a(e){e&&(e.removeEventListener(Xn,r),e.removeEventListener(qn,r))}return t.useEffect((function(){return function(){a(i.current)}}),[]),[function(e){i.current&&i.current!==e&&a(i.current),e&&e!==i.current&&(e.addEventListener(Xn,r),e.addEventListener(qn,r),i.current=e)},a]}(G),H=(0,r.Z)(W,1)[0],Z=t.useMemo((function(){var e,t,i;switch(A){case $n:return e={},(0,q.Z)(e,tr,f),(0,q.Z)(e,ir,y),(0,q.Z)(e,nr,b),e;case Jn:return t={},(0,q.Z)(t,tr,m),(0,q.Z)(t,ir,g),(0,q.Z)(t,nr,x),t;case Qn:return i={},(0,q.Z)(i,tr,v),(0,q.Z)(i,ir,_),(0,q.Z)(i,nr,w),i;default:return{}}}),[A]),X=lr(A,(function(e){if(e===tr){var t=Z.prepare;return!!t&&t(N())}var i;J in Z&&j((null===(i=Z[J])||void 0===i?void 0:i.call(Z,N(),null))||null);return J===nr&&(H(N()),p>0&&(clearTimeout(V.current),V.current=setTimeout((function(){G({deadline:!0})}),p))),true})),Y=(0,r.Z)(X,2),$=Y[0],J=Y[1],Q=sr(J);U.current=Q,ar((function(){I(i);var t,n=B.current;(B.current=!0,e)&&(!n&&i&&u&&(t=$n),n&&i&&s&&(t=Jn),(n&&!i&&h||!n&&d&&!i&&h)&&(t=Qn),t&&(L(t),$()))}),[i]),(0,t.useEffect)((function(){(A===$n&&!u||A===Jn&&!s||A===Qn&&!h)&&L(Yn)}),[u,s,h]),(0,t.useEffect)((function(){return function(){B.current=!1,clearTimeout(V.current)}}),[]);var ee=t.useRef(!1);(0,t.useEffect)((function(){M&&(ee.current=!0),void 0!==M&&A===Yn&&((ee.current||M)&&(null===T||void 0===T||T(M)),ee.current=!0)}),[M,A]);var te=F;return Z.prepare&&J===ir&&(te=K({transition:"none"},te)),[A,J,te,null!==M&&void 0!==M?M:i]}var cr=function(e){(0,St.Z)(i,e);var t=Ct(i);function i(){return(0,kt.Z)(this,i),t.apply(this,arguments)}return(0,Pt.Z)(i,[{key:"render",value:function(){return this.props.children}}]),i}(t.Component),hr=cr;var pr=function(e){var i=e;function n(e){return!(!e.motionName||!i)}"object"===(0,te.Z)(e)&&(i=e.transitionSupport);var a=t.forwardRef((function(e,i){var a=e.visible,o=void 0===a||a,s=e.removeOnLeave,l=void 0===s||s,u=e.forceRender,c=e.children,h=e.motionName,p=e.leavedClassName,d=e.eventProps,f=n(e),m=(0,t.useRef)(),v=(0,t.useRef)();var y=ur(f,o,(function(){try{return m.current instanceof HTMLElement?m.current:Xt(v.current)}catch(e){return null}}),e),g=(0,r.Z)(y,4),_=g[0],b=g[1],x=g[2],w=g[3],k=t.useRef(w);w&&(k.current=!0);var P,S=t.useCallback((function(e){m.current=e,Wt(i,e)}),[i]),T=K(K({},d),{},{visible:o});if(c)if(_!==Yn&&n(e)){var E,C;b===tr?C="prepare":sr(b)?C="active":b===ir&&(C="start"),P=c(K(K({},T),{},{className:Q()(Kn(h,_),(E={},(0,q.Z)(E,Kn(h,"".concat(_,"-").concat(C)),C),(0,q.Z)(E,h,"string"===typeof h),E)),style:x}),S)}else P=w?c(K({},T),S):!l&&k.current?c(K(K({},T),{},{className:p}),S):u?c(K(K({},T),{},{style:{display:"none"}}),S):null;else P=null;t.isValidElement(P)&&Zt(P)&&(P.ref||(P=t.cloneElement(P,{ref:S})));return t.createElement(hr,{ref:v},P)}));return a.displayName="CSSMotion",a}(Zn),dr="add",fr="keep",mr="remove",vr="removed";function yr(e){var t;return K(K({},t=e&&"object"===(0,te.Z)(e)&&"key"in e?e:{key:e}),{},{key:String(t.key)})}function gr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(yr)}function _r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[],n=0,r=t.length,a=gr(e),o=gr(t);a.forEach((function(e){for(var t=!1,a=n;a<r;a+=1){var s=o[a];if(s.key===e.key){n<a&&(i=i.concat(o.slice(n,a).map((function(e){return K(K({},e),{},{status:dr})}))),n=a),i.push(K(K({},s),{},{status:fr})),n+=1,t=!0;break}}t||i.push(K(K({},e),{},{status:mr}))})),n<r&&(i=i.concat(o.slice(n).map((function(e){return K(K({},e),{},{status:dr})}))));var s={};i.forEach((function(e){var t=e.key;s[t]=(s[t]||0)+1}));var l=Object.keys(s).filter((function(e){return s[e]>1}));return l.forEach((function(e){(i=i.filter((function(t){var i=t.key,n=t.status;return i!==e||n!==mr}))).forEach((function(t){t.key===e&&(t.status=fr)}))})),i}var br=["component","children","onVisibleChanged","onAllRemoved"],xr=["status"],wr=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];!function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr,n=function(e){(0,St.Z)(r,e);var n=Ct(r);function r(){var e;(0,kt.Z)(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).state={keyEntities:[]},e.removeKey=function(t){var i=e.state.keyEntities.map((function(e){return e.key!==t?e:K(K({},e),{},{status:vr})}));return e.setState({keyEntities:i}),i.filter((function(e){return e.status!==vr})).length},e}return(0,Pt.Z)(r,[{key:"render",value:function(){var e=this,n=this.state.keyEntities,r=this.props,o=r.component,s=r.children,l=r.onVisibleChanged,u=r.onAllRemoved,c=$(r,br),h=o||t.Fragment,p={};return wr.forEach((function(e){p[e]=c[e],delete c[e]})),delete c.keys,t.createElement(h,c,n.map((function(n){var r=n.status,o=$(n,xr),c=r===dr||r===fr;return t.createElement(i,a({},p,{key:o.key,visible:c,eventProps:o,onVisibleChanged:function(t){(null===l||void 0===l||l(t,{key:o.key}),t)||0===e.removeKey(o.key)&&u&&u()}}),s)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var i=e.keys,n=t.keyEntities,r=gr(i);return{keyEntities:_r(n,r).filter((function(e){var t=n.find((function(t){var i=t.key;return e.key===i}));return!t||t.status!==vr||e.status!==mr}))}}}]),r}(t.Component);n.defaultProps={component:"div"}}(Zn);var kr=pr;function Pr(e){var t=e.prefixCls,i=e.motion,n=e.animation,r=e.transitionName;return i||(n?{motionName:"".concat(t,"-").concat(n)}:r?{motionName:r}:null)}function Sr(e){var i=e.prefixCls,n=e.visible,r=e.zIndex,o=e.mask,s=e.maskMotion,l=e.maskAnimation,u=e.maskTransitionName;if(!o)return null;var c={};return(s||u||l)&&(c=K({motionAppear:!0},Pr({motion:s,prefixCls:i,transitionName:u,animation:l}))),t.createElement(kr,a({},c,{visible:n,removeOnLeave:!0}),(function(e){var n=e.className;return t.createElement("div",{style:{zIndex:r},className:Q()("".concat(i,"-mask"),n)})}))}var Tr,Er=function(e){if(!e)return!1;if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox();if(t.width||t.height)return!0}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();if(i.width||i.height)return!0}return!1};function Cr(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Mr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Cr(Object(i),!0).forEach((function(t){Or(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Cr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ir(e){return Ir="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Or(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Dr={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function Ar(){if(void 0!==Tr)return Tr;Tr="";var e=document.createElement("p").style;for(var t in Dr)t+"Transform"in e&&(Tr=t);return Tr}function Lr(){return Ar()?"".concat(Ar(),"TransitionProperty"):"transitionProperty"}function zr(){return Ar()?"".concat(Ar(),"Transform"):"transform"}function Rr(e,t){var i=Lr();i&&(e.style[i]=t,"transitionProperty"!==i&&(e.style.transitionProperty=t))}function Fr(e,t){var i=zr();i&&(e.style[i]=t,"transform"!==i&&(e.style.transform=t))}var jr,Br=/matrix\((.*)\)/,Vr=/matrix3d\((.*)\)/;function Nr(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function Ur(e,t,i){var n=i;if("object"!==Ir(t))return"undefined"!==typeof n?("number"===typeof n&&(n="".concat(n,"px")),void(e.style[t]=n)):jr(e,t);for(var r in t)t.hasOwnProperty(r)&&Ur(e,r,t[r])}function Gr(e,t){var i=e["page".concat(t?"Y":"X","Offset")],n="scroll".concat(t?"Top":"Left");if("number"!==typeof i){var r=e.document;"number"!==typeof(i=r.documentElement[n])&&(i=r.body[n])}return i}function Wr(e){return Gr(e)}function Hr(e){return Gr(e,!0)}function Zr(e){var t=function(e){var t,i,n,r=e.ownerDocument,a=r.body,o=r&&r.documentElement;return t=e.getBoundingClientRect(),i=Math.floor(t.left),n=Math.floor(t.top),{left:i-=o.clientLeft||a.clientLeft||0,top:n-=o.clientTop||a.clientTop||0}}(e),i=e.ownerDocument,n=i.defaultView||i.parentWindow;return t.left+=Wr(n),t.top+=Hr(n),t}function qr(e){return null!==e&&void 0!==e&&e==e.window}function Xr(e){return qr(e)?e.document:9===e.nodeType?e:e.ownerDocument}var Kr=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),Yr=/^(top|right|bottom|left)$/;function $r(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function Jr(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function Qr(e,t,i){"static"===Ur(e,"position")&&(e.style.position="relative");var n=-999,r=-999,a=$r("left",i),o=$r("top",i),s=Jr(a),l=Jr(o);"left"!==a&&(n=999),"top"!==o&&(r=999);var u,c="",h=Zr(e);("left"in t||"top"in t)&&(c=(u=e).style.transitionProperty||u.style[Lr()]||"",Rr(e,"none")),"left"in t&&(e.style[s]="",e.style[a]="".concat(n,"px")),"top"in t&&(e.style[l]="",e.style[o]="".concat(r,"px")),Nr(e);var p=Zr(e),d={};for(var f in t)if(t.hasOwnProperty(f)){var m=$r(f,i),v="left"===f?n:r,y=h[f]-p[f];d[m]=m===f?v+y:v-y}Ur(e,d),Nr(e),("left"in t||"top"in t)&&Rr(e,c);var g={};for(var _ in t)if(t.hasOwnProperty(_)){var b=$r(_,i),x=t[_]-h[_];g[b]=_===b?d[b]+x:d[b]-x}Ur(e,g)}function ea(e,t){var i=Zr(e),n=function(e){var t=window.getComputedStyle(e,null),i=t.getPropertyValue("transform")||t.getPropertyValue(zr());if(i&&"none"!==i){var n=i.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(n[12]||n[4],0),y:parseFloat(n[13]||n[5],0)}}return{x:0,y:0}}(e),r={x:n.x,y:n.y};"left"in t&&(r.x=n.x+t.left-i.left),"top"in t&&(r.y=n.y+t.top-i.top),function(e,t){var i=window.getComputedStyle(e,null),n=i.getPropertyValue("transform")||i.getPropertyValue(zr());if(n&&"none"!==n){var r,a=n.match(Br);a?((r=(a=a[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,r[5]=t.y,Fr(e,"matrix(".concat(r.join(","),")"))):((r=n.match(Vr)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,r[13]=t.y,Fr(e,"matrix3d(".concat(r.join(","),")")))}else Fr(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,r)}function ta(e,t){for(var i=0;i<e.length;i++)t(e[i])}function ia(e){return"border-box"===jr(e,"boxSizing")}"undefined"!==typeof window&&(jr=window.getComputedStyle?function(e,t,i){var n=i,r="",a=Xr(e);return(n=n||a.defaultView.getComputedStyle(e,null))&&(r=n.getPropertyValue(t)||n[t]),r}:function(e,t){var i=e.currentStyle&&e.currentStyle[t];if(Kr.test(i)&&!Yr.test(t)){var n=e.style,r=n.left,a=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,n.left="fontSize"===t?"1em":i||0,i=n.pixelLeft+"px",n.left=r,e.runtimeStyle.left=a}return""===i?"auto":i});var na=["margin","border","padding"];function ra(e,t,i){var n,r={},a=e.style;for(n in t)t.hasOwnProperty(n)&&(r[n]=a[n],a[n]=t[n]);for(n in i.call(e),t)t.hasOwnProperty(n)&&(a[n]=r[n])}function aa(e,t,i){var n,r,a,o=0;for(r=0;r<t.length;r++)if(n=t[r])for(a=0;a<i.length;a++){var s=void 0;s="border"===n?"".concat(n).concat(i[a],"Width"):n+i[a],o+=parseFloat(jr(e,s))||0}return o}var oa={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function sa(e,t,i){var n=i;if(qr(e))return"width"===t?oa.viewportWidth(e):oa.viewportHeight(e);if(9===e.nodeType)return"width"===t?oa.docWidth(e):oa.docHeight(e);var r="width"===t?["Left","Right"]:["Top","Bottom"],a="width"===t?Math.floor(e.getBoundingClientRect().width):Math.floor(e.getBoundingClientRect().height),o=ia(e),s=0;(null===a||void 0===a||a<=0)&&(a=void 0,(null===(s=jr(e,t))||void 0===s||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),void 0===n&&(n=o?1:-1);var l=void 0!==a||o,u=a||s;return-1===n?l?u-aa(e,["border","padding"],r):s:l?1===n?u:u+(2===n?-aa(e,["border"],r):aa(e,["margin"],r)):s+aa(e,na.slice(n),r)}ta(["Width","Height"],(function(e){oa["doc".concat(e)]=function(t){var i=t.document;return Math.max(i.documentElement["scroll".concat(e)],i.body["scroll".concat(e)],oa["viewport".concat(e)](i))},oa["viewport".concat(e)]=function(t){var i="client".concat(e),n=t.document,r=n.body,a=n.documentElement[i];return"CSS1Compat"===n.compatMode&&a||r&&r[i]||a}}));var la={position:"absolute",visibility:"hidden",display:"block"};function ua(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n,r=t[0];return 0!==r.offsetWidth?n=sa.apply(void 0,t):ra(r,la,(function(){n=sa.apply(void 0,t)})),n}function ca(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}ta(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);oa["outer".concat(t)]=function(t,i){return t&&ua(t,e,i?0:1)};var i="width"===e?["Left","Right"]:["Top","Bottom"];oa[e]=function(t,n){var r=n;return void 0!==r?t?(ia(t)&&(r+=aa(t,["padding","border"],i)),Ur(t,e,r)):void 0:t&&ua(t,e,-1)}}));var ha={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:Xr,offset:function(e,t,i){if("undefined"===typeof t)return Zr(e);!function(e,t,i){if(i.ignoreShake){var n=Zr(e),r=n.left.toFixed(0),a=n.top.toFixed(0),o=t.left.toFixed(0),s=t.top.toFixed(0);if(r===o&&a===s)return}i.useCssRight||i.useCssBottom?Qr(e,t,i):i.useCssTransform&&zr()in document.body.style?ea(e,t):Qr(e,t,i)}(e,t,i||{})},isWindow:qr,each:ta,css:Ur,clone:function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(i.overflow[t]=e.overflow[t]);return i},mix:ca,getWindowScrollLeft:function(e){return Wr(e)},getWindowScrollTop:function(e){return Hr(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)ha.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};ca(ha,oa);var pa=ha.getParent;function da(e){if(ha.isWindow(e)||9===e.nodeType)return null;var t,i=ha.getDocument(e).body,n=ha.css(e,"position");if(!("fixed"===n||"absolute"===n))return"html"===e.nodeName.toLowerCase()?null:pa(e);for(t=pa(e);t&&t!==i&&9!==t.nodeType;t=pa(t))if("static"!==(n=ha.css(t,"position")))return t;return null}var fa=ha.getParent;function ma(e,t){for(var i={left:0,right:1/0,top:0,bottom:1/0},n=da(e),r=ha.getDocument(e),a=r.defaultView||r.parentWindow,o=r.body,s=r.documentElement;n;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===n.clientWidth||n===o||n===s||"visible"===ha.css(n,"overflow")){if(n===o||n===s)break}else{var l=ha.offset(n);l.left+=n.clientLeft,l.top+=n.clientTop,i.top=Math.max(i.top,l.top),i.right=Math.min(i.right,l.left+n.clientWidth),i.bottom=Math.min(i.bottom,l.top+n.clientHeight),i.left=Math.max(i.left,l.left)}n=da(n)}var u=null;ha.isWindow(e)||9===e.nodeType||(u=e.style.position,"absolute"===ha.css(e,"position")&&(e.style.position="fixed"));var c=ha.getWindowScrollLeft(a),h=ha.getWindowScrollTop(a),p=ha.viewportWidth(a),d=ha.viewportHeight(a),f=s.scrollWidth,m=s.scrollHeight,v=window.getComputedStyle(o);if("hidden"===v.overflowX&&(f=a.innerWidth),"hidden"===v.overflowY&&(m=a.innerHeight),e.style&&(e.style.position=u),t||function(e){if(ha.isWindow(e)||9===e.nodeType)return!1;var t=ha.getDocument(e),i=t.body,n=null;for(n=fa(e);n&&n!==i&&n!==t;n=fa(n))if("fixed"===ha.css(n,"position"))return!0;return!1}(e))i.left=Math.max(i.left,c),i.top=Math.max(i.top,h),i.right=Math.min(i.right,c+p),i.bottom=Math.min(i.bottom,h+d);else{var y=Math.max(f,c+p);i.right=Math.min(i.right,y);var g=Math.max(m,h+d);i.bottom=Math.min(i.bottom,g)}return i.top>=0&&i.left>=0&&i.bottom>i.top&&i.right>i.left?i:null}function va(e){var t,i,n;if(ha.isWindow(e)||9===e.nodeType){var r=ha.getWindow(e);t={left:ha.getWindowScrollLeft(r),top:ha.getWindowScrollTop(r)},i=ha.viewportWidth(r),n=ha.viewportHeight(r)}else t=ha.offset(e),i=ha.outerWidth(e),n=ha.outerHeight(e);return t.width=i,t.height=n,t}function ya(e,t){var i=t.charAt(0),n=t.charAt(1),r=e.width,a=e.height,o=e.left,s=e.top;return"c"===i?s+=a/2:"b"===i&&(s+=a),"c"===n?o+=r/2:"r"===n&&(o+=r),{left:o,top:s}}function ga(e,t,i,n,r){var a=ya(t,i[1]),o=ya(e,i[0]),s=[o.left-a.left,o.top-a.top];return{left:Math.round(e.left-s[0]+n[0]-r[0]),top:Math.round(e.top-s[1]+n[1]-r[1])}}function _a(e,t,i){return e.left<i.left||e.left+t.width>i.right}function ba(e,t,i){return e.top<i.top||e.top+t.height>i.bottom}function xa(e,t,i){var n=[];return ha.each(e,(function(e){n.push(e.replace(t,(function(e){return i[e]})))})),n}function wa(e,t){return e[t]=-e[t],e}function ka(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function Pa(e,t){e[0]=ka(e[0],t.width),e[1]=ka(e[1],t.height)}function Sa(e,t,i,n){var r=i.points,a=i.offset||[0,0],o=i.targetOffset||[0,0],s=i.overflow,l=i.source||e;a=[].concat(a),o=[].concat(o);var u={},c=0,h=ma(l,!(!(s=s||{})||!s.alwaysByViewport)),p=va(l);Pa(a,p),Pa(o,t);var d=ga(p,t,r,a,o),f=ha.merge(p,d);if(h&&(s.adjustX||s.adjustY)&&n){if(s.adjustX&&_a(d,p,h)){var m=xa(r,/[lr]/gi,{l:"r",r:"l"}),v=wa(a,0),y=wa(o,0);(function(e,t,i){return e.left>i.right||e.left+t.width<i.left})(ga(p,t,m,v,y),p,h)||(c=1,r=m,a=v,o=y)}if(s.adjustY&&ba(d,p,h)){var g=xa(r,/[tb]/gi,{t:"b",b:"t"}),_=wa(a,1),b=wa(o,1);(function(e,t,i){return e.top>i.bottom||e.top+t.height<i.top})(ga(p,t,g,_,b),p,h)||(c=1,r=g,a=_,o=b)}c&&(d=ga(p,t,r,a,o),ha.mix(f,d));var x=_a(d,p,h),w=ba(d,p,h);if(x||w){var k=r;x&&(k=xa(r,/[lr]/gi,{l:"r",r:"l"})),w&&(k=xa(r,/[tb]/gi,{t:"b",b:"t"})),r=k,a=i.offset||[0,0],o=i.targetOffset||[0,0]}u.adjustX=s.adjustX&&x,u.adjustY=s.adjustY&&w,(u.adjustX||u.adjustY)&&(f=function(e,t,i,n){var r=ha.clone(e),a={width:t.width,height:t.height};return n.adjustX&&r.left<i.left&&(r.left=i.left),n.resizeWidth&&r.left>=i.left&&r.left+a.width>i.right&&(a.width-=r.left+a.width-i.right),n.adjustX&&r.left+a.width>i.right&&(r.left=Math.max(i.right-a.width,i.left)),n.adjustY&&r.top<i.top&&(r.top=i.top),n.resizeHeight&&r.top>=i.top&&r.top+a.height>i.bottom&&(a.height-=r.top+a.height-i.bottom),n.adjustY&&r.top+a.height>i.bottom&&(r.top=Math.max(i.bottom-a.height,i.top)),ha.mix(r,a)}(d,p,h,u))}return f.width!==p.width&&ha.css(l,"width",ha.width(l)+f.width-p.width),f.height!==p.height&&ha.css(l,"height",ha.height(l)+f.height-p.height),ha.offset(l,{left:f.left,top:f.top},{useCssRight:i.useCssRight,useCssBottom:i.useCssBottom,useCssTransform:i.useCssTransform,ignoreShake:i.ignoreShake}),{points:r,offset:a,targetOffset:o,overflow:u}}function Ta(e,t,i){var n=i.target||t,r=va(n),a=!function(e,t){var i=ma(e,t),n=va(e);return!i||n.left+n.width<=i.left||n.top+n.height<=i.top||n.left>=i.right||n.top>=i.bottom}(n,i.overflow&&i.overflow.alwaysByViewport);return Sa(e,r,i,a)}Ta.__getOffsetParent=da,Ta.__getVisibleRectForElement=ma;var Ea=i(8111),Ca=i.n(Ea);function Ma(e,t){var i=null,n=null;var a=new vi((function(e){var a=(0,r.Z)(e,1)[0].target;if(document.documentElement.contains(a)){var o=a.getBoundingClientRect(),s=o.width,l=o.height,u=Math.floor(s),c=Math.floor(l);i===u&&n===c||Promise.resolve().then((function(){t({width:u,height:c})})),i=u,n=c}}));return e&&a.observe(e),function(){a.disconnect()}}function Ia(e){return"function"!==typeof e?null:e()}function Oa(e){return"object"===(0,te.Z)(e)&&e?e:null}var Da=function(e,i){var n=e.children,a=e.disabled,o=e.target,s=e.align,l=e.onAlign,u=e.monitorWindowResize,c=e.monitorBufferTime,h=void 0===c?0:c,p=t.useRef({}),d=t.useRef(),f=t.Children.only(n),m=t.useRef({});m.current.disabled=a,m.current.target=o,m.current.align=s,m.current.onAlign=l;var v=function(e,i){var n=t.useRef(!1),r=t.useRef(null);function a(){window.clearTimeout(r.current)}return[function t(o){if(a(),n.current&&!0!==o)r.current=window.setTimeout((function(){n.current=!1,t()}),i);else{if(!1===e())return;n.current=!0,r.current=window.setTimeout((function(){n.current=!1}),i)}},function(){n.current=!1,a()}]}((function(){var e=m.current,t=e.disabled,i=e.target,n=e.align,r=e.onAlign;if(!t&&i){var a,o=d.current,s=Ia(i),l=Oa(i);p.current.element=s,p.current.point=l,p.current.align=n;var u=document.activeElement;return s&&Er(s)?a=Ta(o,s,n):l&&(a=function(e,t,i){var n,r,a=ha.getDocument(e),o=a.defaultView||a.parentWindow,s=ha.getWindowScrollLeft(o),l=ha.getWindowScrollTop(o),u=ha.viewportWidth(o),c=ha.viewportHeight(o),h={left:n="pageX"in t?t.pageX:s+t.clientX,top:r="pageY"in t?t.pageY:l+t.clientY,width:0,height:0},p=n>=0&&n<=s+u&&r>=0&&r<=l+c,d=[i.points[0],"cc"];return Sa(e,h,Mr(Mr({},i),{},{points:d}),p)}(o,l,n)),function(e,t){e!==document.activeElement&&An(t,e)&&"function"===typeof e.focus&&e.focus()}(u,o),r&&a&&r(o,a),!0}return!1}),h),y=(0,r.Z)(v,2),g=y[0],_=y[1],b=t.useRef({cancel:function(){}}),x=t.useRef({cancel:function(){}});t.useEffect((function(){var e,t,i=Ia(o),n=Oa(o);d.current!==x.current.element&&(x.current.cancel(),x.current.element=d.current,x.current.cancel=Ma(d.current,g)),p.current.element===i&&((e=p.current.point)===(t=n)||e&&t&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY))&&Ca()(p.current.align,s)||(g(),b.current.element!==i&&(b.current.cancel(),b.current.element=i,b.current.cancel=Ma(i,g)))})),t.useEffect((function(){a?_():g()}),[a]);var w=t.useRef(null);return t.useEffect((function(){u?w.current||(w.current=Ln(window,"resize",g)):w.current&&(w.current.remove(),w.current=null)}),[u]),t.useEffect((function(){return function(){b.current.cancel(),x.current.cancel(),w.current&&w.current.remove(),_()}}),[]),t.useImperativeHandle(i,(function(){return{forceAlign:function(){return g(!0)}}})),t.isValidElement(f)&&(f=t.cloneElement(f,{ref:Ht(f.ref,d)})),f},Aa=t.forwardRef(Da);Aa.displayName="Align";var La=Aa;function za(){za=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(T){s=function(e,t,i){return e[t]=i}}function l(e,t,i,n){var r=t&&t.prototype instanceof h?t:h,a=Object.create(r.prototype),o=new k(n||[]);return a._invoke=function(e,t,i){var n="suspendedStart";return function(r,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw a;return S()}for(i.method=r,i.arg=a;;){var o=i.delegate;if(o){var s=b(o,i);if(s){if(s===c)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=u(e,t,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(e,i,o),a}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(T){return{type:"throw",arg:T}}}e.wrap=l;var c={};function h(){}function p(){}function d(){}var f={};s(f,r,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(P([])));v&&v!==t&&i.call(v,r)&&(f=v);var y=d.prototype=h.prototype=Object.create(f);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(r,a,o,s){var l=u(e[r],e,a);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==(0,te.Z)(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var r;this._invoke=function(e,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}}function b(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=u(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var r=n.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=d,s(y,"constructor",d),s(d,"constructor",p),p.displayName=s(d,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(_.prototype),s(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,i,n,r,a){void 0===a&&(a=Promise);var o=new _(l(t,i,n,r),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(y),s(y,o,"Generator"),s(y,r,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return o.type="throw",o.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),w(i),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var r=n.arg;w(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:P(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),c}},e}var Ra=i(5861),Fa=["measure","alignPre","align",null,"motion"],ja=t.forwardRef((function(e,i){var n=e.visible,o=e.prefixCls,s=e.className,l=e.style,u=e.children,c=e.zIndex,h=e.stretch,p=e.destroyPopupOnHide,d=e.forceRender,f=e.align,m=e.point,v=e.getRootDomNode,y=e.getClassNameFromAlign,g=e.onAlign,_=e.onMouseEnter,b=e.onMouseLeave,x=e.onMouseDown,w=e.onTouchStart,k=e.onClick,P=(0,t.useRef)(),S=(0,t.useRef)(),T=(0,t.useState)(),E=(0,r.Z)(T,2),C=E[0],M=E[1],I=function(e){var i=t.useState({width:0,height:0}),n=(0,r.Z)(i,2),a=n[0],o=n[1];return[t.useMemo((function(){var t={};if(e){var i=a.width,n=a.height;-1!==e.indexOf("height")&&n?t.height=n:-1!==e.indexOf("minHeight")&&n&&(t.minHeight=n),-1!==e.indexOf("width")&&i?t.width=i:-1!==e.indexOf("minWidth")&&i&&(t.minWidth=i)}return t}),[e,a]),function(e){o({width:e.offsetWidth,height:e.offsetHeight})}]}(h),O=(0,r.Z)(I,2),D=O[0],A=O[1];var L=function(e,i){var n=Bt(null),a=(0,r.Z)(n,2),o=a[0],s=a[1],l=(0,t.useRef)();function u(e){s(e,!0)}function c(){Li.cancel(l.current)}return(0,t.useEffect)((function(){u("measure")}),[e]),(0,t.useEffect)((function(){"measure"===o&&i(),o&&(l.current=Li((0,Ra.Z)(za().mark((function e(){var t,i;return za().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Fa.indexOf(o),(i=Fa[t+1])&&-1!==t&&u(i);case 3:case"end":return e.stop()}}),e)})))))}),[o]),(0,t.useEffect)((function(){return function(){c()}}),[]),[o,function(e){c(),l.current=Li((function(){u((function(e){switch(o){case"align":return"motion";case"motion":return"stable"}return e})),null===e||void 0===e||e()}))}]}(n,(function(){h&&A(v())})),z=(0,r.Z)(L,2),R=z[0],F=z[1],j=(0,t.useState)(0),B=(0,r.Z)(j,2),V=B[0],N=B[1],U=(0,t.useRef)();function G(){var e;null===(e=P.current)||void 0===e||e.forceAlign()}function W(e,t){var i=y(t);C!==i&&M(i),N((function(e){return e+1})),"align"===R&&(null===g||void 0===g||g(e,t))}jt((function(){"alignPre"===R&&N(0)}),[R]),jt((function(){"align"===R&&(V<2?G():F((function(){var e;null===(e=U.current)||void 0===e||e.call(U)})))}),[V]);var H=K({},Pr(e));function Z(){return new Promise((function(e){U.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=H[e];H[e]=function(e,i){return F(),null===t||void 0===t?void 0:t(e,i)}})),t.useEffect((function(){H.motionName||"motion"!==R||F()}),[H.motionName,R]),t.useImperativeHandle(i,(function(){return{forceAlign:G,getElement:function(){return S.current}}}));var q=K(K({},D),{},{zIndex:c,opacity:"motion"!==R&&"stable"!==R&&n?0:void 0,pointerEvents:n||"stable"===R?void 0:"none"},l),X=!0;!(null===f||void 0===f?void 0:f.points)||"align"!==R&&"stable"!==R||(X=!1);var Y=u;return t.Children.count(u)>1&&(Y=t.createElement("div",{className:"".concat(o,"-content")},u)),t.createElement(kr,a({visible:n,ref:S,leavedClassName:"".concat(o,"-hidden")},H,{onAppearPrepare:Z,onEnterPrepare:Z,removeOnLeave:p,forceRender:d}),(function(e,i){var n=e.className,r=e.style,a=Q()(o,s,C,n);return t.createElement(La,{target:m||v,key:"popup",ref:P,monitorWindowResize:!0,disabled:X,align:f,onAlign:W},t.createElement("div",{ref:i,className:a,onMouseEnter:_,onMouseLeave:b,onMouseDownCapture:x,onTouchStartCapture:w,onClick:k,style:K(K({},r),q)},Y))}))}));ja.displayName="PopupInner";var Ba=ja,Va=t.forwardRef((function(e,i){var n=e.prefixCls,r=e.visible,o=e.zIndex,s=e.children,l=e.mobile,u=(l=void 0===l?{}:l).popupClassName,c=l.popupStyle,h=l.popupMotion,p=void 0===h?{}:h,d=l.popupRender,f=e.onClick,m=t.useRef();t.useImperativeHandle(i,(function(){return{forceAlign:function(){},getElement:function(){return m.current}}}));var v=K({zIndex:o},c),y=s;return t.Children.count(s)>1&&(y=t.createElement("div",{className:"".concat(n,"-content")},s)),d&&(y=d(y)),t.createElement(kr,a({visible:r,ref:m,removeOnLeave:!0},p),(function(e,i){var r=e.className,a=e.style,o=Q()(n,u,r);return t.createElement("div",{ref:i,className:o,onClick:f,style:K(K({},a),v)},y)}))}));Va.displayName="MobilePopupInner";var Na=Va,Ua=["visible","mobile"],Ga=t.forwardRef((function(e,i){var n=e.visible,o=e.mobile,s=$(e,Ua),l=(0,t.useState)(n),u=(0,r.Z)(l,2),c=u[0],h=u[1],p=(0,t.useState)(!1),d=(0,r.Z)(p,2),f=d[0],m=d[1],v=K(K({},s),{},{visible:c});(0,t.useEffect)((function(){h(n),n&&o&&m(function(){if("undefined"===typeof navigator||"undefined"===typeof window)return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null===e||void 0===e?void 0:e.substr(0,4)))}())}),[n,o]);var y=f?t.createElement(Na,a({},v,{mobile:o,ref:i})):t.createElement(Ba,a({},v,{ref:i}));return t.createElement("div",null,t.createElement(Sr,v),y)}));Ga.displayName="Popup";var Wa=Ga,Ha=t.createContext(null);function Za(){}function qa(){return""}function Xa(e){return e?e.ownerDocument:window.document}var Ka=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];var Ya=function(e){var i=function(i){(0,St.Z)(r,i);var n=Ct(r);function r(e){var i,o;return(0,kt.Z)(this,r),(i=n.call(this,e)).popupRef=t.createRef(),i.triggerRef=t.createRef(),i.portalContainer=void 0,i.attachId=void 0,i.clickOutsideHandler=void 0,i.touchOutsideHandler=void 0,i.contextMenuOutsideHandler1=void 0,i.contextMenuOutsideHandler2=void 0,i.mouseDownTimeout=void 0,i.focusTime=void 0,i.preClickTime=void 0,i.preTouchTime=void 0,i.delayTimer=void 0,i.hasPopupMouseDown=void 0,i.onMouseEnter=function(e){var t=i.props.mouseEnterDelay;i.fireEvents("onMouseEnter",e),i.delaySetPopupVisible(!0,t,t?null:e)},i.onMouseMove=function(e){i.fireEvents("onMouseMove",e),i.setPoint(e)},i.onMouseLeave=function(e){i.fireEvents("onMouseLeave",e),i.delaySetPopupVisible(!1,i.props.mouseLeaveDelay)},i.onPopupMouseEnter=function(){i.clearDelayTimer()},i.onPopupMouseLeave=function(e){var t;e.relatedTarget&&!e.relatedTarget.setTimeout&&An(null===(t=i.popupRef.current)||void 0===t?void 0:t.getElement(),e.relatedTarget)||i.delaySetPopupVisible(!1,i.props.mouseLeaveDelay)},i.onFocus=function(e){i.fireEvents("onFocus",e),i.clearDelayTimer(),i.isFocusToShow()&&(i.focusTime=Date.now(),i.delaySetPopupVisible(!0,i.props.focusDelay))},i.onMouseDown=function(e){i.fireEvents("onMouseDown",e),i.preClickTime=Date.now()},i.onTouchStart=function(e){i.fireEvents("onTouchStart",e),i.preTouchTime=Date.now()},i.onBlur=function(e){i.fireEvents("onBlur",e),i.clearDelayTimer(),i.isBlurToHide()&&i.delaySetPopupVisible(!1,i.props.blurDelay)},i.onContextMenu=function(e){e.preventDefault(),i.fireEvents("onContextMenu",e),i.setPopupVisible(!0,e)},i.onContextMenuClose=function(){i.isContextMenuToShow()&&i.close()},i.onClick=function(e){if(i.fireEvents("onClick",e),i.focusTime){var t;if(i.preClickTime&&i.preTouchTime?t=Math.min(i.preClickTime,i.preTouchTime):i.preClickTime?t=i.preClickTime:i.preTouchTime&&(t=i.preTouchTime),Math.abs(t-i.focusTime)<20)return;i.focusTime=0}i.preClickTime=0,i.preTouchTime=0,i.isClickToShow()&&(i.isClickToHide()||i.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var n=!i.state.popupVisible;(i.isClickToHide()&&!n||n&&i.isClickToShow())&&i.setPopupVisible(!i.state.popupVisible,e)},i.onPopupMouseDown=function(){var e;(i.hasPopupMouseDown=!0,clearTimeout(i.mouseDownTimeout),i.mouseDownTimeout=window.setTimeout((function(){i.hasPopupMouseDown=!1}),0),i.context)&&(e=i.context).onPopupMouseDown.apply(e,arguments)},i.onDocumentClick=function(e){if(!i.props.mask||i.props.maskClosable){var t=e.target,n=i.getRootDomNode(),r=i.getPopupDomNode();An(n,t)&&!i.isContextMenuOnly()||An(r,t)||i.hasPopupMouseDown||i.close()}},i.getRootDomNode=function(){var e=i.props.getTriggerDOMNode;if(e)return e(i.triggerRef.current);try{var t=Xt(i.triggerRef.current);if(t)return t}catch(n){}return qt.findDOMNode((0,Dn.Z)(i))},i.getPopupClassNameFromAlign=function(e){var t=[],n=i.props,r=n.popupPlacement,a=n.builtinPlacements,o=n.prefixCls,s=n.alignPoint,l=n.getPopupClassNameFromAlign;return r&&a&&t.push(function(e,t,i,n){for(var r=i.points,a=Object.keys(e),o=0;o<a.length;o+=1){var s=a[o];if(Fn(e[s].points,r,n))return"".concat(t,"-placement-").concat(s)}return""}(a,o,e,s)),l&&t.push(l(e)),t.join(" ")},i.getComponent=function(){var e=i.props,n=e.prefixCls,r=e.destroyPopupOnHide,o=e.popupClassName,s=e.onPopupAlign,l=e.popupMotion,u=e.popupAnimation,c=e.popupTransitionName,h=e.popupStyle,p=e.mask,d=e.maskAnimation,f=e.maskTransitionName,m=e.maskMotion,v=e.zIndex,y=e.popup,g=e.stretch,_=e.alignPoint,b=e.mobile,x=e.forceRender,w=e.onPopupClick,k=i.state,P=k.popupVisible,S=k.point,T=i.getPopupAlign(),E={};return i.isMouseEnterToShow()&&(E.onMouseEnter=i.onPopupMouseEnter),i.isMouseLeaveToHide()&&(E.onMouseLeave=i.onPopupMouseLeave),E.onMouseDown=i.onPopupMouseDown,E.onTouchStart=i.onPopupMouseDown,t.createElement(Wa,a({prefixCls:n,destroyPopupOnHide:r,visible:P,point:_&&S,className:o,align:T,onAlign:s,animation:u,getClassNameFromAlign:i.getPopupClassNameFromAlign},E,{stretch:g,getRootDomNode:i.getRootDomNode,style:h,mask:p,zIndex:v,transitionName:c,maskAnimation:d,maskTransitionName:f,maskMotion:m,ref:i.popupRef,motion:l,mobile:b,forceRender:x,onClick:w}),"function"===typeof y?y():y)},i.attachParent=function(e){Li.cancel(i.attachId);var t,n=i.props,r=n.getPopupContainer,a=n.getDocument,o=i.getRootDomNode();r?(o||0===r.length)&&(t=r(o)):t=a(i.getRootDomNode()).body,t?t.appendChild(e):i.attachId=Li((function(){i.attachParent(e)}))},i.getContainer=function(){if(!i.portalContainer){var e=(0,i.props.getDocument)(i.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",i.portalContainer=e}return i.attachParent(i.portalContainer),i.portalContainer},i.setPoint=function(e){i.props.alignPoint&&e&&i.setState({point:{pageX:e.pageX,pageY:e.pageY}})},i.handlePortalUpdate=function(){i.state.prevPopupVisible!==i.state.popupVisible&&i.props.afterPopupVisibleChange(i.state.popupVisible)},i.triggerContextValue={onPopupMouseDown:i.onPopupMouseDown},o="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,i.state={prevPopupVisible:o,popupVisible:o},Ka.forEach((function(e){i["fire".concat(e)]=function(t){i.fireEvents(e,t)}})),i}return(0,Pt.Z)(r,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=Ln(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=Ln(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=Ln(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=Ln(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),Li.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,i=e.popupAlign,n=e.builtinPlacements;return t&&n?function(e,t,i){return K(K({},e[t]||{}),i)}(n,t,i):i}},{key:"setPopupVisible",value:function(e,t){var i=this.props.alignPoint,n=this.state.popupVisible;this.clearDelayTimer(),n!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:n}),this.props.onPopupVisibleChange(e)),i&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,i){var n=this,r=1e3*t;if(this.clearDelayTimer(),r){var a=i?{pageX:i.pageX,pageY:i.pageY}:null;this.delayTimer=window.setTimeout((function(){n.setPopupVisible(e,a),n.clearDelayTimer()}),r)}else this.setPopupVisible(e,i)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,i=this.props;return t[e]&&i[e]?this["fire".concat(e)]:t[e]||i[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf("click")||-1!==i.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==i.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf("click")||-1!==i.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf("hover")||-1!==i.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf("hover")||-1!==i.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf("focus")||-1!==i.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf("focus")||-1!==i.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var i=this.props.children.props[e];i&&i(t);var n=this.props[e];n&&n(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var i=this.state.popupVisible,n=this.props,r=n.children,a=n.forceRender,o=n.alignPoint,s=n.className,l=n.autoDestroy,u=t.Children.only(r),c={key:"trigger"};this.isContextMenuToShow()?c.onContextMenu=this.onContextMenu:c.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(c.onClick=this.onClick,c.onMouseDown=this.onMouseDown,c.onTouchStart=this.onTouchStart):(c.onClick=this.createTwoChains("onClick"),c.onMouseDown=this.createTwoChains("onMouseDown"),c.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(c.onMouseEnter=this.onMouseEnter,o&&(c.onMouseMove=this.onMouseMove)):c.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?c.onMouseLeave=this.onMouseLeave:c.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(c.onFocus=this.onFocus,c.onBlur=this.onBlur):(c.onFocus=this.createTwoChains("onFocus"),c.onBlur=this.createTwoChains("onBlur"));var h=Q()(u&&u.props&&u.props.className,s);h&&(c.className=h);var p=K({},c);Zt(u)&&(p.ref=Ht(this.triggerRef,u.ref));var d,f=t.cloneElement(u,p);return(i||this.popupRef.current||a)&&(d=t.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!i&&l&&(d=null),t.createElement(Ha.Provider,{value:this.triggerContextValue},f,d)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var i=e.popupVisible,n={};return void 0!==i&&t.popupVisible!==i&&(n.popupVisible=i,n.prevPopupVisible=t.popupVisible),n}}]),r}(t.Component);return i.contextType=Ha,i.defaultProps={prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:qa,getDocument:Xa,onPopupVisibleChange:Za,afterPopupVisibleChange:Za,onPopupAlign:Za,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1},i}(Rn),$a={adjustX:1,adjustY:1},Ja={topLeft:{points:["bl","tl"],overflow:$a,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:$a,offset:[0,7]},leftTop:{points:["tr","tl"],overflow:$a,offset:[-4,0]},rightTop:{points:["tl","tr"],overflow:$a,offset:[4,0]}},Qa={topLeft:{points:["bl","tl"],overflow:$a,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:$a,offset:[0,7]},rightTop:{points:["tr","tl"],overflow:$a,offset:[-4,0]},leftTop:{points:["tl","tr"],overflow:$a,offset:[4,0]}};function eo(e,t,i){return t||(i?i[e]||i.other:void 0)}var to={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function io(e){var i=e.prefixCls,n=e.visible,a=e.children,o=e.popup,s=e.popupClassName,l=e.popupOffset,u=e.disabled,c=e.mode,h=e.onVisibleChange,p=t.useContext(Qi),d=p.getPopupContainer,f=p.rtl,m=p.subMenuOpenDelay,v=p.subMenuCloseDelay,y=p.builtinPlacements,g=p.triggerSubMenuAction,_=p.forceSubMenuRender,b=p.rootClassName,x=p.motion,w=p.defaultMotions,k=t.useState(!1),P=(0,r.Z)(k,2),S=P[0],T=P[1],E=K(K({},f?Qa:Ja),y),C=to[c],M=K(K({},eo(c,x,w)),{},{leavedClassName:"".concat(i,"-hidden"),removeOnLeave:!1,motionAppear:!0}),I=t.useRef();return t.useEffect((function(){return I.current=Li((function(){T(n)})),function(){Li.cancel(I.current)}}),[n]),t.createElement(Ya,{prefixCls:i,popupClassName:Q()("".concat(i,"-popup"),(0,q.Z)({},"".concat(i,"-rtl"),f),s,b),stretch:"horizontal"===c?"minWidth":null,getPopupContainer:d,builtinPlacements:E,popupPlacement:C,popupVisible:S,popup:o,popupAlign:l&&{offset:l},action:u?[]:[g],mouseEnterDelay:m,mouseLeaveDelay:v,onPopupVisibleChange:h,forceRender:_,popupMotion:M},a)}function no(e){var i=e.id,n=e.open,o=e.keyPath,s=e.children,l="inline",u=t.useContext(Qi),c=u.prefixCls,h=u.forceSubMenuRender,p=u.motion,d=u.defaultMotions,f=u.mode,m=t.useRef(!1);m.current=f===l;var v=t.useState(!m.current),y=(0,r.Z)(v,2),g=y[0],_=y[1],b=!!m.current&&n;t.useEffect((function(){m.current&&_(!1)}),[f]);var x=K({},eo(l,p,d));o.length>1&&(x.motionAppear=!1);var w=x.onVisibleChanged;return x.onVisibleChanged=function(e){return m.current||e||_(!0),null===w||void 0===w?void 0:w(e)},g?null:t.createElement(en,{mode:l,locked:!m.current},t.createElement(kr,a({visible:b},x,{forceRender:h,removeOnLeave:!1,leavedClassName:"".concat(c,"-hidden")}),(function(e){var n=e.className,r=e.style;return t.createElement(On,{id:i,className:n,style:r},s)})))}var ro=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],ao=["active"],oo=function(e){var i,n=e.style,o=e.className,s=e.title,l=e.eventKey,u=(e.warnKey,e.disabled),c=e.internalPopupClose,h=e.children,p=e.itemIcon,d=e.expandIcon,f=e.popupClassName,m=e.popupOffset,v=e.onClick,y=e.onMouseEnter,g=e.onMouseLeave,_=e.onTitleClick,b=e.onTitleMouseEnter,x=e.onTitleMouseLeave,w=$(e,ro),k=mn(l),P=t.useContext(Qi),S=P.prefixCls,T=P.mode,E=P.openKeys,C=P.disabled,M=P.overflowDisabled,I=P.activeKey,O=P.selectedKeys,D=P.itemIcon,A=P.expandIcon,L=P.onItemClick,z=P.onOpenChange,R=P.onActive,F=t.useContext(vn)._internalRenderSubMenuItem,j=t.useContext(pn).isSubPathKey,B=hn(),V="".concat(S,"-submenu"),N=C||u,U=t.useRef(),G=t.useRef();var W=p||D,H=d||A,Z=E.includes(l),X=!M&&Z,Y=j(O,l),J=tn(l,N,b,x),ee=J.active,te=$(J,ao),ie=t.useState(!1),ne=(0,r.Z)(ie,2),re=ne[0],ae=ne[1],oe=function(e){N||ae(e)},se=t.useMemo((function(){return ee||"inline"!==T&&(re||j([I],l))}),[T,ee,I,re,l,j]),le=on(B.length),ue=En((function(e){null===v||void 0===v||v(rn(e)),L(e)})),ce=k&&"".concat(k,"-popup"),he=t.createElement("div",a({role:"menuitem",style:le,className:"".concat(V,"-title"),tabIndex:N?null:-1,ref:U,title:"string"===typeof s?s:null,"data-menu-id":M&&k?null:k,"aria-expanded":X,"aria-haspopup":!0,"aria-controls":ce,"aria-disabled":N,onClick:function(e){N||(null===_||void 0===_||_({key:l,domEvent:e}),"inline"===T&&z(l,!Z))},onFocus:function(){R(l)}},te),s,t.createElement(an,{icon:"horizontal"!==T?H:null,props:K(K({},e),{},{isOpen:X,isSubMenu:!0})},t.createElement("i",{className:"".concat(V,"-arrow")}))),pe=t.useRef(T);if("inline"!==T&&(pe.current=B.length>1?"vertical":T),!M){var de=pe.current;he=t.createElement(io,{mode:de,prefixCls:V,visible:!c&&X&&"inline"!==T,popupClassName:f,popupOffset:m,popup:t.createElement(en,{mode:"horizontal"===de?"vertical":de},t.createElement(On,{id:ce,ref:G},h)),disabled:N,onVisibleChange:function(e){"inline"!==T&&z(l,e)}},he)}var fe=t.createElement(Xi.Item,a({role:"none"},w,{component:"li",style:n,className:Q()(V,"".concat(V,"-").concat(T),o,(i={},(0,q.Z)(i,"".concat(V,"-open"),X),(0,q.Z)(i,"".concat(V,"-active"),se),(0,q.Z)(i,"".concat(V,"-selected"),Y),(0,q.Z)(i,"".concat(V,"-disabled"),N),i)),onMouseEnter:function(e){oe(!0),null===y||void 0===y||y({key:l,domEvent:e})},onMouseLeave:function(e){oe(!1),null===g||void 0===g||g({key:l,domEvent:e})}}),he,!M&&t.createElement(no,{id:ce,open:X,keyPath:B},h));return F&&(fe=F(fe,e,{selected:Y,active:se,open:X,disabled:N})),t.createElement(en,{onItemClick:ue,mode:"horizontal"===T?"vertical":T,itemIcon:W,expandIcon:H},fe)};function so(e){var i,n=e.eventKey,r=e.children,a=hn(n),o=Pn(r,a),s=un();return t.useEffect((function(){if(s)return s.registerPath(n,a),function(){s.unregisterPath(n,a)}}),[a]),i=s?o:t.createElement(oo,e,o),t.createElement(cn.Provider,{value:a},i)}function lo(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Er(e)){var i=e.nodeName.toLowerCase(),n=["input","select","textarea","button"].includes(i)||e.isContentEditable||"a"===i&&!!e.getAttribute("href"),r=e.getAttribute("tabindex"),a=Number(r),o=null;return r&&!Number.isNaN(a)?o=a:n&&null===o&&(o=0),n&&e.disabled&&(o=null),null!==o&&(o>=0||t&&o<0)}return!1}function uo(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,Dt.Z)(e.querySelectorAll("*")).filter((function(e){return lo(e,t)}));return lo(e,t)&&i.unshift(e),i}var co=Yi.LEFT,ho=Yi.RIGHT,po=Yi.UP,fo=Yi.DOWN,mo=Yi.ENTER,vo=Yi.ESC,yo=Yi.HOME,go=Yi.END,_o=[po,fo,co,ho];function bo(e,t){return uo(e,!0).filter((function(e){return t.has(e)}))}function xo(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var r=bo(e,t),a=r.length,o=r.findIndex((function(e){return i===e}));return n<0?-1===o?o=a-1:o-=1:n>0&&(o+=1),r[o=(o+a)%a]}function wo(e,i,n,r,a,o,s,l,u,c){var h=t.useRef(),p=t.useRef();p.current=i;var d=function(){Li.cancel(h.current)};return t.useEffect((function(){return function(){d()}}),[]),function(t){var f=t.which;if([].concat(_o,[mo,vo,yo,go]).includes(f)){var m,v,y,g=function(){return m=new Set,v=new Map,y=new Map,o().forEach((function(e){var t=document.querySelector("[data-menu-id='".concat(fn(r,e),"']"));t&&(m.add(t),y.set(t,e),v.set(e,t))})),m};g();var _=function(e,t){for(var i=e||document.activeElement;i;){if(t.has(i))return i;i=i.parentElement}return null}(v.get(i),m),b=y.get(_),x=function(e,t,i,n){var r,a,o,s,l="prev",u="next",c="children",h="parent";if("inline"===e&&n===mo)return{inlineTrigger:!0};var p=(r={},(0,q.Z)(r,po,l),(0,q.Z)(r,fo,u),r),d=(a={},(0,q.Z)(a,co,i?u:l),(0,q.Z)(a,ho,i?l:u),(0,q.Z)(a,fo,c),(0,q.Z)(a,mo,c),a),f=(o={},(0,q.Z)(o,po,l),(0,q.Z)(o,fo,u),(0,q.Z)(o,mo,c),(0,q.Z)(o,vo,h),(0,q.Z)(o,co,i?c:h),(0,q.Z)(o,ho,i?h:c),o);switch(null===(s={inline:p,horizontal:d,vertical:f,inlineSub:p,horizontalSub:f,verticalSub:f}["".concat(e).concat(t?"":"Sub")])||void 0===s?void 0:s[n]){case l:return{offset:-1,sibling:!0};case u:return{offset:1,sibling:!0};case h:return{offset:-1,sibling:!1};case c:return{offset:1,sibling:!1};default:return null}}(e,1===s(b,!0).length,n,f);if(!x&&f!==yo&&f!==go)return;(_o.includes(f)||[yo,go].includes(f))&&t.preventDefault();var w=function(e){if(e){var t=e,i=e.querySelector("a");(null===i||void 0===i?void 0:i.getAttribute("href"))&&(t=i);var n=y.get(e);l(n),d(),h.current=Li((function(){p.current===n&&t.focus()}))}};if([yo,go].includes(f)||x.sibling||!_){var k,P,S=bo(k=_&&"inline"!==e?function(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}(_):a.current,m);P=f===yo?S[0]:f===go?S[S.length-1]:xo(k,m,_,x.offset),w(P)}else if(x.inlineTrigger)u(b);else if(x.offset>0)u(b,!0),d(),h.current=Li((function(){g();var e=_.getAttribute("aria-controls"),t=xo(document.getElementById(e),m);w(t)}),5);else if(x.offset<0){var T=s(b,!0),E=T[T.length-2],C=v.get(E);u(E,!1),w(C)}}null===c||void 0===c||c(t)}}var ko=Math.random().toFixed(5).toString().slice(2),Po=0;var So="__RC_UTIL_PATH_SPLIT__",To=function(e){return e.join(So)},Eo="rc-menu-more";function Co(){var e=t.useState({}),i=(0,r.Z)(e,2)[1],n=(0,t.useRef)(new Map),a=(0,t.useRef)(new Map),o=t.useState([]),s=(0,r.Z)(o,2),l=s[0],u=s[1],c=(0,t.useRef)(0),h=(0,t.useRef)(!1),p=(0,t.useCallback)((function(e,t){var r=To(t);a.current.set(r,e),n.current.set(e,r),c.current+=1;var o,s=c.current;o=function(){s===c.current&&(h.current||i({}))},Promise.resolve().then(o)}),[]),d=(0,t.useCallback)((function(e,t){var i=To(t);a.current.delete(i),n.current.delete(e)}),[]),f=(0,t.useCallback)((function(e){u(e)}),[]),m=(0,t.useCallback)((function(e,t){var i=n.current.get(e)||"",r=i.split(So);return t&&l.includes(r[0])&&r.unshift(Eo),r}),[l]),v=(0,t.useCallback)((function(e,t){return e.some((function(e){return m(e,!0).includes(t)}))}),[m]),y=(0,t.useCallback)((function(e){var t="".concat(n.current.get(e)).concat(So),i=new Set;return(0,Dt.Z)(a.current.keys()).forEach((function(e){e.startsWith(t)&&i.add(a.current.get(e))})),i}),[]);return t.useEffect((function(){return function(){h.current=!0}}),[]),{registerPath:p,unregisterPath:d,refreshOverflowKeys:f,isSubPathKey:v,getKeyPath:m,getKeys:function(){var e=(0,Dt.Z)(n.current.keys());return l.length&&e.push(Eo),e},getSubPathKeys:y}}var Mo=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],Io=[],Oo=t.forwardRef((function(e,i){var n,o,s=e.prefixCls,l=void 0===s?"rc-menu":s,u=e.rootClassName,c=e.style,h=e.className,p=e.tabIndex,d=void 0===p?0:p,f=e.items,m=e.children,v=e.direction,y=e.id,g=e.mode,_=void 0===g?"vertical":g,b=e.inlineCollapsed,x=e.disabled,w=e.disabledOverflow,k=e.subMenuOpenDelay,P=void 0===k?.1:k,S=e.subMenuCloseDelay,T=void 0===S?.1:S,E=e.forceSubMenuRender,C=e.defaultOpenKeys,M=e.openKeys,I=e.activeKey,O=e.defaultActiveFirst,D=e.selectable,A=void 0===D||D,L=e.multiple,z=void 0!==L&&L,R=e.defaultSelectedKeys,F=e.selectedKeys,j=e.onSelect,B=e.onDeselect,V=e.inlineIndent,N=void 0===V?24:V,U=e.motion,G=e.defaultMotions,W=e.triggerSubMenuAction,H=void 0===W?"hover":W,Z=e.builtinPlacements,X=e.itemIcon,Y=e.expandIcon,J=e.overflowedIndicator,ee=void 0===J?"...":J,te=e.overflowedIndicatorPopupClassName,ie=e.getPopupContainer,ne=e.onClick,re=e.onOpenChange,ae=e.onKeyDown,oe=(e.openAnimation,e.openTransitionName,e._internalRenderMenuItem),se=e._internalRenderSubMenuItem,le=$(e,Mo),ue=t.useMemo((function(){return Tn(m,f,Io)}),[m,f]),ce=t.useState(!1),he=(0,r.Z)(ce,2),pe=he[0],de=he[1],fe=t.useRef(),me=function(e){var i=Nt(e,{value:e}),n=(0,r.Z)(i,2),a=n[0],o=n[1];return t.useEffect((function(){Po+=1;var e="".concat(ko,"-").concat(Po);o("rc-menu-uuid-".concat(e))}),[]),a}(y),ve="rtl"===v;var ye=t.useMemo((function(){return"inline"!==_&&"vertical"!==_||!b?[_,!1]:["vertical",b]}),[_,b]),ge=(0,r.Z)(ye,2),_e=ge[0],be=ge[1],xe=t.useState(0),we=(0,r.Z)(xe,2),ke=we[0],Pe=we[1],Se=ke>=ue.length-1||"horizontal"!==_e||w,Te=Nt(C,{value:M,postState:function(e){return e||Io}}),Ee=(0,r.Z)(Te,2),Ce=Ee[0],Me=Ee[1],Ie=function(e){Me(e),null===re||void 0===re||re(e)},Oe=t.useState(Ce),De=(0,r.Z)(Oe,2),Ae=De[0],Le=De[1],ze="inline"===_e,Re=t.useRef(!1);t.useEffect((function(){ze&&Le(Ce)}),[Ce]),t.useEffect((function(){Re.current?ze?Me(Ae):Ie(Io):Re.current=!0}),[ze]);var Fe=Co(),je=Fe.registerPath,Be=Fe.unregisterPath,Ve=Fe.refreshOverflowKeys,Ne=Fe.isSubPathKey,Ue=Fe.getKeyPath,Ge=Fe.getKeys,We=Fe.getSubPathKeys,He=t.useMemo((function(){return{registerPath:je,unregisterPath:Be}}),[je,Be]),Ze=t.useMemo((function(){return{isSubPathKey:Ne}}),[Ne]);t.useEffect((function(){Ve(Se?Io:ue.slice(ke+1).map((function(e){return e.key})))}),[ke,Se]);var qe=Nt(I||O&&(null===(n=ue[0])||void 0===n?void 0:n.key),{value:I}),Xe=(0,r.Z)(qe,2),Ke=Xe[0],Ye=Xe[1],$e=En((function(e){Ye(e)})),Je=En((function(){Ye(void 0)}));(0,t.useImperativeHandle)(i,(function(){return{list:fe.current,focus:function(e){var t,i,n,r,a=null!==Ke&&void 0!==Ke?Ke:null===(t=ue.find((function(e){return!e.props.disabled})))||void 0===t?void 0:t.key;a&&(null===(i=fe.current)||void 0===i||null===(n=i.querySelector("li[data-menu-id='".concat(fn(me,a),"']")))||void 0===n||null===(r=n.focus)||void 0===r||r.call(n,e))}}}));var Qe=Nt(R||[],{value:F,postState:function(e){return Array.isArray(e)?e:null===e||void 0===e?Io:[e]}}),et=(0,r.Z)(Qe,2),tt=et[0],it=et[1],nt=En((function(e){null===ne||void 0===ne||ne(rn(e)),function(e){if(A){var t,i=e.key,n=tt.includes(i);t=z?n?tt.filter((function(e){return e!==i})):[].concat((0,Dt.Z)(tt),[i]):[i],it(t);var r=K(K({},e),{},{selectedKeys:t});n?null===B||void 0===B||B(r):null===j||void 0===j||j(r)}!z&&Ce.length&&"inline"!==_e&&Ie(Io)}(e)})),rt=En((function(e,t){var i=Ce.filter((function(t){return t!==e}));if(t)i.push(e);else if("inline"!==_e){var n=We(e);i=i.filter((function(e){return!n.has(e)}))}Lt()(Ce,i)||Ie(i)})),at=En(ie),ot=wo(_e,Ke,ve,me,fe,Ge,Ue,Ye,(function(e,t){var i=null!==t&&void 0!==t?t:!Ce.includes(e);rt(e,i)}),ae);t.useEffect((function(){de(!0)}),[]);var st=t.useMemo((function(){return{_internalRenderMenuItem:oe,_internalRenderSubMenuItem:se}}),[oe,se]),lt="horizontal"!==_e||w?ue:ue.map((function(e,i){return t.createElement(en,{key:e.key,overflowDisabled:i>ke},e)})),ut=t.createElement(Xi,a({id:y,ref:fe,prefixCls:"".concat(l,"-overflow"),component:"ul",itemComponent:wn,className:Q()(l,"".concat(l,"-root"),"".concat(l,"-").concat(_e),h,(o={},(0,q.Z)(o,"".concat(l,"-inline-collapsed"),be),(0,q.Z)(o,"".concat(l,"-rtl"),ve),o),u),dir:v,style:c,role:"menu",tabIndex:d,data:lt,renderRawItem:function(e){return e},renderRawRest:function(e){var i=e.length,n=i?ue.slice(-i):null;return t.createElement(so,{eventKey:Eo,title:ee,disabled:Se,internalPopupClose:0===i,popupClassName:te},n)},maxCount:"horizontal"!==_e||w?Xi.INVALIDATE:Xi.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(e){Pe(e)},onKeyDown:ot},le));return t.createElement(vn.Provider,{value:st},t.createElement(dn.Provider,{value:me},t.createElement(en,{prefixCls:l,rootClassName:u,mode:_e,openKeys:Ce,rtl:ve,disabled:x,motion:pe?U:null,defaultMotions:pe?G:null,activeKey:Ke,onActive:$e,onInactive:Je,selectedKeys:tt,inlineIndent:N,subMenuOpenDelay:P,subMenuCloseDelay:T,forceSubMenuRender:E,builtinPlacements:Z,triggerSubMenuAction:H,getPopupContainer:at,itemIcon:X,expandIcon:Y,onItemClick:nt,onOpenChange:rt},t.createElement(pn.Provider,{value:Ze},ut),t.createElement("div",{style:{display:"none"},"aria-hidden":!0},t.createElement(ln.Provider,{value:He},ue)))))})),Do=["className","title","eventKey","children"],Ao=["children"],Lo=function(e){var i=e.className,n=e.title,r=(e.eventKey,e.children),o=$(e,Do),s=t.useContext(Qi).prefixCls,l="".concat(s,"-item-group");return t.createElement("li",a({},o,{onClick:function(e){return e.stopPropagation()},className:Q()(l,i)}),t.createElement("div",{className:"".concat(l,"-title"),title:"string"===typeof n?n:void 0},n),t.createElement("ul",{className:"".concat(l,"-list")},r))};function zo(e){var i=e.children,n=$(e,Ao),r=Pn(i,hn(n.eventKey));return un()?r:t.createElement(Lo,$i(n,["warnKey"]),r)}function Ro(e){var i=e.className,n=e.style,r=t.useContext(Qi).prefixCls;return un()?null:t.createElement("li",{className:Q()("".concat(r,"-item-divider"),i),style:n})}var Fo=hn,jo=Oo;jo.Item=wn,jo.SubMenu=so,jo.ItemGroup=zo,jo.Divider=Ro;var Bo=jo,Vo=t.createContext({getPrefixCls:function(e,t){return t||(e?"ant-".concat(e):"ant")}}),No=Vo.Consumer;var Uo=t.createContext({});!function(){var e=0}();var Go=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t},Wo=function(){return{height:0,opacity:0}},Ho=function(e){return{height:e.scrollHeight,opacity:1}},Zo=function(e,t){return!0===(null===t||void 0===t?void 0:t.deadline)||"height"===t.propertyName},qo={motionName:"ant-motion-collapse",onAppearStart:Wo,onEnterStart:Wo,onAppearActive:Ho,onEnterActive:Ho,onLeaveStart:function(e){return{height:e?e.offsetHeight:0}},onLeaveActive:Wo,onAppearEnd:Zo,onEnterEnd:Zo,onLeaveEnd:Zo,motionDeadline:500},Xo=(Go("bottomLeft","bottomRight","topLeft","topRight"),function(e,t,i){return void 0!==i?i:"".concat(e,"-").concat(t)}),Ko=qo,Yo=t.isValidElement;function $o(e,i){return function(e,i,n){return Yo(e)?t.cloneElement(e,"function"===typeof n?n(e.props||{}):n):i}(e,e,i)}var Jo=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Qo=function(e){var i=e.prefixCls,n=e.className,r=e.dashed,o=Jo(e,["prefixCls","className","dashed"]),s=(0,t.useContext(Vo).getPrefixCls)("menu",i),l=Q()((0,q.Z)({},"".concat(s,"-item-divider-dashed"),!!r),n);return t.createElement(Ro,a({className:l},o))},es={adjustX:1,adjustY:1},ts=[0,0],is={left:{points:["cr","cl"],overflow:es,offset:[-4,0],targetOffset:ts},right:{points:["cl","cr"],overflow:es,offset:[4,0],targetOffset:ts},top:{points:["bc","tc"],overflow:es,offset:[0,-4],targetOffset:ts},bottom:{points:["tc","bc"],overflow:es,offset:[0,4],targetOffset:ts},topLeft:{points:["bl","tl"],overflow:es,offset:[0,-4],targetOffset:ts},leftTop:{points:["tr","tl"],overflow:es,offset:[-4,0],targetOffset:ts},topRight:{points:["br","tr"],overflow:es,offset:[0,-4],targetOffset:ts},rightTop:{points:["tl","tr"],overflow:es,offset:[4,0],targetOffset:ts},bottomRight:{points:["tr","br"],overflow:es,offset:[0,4],targetOffset:ts},rightBottom:{points:["bl","br"],overflow:es,offset:[4,0],targetOffset:ts},bottomLeft:{points:["tl","bl"],overflow:es,offset:[0,4],targetOffset:ts},leftBottom:{points:["br","bl"],overflow:es,offset:[-4,0],targetOffset:ts}};function ns(e){var i=e.showArrow,n=e.arrowContent,r=e.children,a=e.prefixCls,o=e.id,s=e.overlayInnerStyle,l=e.className,u=e.style;return t.createElement("div",{className:Q()("".concat(a,"-content"),l),style:u},!1!==i&&t.createElement("div",{className:"".concat(a,"-arrow"),key:"arrow"},n),t.createElement("div",{className:"".concat(a,"-inner"),id:o,role:"tooltip",style:s},"function"===typeof r?r():r))}var rs=function(e,i){var n=e.overlayClassName,r=e.trigger,o=void 0===r?["hover"]:r,s=e.mouseEnterDelay,l=void 0===s?0:s,u=e.mouseLeaveDelay,c=void 0===u?.1:u,h=e.overlayStyle,p=e.prefixCls,d=void 0===p?"rc-tooltip":p,f=e.children,m=e.onVisibleChange,v=e.afterVisibleChange,y=e.transitionName,g=e.animation,_=e.motion,b=e.placement,x=void 0===b?"right":b,w=e.align,k=void 0===w?{}:w,P=e.destroyTooltipOnHide,S=void 0!==P&&P,T=e.defaultVisible,E=e.getTooltipContainer,C=e.overlayInnerStyle,M=e.arrowContent,I=e.overlay,O=e.id,D=e.showArrow,A=$(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"]),L=(0,t.useRef)(null);(0,t.useImperativeHandle)(i,(function(){return L.current}));var z=K({},A);"visible"in e&&(z.popupVisible=e.visible);var R=!1,F=!1;if("boolean"===typeof S)R=S;else if(S&&"object"===(0,te.Z)(S)){var j=S.keepParent;R=!0===j,F=!1===j}return t.createElement(Ya,a({popupClassName:n,prefixCls:d,popup:function(){return t.createElement(ns,{showArrow:D,arrowContent:M,key:"content",prefixCls:d,id:O,overlayInnerStyle:C},I)},action:o,builtinPlacements:is,popupPlacement:x,ref:L,popupAlign:k,getPopupContainer:E,onPopupVisibleChange:m,afterPopupVisibleChange:v,popupTransitionName:y,popupAnimation:g,popupMotion:_,defaultPopupVisible:T,destroyPopupOnHide:R,autoDestroy:F,mouseLeaveDelay:c,popupStyle:h,mouseEnterDelay:l},z),f)},as=(0,t.forwardRef)(rs),os=(Go("success","processing","error","default","warning"),Go("pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime")),ss={adjustX:1,adjustY:1},ls={adjustX:0,adjustY:0},us=[0,0];function cs(e){return"boolean"===typeof e?e?ss:ls:a(a({},ls),e)}function hs(e){var t=e.arrowWidth,i=void 0===t?4:t,n=e.horizontalArrowShift,r=void 0===n?16:n,o=e.verticalArrowShift,s=void 0===o?8:o,l=e.autoAdjustOverflow,u=e.arrowPointAtCenter,c={left:{points:["cr","cl"],offset:[-4,0]},right:{points:["cl","cr"],offset:[4,0]},top:{points:["bc","tc"],offset:[0,-4]},bottom:{points:["tc","bc"],offset:[0,4]},topLeft:{points:["bl","tc"],offset:[-(r+i),-4]},leftTop:{points:["tr","cl"],offset:[-4,-(s+i)]},topRight:{points:["br","tc"],offset:[r+i,-4]},rightTop:{points:["tl","cr"],offset:[4,-(s+i)]},bottomRight:{points:["tr","bc"],offset:[r+i,4]},rightBottom:{points:["bl","cr"],offset:[4,s+i]},bottomLeft:{points:["tl","bc"],offset:[-(r+i),4]},leftBottom:{points:["br","cl"],offset:[-4,s+i]}};return Object.keys(c).forEach((function(e){c[e]=u?a(a({},c[e]),{overflow:cs(l),targetOffset:us}):a(a({},is[e]),{overflow:cs(l)}),c[e].ignoreShake=!0})),c}var ps=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},ds=new RegExp("^(".concat(os.join("|"),")(-inverse)?$"));function fs(e,i){var n=e.type;if((!0===n.__ANT_BUTTON||"button"===e.type)&&e.props.disabled||!0===n.__ANT_SWITCH&&(e.props.disabled||e.props.loading)||!0===n.__ANT_RADIO&&e.props.disabled){var r=function(e,t){var i={},n=a({},e);return t.forEach((function(t){e&&t in e&&(i[t]=e[t],delete n[t])})),{picked:i,omitted:n}}(e.props.style,["position","left","right","top","bottom","float","display","zIndex"]),o=r.picked,s=r.omitted,l=a(a({display:"inline-block"},o),{cursor:"not-allowed",width:e.props.block?"100%":null}),u=$o(e,{style:a(a({},s),{pointerEvents:"none"}),className:null});return t.createElement("span",{style:l,className:Q()(e.props.className,"".concat(i,"-disabled-compatible-wrapper"))},u)}return e}var ms=t.forwardRef((function(e,i){var n,o=t.useContext(Vo),s=o.getPopupContainer,l=o.getPrefixCls,u=o.direction,c=Nt(!1,{value:e.visible,defaultValue:e.defaultVisible}),h=(0,r.Z)(c,2),p=h[0],d=h[1],f=function(){var t=e.title,i=e.overlay;return!t&&!i&&0!==t},m=function(){var t=e.builtinPlacements,i=e.arrowPointAtCenter,n=e.autoAdjustOverflow;return t||hs({arrowPointAtCenter:i,autoAdjustOverflow:n})},v=e.getPopupContainer,y=ps(e,["getPopupContainer"]),g=e.prefixCls,_=e.openClassName,b=e.getTooltipContainer,x=e.overlayClassName,w=e.color,k=e.overlayInnerStyle,P=e.children,S=l("tooltip",g),T=l(),E=p;!("visible"in e)&&f()&&(E=!1);var C,M=fs(Yo(P)?P:t.createElement("span",null,P),S),I=M.props,O=Q()(I.className,(0,q.Z)({},_||"".concat(S,"-open"),!0)),D=Q()(x,(n={},(0,q.Z)(n,"".concat(S,"-rtl"),"rtl"===u),(0,q.Z)(n,"".concat(S,"-").concat(w),w&&ds.test(w)),n)),A=k;return w&&!ds.test(w)&&(A=a(a({},k),{background:w}),C={"--antd-arrow-background-color":w}),t.createElement(as,a({},y,{prefixCls:S,overlayClassName:D,getTooltipContainer:v||b||s,ref:i,builtinPlacements:m(),overlay:function(){var t=e.title,i=e.overlay;return 0===t?t:i||t||""}(),visible:E,onVisibleChange:function(t){var i;d(!f()&&t),f()||null===(i=e.onVisibleChange)||void 0===i||i.call(e,t)},onPopupAlign:function(e,t){var i=m(),n=Object.keys(i).find((function(e){return i[e].points[0]===t.points[0]&&i[e].points[1]===t.points[1]}));if(n){var r=e.getBoundingClientRect(),a={top:"50%",left:"50%"};n.indexOf("top")>=0||n.indexOf("Bottom")>=0?a.top="".concat(r.height-t.offset[1],"px"):(n.indexOf("Top")>=0||n.indexOf("bottom")>=0)&&(a.top="".concat(-t.offset[1],"px")),n.indexOf("left")>=0||n.indexOf("Right")>=0?a.left="".concat(r.width-t.offset[0],"px"):(n.indexOf("right")>=0||n.indexOf("Left")>=0)&&(a.left="".concat(-t.offset[0],"px")),e.style.transformOrigin="".concat(a.left," ").concat(a.top)}},overlayInnerStyle:A,arrowContent:t.createElement("span",{className:"".concat(S,"-arrow-content"),style:C}),motion:{motionName:Xo(T,"zoom-big-fast",e.transitionName),motionDeadline:1e3}}),E?$o(M,{className:O}):M)}));ms.defaultProps={placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0};var vs=ms,ys=(0,t.createContext)({prefixCls:"",firstLevel:!0,inlineCollapsed:!1}),gs=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},_s=function(e){(0,St.Z)(n,e);var i=Ct(n);function n(){var e;return(0,kt.Z)(this,n),(e=i.apply(this,arguments)).renderItem=function(i){var n,r,o=i.siderCollapsed,s=e.context,l=s.prefixCls,u=s.firstLevel,c=s.inlineCollapsed,h=s.direction,p=s.disableMenuItemTitleTooltip,d=e.props,f=d.className,m=d.children,v=e.props,y=v.title,g=v.icon,_=v.danger,b=gs(v,["title","icon","danger"]),x=y;"undefined"===typeof y?x=u?m:"":!1===y&&(x="");var w={title:x};o||c||(w.title=null,w.visible=!1);var k=Gt(m).length,P=t.createElement(wn,a({},b,{className:Q()((n={},(0,q.Z)(n,"".concat(l,"-item-danger"),_),(0,q.Z)(n,"".concat(l,"-item-only-child"),1===(g?k+1:k)),n),f),title:"string"===typeof y?y:void 0}),$o(g,{className:Q()(Yo(g)?null===(r=g.props)||void 0===r?void 0:r.className:"","".concat(l,"-item-icon"))}),e.renderItemChildren(c));return p||(P=t.createElement(vs,a({},w,{placement:"rtl"===h?"left":"right",overlayClassName:"".concat(l,"-inline-collapsed-tooltip")}),P)),P},e}return(0,Pt.Z)(n,[{key:"renderItemChildren",value:function(e){var i=this.context,n=i.prefixCls,r=i.firstLevel,a=this.props,o=a.icon,s=a.children,l=t.createElement("span",{className:"".concat(n,"-title-content")},s);return(!o||Yo(s)&&"span"===s.type)&&s&&e&&r&&"string"===typeof s?t.createElement("div",{className:"".concat(n,"-inline-collapsed-noicon")},s.charAt(0)):l}},{key:"render",value:function(){return t.createElement(Uo.Consumer,null,this.renderItem)}}]),n}(t.Component);_s.contextType=ys;var bs=function(e){var i,n,r=e.popupClassName,o=e.icon,s=e.title,l=e.theme,u=t.useContext(ys),c=u.prefixCls,h=u.inlineCollapsed,p=u.antdMenuTheme,d=Fo();if(o){var f=Yo(s)&&"span"===s.type;n=t.createElement(t.Fragment,null,$o(o,{className:Q()(Yo(o)?null===(i=o.props)||void 0===i?void 0:i.className:"","".concat(c,"-item-icon"))}),f?s:t.createElement("span",{className:"".concat(c,"-title-content")},s))}else n=h&&!d.length&&s&&"string"===typeof s?t.createElement("div",{className:"".concat(c,"-inline-collapsed-noicon")},s.charAt(0)):t.createElement("span",{className:"".concat(c,"-title-content")},s);var m=t.useMemo((function(){return a(a({},u),{firstLevel:!1})}),[u]);return t.createElement(ys.Provider,{value:m},t.createElement(so,a({},$i(e,["icon"]),{title:n,popupClassName:Q()(c,"".concat(c,"-").concat(l||p),r)})))},xs=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function ws(e){return(e||[]).map((function(e,i){if(e&&"object"===(0,te.Z)(e)){var n=e,r=n.label,o=n.children,s=n.key,l=n.type,u=xs(n,["label","children","key","type"]),c=null!==s&&void 0!==s?s:"tmp-".concat(i);return o||"group"===l?"group"===l?t.createElement(zo,a({key:c},u,{title:r}),ws(o)):t.createElement(bs,a({key:c},u,{title:r}),ws(o)):"divider"===l?t.createElement(Qo,a({key:c},u)):t.createElement(_s,a({key:c},u),r)}return null})).filter((function(e){return e}))}function ks(e){return t.useMemo((function(){return e?ws(e):e}),[e])}var Ps=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Ss=t.createContext(null),Ts=function(e){var i=e.children,n=Ps(e,["children"]),r=t.useContext(Ss),o=t.useMemo((function(){return a(a({},r),n)}),[r,n.prefixCls,n.mode,n.selectable]);return t.createElement(Ss.Provider,{value:o},i)},Es=Ss,Cs=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Ms=(0,t.forwardRef)((function(e,i){var n,r=t.useContext(Es)||{},o=t.useContext(Vo),s=o.getPrefixCls,l=o.getPopupContainer,u=o.direction,c=s(),h=e.prefixCls,p=e.className,d=e.theme,f=void 0===d?"light":d,m=e.expandIcon,v=e._internalDisableMenuItemTitleTooltip,y=e.inlineCollapsed,g=e.siderCollapsed,_=e.items,b=e.children,x=e.mode,w=e.selectable,k=e.onClick,P=$i(Cs(e,["prefixCls","className","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","items","children","mode","selectable","onClick"]),["collapsedWidth"]),S=ks(_)||b;null===(n=r.validator)||void 0===n||n.call(r,{mode:x});var T,E=zt((function(){var e;null===k||void 0===k||k.apply(void 0,arguments),null===(e=null===r||void 0===r?void 0:r.onClick)||void 0===e||e.call(r)})),C=r.mode||x,M=null!==w&&void 0!==w?w:r.selectable,I=t.useMemo((function(){return void 0!==g?g:y}),[y,g]),O={horizontal:{motionName:"".concat(c,"-slide-up")},inline:Ko,other:{motionName:"".concat(c,"-zoom-big")}},D=s("menu",h||r.prefixCls),A=Q()("".concat(D,"-").concat(f),p);T="function"===typeof m?m:$o(m||r.expandIcon,{className:"".concat(D,"-submenu-expand-icon")});var L=t.useMemo((function(){return{prefixCls:D,inlineCollapsed:I||!1,antdMenuTheme:f,direction:u,firstLevel:!0,disableMenuItemTitleTooltip:v}}),[D,I,f,u,v]);return t.createElement(Es.Provider,{value:null},t.createElement(ys.Provider,{value:L},t.createElement(Bo,a({getPopupContainer:l,overflowedIndicator:t.createElement(Ot,null),overflowedIndicatorPopupClassName:"".concat(D,"-").concat(f),mode:C,selectable:M,onClick:E},P,{inlineCollapsed:I,className:A,prefixCls:D,direction:u,defaultMotions:O,expandIcon:T,ref:i}),S)))})),Is=function(e){(0,St.Z)(n,e);var i=Ct(n);function n(){var e;return(0,kt.Z)(this,n),(e=i.apply(this,arguments)).focus=function(t){var i;null===(i=e.menu)||void 0===i||i.focus(t)},e}return(0,Pt.Z)(n,[{key:"render",value:function(){var e=this;return t.createElement(Uo.Consumer,null,(function(i){return t.createElement(Ms,a({ref:function(t){e.menu=t}},e.props,i))}))}}]),n}(t.Component);Is.Divider=Qo,Is.Item=_s,Is.SubMenu=bs,Is.ItemGroup=zo;var Os=Is;var Ds=i.p+"static/media/overview.ed49f3cffdf5245922e675eaa895b361.svg";var As=i.p+"static/media/notification.8a0e7e65d5d6edaa5123bf49848c4989.svg";var Ls=i.p+"static/media/lanchers.1263d4afba20496309c05d8a9615f619.svg";var zs=i.p+"static/media/ota.af2a0871e121b04ac362eedf20b3b07c.svg";var Rs=i.p+"static/media/monitoring.6e2eb88a425394637c982e3bfada13b9.svg";i.p;var Fs=Os.SubMenu,js=function(){var e=(0,t.useState)(!1),i=(0,r.Z)(e,2),n=i[0],a=i[1],o=function(){a(!n)};return(0,mt.jsxs)("div",{children:[(0,mt.jsx)("div",{children:(0,mt.jsx)(_t,{className:"navbar-burger-menu",onClick:o})}),(0,mt.jsxs)("div",{className:n?"slider active":"slider",children:[(0,mt.jsx)("div",{children:(0,mt.jsx)(it,{className:"navbar-close-btn",onClick:o})}),(0,mt.jsx)("div",{children:(0,mt.jsxs)(Os,{style:{width:"191px",backgroundColor:"#171717",color:"#ffffff",marginTop:"30px"},mode:"inline",theme:"dark",children:[(0,mt.jsxs)(Os.Item,{className:"sidebar-overview-icon",children:[(0,mt.jsx)("img",{src:Ds,alt:"overview"}),(0,mt.jsx)(H,{to:"/",children:"Overview"})]},"1"),(0,mt.jsxs)(Os.Item,{className:"sidebar-notification-icon",children:[(0,mt.jsx)("img",{src:As,alt:"notification"}),(0,mt.jsx)(H,{to:"/notifications",children:"Notifications"})]},"2"),(0,mt.jsxs)(Fs,{title:"Contents",icon:(0,mt.jsx)(wt,{}),children:[(0,mt.jsx)(Os.Item,{children:"Filimo "},"4"),(0,mt.jsx)(Os.Item,{children:"Filimo "},"5"),(0,mt.jsx)(Os.Item,{children:"TSCOBOX"},"6")]},"3"),(0,mt.jsxs)(Os.Item,{children:[(0,mt.jsx)("img",{src:Ls,alt:"lancher"}),(0,mt.jsx)(H,{to:"/launchers",children:"Launchers"})]},"7"),(0,mt.jsxs)(Os.Item,{children:[(0,mt.jsx)("img",{src:zs,alt:"ota"}),(0,mt.jsx)(H,{to:"/ota",children:"OTA Management"})]},"8"),(0,mt.jsx)("img",{src:Rs,alt:"monitoring"}),(0,mt.jsxs)(Fs,{title:"Monitoring",children:[(0,mt.jsx)(Os.Item,{children:"Users"},"10"),(0,mt.jsx)(Os.Item,{children:"Servers"},"11"),(0,mt.jsx)(Os.Item,{children:"Products"},"12")]},"9")]})}),(0,mt.jsx)("div",{className:"sidebar-menu-text"})]})]})},Bs=function(){return(0,mt.jsx)("nav",{className:"navbar",children:(0,mt.jsxs)("div",{className:"navbar-container",children:[(0,mt.jsx)("ul",{className:"navbar-nav-left",children:(0,mt.jsx)(js,{})}),(0,mt.jsx)("div",{className:"navbar-brand",children:(0,mt.jsx)("img",{src:Z})}),(0,mt.jsx)("ul",{className:"navbar-nav-right",children:(0,mt.jsx)("li",{children:(0,mt.jsx)(vt,{})})})]})})},Vs=i(5483);i.n(Vs)().accessToken="pk.eyJ1IjoibmV4dGxsYyIsImEiOiJjbDV4Z21xZzUwdDF1M2lucG80eTh6MDBhIn0.6H_GxBFoUQDI58Za_iJdrg";var Ns=function(e,t){return Ns=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},Ns(e,t)};function Us(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}Ns(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function Gs(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{l(n.next(e))}catch(t){a(t)}}function s(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function Ws(e,t){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}Object.create;function Hs(e){var t="function"===typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zs(e,t){var i="function"===typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,a=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function qs(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Zs(arguments[t]));return e}Object.create;var Xs=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value/100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percent",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this._value+"%"},e}();function Ks(e){return new Xs(e)}function Ys(e){return Number(e)!==e}function $s(e){return{}.toString.call(e)}function Js(e){if("string"===typeof e)return e;if("number"===typeof e)return""+e;throw new Error("Expected a string or number but got "+$s(e))}function Qs(e){return!!e}function el(e){if(nl(e)&&!ll(e)){var t=Number(e);return Ys(t)&&sl(e)&&""!=e?el(e.replace(/[^0-9.\-]+/g,"")):t}return e}function tl(e){if(nl(e)&&!sl(e)){if(ll(e))return Js(e);if(ul(e))return e.toString()}return e}function il(e){return!nl(e)||ll(e)||function(e){return e instanceof Xs}(e)?e:sl(e)&&-1!=e.indexOf("%")?Ks(el(e)):el(e)}function nl(e){return null!=e}function rl(e){if(nl(e))return e;throw new Error("Value doesn't exist")}function al(e,t){return nl(e)?e:t}function ol(e){return"[object Date]"===$s(e)}function sl(e){return"string"===typeof e}function ll(e){return"number"===typeof e&&Number(e)==e}function ul(e){return"object"===typeof e&&null!=e}function cl(e){return Array.isArray(e)}var hl=Math.PI,pl=hl/2,dl=hl/180,fl=180/hl;function ml(e,t,i){return nl(e)?gl(e=el(e),t,i):e}function vl(e,t,i){if(!ll(t)||t<=0){var n=Math.round(e);return i&&n-e==.5&&n--,n}var r=Math.pow(10,t);return Math.round(e*r)/r}function yl(e,t){if(!ll(t)||t<=0)return Math.ceil(e);var i=Math.pow(10,t);return Math.ceil(e*i)/i}function gl(e,t,i){if(ll(t)){if(ll(i)&&i<t){var n=i;i=t,t=n}e<t&&(e=t)}return ll(i)&&e>i&&(e=i),e}function _l(e){return vl(Math.sin(dl*e),10)}function bl(e){return vl(Math.cos(dl*e),10)}function xl(e,t){return ll(e)?ll(t)&&t>e?t:e:ll(t)?t:null}function wl(e,t){return ll(e)?ll(t)&&t<e?t:e:ll(t)?t:null}function kl(e,t){var i=rl(e.start),n=rl(t.start),r=rl(e.end),a=rl(t.end);return Math.max(i,n)<=Math.min(r,a)}function Pl(e,t){return e?(t||(t={x:0,y:0}),Math.sqrt(Math.pow(Math.abs(e.x-t.x),2)+Math.pow(Math.abs(e.y-t.y),2))):0}function Sl(e,t,i,n,r){if(!e)return 0;t||(t={x:0,y:0});var a=0,o=e;if(r>0)for(var s=0;s<=r;s++){var l=Ol(e,t,i,n,s/r);a+=Pl(o,l),o=l}return a}function Tl(e,t,i,n){var r=Pl(t,n),a=Pl(e,i);return Math.abs(a/r)}function El(e,t,i){return ll(i)||(i=.5),{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function Cl(e,t){t||(t={x:2*e.x,y:2*e.y});var i=t.x-e.x,n=t.y-e.y,r=Math.atan2(n,i)*fl;return r<0&&(r+=360),zl(r)}function Ml(e){if(e){var t=e.length;if(0!==t){for(var i,n=void 0,r=void 0,a=void 0,o=0;o<t;o++){var s=e[o];(!ll(r)||s.x>r)&&(r=s.x),(!ll(n)||s.x<n)&&(n=s.x),(!ll(i)||s.y<i)&&(i=s.y),(!ll(a)||s.y>a)&&(a=s.y)}return{x:n,y:i,width:r-n,height:a-i}}}return{x:0,y:0,width:0,height:0}}function Il(e){var t=e.length;if(0!==t){for(var i=void 0,n=void 0,r=void 0,a=void 0,o=0;o<t;o++){var s=e[o];i=wl(s.x,i),n=wl(s.y,n),r=xl(s.x+s.width,r),a=xl(s.y+s.height,a)}return{x:i,y:n,width:r-i,height:a-n}}}function Ol(e,t,i,n,r){var a={x:0,y:0},o=1-r,s=o*o,l=s*o;return a.x=e.x*l+3*i.x*s*r+3*n.x*o*r*r+t.x*r*r*r,a.y=e.y*l+3*i.y*s*r+3*n.y*o*r*r+t.y*r*r*r,a}function Dl(e,t,i,n,r,a){return r=Ll(r),a=Ll(a),{x:(-e.x+t.x/r+i.x)*r,y:(-e.y+t.y/a+i.y)*a}}function Al(e,t,i,n,r,a){return r=Ll(r),a=Ll(a),{x:(t.x+i.x/r-n.x)*r,y:(t.y+i.y/a-n.y)*a}}function Ll(e){return 1-e+1e-5}function zl(e){return 360==e?360:e%360}function Rl(e,t,i){var n=Number.MAX_VALUE,r=Number.MAX_VALUE,a=-Number.MAX_VALUE,o=-Number.MAX_VALUE,s=[];ll(i)||(i=1),s.push(Fl(i,e)),s.push(Fl(i,t));for(var l=Math.min(90*Math.floor(e/90),90*Math.floor(t/90)),u=Math.max(90*Math.ceil(e/90),90*Math.ceil(t/90)),c=l;c<=u;c+=90)c>=e&&c<=t&&s.push(Fl(i,c));for(var h=0;h<s.length;h++){var p=s[h];p.x<n&&(n=p.x),p.y<r&&(r=p.y),p.x>a&&(a=p.x),p.y>o&&(o=p.y)}return{x:n,y:r,width:a-n,height:o-r}}function Fl(e,t){return{x:e*bl(t),y:e*_l(t)}}function jl(e,t){for(var i=e.length,n=0;n<i;++n)if(e[n]===t)return n;return-1}function Bl(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n]))return!0;return!1}function Vl(e,t){for(var i=e.length,n=new Array(i),r=0;r<i;++r)n[r]=t(e[r],r);return n}function Nl(e,t){for(var i=e.length,n=0;n<i;++n)t(e[n],n)}function Ul(e,t){for(var i=e.length,n=0;n<i&&t(e[n],n);++n);}function Gl(e,t){var i=!1,n=e.indexOf(t);if(-1!==n){i=!0,e.splice(n,1);for(var r=e.length;n<r;)e[n]===t?(e.splice(n,1),--r):++n}return i}function Wl(e,t,i){var n=jl(e,t);-1!==n&&Kl(e,n),null==i?e.push(t):Xl(e,i,t)}function Hl(e,t,i){ll(i)?0===i?e.unshift(t):e.splice(i,0,t):e.push(t)}function Zl(e){return Array.isArray(e)?e:[e]}function ql(e){for(var t=e.length,i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function Xl(e,t,i){e.splice(t,0,i)}function Kl(e,t){e.splice(t,1)}function Yl(e,t,i){for(var n=0,r=e.length,a=!1;n<r;){var o=n+r>>1,s=t(i,e[o]);s<0?r=o:0===s?(a=!0,n=o+1):n=o+1}return{found:a,index:a?n-1:n}}function $l(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n],n))return n;return-1}function Jl(e,t){var i=$l(e,t);if(-1!==i)return e[i]}function Ql(e,t){for(var i=e.length,n=0;n<i;)t(e[n])?++n:(e.splice(n,1),--i)}var eu=function(){function e(e){this._disposed=!1,this._dispose=e}return e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._dispose())},e}(),tu=function(e){function t(t){return e.call(this,(function(){Nl(t,(function(e){e.dispose()}))}))||this}return Us(t,e),t}(eu),iu=function(e){function t(){var t=e.call(this,(function(){nl(t._disposer)&&(t._disposer.dispose(),t._disposer=void 0)}))||this;return t}return Us(t,e),t.prototype.get=function(){return this._value},t.prototype.set=function(e,t){nl(this._disposer)&&this._disposer.dispose(),this._disposer=t,this._value=e},t.prototype.reset=function(){this.set(void 0,void 0)},t}(eu),nu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._counter=0,t}return Us(t,e),t.prototype.increment=function(){var e=this;return++this._counter,new eu((function(){--e._counter,0===e._counter&&e.dispose()}))},t}(eu),ru=!1,au=[],ou=[],su=[],lu=[],uu="function"===typeof requestAnimationFrame?function(e){requestAnimationFrame(e)}:function(e){setTimeout(e,16.666666666666668)};function cu(){for(var e=Date.now(),t=au.length,i=0;i<t;++i)au[i](e);!function(e,t){for(var i=e.length,n=t;n<i;++n)e[n-t]=e[n];e.length=i-t}(au,t);for(i=0;i<ou.length;++i)ou[i](e);ou.length=0;for(i=0;i<su.length;++i)su[i](e);su.length=0,0===au.length&&0===ou.length?ru=!1:uu(cu)}function hu(){ru||(ru=!0,uu(cu))}function pu(e){su.push(e),hu()}var du=function(){function e(){this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}return e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;var e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{Nl(e,(function(e){e.disposer.dispose()}))}finally{this._killed=null,this._iterating=null}}},e.prototype.hasListeners=function(){return 0!==this._listeners.length},e.prototype.hasListenersByType=function(e){return Bl(this._listeners,(function(t){return(null===t.type||t.type===e)&&!t.killed}))},e.prototype.enable=function(){this._enabled=!0},e.prototype.disable=function(){this._enabled=!1},e.prototype.enableType=function(e){delete this._disabled[e]},e.prototype.disableType=function(e,t){void 0===t&&(t=1/0),this._disabled[e]=t},e.prototype._removeListener=function(e){if(0===this._iterating){var t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)},e.prototype._removeExistingListener=function(e,t,i,n){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((function(r){r.once!==e||r.type!==t||null!=i&&r.callback!==i||r.context!==n||r.disposer.dispose()}))},e.prototype.isEnabled=function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&null==this._disabled[e]},e.prototype.has=function(e,t,i){return-1!==$l(this._listeners,(function(n){return!0!==n.once&&n.type===e&&(null==t||n.callback===t)&&n.context===i}))},e.prototype._shouldDispatch=function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");var t=this._disabled[e];return ll(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled},e.prototype._eachListener=function(e){var t=this;++this._iterating;try{Nl(this._listeners,e)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(Nl(this._killed,(function(e){t._removeListener(e)})),this._killed.length=0)}},e.prototype.dispatchImmediately=function(e,t){this._shouldDispatch(e)&&this._eachListener((function(i){i.killed||null!==i.type&&i.type!==e||i.dispatch(e,t)}))},e.prototype.dispatch=function(e,t){this._shouldDispatch(e)&&this._eachListener((function(i){var n;i.killed||null!==i.type&&i.type!==e||(n=function(){i.killed||i.dispatch(e,t)},lu.push(n))}))},e.prototype._on=function(e,t,i,n,r,a){var o=this;if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,n);var s={type:t,callback:i,context:n,shouldClone:r,dispatch:a,killed:!1,once:e,disposer:new eu((function(){s.killed=!0,o._removeListener(s)}))};return this._listeners.push(s),s},e.prototype.onAll=function(e,t,i){return void 0===i&&(i=!0),this._on(!1,null,e,t,i,(function(i,n){return e.call(t,i,n)})).disposer},e.prototype.on=function(e,t,i,n){return void 0===n&&(n=!0),this._on(!1,e,t,i,n,(function(e,n){return t.call(i,n)})).disposer},e.prototype.once=function(e,t,i,n){void 0===n&&(n=!0);var r=this._on(!0,e,t,i,n,(function(e,n){r.disposer.dispose(),t.call(i,n)}));return r.disposer},e.prototype.off=function(e,t,i){this._removeExistingListener(!1,e,t,i)},e.prototype.copyFrom=function(e){var t=this;if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");Nl(e._listeners,(function(e){!e.killed&&e.shouldClone&&(null===e.type?t.onAll(e.callback,e.context):e.once?t.once(e.type,e.callback,e.context):t.on(e.type,e.callback,e.context))}))},e}(),fu=function(e){function t(t){var i=e.call(this)||this;return i.target=t,i}return Us(t,e),t.prototype.copyFrom=function(e){var t=this;if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");Nl(e._listeners,(function(i){i.context!==e.target&&!i.killed&&i.shouldClone&&(null===i.type?t.onAll(i.callback,i.context):i.once?t.once(i.type,i.callback,i.context):t.on(i.type,i.callback,i.context))}))},t}(du);function mu(e){var t=[];for(var i in e)vu(e,i)&&t.push(i);return t}function vu(e,t){return{}.hasOwnProperty.call(e,t)}function yu(e,t){for(var i in e)if(vu(e,i)&&!t(i,e[i]))break}function gu(e,t){yu(e,(function(e,i){return t(e,i),!0}))}function _u(e,t,i){Nl(function(e,t){return mu(e).sort(t)}(e,i),(function(i){t(i,e[i])}))}function bu(e,t){return Object.assign({},e,t)}function xu(e,t,i){Nl(i,(function(i){nl(e[i])&&(t[i]=e[i])}))}function wu(e,t){xu(e,t,mu(e))}function ku(e){return function(t){for(var i=e.length,n=0;n<i&&t(e[n]);++n);}}function Pu(e){var t=[];return e((function(e){return t.push(e),!0})),t}function Su(e,t){e(t)}function Tu(e,t){e((function(e){return t(e),!0}))}function Eu(e,t){return function(i){return e((function(e){return i(t(e))}))}}function Cu(e){return function(t){var i=0;e((function(e){return t([i++,e])}))}}function Mu(e,t){var i;return e((function(e){return!t(e)||(i=e,!1)})),i}function Iu(e,t){var i=!1;return e((function(e){return!t(e)||(i=!0,!1)})),i}var Ou=function(){function e(e,t){this.createNewItems=!1,this.list=e,this._create=t,this.reset()}return e.prototype.reset=function(){this._listCopy=Pu(this.list.iterator())},e.prototype.clear=function(){this._listCopy.length=0},e.prototype.getFirst=function(){return this.returnItem(0)},e.prototype.getLast=function(){return this.returnItem(this._listCopy.length-1)},e.prototype.find=function(e){var t=$l(this._listCopy,e);if(-1!==t){var i=this._listCopy[t];return Gl(this._listCopy,i),i}return this.getLast()},e.prototype.removeItem=function(e){return Gl(this._listCopy,e)},e.prototype.returnItem=function(e){if(e>=0&&e<this._listCopy.length){var t=this._listCopy[e];return Gl(this._listCopy,t),t}if(this.createNewItems)return this._create()},e.prototype.iterator=function(){return ku(this._listCopy)},e}();function Du(e,t){return new Array(t+1).join(e)}var Au=function(e){function t(t){var i=t.events.on("removed",(function(e){e.oldValue.dispose()}),void 0,!1);return e.call(this,(function(){i.dispose(),Tu(t.iterator(),(function(e){e[1].dispose()}))}))||this}return Us(t,e),t}(eu),Lu=function(){function e(){this.events=new du,this._dictionary={}}return e.prototype.hasKey=function(e){return vu(this._dictionary,e)},e.prototype.getKey=function(e){return this._dictionary[e]},e.prototype.insertKey=function(e,t){if(vu(this._dictionary,e))throw new Error("Key "+e+" already exists in dictionary");this._dictionary[e]=t,this.events.isEnabled("insertKey")&&this.events.dispatchImmediately("insertKey",{type:"insertKey",target:this,key:e,newValue:t})},e.prototype.setKey=function(e,t){if(vu(this._dictionary,e)){var i=this._dictionary[e];i!==t&&(this._dictionary[e]=t,this.events.isEnabled("setKey")&&this.events.dispatchImmediately("setKey",{type:"setKey",target:this,key:e,oldValue:i,newValue:t}),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,oldValue:i}))}else this._dictionary[e]=t,this.events.isEnabled("insertKey")&&this.events.dispatchImmediately("insertKey",{type:"insertKey",target:this,key:e,newValue:t})},e.prototype.updateKey=function(e,t){if(!vu(this._dictionary,e))throw new Error("Key "+e+" doesn't exist in dictionary");var i=this._dictionary[e],n=t(i);i!==n&&(this._dictionary[e]=n,this.events.isEnabled("setKey")&&this.events.dispatchImmediately("setKey",{type:"setKey",target:this,key:e,oldValue:i,newValue:n}),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,oldValue:i}))},e.prototype.removeKey=function(e){if(vu(this._dictionary,e)){var t=this._dictionary[e];delete this._dictionary[e],this.events.isEnabled("removeKey")&&this.events.dispatchImmediately("removeKey",{type:"removeKey",target:this,key:e,oldValue:t}),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,oldValue:t})}},e.prototype.insertKeyIfEmpty=function(e,t){return this.hasKey(e)||this.insertKey(e,t()),this.getKey(e)},e.prototype.clear=function(){var e=this;this.events.isEnabled("removed")&&gu(this._dictionary,(function(t,i){e.events.dispatchImmediately("removed",{type:"removed",target:e,oldValue:i})})),this._dictionary={},this.events.isEnabled("cleared")&&this.events.dispatchImmediately("cleared",{type:"cleared",target:this})},e.prototype.copyFrom=function(e){var t=this;Tu(e.iterator(),(function(e){t.setKey(e[0],e[1])}))},e.prototype.iterator=function(){return function(e){return function(t){for(var i in e)if(vu(e,i)&&!t([i,e[i]]))break}}(this._dictionary)},e.prototype[Symbol.iterator]=function(){var e,t,i,n;return Ws(this,(function(r){switch(r.label){case 0:for(t in e=[],this._dictionary)e.push(t);i=0,r.label=1;case 1:return i<e.length?(n=e[i],vu(this._dictionary,n)?[4,[n,this._dictionary[n]]]:[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return i++,[3,1];case 4:return[2]}}))},e.prototype.each=function(e){Tu(this.iterator(),(function(t){var i=Zs(t,2),n=i[0],r=i[1];return e(n,r)}))},e.prototype.sortedIterator=function(){return e=this.iterator(),t=function(e,t){return i=e[0],n=t[0],i===n?0:i<n?-1:1;var i,n},ku(Pu(e).sort(t));var e,t},e}(),zu=function(e){function t(t){var i=e.call(this)||this;return i.template=t,i}return Us(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},set:function(e){e.isTemplate=!0,this._template=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(e){var t=this;Tu(e.iterator(),(function(e){t.setKey(e[0],e[1].clone())}))},t.prototype.create=function(e){var t=this;return this.insertKeyIfEmpty(e,(function(){return t.template.clone()}))},t}(Lu),Ru=function(){function e(){this._storage=new Lu,this.ttl=1e3}return e.prototype.set=function(e,t,i,n){var r=this._storage.insertKeyIfEmpty(e,(function(){return new Lu})),a={touched:(new Date).getTime(),ttl:ll(n)?n:this.ttl,value:i};r.setKey(t,a)},e.prototype.get=function(e,t,i){if(void 0===i&&(i=void 0),this._storage.hasKey(e)){var n=this._storage.getKey(e);if(n.hasKey(t)){var r=n.getKey(t);return r.ttl&&r.touched+r.ttl<(new Date).getTime()&&(r.expired=!0),r.expired?(n.removeKey(t),i):r.value}return i}return i},e.prototype.clear=function(e){e?this._storage.removeKey(e):this._storage.clear()},e}(),Fu=new Ru,ju=function(){function e(){var e=this;this.events=new du,this.themes=[],this.loadedThemes={},this._uidCount=0,this.registeredClasses={},this._placeholders={},this.invalidSprites={},this.invalidDatas={},this.invalidRawDatas=[],this.invalidDataItems=[],this.invalidDataRange=[],this.invalidPositions={},this.invalidLayouts={},this.baseSprites=[],this.baseSpritesByUid={},this.queue=[],this.deferred=[],this.uid=this.getUniqueId(),this.invalidSprites.noBase=[],this.invalidDatas.noBase=[],this.invalidLayouts.noBase=[],this.invalidPositions.noBase=[],"undefined"!==typeof addEventListener&&(addEventListener("beforeprint",(function(){Nl(e.baseSprites,(function(e){var t=e.paper.svg;t.setAttribute("viewBox","0 0 "+t.clientWidth+" "+t.clientHeight)}))})),addEventListener("afterprint",(function(){Nl(e.baseSprites,(function(e){e.paper.svg.removeAttribute("viewBox")}))})))}return e.prototype.getUniqueId=function(){var e=this._uidCount;return this._uidCount+=1,"id-"+e},Object.defineProperty(e.prototype,"map",{get:function(){return this._map||(this._map=new Lu),this._map},enumerable:!0,configurable:!0}),e.prototype.setCache=function(e,t,i){Fu.set(this.uid,e,t,i)},e.prototype.getCache=function(e,t){return void 0===t&&(t=void 0),Fu.get(this.uid,e,t)},e.prototype.dispatch=function(e,t){this.events.isEnabled(e)&&(t?(t.type=e,t.target=t.target||this,this.events.dispatch(e,{type:e,target:this})):this.events.dispatch(e,{type:e,target:this}))},e.prototype.dispatchImmediately=function(e,t){this.events.isEnabled(e)&&(t?(t.type=e,t.target=t.target||this,this.events.dispatchImmediately(e,t)):this.events.dispatchImmediately(e,{type:e,target:this}))},e.prototype.getPlaceholder=function(e){return nl(this._placeholders[e])||(this._placeholders[e]="__amcharts_"+e+"_"+function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}(8)+"__"),this._placeholders[e]},e.prototype.addToInvalidComponents=function(e){e.baseId?Wl(this.invalidDatas[e.baseId],e):Wl(this.invalidDatas.noBase,e)},e.prototype.removeFromInvalidComponents=function(e){e.baseId&&Gl(this.invalidDatas[e.baseId],e),Gl(this.invalidDatas.noBase,e)},e.prototype.addToInvalidSprites=function(e){e.baseId?Hl(this.invalidSprites[e.baseId],e):Hl(this.invalidSprites.noBase,e)},e.prototype.removeFromInvalidSprites=function(e){e.baseId&&Gl(this.invalidSprites[e.baseId],e),Gl(this.invalidSprites.noBase,e)},e.prototype.addToInvalidPositions=function(e){e.baseId?Hl(this.invalidPositions[e.baseId],e):Hl(this.invalidPositions.noBase,e)},e.prototype.removeFromInvalidPositions=function(e){e.baseId&&Gl(this.invalidPositions[e.baseId],e),Gl(this.invalidPositions.noBase,e)},e.prototype.addToInvalidLayouts=function(e){e.baseId?Hl(this.invalidLayouts[e.baseId],e):Hl(this.invalidLayouts.noBase,e)},e.prototype.removeFromInvalidLayouts=function(e){e.baseId&&Gl(this.invalidLayouts[e.baseId],e),Gl(this.invalidLayouts.noBase,e)},e}(),Bu=new ju;function Vu(e,t){var i=Bu.registeredClasses[t];return null!=i&&e instanceof i}var Nu=function(){function e(e,t,i){this._array=e,this._start=t,this._end=i}return e.prototype.iterator=function(){var e=this;return function(t){if(e._start!==e._end)if(e._start<e._end)for(var i=e._start;i<e._end&&t(e._array[i]);++i);else for(i=e._start-1;i>=e._end&&t(e._array[i]);--i);}},e.prototype.backwards=function(){return new e(this._array,this._end,this._start)},e.prototype.range=function(t,i){if(t<=i){if(this._start===this._end)return this;if(this._start<this._end){var n=i-t;return t=Math.max(this._start+t,this._start),i=Math.min(t+n,this._end),new e(this._array,t,i)}n=i-t;return t=Math.max(this._start-t,this._end),i=Math.max(t-n,this._end),new e(this._array,t,i)}throw new Error("Start index must be lower than end index")},e}(),Uu=(function(e){function t(t,i,n){var r=e.call(this,[t.events.on("inserted",(function(e){var i=e.newValue,n=r._getKey(i),a=0;Su(t.iterator(),(function(e){return e!==i&&(r._getKey(e)===n&&++a,!0)})),r._insert(i,n,a)}),void 0,!1),t.events.on("removed",(function(e){r._remove(e.oldValue)}),void 0,!1)])||this;return r._keys=[],r._groups={},r._getKey=i,r._sort=n,Tu(t.iterator(),(function(e){r._insert(e,i(e))})),r}Us(t,e),t.prototype._insert=function(e,t,i){if(null==this._groups[t]){this._groups[t]=[];var n=Yl(this._keys,this._sort,t),r=n.found,a=n.index;if(r)throw new Error("Key already exists: "+t);Xl(this._keys,a,t)}null==i?this._groups[t].push(e):Xl(this._groups[t],i,e)},t.prototype._remove=function(e){var t=this._getKey(e),i=this._groups[t];if(null!=i&&(Gl(i,e),0===i.length)){delete this._groups[t];var n=Yl(this._keys,this._sort,t),r=n.found,a=n.index;if(!r)throw new Error("Key doesn't exist: "+t);Kl(this._keys,a)}},t.prototype.iterator=function(){var e,t=this;return e=Eu(ku(this._keys),(function(e){return ku(t._groups[e])})),function(t){var i=!0,n=function(e){return i=t(e)};e((function(e){return e(n),i}))}}}(tu),function(e){function t(t,i){void 0===i&&(i=!0);var n=this;if(i){var r=t.events.on("removed",(function(e){e.oldValue.dispose()}),void 0,!1);n=e.call(this,(function(){r.dispose(),Tu(t.iterator(),(function(e){e.dispose()}))}))||this}else n=e.call(this,(function(){Tu(t.iterator(),(function(e){e.dispose()}))}))||this;return n}return Us(t,e),t}(eu));function Gu(e,t){if(!(e>=0&&e<t))throw new Error("Index out of bounds: "+e)}var Wu=function(){function e(e){void 0===e&&(e=[]),this.events=new du,this._values=e}return Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return-1!==this._values.indexOf(e)},e.prototype.removeValue=function(e){for(var t=0,i=this._values.length;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t},e.prototype.indexOf=function(e){return jl(this._values,e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),e.prototype.hasIndex=function(e){return e>=0&&e<this._values.length},e.prototype.getIndex=function(e){return this._values[e]},e.prototype.setIndex=function(e,t){Gu(e,this._values.length);var i=this._values[e];return i!==t&&(this._values[e]=t,this.events.isEnabled("setIndex")&&this.events.dispatchImmediately("setIndex",{type:"setIndex",target:this,index:e,oldValue:i,newValue:t}),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,oldValue:i}),this.events.isEnabled("inserted")&&this.events.dispatchImmediately("inserted",{type:"inserted",target:this,newValue:t})),i},e.prototype.insertIndex=function(e,t){Gu(e,this._values.length+1),Xl(this._values,e,t),this.events.isEnabled("insertIndex")&&this.events.dispatchImmediately("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t}),this.events.isEnabled("inserted")&&this.events.dispatchImmediately("inserted",{type:"inserted",target:this,newValue:t})},e.prototype._sortQuicksort=function(e,t,i){if(e<t){var n=this._sortPartition(e,t,i);this._sortQuicksort(e,n,i),this._sortQuicksort(n+1,t,i)}},e.prototype._sortPartition=function(e,t,i){for(var n=this._values,r=n[e],a=e-1,o=t+1;;){do{++a}while(i(n[a],r)<0);do{--o}while(i(n[o],r)>0);if(a>=o)return o;this.swap(a,o)}},e.prototype.sort=function(e){this._sortQuicksort(0,this._values.length-1,e)},e.prototype.swap=function(e,t){var i=this._values.length;if(Gu(e,i),Gu(t,i),e!==t){var n=this._values[e],r=this._values[t];this._values[e]=r,this.events.isEnabled("setIndex")&&this.events.dispatchImmediately("setIndex",{type:"setIndex",target:this,index:e,oldValue:n,newValue:r}),this._values[t]=n,this.events.isEnabled("setIndex")&&this.events.dispatchImmediately("setIndex",{type:"setIndex",target:this,index:t,oldValue:r,newValue:n})}},e.prototype.removeIndex=function(e){Gu(e,this._values.length);var t=this._values[e];return Kl(this._values,e),this.events.isEnabled("removeIndex")&&this.events.dispatchImmediately("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t}),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,oldValue:t}),t},e.prototype.moveValue=function(e,t){var i=this.indexOf(e);if(-1!==i){var n=this._values[i];Kl(this._values,i),this.events.isEnabled("removeIndex")&&this.events.dispatchImmediately("removeIndex",{type:"removeIndex",target:this,index:i,oldValue:n})}null==t?(t=this._values.length,this._values.push(e)):Xl(this._values,t,e),this.events.isEnabled("insertIndex")&&this.events.dispatchImmediately("insertIndex",{type:"insertIndex",target:this,index:t,newValue:e}),-1===i&&this.events.isEnabled("inserted")&&this.events.dispatchImmediately("inserted",{type:"inserted",target:this,newValue:e})},e.prototype.push=function(e){var t=this._values.push(e)-1;return this.events.isEnabled("insertIndex")&&this.events.dispatchImmediately("insertIndex",{type:"insertIndex",target:this,index:t,newValue:e}),this.events.isEnabled("inserted")&&this.events.dispatchImmediately("inserted",{type:"inserted",target:this,newValue:e}),e},e.prototype.unshift=function(e){this.insertIndex(0,e)},e.prototype.pushAll=function(e){var t=this;Nl(e,(function(e){t.push(e)}))},e.prototype.copyFrom=function(e){this.pushAll(e._values)},e.prototype.pop=function(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)},e.prototype.shift=function(){return this._values.length?this.removeIndex(0):void 0},e.prototype.setAll=function(e){var t=this,i=ql(this._values);this._values.length=0,Nl(e,(function(e){t._values.push(e)})),this.events.isEnabled("setAll")&&this.events.dispatchImmediately("setAll",{type:"setAll",target:this,oldArray:i,newArray:this._values}),this.events.isEnabled("removed")&&Nl(i,(function(e){t.events.dispatchImmediately("removed",{type:"removed",target:t,oldValue:e})})),this.events.isEnabled("inserted")&&Nl(this._values,(function(e){t.events.dispatchImmediately("inserted",{type:"inserted",target:t,newValue:e})}))},e.prototype.clear=function(){this.setAll([])},e.prototype.iterator=function(){return ku(this._values)},e.prototype[Symbol.iterator]=function(){var e,t;return Ws(this,(function(i){switch(i.label){case 0:e=this._values.length,t=0,i.label=1;case 1:return t<e?[4,this._values[t]]:[3,4];case 2:i.sent(),i.label=3;case 3:return++t,[3,1];case 4:return[2]}}))},e.prototype.each=function(e){Nl(this._values,e)},e.prototype.range=function(e,t){if(e<=t){var i=t-e;return e=Math.max(e,0),t=Math.min(e+i,this._values.length),new Nu(this._values,e,t)}throw new Error("Start index must be lower than end index")},e.prototype.backwards=function(){return new Nu(this._values,this._values.length,0)},e}(),Hu=function(e){function t(t){var i=e.call(this)||this;return i.template=t,i}return Us(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},set:function(e){e.isTemplate=!0,this._template=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(e){var t=this;Tu(e.iterator(),(function(e){t.push(e.clone())}))},t.prototype.create=function(e){var t=null!=e?new e:this.template.clone();return this.push(t),t},t.prototype.clone=function(){for(var e=new t(this.template),i=this.values,n=i.length,r=0;r<n;++r)e.push(i[r].clone());return e},t}(Wu),Zu=function(){function e(e){this._values=[],this.events=new du,null!=e&&this.setAll(e)}return Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),e.prototype._insert=function(e){return this._values.push(e),this._values.length-1},Object.defineProperty(e.prototype,"length",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return jl(this._values,e)},e.prototype.contains=function(e){return-1!==this.indexOf(e)},e.prototype.getIndex=function(e){return this._values[e]},Object.defineProperty(e.prototype,"first",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this._values[this._values.length-1]},enumerable:!0,configurable:!0}),e.prototype.insert=function(e){var t=this._insert(e);this.events.isEnabled("inserted")&&this.events.dispatchImmediately("inserted",{type:"inserted",target:this,index:t,newValue:e})},e.prototype.remove=function(e){var t=this.indexOf(e);if(-1!==t){var i=this._values[t];Kl(this._values,t),this.events.isEnabled("removed")&&this.events.dispatchImmediately("removed",{type:"removed",target:this,index:t,oldValue:i})}},e.prototype.setAll=function(e){var t=this;!function(e,t){for(var i=e.length;i--;)t(e[i],i)}(this._values,(function(e,i){t._values.pop(),t.events.isEnabled("removed")&&t.events.dispatchImmediately("removed",{type:"removed",target:t,index:i,oldValue:e})})),Nl(e,(function(e){t.insert(e)}))},e.prototype.clear=function(){this.setAll([])},e.prototype.slice=function(t,i){var n=new e;return n._values=this._values.slice(t,i),n},e.prototype.findClosestIndex=function(e,t,i){void 0===i&&(i="any");var n,r,a=-1,o=0;return Su(this.iterator(),(function(s){var l=t(s);if("any"===i){if(l===e)return a=o,!1;var u=Math.abs(e-l);(!nl(r)||r>u)&&(a=o,n=l,r=u)}else"left"===i&&l<e?(!nl(n)||n<l)&&(a=o,n=l):"right"===i&&l>=e&&(!nl(n)||n>=l)&&(a=o,n=l);return++o,!0})),-1===a&&("left"===i?a=0:"right"===i&&(a=this.length-1)),a},e.prototype.iterator=function(){return ku(this._values)},e.prototype[Symbol.iterator]=function(){var e,t;return Ws(this,(function(i){switch(i.label){case 0:e=this._values.length,t=0,i.label=1;case 1:return t<e?[4,this._values[t]]:[3,4];case 2:i.sent(),i.label=3;case 3:return++t,[3,1];case 4:return[2]}}))},e.prototype.each=function(e){Nl(this._values,e)},e}(),qu=function(e){function t(t){var i=e.call(this)||this;return i._ordering=t,i}return Us(t,e),t.prototype._insert=function(e){var t=Yl(this._values,this._ordering,e).index;return Xl(this._values,t,e),t},t.prototype.indexOf=function(e){var t=Yl(this._values,this._ordering,e),i=t.found,n=t.index;return i?n:-1},t.prototype.update=function(e){var t=jl(this._values,e);if(-1!==t){var i=this._values.length-1;(0===t||this._ordering(this._values[t-1],e)<0)&&(t===i||this._ordering(e,this._values[t+1])<0)||(Kl(this._values,t),this._insert(e))}},t}(Zu),Xu=function(e){function t(t){var i=e.call(this)||this;return i.template=t,i}return Us(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},set:function(e){e.isTemplate=!0,this._template=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(e){var t=this;Tu(e.iterator(),(function(e){t.insert(e.clone())}))},t.prototype.slice=function(e,i){var n=new t(this.template);return n._values=this._values.slice(e,i),n},t.prototype.create=function(e){var t=null!=e?new e:this.template.clone();return this.insert(t),t},t}(Zu),Ku=function(e){function t(t,i){var n=e.call(this,i)||this;return n.template=t,n}return Us(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},set:function(e){e.isTemplate=!0,this._template=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(e){var t=this;Tu(e.iterator(),(function(e){t.insert(e.clone())}))},t.prototype.create=function(e){var t=null!=e?new e:this.template.clone();return this.insert(t),t},t}(qu);function Yu(e,t){return e===t?0:e<t?-1:1}function $u(e,t){return 0===e?t:e}var Ju=function(){function e(){this._callbackId=0,this._callbacks=new qu((function(e,t){return $u(Yu(e.priority,t.priority),Yu(e.id,t.id))}))}return e.prototype.addAll=function(e,t,i,n,r){void 0===n&&(n=0),this._callbacks.insert({id:++this._callbackId,key:t,callback:i,priority:n,scope:r,type:e})},e.prototype.isEnabled=function(e,t){return Bl(this._callbacks.values,(function(i){return i.key===t&&e instanceof i.type}))},e.prototype.applyAll=function(e,t,i){var n=this._callbacks.values,r=n.length;if(0==r)return i;for(var a=0;a<r;++a){var o=n[a];o.key===t&&e instanceof o.type&&(i=o.callback.call(o.scope,i,e,t))}return i},e}(),Qu=new Ju,ec=function(){function e(e){this._callbackId=0,this._callbacks=new qu((function(e,t){return $u(Yu(e.priority,t.priority),Yu(e.id,t.id))})),this._disabled={},this.object=e,this.events=this._callbacks.events}return e.prototype.add=function(e,t,i,n){void 0===i&&(i=0),this._callbacks.insert({id:++this._callbackId,key:e,callback:t,priority:i,scope:n})},e.prototype.has=function(e,t,i,n){return void 0===i&&(i=0),Iu(this._callbacks.iterator(),(function(r){return r.key===e&&r.callback===t&&r.priority===i&&r.scope===n}))},e.prototype.remove=function(e,t){var i=this;Nl(Pu(this._callbacks.iterator()),(function(n){n.key!==e||ll(t)&&t!==n.priority||i._callbacks.remove(n)}))},e.prototype.enableKey=function(e){delete this._disabled[e]},e.prototype.disableKey=function(e,t){void 0===t&&(t=1/0),this._disabled[e]=t},e.prototype._hasListenersByType=function(e){return Bl(this._callbacks.values,(function(t){return t.key===e}))},e.prototype.isEnabled=function(e){return null==this._disabled[e]&&(this._hasListenersByType(e)||Qu.isEnabled(this.object,e))},e.prototype._shouldDispatch=function(e){var t=this._disabled[e];return!ll(t)||(t<=1?delete this._disabled[e]:--this._disabled[e],!1)},e.prototype.apply=function(e,t){if(this._shouldDispatch(e)){var i=this._callbacks.values,n=i.length;if(n>0)for(var r=0;r<n;++r){var a=i[r];a.key===e&&(t=a.callback.call(a.scope,t,this.object,e))}return t=Qu.applyAll(this.object,e,t)}return t},e.prototype.keys=function(){return Pu(Eu(this._callbacks.iterator(),(function(e){return e.key})))},e.prototype.copyFrom=function(e){var t=this;Tu(e._callbacks.iterator(),(function(e){t.add(e.key,e.callback,e.priority,e.scope)})),gu(e._disabled,(function(e,i){t._disabled[e]=i}))},e.prototype.clear=function(){this._callbacks.clear()},e}(),tc={aliceblue:{r:240,g:248,b:255},antiquewhite:{r:250,g:235,b:215},aqua:{r:0,g:255,b:255},aquamarine:{r:127,g:255,b:212},azure:{r:240,g:255,b:255},beige:{r:245,g:245,b:220},bisque:{r:255,g:228,b:196},black:{r:0,g:0,b:0},blanchedalmond:{r:255,g:235,b:205},blue:{r:0,g:0,b:255},blueviolet:{r:138,g:43,b:226},brown:{r:165,g:42,b:42},burlywood:{r:222,g:184,b:135},cadetblue:{r:95,g:158,b:160},chartreuse:{r:127,g:255,b:0},chocolate:{r:210,g:105,b:30},coral:{r:255,g:127,b:80},cornflowerblue:{r:100,g:149,b:237},cornsilk:{r:255,g:248,b:220},crimson:{r:220,g:20,b:60},cyan:{r:0,g:255,b:255},darkblue:{r:0,g:0,b:139},darkcyan:{r:0,g:139,b:139},darkgoldenrod:{r:184,g:134,b:11},darkgray:{r:169,g:169,b:169},darkgrey:{r:169,g:169,b:169},darkgreen:{r:0,g:100,b:0},darkkhaki:{r:189,g:183,b:107},darkmagenta:{r:139,g:0,b:139},darkolivegreen:{r:85,g:107,b:47},darkorange:{r:255,g:140,b:0},darkorchid:{r:153,g:50,b:204},darkred:{r:139,g:0,b:0},darksalmon:{r:233,g:150,b:122},darkseagreen:{r:143,g:188,b:143},darkslateblue:{r:72,g:61,b:139},darkslategray:{r:47,g:79,b:79},darkslategrey:{r:47,g:79,b:79},darkturquoise:{r:0,g:206,b:209},darkviolet:{r:148,g:0,b:211},deeppink:{r:255,g:20,b:147},deepskyblue:{r:0,g:191,b:255},dimgray:{r:105,g:105,b:105},dimgrey:{r:105,g:105,b:105},dodgerblue:{r:30,g:144,b:255},firebrick:{r:178,g:34,b:34},floralwhite:{r:255,g:250,b:240},forestgreen:{r:34,g:139,b:34},fuchsia:{r:255,g:0,b:255},gainsboro:{r:220,g:220,b:220},ghostwhite:{r:248,g:248,b:255},gold:{r:255,g:215,b:0},goldenrod:{r:218,g:165,b:32},gray:{r:128,g:128,b:128},grey:{r:128,g:128,b:128},green:{r:0,g:128,b:0},greenyellow:{r:173,g:255,b:47},honeydew:{r:240,g:255,b:240},hotpink:{r:255,g:105,b:180},indianred:{r:205,g:92,b:92},indigo:{r:75,g:0,b:130},ivory:{r:255,g:255,b:240},khaki:{r:240,g:230,b:140},lavender:{r:230,g:230,b:250},lavenderblush:{r:255,g:240,b:245},lawngreen:{r:124,g:252,b:0},lemonchiffon:{r:255,g:250,b:205},lightblue:{r:173,g:216,b:230},lightcoral:{r:240,g:128,b:128},lightcyan:{r:224,g:255,b:255},lightgoldenrodyellow:{r:250,g:250,b:210},lightgray:{r:211,g:211,b:211},lightgrey:{r:211,g:211,b:211},lightgreen:{r:144,g:238,b:144},lightpink:{r:255,g:182,b:193},lightsalmon:{r:255,g:160,b:122},lightseagreen:{r:32,g:178,b:170},lightskyblue:{r:135,g:206,b:250},lightslategray:{r:119,g:136,b:153},lightslategrey:{r:119,g:136,b:153},lightsteelblue:{r:176,g:196,b:222},lightyellow:{r:255,g:255,b:224},lime:{r:0,g:255,b:0},limegreen:{r:50,g:205,b:50},linen:{r:250,g:240,b:230},magenta:{r:255,g:0,b:255},maroon:{r:128,g:0,b:0},mediumaquamarine:{r:102,g:205,b:170},mediumblue:{r:0,g:0,b:205},mediumorchid:{r:186,g:85,b:211},mediumpurple:{r:147,g:112,b:219},mediumseagreen:{r:60,g:179,b:113},mediumslateblue:{r:123,g:104,b:238},mediumspringgreen:{r:0,g:250,b:154},mediumturquoise:{r:72,g:209,b:204},mediumvioletred:{r:199,g:21,b:133},midnightblue:{r:25,g:25,b:112},mintcream:{r:245,g:255,b:250},mistyrose:{r:255,g:228,b:225},moccasin:{r:255,g:228,b:181},navajowhite:{r:255,g:222,b:173},navy:{r:0,g:0,b:128},oldlace:{r:253,g:245,b:230},olive:{r:128,g:128,b:0},olivedrab:{r:107,g:142,b:35},orange:{r:255,g:165,b:0},orangered:{r:255,g:69,b:0},orchid:{r:218,g:112,b:214},palegoldenrod:{r:238,g:232,b:170},palegreen:{r:152,g:251,b:152},paleturquoise:{r:175,g:238,b:238},palevioletred:{r:219,g:112,b:147},papayawhip:{r:255,g:239,b:213},peachpuff:{r:255,g:218,b:185},peru:{r:205,g:133,b:63},pink:{r:255,g:192,b:203},plum:{r:221,g:160,b:221},powderblue:{r:176,g:224,b:230},purple:{r:128,g:0,b:128},rebeccapurple:{r:102,g:51,b:153},red:{r:255,g:0,b:0},rosybrown:{r:188,g:143,b:143},royalblue:{r:65,g:105,b:225},saddlebrown:{r:139,g:69,b:19},salmon:{r:250,g:128,b:114},sandybrown:{r:244,g:164,b:96},seagreen:{r:46,g:139,b:87},seashell:{r:255,g:245,b:238},sienna:{r:160,g:82,b:45},silver:{r:192,g:192,b:192},skyblue:{r:135,g:206,b:235},slateblue:{r:106,g:90,b:205},slategray:{r:112,g:128,b:144},slategrey:{r:112,g:128,b:144},snow:{r:255,g:250,b:250},springgreen:{r:0,g:255,b:127},steelblue:{r:70,g:130,b:180},tan:{r:210,g:180,b:140},teal:{r:0,g:128,b:128},thistle:{r:216,g:191,b:216},tomato:{r:255,g:99,b:71},turquoise:{r:64,g:224,b:208},violet:{r:238,g:130,b:238},wheat:{r:245,g:222,b:179},white:{r:255,g:255,b:255},whitesmoke:{r:245,g:245,b:245},yellow:{r:255,g:255,b:0},yellowgreen:{r:154,g:205,b:50}};function ic(e,t){var i;return tc[e]?i=tc[e]:"#"===e.charAt(0)?i=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(function(e,t,i,n){return t+t+i+i+n+n}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(function(e,t,i,n,r){return t+t+i+i+n+n+r+r}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16),a:parseInt(i[4],16)/256}:void 0}(e)}(e):e.match(/^rgba?\(/)&&(i=function(e){var t=(e=e.replace(/[ ]/g,"")).match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(t)t.push("1");else if(!(t=e.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i)))return;return{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:parseFloat(t[4])}}(e)),i||(i={r:0,g:0,b:0,a:1}),nl(t)&&(i.a=t),i}function nc(e){return 1==e.length?"0"+e:""+e}function rc(e,t,i){return i=gl(i,0,1),e?t?{r:e.r+Math.round((t.r-e.r)*i),g:e.g+Math.round((t.g-e.g)*i),b:e.b+Math.round((t.b-e.b)*i),a:(e.a||1)+Math.round(((t.a||1)-(e.a||1))*i)}:e:t||e}function ac(e,t){var i=t>0?255-e:e;return Math.round(i*t)}function oc(e){var t,i,n,r=e.h,a=e.s,o=e.l;if(0==a)t=i=n=o;else{var s=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},l=o<.5?o*(1+a):o+a-o*a,u=2*o-l;t=s(u,l,r+1/3),i=s(u,l,r),n=s(u,l,r-1/3)}return{r:Math.round(255*t),g:Math.round(255*i),b:Math.round(255*n)}}function sc(e){var t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),a=Math.min(t,i,n),o=0,s=0,l=(r+a)/2;if(r===a)o=s=0;else{var u=r-a;switch(s=l>.5?u/(2-r-a):u/(r+a),r){case t:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-t)/u+2;break;case n:o=(t-i)/u+4}o/=6}return{h:o,s:s,l:l}}var lc=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"rgb",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hex",{get:function(){return this._value?"#"+nc((e=this._value).r.toString(16))+nc(e.g.toString(16))+nc(e.b.toString(16)):"none";var e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgba",{get:function(){return this._value?nl((e=this._value).a)&&1!==e.a?"rgba("+e.r+","+e.g+","+e.b+","+e.a+")":"rgb("+e.r+","+e.g+","+e.b+")":"none";var e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return null!=this._value&&null!=this._value.a?this._value.a:1},set:function(e){this._value&&(this._value.a=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightColor",{get:function(){return this._lightColor||(this._lightColor=new e({r:255,g:255,b:255})),this._lightColor},set:function(e){this._lightColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"darkColor",{get:function(){return this._darkColor||(this._darkColor=new e({r:0,g:0,b:0})),this._darkColor},set:function(e){this._darkColor=e},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.alpha<1?this.rgba:this.hex},e.prototype.lighten=function(t){return new e(function(e,t){return e?{r:Math.max(0,Math.min(255,e.r+ac(e.r,t))),g:Math.max(0,Math.min(255,e.g+ac(e.g,t))),b:Math.max(0,Math.min(255,e.b+ac(e.b,t))),a:e.a}:e}(this.rgb,t))},e.prototype.brighten=function(t){return new e(function(e,t){if(e){var i=ac(Math.min(Math.max(e.r,e.g,e.b),230),t);return{r:Math.max(0,Math.min(255,Math.round(e.r+i))),g:Math.max(0,Math.min(255,Math.round(e.g+i))),b:Math.max(0,Math.min(255,Math.round(e.b+i))),a:e.a}}return e}(this.rgb,t))},e.prototype.saturate=function(t){return new e(function(e,t){if(null==e||1==t)return e;var i=sc(e);return i.s=t,oc(i)}(this.rgb,t))},Object.defineProperty(e.prototype,"alternative",{get:function(){if(null!=this.rgb)return function(e){return(299*e.r+587*e.g+114*e.b)/1e3>=128}(this.rgb)?this.darkColor:this.lightColor;throw new Error("Color does not exist")},enumerable:!0,configurable:!0}),e}();function uc(e,t){if(!nl(e))return new lc(void 0);if("string"==typeof e){var i="_color_"+e+"_"+(t||"1"),n=Bu.getCache(i);if(n)return new lc({r:n.r,g:n.g,b:n.b,a:n.a});var r=ic(e,t);return Bu.setCache(i,r),new lc(r)}return e instanceof lc?(nl(t)&&(e.alpha=t),e):new lc(e)}function cc(e){return nl(e)&&!function(e){return e instanceof lc}(e)?function(e){return uc(e)}(e):e}var hc=function(){function e(){this._disposed=!1,this._disposers=[],this.className="BaseObject"}return e.prototype.debug=function(){},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid||(this._uid=Bu.getUniqueId(),Bu.map.setKey(this._uid,this)),this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return this._map||(this._map=new Lu),this._map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delayedMap",{get:function(){return this._delayedMap||(this._delayedMap=new Lu),this._delayedMap},enumerable:!0,configurable:!0}),e.prototype.addDelayedMap=function(e,t){var i=this.delayedMap;i.hasKey(t)||i.setKey(t,[]),i.getKey(t).push({property:e,target:this})},e.prototype.processDelayedMap=function(){var e=this;this.delayedMap.each((function(t,i){if(e.map.hasKey(t)){var n=e.map.getKey(t);Nl(i,(function(e){e.target[e.property]=n})),e.delayedMap.removeKey(t)}}))},e.prototype.applyTheme=function(){var e=this;if(Bu){var t=this.getCurrentThemes();t&&Nl(t,(function(t,i){t(e)}))}},Object.defineProperty(e.prototype,"themes",{get:function(){return this._themes},set:function(e){this._themes=e},enumerable:!0,configurable:!0}),e.prototype.getCurrentThemes=function(){return this.themes||Bu.themes},e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;var e=this._disposers;for(this._disposers=null;0!==e.length;){e.shift().dispose()}this.clearCache(),this.clonedFrom&&this.clonedFrom.clones.removeValue(this);var t=this._uid;null!=t&&Bu.map.removeKey(t)}},e.prototype.addDisposer=function(e){this._disposers.push(e)},e.prototype.removeDispose=function(e){if(!this._disposed){var t=jl(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()},e.prototype.clone=function(e){e||(e="clone-"+Bu.getUniqueId());var t=new this.constructor;return t.cloneId=e,t.copyFrom(this),t},Object.defineProperty(e.prototype,"clones",{get:function(){return this._clones||(this._clones=new Wu),this._clones},enumerable:!0,configurable:!0}),e.prototype.copyFrom=function(e){e.clones.push(this),this.clonedFrom=e},Object.defineProperty(e.prototype,"className",{get:function(){return this._className},set:function(e){this._className=e},enumerable:!0,configurable:!0}),e.prototype.setCache=function(e,t,i){Fu.set(this.uid,e,t,i)},e.prototype.getCache=function(e,t){return void 0===t&&(t=void 0),Fu.get(this.uid,e,t)},e.prototype.clearCache=function(){Fu.clear(this.uid)},e.prototype.setTimeout=function(e,t){var i=this,n=setTimeout((function(){i.removeDispose(r),e()}),t),r=new eu((function(){clearTimeout(n)}));return this._disposers.push(r),r},e.prototype.setInterval=function(e,t){var i=this,n=setInterval((function(){i.removeDispose(r),e()}),t),r=new eu((function(){clearTimeout(n)}));return this._disposers.push(r),r},Object.defineProperty(e.prototype,"config",{set:function(e){try{this.processConfig(e)}catch(t){this.raiseCriticalError(t)}},enumerable:!0,configurable:!0}),e.prototype.processConfig=function(t){var i=this;if(t){var n=this;if(_u(t,(function(t,r){var a,o=r;if("callback"==t&&"function"==typeof r&&r.call(n),i.hasProperty(t))if(!ul(o)||!nl(o.type)||ul(n[t])&&nl(n[t].className)&&!o.forceCreate&&n[t].className==o.type||i.asIs(t)?a=n[t]:(a=i.createClassInstance(o.type))?n[t]=a:a=n[t],a instanceof ec)i.processAdapters(a,o);else if(a instanceof du)i.processEvents(a,o);else if("locale"==t&&sl(o))window["am4lang_"+o]&&(n[t]=window["am4lang_"+o]);else if("parent"==t&&sl(o)){var s=i.map.getKey(o);s?n[t]=s:i.addDelayedMap("parent",o)}else if(i.asIs(t))n[t]=o;else if(i.asFunction(t)&&sl(o)){if(!nl(Bu.registeredClasses[o]))throw Error("Invalid easing function: "+o);n[t]=Bu.registeredClasses[o]}else if(o instanceof e)n[t]=o;else if(a instanceof e)a.config=o;else if(a instanceof Hu||a instanceof Xu||a instanceof Ku){if(cl(o))a instanceof Hu?i.processListTemplate(o,a):i.processOrderedTemplate(o,a);else if(ul(o))if(o instanceof e)a.template=o;else{var l=void 0;l=nl(o.template)?o.template:o,a.template instanceof e?a.template.config=l:gu(l,(function(t,n){var r=a.template[t];r instanceof ec?i.processAdapters(r,n):r instanceof du?i.processEvents(r,n):r instanceof zu?i.processDictionaryTemplate(r,n):a.template[t]instanceof e?a.template[t].config=n:ul(n)&&nl(n.type)?(r=i.createClassInstance(n.type))?(r instanceof e&&(r.config=n),a.template[t]=r):a.template[t]=n:r instanceof Wu?i.processList(n,r):a.template[t]=i.maybeColorOrPercent(n)})),nl(o.values)&&(a instanceof Hu?i.processListTemplate(o.values,a):i.processOrderedTemplate(o.values,a))}}else a instanceof Wu?"children"==t?i.processList(o,a,i):i.processList(o,a):a instanceof zu?i.processDictionaryTemplate(a,o):a instanceof Lu?i.processDictionary(a,o):a instanceof lc||a instanceof Xs?n[t]=i.maybeColorOrPercent(o):ul(a)&&ul(o)?wu(o,a):(o=i.maybeColorOrPercent(o),n[t]=o);else i.isReserved(t)||(n[t]=o)}),this.configOrder),this.processingErrors.length){var r=this.processingErrors.join("\n");throw this._processingErrors=[],Error(r)}}},e.prototype.maybeColorOrPercent=function(e){if(sl(e)){if(e.match(/^[\-]?[0-9.]+\%$/))return Ks(el(e));if(e.match(/^\#[0-9abcdef]{3,}$/i))return uc(e)}return e},e.prototype.processAdapters=function(e,t){var i=this;cl(t)?Nl(t,(function(t,n){e.add(t.key,t.callback,t.priority||0,i)})):ul(t)&&gu(t,(function(t,i){e.has(t,i)||e.add(t,i)}))},e.prototype.processEvents=function(e,t){var i=this;cl(t)?Nl(t,(function(t,n){e.on(t.type,t.callback,i)})):ul(t)&&gu(t,(function(t,i){e.has(t,i)||e.on(t,i)}))},e.prototype.processDictionaryTemplate=function(t,i){ul(i)&&gu(i,(function(i,n){var r;(r="template"==i?t.template:t.hasKey(i)?t.getKey(i):t.create(i))instanceof e?r.config=n:ul(r)&&ul(n)?wu(n,r):r.setKey(i,n)}))},e.prototype.processDictionary=function(e,t){ul(t)&&gu(t,(function(t,i){e.setKey(t,i)}))},e.prototype.processListTemplate=function(t,i){var n=this;for(Nl(t,(function(t,r){var a,o=n.getConfigEntryType(t);if(i.hasIndex(r)&&!t.forceCreate)a=i.getIndex(r);else{if(t instanceof e)return void i.push(t);a=o?i.create(o):i.create()}t===a||ul(t)&&(a instanceof e?a.config=t:ul(a)&&ul(t)?wu(t,a):i.setIndex(i.indexOf(a),t))}));t.length>i.length;)i.pop()},e.prototype.processOrderedTemplate=function(t,i){var n=this;Nl(t,(function(t,r){var a,o=n.getConfigEntryType(t);a=o?i.create(o):i.create(),ul(t)&&(a instanceof e?a.config=t:ul(a)&&ul(t)?wu(t,a):i.insert(t))}))},e.prototype.processList=function(t,i,n){var r=this;cl(t)||(t=[t]);var a=i.length,o=0;for(Nl(t,(function(t,s){if(ul(t)){var l=void 0;if(s<a&&!t.forceCreate)l=i.getIndex(s);else{if(t instanceof e)return void i.push(t);o++,l=r.createEntryInstance(t),n?l.parent=n:i.push(l)}l instanceof e?l.config=t:ul(l)&&ul(t)&&wu(t,l)}else i.hasIndex(s)?i.setIndex(s,t):i.push(t)}));!n&&t.length+o<i.length;)i.pop()},e.prototype.configOrder=function(e,t){return e==t?0:"language"==e?-1:"language"==t?1:0},e.prototype.asIs=function(e){return-1!=jl(["locale"],e)},e.prototype.asFunction=function(e){return!1},e.prototype.createClassInstance=function(e){if(nl(Bu.registeredClasses[e]))return new Bu.registeredClasses[e];throw Error('Invalid type: "'+e+'".')},e.prototype.createEntryInstance=function(e){var t;return nl(e.type)&&(t=this.createClassInstance(e.type)),t||e},e.prototype.getConfigEntryType=function(e){if(nl(e.type)){if(nl(Bu.registeredClasses[e.type]))return Bu.registeredClasses[e.type];throw Error('Invalid type: "'+e.type+'".')}},e.prototype.hasProperty=function(e){return e in this},e.prototype.isReserved=function(e){return-1!==["type","forceCreate"].indexOf(e)},Object.defineProperty(e.prototype,"processingErrors",{get:function(){return this._processingErrors||(this._processingErrors=[]),this._processingErrors},enumerable:!0,configurable:!0}),e}(),pc=function(e){function t(){var t=e.call(this)||this;return t.className="BaseObjectEvents",t}return Us(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return this._eventDispatcher||(this._eventDispatcher=new du,this._disposers.push(this._eventDispatcher)),this._eventDispatcher},enumerable:!0,configurable:!0}),t.prototype.dispatch=function(e,t){this._eventDispatcher&&this.events.isEnabled(e)&&(t?(t.type=e,t.target=t.target||this,this.events.dispatch(e,{type:e,target:this})):this.events.dispatch(e,{type:e,target:this}))},t.prototype.dispatchImmediately=function(e,t){this._eventDispatcher&&this.events.isEnabled(e)&&(t?(t.type=e,t.target=t.target||this,this.events.dispatchImmediately(e,t)):this.events.dispatchImmediately(e,{type:e,target:this}))},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),t._eventDispatcher&&this.events.copyFrom(t._eventDispatcher)},t}(hc);var dc="string",fc="number",mc="date",vc="duration",yc="__\xa7\xa7\xa7__",gc="__\xa7\xa7\xa7\xa7__";function _c(e,t){return gu(e,(function(e,i){nl(i)&&(t[e]=i)})),t}function bc(e){return/^[^#]*/.exec(e)[0]}function xc(){var e="#";if(/apple/i.test(navigator.vendor)){var t=document.baseURI;if(t){t=bc(t);var i=bc(location.href);t!==i&&(e=i+e)}}return e}function wc(e,t){return gu(e,(function(e,i){nl(i)&&!nl(t[e])&&(t[e]=i)})),t}function kc(e){return nl(e)&&""!==e.toString()}function Pc(e,t){return ll(e)?e:null!=e&&ll(e.value)&&ll(t)?t*e.value:0}function Sc(e){return JSON.stringify(e)}function Tc(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Ec(e,t,i,n,r){if(e.length<=t)return[e];var a=[];if(i){for(var o=-1,s=e.replace(/([,;:!?\\\/]+|[\s])/g,"__\xa7\xa7\xa7__$1__\xa7\xa7\xa7__").split(yc),l=1;l<s.length;l++){"."!=(u=s[l])&&","!=u||!s[l-1].match(/[\w]+$/)||(s[l-1]+=u,s[l]="")}for(l=0;l<s.length;l++){var u,c=(u=s[l]).length;if(0!==c){if(c>t&&(!0!==i||0!=r)){if(n&&(u=Oc(u)),p=u.match(new RegExp(".{1,"+t+"}","g"))){if(n)for(var h=0;h<p.length;h++)p[h]=Oc(p[h]);a=a.concat(p)}}else-1===o&&(a.push(""),o=0),a[o].length+c+1>t&&""!==a[o]&&(a.push(""),o++),a[o]+=u;o=a.length-1}}}else{var p;if(p=e.match(new RegExp(".{1,"+t+"}","g"))){if(n)for(h=0;h<p.length;h++)p[h]=Oc(p[h]);a=p}}return 1==a.length&&i&&r&&a[0].length>t&&(a=[]),a}function Cc(e,t,i,n,r){return e.length<=t?e:((t-=i.length)<1&&(t=1),(Ec(e,t,n,r)[0]||"")+i)}function Mc(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function Ic(e){return e.replace(/[\s\uFEFF\xA0]+$/g,"")}function Oc(e){return e.split("").reverse().join("")}function Dc(e,t,i){return void 0===t&&(t=0),void 0===i&&(i="0"),"string"!==typeof e&&(e=e.toString()),t>e.length?Array(t-e.length+1).join(i)+e:e}function Ac(e){return e.replace(/\/(date|number|duration)$/i,"")}function Lc(e){return e?e.replace(/<[^>]*>/g,""):e}function zc(e){return e?Lc((""+e).replace(/[\n\r]+/g,". ")):e}function Rc(e){if(ol(e)){var t=new Date(e);return t.setMilliseconds(e.getMilliseconds()),t}if(ll(e))return new Date(e);var i=Number(e);return ll(i)?new Date(i):new Date(e)}function Fc(e){if(ol(e))return e.getTime();if(ll(e))return e;if(sl(e)){var t=Number(e);return ll(t)?t:void 0}}function jc(e,t){void 0===t&&(t=!1);var i=new Date(e.getFullYear(),0,0),n=e.getTime()-i.getTime()+60*(i.getTimezoneOffset()-e.getTimezoneOffset())*1e3;return Math.floor(n/864e5)}function Bc(e,t){void 0===t&&(t=!1);var i=jc(e,t)-1,n=Math.floor((i-(e.getDay()||7)+10)/7);return 0===n?n=53:53===n&&(n=1),n}function Vc(e,t){void 0===t&&(t=!1);var i=Bc(new Date(e.getFullYear(),e.getMonth(),1),t),n=Bc(e,t);return 1==n&&(n=53),n-i+1}function Nc(e,t){return e>12?e-=12:0===e&&(e=12),nl(t)?e+(t-1):e}function Uc(e,t,i,n){if(void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===n&&(n=!1),n)return t?"Coordinated Universal Time":"UTC";var r=e.toLocaleString("UTC"),a=e.toLocaleString("UTC",{timeZoneName:t?"long":"short"}).substr(r.length);return!1===i&&(a=a.replace(/ (standard|daylight|summer|winter) /i," ")),a}function Gc(e,t,i){return e>i?i:e<t?t:e}function Wc(e,t,i){var n=i-t;return(e>i||e<t)&&(e=t+(e-n*Math.floor(e/n))),e}function Hc(e,t){var i=e.x,n=e.y,r=[];if(t){for(;nl(t.parent);)r.push(t),t=t.parent;r.reverse();for(var a=0;a<r.length;a++){var o=r[a],s=o.rotation,l=i-o.pixelX-o.ex,u=n-o.pixelY-o.ey;o.dx&&(i-=o.dx),o.dy&&(n-=o.dy);var c=o.scale;o.group&&(c=o.group.scale),i=(bl(-s)*l-_l(-s)*u)/c-o.pixelPaddingLeft,n=(bl(-s)*u+_l(-s)*l)/c-o.pixelPaddingTop}}return{x:i,y:n}}function Zc(e,t){var i=e.x,n=e.y;if(t)for(;nl(t.parent);){var r=t.rotation;i+=t.pixelPaddingLeft+t.ex,n+=t.pixelPaddingTop+t.ey;var a=t.scale;t.group&&(a=t.group.scale);var o=t.pixelX+(i*bl(r)-n*_l(r))*a,s=t.pixelY+(i*_l(r)+n*bl(r))*a;t.dx&&(o+=t.dx),t.dy&&(s+=t.dy),i=o,n=s,t=t.parent}return{x:i,y:n}}function qc(e,t,i){return Hc(Zc(e,t),i)}function Xc(e,t){var i=Zc(e,t),n=Zc({x:e.x+e.width,y:e.y+e.height},t);return{x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y}}function Kc(e,t,i){try{var n=t.getBoundingClientRect();return ll(i)||(i=1),{x:(e.x-n.left)/i,y:(e.y-n.top)/i}}catch(r){return e}}function Yc(e,t){return t&&t.htmlContainer?Hc(Kc(e,rl(t.htmlContainer),t.svgContainer.cssScale),t):e}function $c(e,t){return t&&t.htmlContainer?function(e,t){try{var i=t.getBoundingClientRect();return{x:e.x+i.left,y:e.y+i.top}}catch(n){return e}}(Zc(e,t),rl(t.htmlContainer)):e}var Jc=/^([a-zA-Z][a-zA-Z0-9\+\.\-]*:)?(?:(\/\/)([^\@]+\@)?([^\/\?\#\:]*)(\:[0-9]+)?)?([^\?\#]*)(\?[^\#]*)?(\#.*)?$/;function Qc(e){var t=Jc.exec(e);return{protocol:t&&t[1]||"",separator:t&&t[2]||"",authority:t&&t[3]||"",domain:t&&t[4]||"",port:t&&t[5]||"",path:t&&t[6]||"",query:t&&t[7]||"",hash:t&&t[8]||""}}function eh(e){return e.protocol+e.separator+e.authority+e.domain+e.port+e.path+e.query+e.hash}function th(e){return""===e.protocol&&""===e.separator&&""===e.authority&&""===e.domain&&""===e.port}function ih(e,t){var i=Qc(e),n=Qc(t);if(th(i))throw new Error("Left URL is not absolute");if(th(n)){if(""!==n.path)if("/"===n.path[0])i.path=n.path;else{var r=i.path.split(/\//),a=n.path.split(/\//);if(0===r.length?0!==a.length&&r.push(""):r.length>1&&r.pop(),function(e,t){for(var i=t.length,n=0;n<i;++n)e.push(t[n])}(r,a),i.path=r.join("/"),""!==i.path&&"/"!==i.path[0])throw new Error("URL path must start with /")}return i.query=n.query,i.hash=n.hash,eh(i)}return eh(n)}function nh(e){return+e}function rh(e,t){return Math.pow(e,t)}function ah(e,t){return 1-Math.pow(1-e,t)}function oh(e,t){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}function sh(e){return ah(e,3)}function lh(e){return e*e*e}function uh(e){return--e*e*e+1}Bu.registeredClasses["ease.linear"]=nh,Bu.registeredClasses["ease.quadIn"]=function(e){return e*e},Bu.registeredClasses["ease.quadOut"]=function(e){return e*(2-e)},Bu.registeredClasses["ease.quadInOut"]=function(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2},Bu.registeredClasses["ease.polyIn"]=rh,Bu.registeredClasses["ease.polyOut"]=ah,Bu.registeredClasses["ease.polyInOut"]=oh,Bu.registeredClasses["ease.polyIn3"]=function(e){return rh(e,3)},Bu.registeredClasses["ease.polyOut3"]=sh,Bu.registeredClasses["ease.polyInOut3"]=function(e){return oh(e,3)},Bu.registeredClasses["ease.expIn"]=function(e){return Math.pow(2,10*e-10)},Bu.registeredClasses["ease.expOut"]=function(e){return 1-Math.pow(2,-10*e)},Bu.registeredClasses["ease.expInOut"]=function(e){return((e*=2)<=1?Math.pow(2,10*e-10):2-Math.pow(2,10-10*e))/2},Bu.registeredClasses["ease.sinIn"]=function(e){return 1-Math.cos(e*pl)},Bu.registeredClasses["ease.sinOut"]=function(e){return Math.sin(e*pl)},Bu.registeredClasses["ease.sinInOut"]=function(e){return(1-Math.cos(hl*e))/2},Bu.registeredClasses["ease.cubicIn"]=lh,Bu.registeredClasses["ease.cubicOut"]=uh,Bu.registeredClasses["ease.cubicInOut"]=function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2},Bu.registeredClasses["ease.circleIn"]=function(e){return 1-Math.sqrt(1-e*e)},Bu.registeredClasses["ease.circleOut"]=function(e){return Math.sqrt(1- --e*e)},Bu.registeredClasses["ease.circleInOut"]=function(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2};var ch=4/11,hh=7.5625;function ph(e){return(e=+e)<ch?hh*e*e:e<.7272727272727273?hh*(e-=.5454545454545454)*e+.75:e<.9090909090909091?hh*(e-=.8181818181818182)*e+.9375:hh*(e-=.9545454545454546)*e+.984375}Bu.registeredClasses["ease.bounceIn"]=function(e){return 1-ph(1-e)},Bu.registeredClasses["ease.bounceOut"]=ph,Bu.registeredClasses["ease.bounceInOut"]=function(e){return((e*=2)<=1?1-ph(1-e):ph(e-1)+1)/2};var dh=2*Math.PI,fh=.3/dh,mh=Math.asin(1)*fh;Bu.registeredClasses["ease.elasticIn"]=function(e){return 1*Math.pow(2,10*--e)*Math.sin((mh-e)/fh)},Bu.registeredClasses["ease.elasticOut"]=function(e){return 1-1*Math.pow(2,-10*(e=+e))*Math.sin((e+mh)/fh)},Bu.registeredClasses["ease.elasticInOut"]=function(e){return((e=2*e-1)<0?1*Math.pow(2,10*e)*Math.sin((mh-e)/fh):2-1*Math.pow(2,-10*e)*Math.sin((mh+e)/fh))/2};var vh=function(e){function t(){var t=e.call(this)||this;return t.transitionDuration=0,t.transitionEasing=uh,t.properties={},t.propertyFields={},t.filters=new Wu,t.isTemplate=!1,t.className="SpriteState",t._disposers.push(new Uu(t.filters)),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"adapter",{get:function(){var e=this;return this._adapterO||(this._adapterO=new ec(this),this._adapterO.events.on("inserted",(function(t){e[t.newValue.key]=e[t.newValue.key]}),void 0,!1),this._adapterO.events.on("removed",(function(t){e[t.newValue.key]=e[t.newValue.key]}),void 0,!1)),this._adapterO},enumerable:!0,configurable:!0}),t.prototype.getPropertyValue=function(e){var t=this.properties[e],i=this.sprite;if(i){var n=this.propertyFields[e];if(nl(n)&&(i.dataItem&&(t=i.dataItem.dataContext[n]),void 0==t&&(t="__unset")),nl(t))this._adapterO&&(t=this._adapterO.apply(e,t));else{var r=i.getPropertyValue(e);(t=this._adapterO?this._adapterO.apply(e,r):r)==r&&(t=void 0)}}return t},t.prototype.copyFrom=function(e){e&&e!=this&&(this.transitionDuration=e.transitionDuration,this.transitionEasing=e.transitionEasing,_c(e.properties,this.properties),_c(e.propertyFields,this.propertyFields),this.filters.copyFrom(e.filters),e._adapterO&&this.adapter.copyFrom(e._adapterO))},Object.defineProperty(t.prototype,"allValues",{get:function(){var e=this,t={};(gu(this.properties,(function(i,n){t[i]=e.getPropertyValue(i)})),this._adapterO)&&gu(this._adapterO.keys(),(function(i,n){var r=e.getPropertyValue(n);t[n]=r}));return gu(this.propertyFields,(function(i){var n=e.getPropertyValue(i);t[i]=n})),t},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.properties={},this.filters.clear()},t.prototype.processConfig=function(t){nl(t)&&nl(t.properties)&&gu(t.properties,(function(e,i){sl(i)&&(i.match(/^[0-9.\-]+\%$/)?t.properties[e]=Ks(el(i)):i.match(/^\#[0-9abcdef]{3,}$/i)&&(t.properties[e]=cc(i)))})),e.prototype.processConfig.call(this,t)},t.prototype.asFunction=function(t){return"transitionEasing"==t||e.prototype.asIs.call(this,t)},t}(hc);Bu.registeredClasses.SpriteState=vh;var yh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._interactionEvents=new Lu,t}return Us(t,e),t.prototype._dispatchSpriteEvent=function(e){if(!this.target.disabled&&!this.target.isTemplate&&this.target.events.isEnabled(e.type)){var t=bu(e,{target:this.target});this.target.events.dispatchImmediately(t.type,t)}},t.prototype._dispatchSpritePointEvent=function(e){if(!this.target.disabled&&!this.target.isTemplate&&this.target.events.isEnabled(e.type)){var t=bu(e,{target:this.target,spritePoint:e.point?Yc(e.point,this.target):void 0,svgPoint:this.target.getSvgPoint(e.point)});this.target.events.dispatchImmediately(t.type,t)}},t.prototype._addInteractionObjectEvent=function(e,t,i,n){var r=this,a=n+"-"+e;return this._interactionEvents.insertKeyIfEmpty(a,(function(){var o=r.target.interactions.events.on(e,t,i,n);return new nu((function(){r._interactionEvents.removeKey(a),o.dispose()}))})).increment()},t.prototype._on=function(t,i,n,r,a,o){var s=e.prototype._on.call(this,t,i,n,r,a,o),l=[s.disposer];switch(i){case"hit":case"track":case"doublehit":case"wheel":case"wheelup":case"wheeldown":case"wheelleft":case"wheelright":l.push(this._addInteractionObjectEvent(i,this._dispatchSpritePointEvent,this,a));break;case"rightclick":case"down":case"up":case"drag":case"dragged":case"dragstart":case"dragstop":case"over":case"out":case"swipe":case"swipeleft":case"swiperight":case"resize":case"focus":case"blur":case"toggled":l.push(this._addInteractionObjectEvent(i,this._dispatchSpriteEvent,this,a))}switch(i){case"hit":case"doublehit":case"rightclick":case"down":case"up":this.target.clickable=!0;break;case"toggled":this.target.togglable=!0;break;case"drag":case"dragstart":case"dragstop":this.target.draggable=!0;break;case"track":this.target.trackable=!0;break;case"resize":this.target.resizable=!0;break;case"swipe":case"swipeleft":case"swiperight":this.target.swipeable=!0;break;case"wheel":case"wheelup":case"wheeldown":case"wheelleft":case"wheelright":this.target.wheelable=!0;break;case"over":this.target.hoverable=!0;case"out":this.target.hoverable=!0;break;case"focus":case"blur":this.target.focusable=!0}return s.disposer=new tu(l),s},t}(fu),gh=function(){function e(){}return e.opacity=1,e.strokeOpacity=1,e.strokeWidth=1,e.fillOpacity=1,e.fill=uc("#000000"),e.stroke=uc("#000000"),e.focusable=void 0,e.tabindex=0,e}(),_h={verbose:!0,commercialLicense:!1,classNamePrefix:"amcharts-",autoSetClassName:!1,minPolylineStep:.5,onlyShowOnViewport:!1,queue:!1,autoDispose:!1,licenses:[],suppressErrors:!1,suppressWarnings:!1,animationsEnabled:!0,nonce:"",deferredDelay:100,disableHoverOnTransform:"never",pixelPerfectPrecision:0};function bh(e,t,i){return t+(i-t)*e}function xh(e,t,i){return new Xs(bh(e,t.percent,i.percent))}function wh(e,t,i){var n=new lc(rc(t.rgb,i.rgb,e));return t.alpha!=i.alpha&&(n.alpha=t.alpha+(i.alpha-t.alpha)*e),n}function kh(e,t){return t+e.charAt(0).toUpperCase()+e.substr(1)}var Ph,Sh=function(){function e(e){this._disposer=new eu((function(){for(;0!==e.length;)e[0].dispose()}))}return e.prototype.isDisposed=function(){return this._disposer.isDisposed()},e.prototype.dispose=function(){this._disposer.dispose()},e}(),Th=function(e){function t(t,i,n,r){var a=e.call(this)||this;return a.duration=0,a.easing=nh,a.progress=0,a._loop=0,a._pause=!1,a._delayTimeout=null,a._time=0,a._isFinished=!1,a.className="Animation",!1===_h.animationsEnabled&&(n=0),a.object=t,a.animationOptions=Zl(i),a.duration=n,r&&(a.easing=r),a.applyTheme(),a}return Us(t,e),t.prototype.debug=function(){},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.pause()},t.prototype.delay=function(e){var t=this;if(e>0){this.pause(),Wl(this.object.animations,this);var i=setTimeout((function(){t._delayTimeout=null,t.start()}),e);this._delayTimeout=new eu((function(){clearTimeout(i)}))}return this},t.prototype._start=function(){this._isFinished=!1,this._delayTimeout&&(this.removeDispose(this._delayTimeout),this._delayTimeout=null),this.stopSameAnimations(),this._pause=!1,Wl(Zp.animations,this),Wl(this.object.animations,this),Zp.requestFrame()},t.prototype.start=function(){this._start(),this._startTime=Date.now(),this._time=0,this.staticOptions=[];for(var e=this.animationOptions.length-1;e>=0;e--){var t=this.animationOptions[e];if(nl(t.from)||(t.childObject?t.from=t.childObject[t.property]:(t.from=this.object[t.property],nl(t.from)||(t.from=gh[t.property]))),t.from==t.to)Gl(this.animationOptions,t);else if(!nl(t.from)||!(t.from instanceof Xs)&&t.to instanceof Xs||t.from instanceof Xs&&!(t.to instanceof Xs))this.staticOptions.push(t),Gl(this.animationOptions,t);else if(ll(t.to))if(t.updateMethod=bh,t.from instanceof Xs){var i=this.object[kh(t.property,"pixel")];isNaN(i)?(this.staticOptions.push(t),Gl(this.animationOptions,t)):t.from=i}else isNaN(t.from)&&(this.staticOptions.push(t),Gl(this.animationOptions,t));else if(t.to instanceof lc)t.from?t.updateMethod=wh:(this.staticOptions.push(t),Gl(this.animationOptions,t));else if(t.to instanceof Xs){if(t.updateMethod=xh,!isNaN(t.from)){i=this.object[kh(t.property,"relative")];isNaN(i)||(t.from=Ks(100*i))}}else this.staticOptions.push(t),Gl(this.animationOptions,t)}if(this.applyStaticOptions(),this.events.isEnabled("animationstarted")){var n={type:"animationstarted",target:this,progress:this.progress};this.events.dispatchImmediately("animationstarted",n)}return this.update(),0===this.duration&&this.end(),this},t.prototype.loop=function(e){return ll(e)||(e=1/0),this._loop=e,this},t.prototype.pause=function(){return this._pause=!0,this._delayTimeout&&(this.removeDispose(this._delayTimeout),this._delayTimeout=null),Gl(Zp.animations,this),Gl(this.object.animations,this),this},t.prototype.resume=function(){return this._start(),this._startTime=Date.now()-this._time,this},t.prototype.end=function(){if(0==this._loop&&this.pause(),this.setProgress(1),this.applyStaticOptions(),this.events.isEnabled("animationended")){var e={type:"animationended",target:this,progress:this.progress};this.events.dispatchImmediately("animationended",e)}return this._loop>0?(this._loop--,this.start()):(this.stop(),this._isFinished=!0),this},t.prototype.kill=function(){this.pause(),this._isFinished=!0},t.prototype.isFinished=function(){return this._isFinished},t.prototype.applyStaticOptions=function(){var e=this;Nl(this.staticOptions,(function(t){t.childObject?t.childObject[t.property]=1==e.progress?t.to:t.from:e.object[t.property]=1==e.progress?t.to:t.from}))},t.prototype.stop=function(e){if(this.pause(),!e&&this.events.isEnabled("animationstopped")){var t={type:"animationstopped",target:this,progress:this.progress};this.events.dispatchImmediately("animationstopped",t)}return this},t.prototype.setProgress=function(e){var t=this;if(this._time=this.duration*e,Nl(this.animationOptions,(function(i){if(i.updateMethod&&nl(i.from)){var n=i.updateMethod(e,i.from,i.to);i.childObject?i.childObject[i.property]=n:t.object[i.property]=n}})),this.progress=e,this.events.isEnabled("animationprogress")){var i={type:"animationprogress",target:this,progress:this.progress};this.events.dispatchImmediately("animationprogress",i)}Zp.requestFrame()},t.prototype.update=function(){if(!this._pause){var e=void 0;this._time=gl(Date.now()-this._startTime,0,this.duration);var t=this._time/this.duration;e=this.easing(t),(0==this.duration||!ll(e)||t>=1)&&(e=1),this.setProgress(e),1==vl(this._time/this.duration,6)&&this.end()}return this},Object.defineProperty(t.prototype,"delayed",{get:function(){return!!this._delayTimeout},enumerable:!0,configurable:!0}),t.prototype.stopSameAnimations=function(){var e=this;Nl(ql(this.object.animations),(function(t){if(t!==e&&!t.delayed){var i=[];Nl(e.animationOptions,(function(e){Nl(t.animationOptions,(function(n){e.property==n.property&&e.childObject==n.childObject&&(i.push(n),0==t.animationOptions.length&&t.kill())}))})),Nl(i,(function(e){Gl(t.animationOptions,e)}))}}))},t.prototype.asFunction=function(t){return"easing"==t||e.prototype.asIs.call(this,t)},t}(pc),Eh="http://www.w3.org/2000/svg",Ch="http://www.w3.org/2000/xmlns/",Mh="http://www.w3.org/1999/xlink";function Ih(e,t,i,n){return e.addEventListener(t,i,n||!1),new eu((function(){e.removeEventListener(t,i,n||!1)}))}function Oh(e){if(sl(e)){var t=document.getElementById(e);if(null==t&&(t=document.getElementsByClassName(e)[0]),t instanceof HTMLElement)return t}else if(e instanceof HTMLElement)return e}function Dh(e,t){if(e)if(e.classList){Nl(t.split(" "),(function(t){e.classList.add(t)}))}else{var i=e.getAttribute("class");i?e.setAttribute("class",i.split(" ").filter((function(e){return e!==t})).join(" ")+" "+t):e.setAttribute("class",t)}}function Ah(e,t){if(e)if(e.classList)e.classList.remove(t);else{var i=e.getAttribute("class");i&&e.setAttribute("class",i.split(" ").filter((function(e){return e!==t})).join(" "))}}function Lh(e,t,i){e.style[t]=i}function zh(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function Rh(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{var e=document.createElement("button");e.style.position="fixed",e.style.top="0px",e.style.left="-10000px",document.body.appendChild(e),e.focus(),e.blur(),document.body.removeChild(e)}}function Fh(e,t){for(var i=t;;){if(e===i)return!0;if(null==i.parentNode){if(null==i.host)return!1;i=i.host}else i=i.parentNode}}function jh(e){for(var t=e;;){if(null==t.parentNode)return null!=t.host?t:null;t=t.parentNode}}function Bh(e){for(var t=e.ownerDocument,i=e;;){if(null==i.parentNode)return i===t||null!=i.host?i:null;i=i.parentNode}}function Vh(e){var t;t=function(){try{var t=e.getBoundingClientRect(),i=t.left-Math.round(t.left),n=t.top-Math.round(t.top);0!==i&&pu((function(){e.style.left=i+"px"})),0!==n&&pu((function(){e.style.top=n+"px"}))}catch(r){}},ou.push(t),hu()}var Nh=function(e){function t(t,i,n){var r=this,a=function(e){if(null==e)return nl(Ph)||((t=document.createElement("style")).type="text/css",""!=_h.nonce&&t.setAttribute("nonce",_h.nonce),document.head.appendChild(t),Ph=t.sheet),Ph;var t;return(t=document.createElement("style")).type="text/css",""!=_h.nonce&&t.setAttribute("nonce",_h.nonce),e.appendChild(t),t.sheet}(t);return r=e.call(this,(function(){var e=jl(a.cssRules,r._rule);if(-1===e)throw new Error("Could not dispose StyleRule");a.deleteRule(e)}))||this,r._rule=function(e,t){var i=e.cssRules.length;return e.insertRule(t+"{}",i),e.cssRules[i]}(a,i),gu(n,(function(e,t){r.setStyle(e,t)})),r}return Us(t,e),Object.defineProperty(t.prototype,"selector",{get:function(){return this._rule.selectorText},set:function(e){this._rule.selectorText=e},enumerable:!0,configurable:!0}),t.prototype._setVendorPrefixName=function(e,t){var i=this._rule.style;i.setProperty("-webkit-"+e,t,""),i.setProperty("-moz-"+e,t,""),i.setProperty("-ms-"+e,t,""),i.setProperty("-o-"+e,t,""),i.setProperty(e,t,"")},t.prototype.setStyle=function(e,t){"transition"===e?this._setVendorPrefixName(e,t):this._rule.style.setProperty(e,t,"")},t}(eu),Uh=0;!function(e){function t(t,i,n){var r=this,a=nl(n)?n:"__style_"+ ++Uh+"__";return(r=e.call(this,t,"."+a,i)||this)._className=a,r}Us(t,e),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},set:function(e){this._className=e,this.selector="."+e},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this._className}}(Nh);function Gh(e){var t=zh(e,"font-family");if(t)return t;var i=e.parentElement||e.parentNode;return i?Gh(i):void 0}function Wh(e){var t=zh(e,"font-size");if(t)return t;var i=e.parentElement||e.parentNode;return i?Wh(i):void 0}function Hh(e,t){var i=e.getBoundingClientRect(),n=cl(t)?t:t?[t]:[];if(n.length){for(var r=0;r<n.length;r++){var a=n[r];if(!Hh(a))return!1;var o=a.getBoundingClientRect();if(i.top>=0&&i.left>=0&&i.top<=o.top+o.height&&i.left<=o.left+o.width)return!0}return!1}return i.top>=0&&i.left>=0&&i.top<=(window.innerHeight||document.documentElement.clientHeight)&&i.left<=(window.innerWidth||document.documentElement.clientWidth)}var Zh=function(){function e(e){this._isDisposed=!1,this._x=0,this._y=0,this._rotationY=0,this._rotationX=0,this._rotation=0,this._scale=1,this.node="string"===typeof e?document.createElementNS(Eh,e):e}return e.prototype.removeNode=function(){this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node)},Object.defineProperty(e.prototype,"transformString",{get:function(){if(this.node)return this._transformString},enumerable:!0,configurable:!0}),e.prototype.transform=function(){var e="translate("+this._x+","+this._y+")";if(1!=this._scale&&(e+=(e?" ":"")+"scale("+this._scale+")"),0!=this._rotation){var t="rotate("+this._rotation+")";this._rotationX&&this._rotationY&&(t="rotate("+this._rotation+" "+this._rotationX+" "+this._rotationY+")"),e+=(e?" ":"")+t}this._transformString=e,this.node.setAttribute("transform",e)},e.prototype.getBBox=function(){var e={width:0,height:0,x:0,y:0};if(this.node&&this.node.parentNode)try{var t=this.node.getBBox();e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height}catch(i){}return e},e.prototype.moveTo=function(e){if(e){var t=e.x,i=e.y;this._x==t&&this._y==i||(this._x=t,this._y=i,this.transform())}},Object.defineProperty(e.prototype,"content",{get:function(){return this.node.innerHTML||""},set:function(e){this.node.innerHTML=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.node.textContent||""},set:function(e){this.node.textContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x!=e&&(this._x=e,this.transform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y!=e&&(this._y=e,this.transform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!=e&&(this._rotation=e,this.transform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._rotationX},set:function(e){this._rotationX!=e&&(this._rotationX=e,this.transform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._rotationY},set:function(e){this._rotationY!=e&&(this._rotationY=e,this.transform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale!=e&&(this._scale=e,this.transform())},enumerable:!0,configurable:!0}),e.prototype.removeAttr=function(e){this.node.removeAttribute(e)},e.prototype.attr=function(e){var t=this;return gu(e,(function(e,i){nl(i)?t.node.setAttribute(e,i):t.node.removeAttribute(e)})),this},e.prototype.getAttr=function(e){return this.node.getAttribute(e)},e.prototype.attrNS=function(e,t,i){return this.node.setAttributeNS(e,t,i),this},e.prototype.getAttrNS=function(e,t){return this.node.getAttributeNS(e,t)},e.prototype.removeStyle=function(e){this.node.style[e]=null,delete this.node.style[e]},e.prototype.getStyle=function(e){return this.node.style[e]},e.prototype.addStyle=function(e){var t=this;return gu(e,(function(e,i){nl(i)?t.node.style[e]=i:t.removeStyle(e)})),this},e.prototype.addClass=function(e){Dh(this.node,e)},e.prototype.removeClass=function(e){Ah(this.node,e)},e.prototype.setClass=function(e){this.node.setAttribute("class",e)},e.prototype.removeChildNodes=function(){for(;this.node.childNodes.length>0;)this.node.removeChild(this.node.firstChild)},e.prototype.isDisposed=function(){return this._isDisposed},e.prototype.dispose=function(){this.removeNode()},e}(),qh=function(e){function t(t){return e.call(this,t)||this}return Us(t,e),t.prototype.add=function(e){e&&this.node.appendChild(e.node)},t.prototype.addToBack=function(e){if(e){var t=this.node.childNodes[0];t?t!=e.node&&this.node.insertBefore(e.node,t):this.node.appendChild(e.node)}},t.prototype.removeElement=function(e){if(e)try{e.node&&e.node.parentNode==this.node&&this.node.removeChild(e.node)}catch(t){}},t.prototype.hasChild=function(e){for(var t=0;t<this.node.childNodes.length;t++)if(this.node.childNodes[t]==e.node)return!0;return!1},Object.defineProperty(t.prototype,"content",{get:function(){return this.node.innerHTML},set:function(e){this.node.innerHTML=e},enumerable:!0,configurable:!0}),t.prototype.removeChildren=function(){if(this.node.childNodes)for(;this.node.childNodes.length>0;){var e=this.node.firstChild;e&&e.parentNode&&e.parentNode.removeChild(e)}},t.prototype.removeChildrenByTag=function(e){if(this.node.childNodes)for(var t=this.node.getElementsByTagName(e),i=0;i<t.length;i++)this.node.removeChild(t[i])},t}(Zh),Xh=function(e){function t(){var t=e.call(this)||this;return t._purposes={stroke:uc("#e5e5e5"),fill:uc("#f3f3f3"),primaryButton:uc("#6794dc"),primaryButtonHover:uc("#6771dc"),primaryButtonDown:uc("#68dc75"),primaryButtonActive:uc("#68dc75"),primaryButtonText:uc("#FFFFFF"),primaryButtonStroke:uc("#FFFFFF"),secondaryButton:uc("#d9d9d9"),secondaryButtonHover:uc("#d9d9d9").brighten(-.25),secondaryButtonDown:uc("#d9d9d9").brighten(-.35),secondaryButtonActive:uc("#d9d9d9").brighten(.35),secondaryButtonText:uc("#000000"),secondaryButtonStroke:uc("#FFFFFF"),grid:uc("#000000"),background:uc("#ffffff"),alternativeBackground:uc("#000000"),text:uc("#000000"),alternativeText:uc("#FFFFFF"),disabledBackground:uc("#999999"),positive:uc("#67dc75"),negative:uc("#dc6788")},t.className="InterfaceColorSet",t.applyTheme(),t}return Us(t,e),t.prototype.debug=function(){},t.prototype.getFor=function(e){return this._purposes[e]},t.prototype.setFor=function(e,t){this._purposes[e]=t},t}(hc);Bu.registeredClasses.InterfaceColorSet=Xh;var Kh=new Lu;var Yh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._domEvents={},t}return Us(t,e),t.prototype._addDOMEvent=function(e,t,i,n){var r=this;if(!this._domEvents[e]){var a=function(e){i.call(n,t,e)};this.target.element.addEventListener(e,a,!1),this._domEvents[e]=new nu((function(){delete r._domEvents[e],r.target.element.removeEventListener(e,a,!1)}))}return this._domEvents[e].increment()},t.prototype._dispatchKeyboardEvent=function(e,t){this.target.events.isEnabled(e)&&this.target.events.dispatchImmediately(e,{type:e,target:this.target,event:t})},t.prototype._on=function(t,i,n,r,a,o){var s=e.prototype._on.call(this,t,i,n,r,a,o),l=[s.disposer];switch(i){case"hit":case"doublehit":case"rightclick":case"down":case"up":this.target.clickable=!0;break;case"drag":case"dragstart":case"dragstop":this.target.draggable=!0;break;case"track":this.target.trackable=!0;break;case"resize":this.target.resizable=!0;break;case"swipe":case"swipeleft":case"swiperight":this.target.swipeable=!0;break;case"wheel":case"wheelup":case"wheeldown":case"wheelleft":case"wheelright":this.target.wheelable=!0;break;case"over":case"out":this.target.hoverable=!0;break;case"focus":case"blur":case"focusin":case"focusout":this.target.focusable=!0;break;case"keydown":case"keyup":case"keypress":case"input":l.push(this._addDOMEvent(i,i,this._dispatchKeyboardEvent,this))}return s.disposer=new tu(l),s},t}(fu),$h=function(e){function t(t){var i=e.call(this)||this;return i._eventDispatcher=new Yh(i),i.eventDisposers=new Lu,i.replacedStyles=new Lu,i._clickable=!1,i._contextMenuDisabled=!1,i._hoverable=!1,i._trackable=!1,i._draggable=!1,i._swipeable=!1,i._resizable=!1,i._wheelable=!1,i._inert=!1,i._isHover=!1,i.isRealHover=!1,i._isHoverByTouch=!1,i._isDown=!1,i._isFocused=!1,i._isTouchProtected=!1,i._inertiaOptions=new Lu,i.inertias=new Lu,i._hitOptions={},i._hoverOptions={},i._swipeOptions={},i._keyboardOptions={},i._mouseOptions={},i._cursorOptions={defaultStyle:[{property:"cursor",value:"default"}]},i._disposers.push(i._eventDispatcher),i._element=t,i.className="InteractionObject",i._disposers.push(new Au(i.inertias)),i._disposers.push(new Au(i.eventDisposers)),i.applyTheme(),i}return Us(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return this._eventDispatcher},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHover",{get:function(){return this._isHover},set:function(e){this.isHover!=e&&(this._isHover=e,e?ap().overObjects.moveValue(this):(this.isRealHover=!1,ap().overObjects.removeValue(this)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHoverByTouch",{get:function(){return this._isHoverByTouch},set:function(e){this.isHoverByTouch!=e&&(this._isHoverByTouch=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overPointers",{get:function(){return this._overPointers||(this._overPointers=new Wu),this._overPointers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDown",{get:function(){return this._isDown},set:function(e){this.isDown!=e&&(this._isDown=e,e?ap().downObjects.moveValue(this):ap().downObjects.removeValue(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downPointers",{get:function(){return this._downPointers||(this._downPointers=new Wu),this._downPointers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this._isFocused},set:function(e){this.isFocused!=e&&(this._isFocused=e,ap().focusedObject=e?this:void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTouchProtected",{get:function(){return this._isTouchProtected},set:function(e){this._isTouchProtected!=e&&(this._isTouchProtected=e,e?ap().unprepElement(this):(this.draggable||this.swipeable||this.trackable||this.resizable)&&ap().prepElement(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clickable",{get:function(){return this._clickable},set:function(e){this._clickable!==e&&(this._clickable=e,ap().processClickable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextMenuDisabled",{get:function(){return this._contextMenuDisabled},set:function(e){this._contextMenuDisabled!==e&&(this._contextMenuDisabled=e,ap().processContextMenu(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hoverable",{get:function(){return this._hoverable},set:function(e){this._hoverable!==e&&(this._hoverable=e,ap().processHoverable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trackable",{get:function(){return this._trackable},set:function(e){this._trackable!==e&&(this._trackable=e,ap().processTrackable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"draggable",{get:function(){return this._draggable},set:function(e){this._draggable!==e&&(this._draggable=e,ap().processDraggable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"swipeable",{get:function(){return this._swipeable},set:function(e){this._swipeable!==e&&(this._swipeable=e,ap().processSwipeable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resizable",{get:function(){return this._resizable},set:function(e){this._resizable!==e&&(this._resizable=e,ap().processResizable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wheelable",{get:function(){return this._wheelable},set:function(e){this._wheelable!==e&&(this._wheelable=e,ap().processWheelable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inert",{get:function(){return this._inert},set:function(e){this._inert!==e&&(this._inert=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusable",{get:function(){return this._focusable},set:function(e){this._focusable!==e&&(this._focusable=e,this._focusable&&-1==this.tabindex&&(this._tabindex=1),ap().processFocusable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabindex",{get:function(){return al(this._tabindex,-1)},set:function(e){this._tabindex!==e&&(this._tabindex=e,e>-1&&(this.focusable=!0),ap().processFocusable(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(e){this._element=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalPosition",{get:function(){return this._originalPosition||{x:0,y:0}},set:function(e){this._originalPosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalScale",{get:function(){return al(this._originalScale,1)},set:function(e){this._originalScale!==e&&(this._originalScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalAngle",{get:function(){return al(this._originalAngle,0)},set:function(e){this._originalAngle!==e&&(this._originalAngle=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inertiaOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("inertiaOptions",this._inertiaOptions):this._inertiaOptions},set:function(e){this._inertiaOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hitOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("hitOptions",this._hitOptions):this._hitOptions},set:function(e){this._hitOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hoverOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("hoverOptions",this._hoverOptions):this._hoverOptions},set:function(e){this._hoverOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"swipeOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("swipeOptions",this._swipeOptions):this._swipeOptions},set:function(e){this._swipeOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keyboardOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("keyboardOptions",this._keyboardOptions):this._keyboardOptions},set:function(e){this._keyboardOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("mouseOptions",this._mouseOptions):this._mouseOptions},set:function(e){this._mouseOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursorOptions",{get:function(){return this.sprite&&this.sprite._adapterO?this.sprite._adapterO.apply("cursorOptions",this._cursorOptions):this._cursorOptions},set:function(e){this._cursorOptions=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.inertiaOptions=t.inertiaOptions,this.hitOptions=t.hitOptions,this.hoverOptions=t.hoverOptions,this.swipeOptions=t.swipeOptions,this.keyboardOptions=t.keyboardOptions,this.cursorOptions=t.cursorOptions,this.contextMenuDisabled=t.contextMenuDisabled,ap().applyCursorOverStyle(this)},t.prototype.setEventDisposer=function(e,t,i){var n=this.eventDisposers.getKey(e);t?null==n&&this.eventDisposers.setKey(e,i()):null!=n&&(n.dispose(),this.eventDisposers.removeKey(e))},t.prototype.dispose=function(){e.prototype.dispose.call(this);var t=ap();t.overObjects.removeValue(this),t.downObjects.removeValue(this),t.trackedObjects.removeValue(this),t.transformedObjects.removeValue(this),this.isHover&&this.wheelable&&t.unlockWheel(),t.focusedObject===this&&(t.focusedObject=void 0)},t}(pc),Jh=function(){function e(e,t){this._disposed=!1,this.directionX=0,this.directionY=0,this.interaction=e,this.keyboardEvent=t,this._startedOn=(new Date).getTime(),ap().processDragStart(e),Zp.animations.push(this),this.update()}return e.prototype.update=function(){var e=this.interaction,t=ap().getKeyboardOption(e,"speed"),i=ap().getKeyboardOption(e,"accelleration"),n=ap().getKeyboardOption(e,"accellerationDelay"),r={x:0,y:0};this.keyboardEvent.shiftKey?(t*=.5,i=1):this.keyboardEvent.ctrlKey&&(t*=2);var a=(new Date).getTime()-this._startedOn,o=a-n;if(i>0&&o>0){var s=a/n;a=n,r.x+=this.directionX*(t*i*s*o),r.y+=this.directionY*(t*i*s*o)}r.x+=this.directionX*(t*a),r.y+=this.directionY*(t*a),ap().handleTransformMove(e,r,{x:0,y:0},this.keyboardEvent,!0,!1)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){this._disposed||(ap().processDragStop(this.interaction),Gl(Zp.animations,this))},e}(),Qh=function(e){function t(t,i,n,r){var a=e.call(this)||this;return a.animations=[],a.className="Inertia",a.interaction=t,a.type=i,a.point=n,a.startPoint=r,a._disposers.push(new Sh(a.animations)),a}return Us(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.point.x},set:function(e){ll(e)&&(this.point.x=e,this.handleMove())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.point.y},set:function(e){ll(e)&&(this.point.y=e,this.handleMove())},enumerable:!0,configurable:!0}),t.prototype.handleMove=function(){if(this.interaction.events.isEnabled("drag")){var e={type:"drag",target:this.interaction,shift:{x:this.x-this.startPoint.x,y:this.y-this.startPoint.y},startPoint:this.startPoint,point:{x:this.x,y:this.y},touch:!1};this.interaction.events.dispatchImmediately("drag",e)}},t.prototype.done=function(){this.interaction.inertias.removeKey(this.type),"move"===this.type&&ap().processDragStop(this.interaction),this.dispose()},t}(hc),ep=new(function(){function e(){}return e.prototype.getEventKey=function(e){var t;switch(e.keyCode||e.which){case 38:t="up";break;case 40:t="down";break;case 37:t="left";break;case 39:t="right";break;case 13:t="enter";break;case 27:t="esc";break;case 36:case 36:t="home";break;case 35:case 35:t="end";break;case 9:t="tab";break;case 17:t="ctrl";break;case 18:t="alt";break;case 16:t="shift";break;case 32:t="space";break;case 33:t="pgup";break;case 34:t="pgdn";break;case 45:t="ins";break;case 46:t="del";break;case 107:t="plus";break;case 109:t="minus";break;default:t="other"}return t},e.prototype.isKey=function(e,t){var i=this.getEventKey(e);return sl(t)&&(t=[t]),-1!==t.indexOf(i)},e.prototype.shiftKey=function(e){return e.shiftKey},e.prototype.ctrlKey=function(e){return e.ctrlKey},e.prototype.altKey=function(e){return e.altKey},e.prototype.metaKey=function(e){return e.metaKey},e}());function tp(){return(new Date).getTime()}function ip(e,t){return new Date(e.toLocaleString("en-US",{timeZone:t}))}var np=function(e){function t(){var i=e.call(this)||this;return i._globalEventsAdded=!1,i._pointerEvents={pointerdown:"mousedown",pointerup:"mouseup",pointermove:"mousemove",pointercancel:"mouseup",pointerover:"mouseover",pointerout:"mouseout",wheel:"wheel"},i._usePointerEventsOnly=!1,i._useTouchEventsOnly=!1,i._addHoverEvents=!0,i._passiveSupported=!1,i._delayedEvents={out:[]},i.overObjects=new Wu,i.downObjects=new Wu,i.trackedObjects=new Wu,i.transformedObjects=new Wu,i.pointers=new Lu,i.inertiaOptions=new Lu,i.hitOptions={doubleHitTime:300,hitTolerance:10,noFocus:!0},i.hoverOptions={touchOutBehavior:"leave",touchOutDelay:1e3},i.swipeOptions={time:500,verticalThreshold:75,horizontalThreshold:30},i.keyboardOptions={speed:.1,accelleration:1.2,accellerationDelay:2e3},i.mouseOptions={sensitivity:1},i.className="Interaction",i.body=i.getInteraction(document.body),i._disposers.push(i.body),window.hasOwnProperty("PointerEvent")?(i._pointerEvents.pointerdown="pointerdown",i._pointerEvents.pointerup="pointerup",i._pointerEvents.pointermove="pointermove",i._pointerEvents.pointercancel="pointercancel",i._pointerEvents.pointerover="pointerover",i._pointerEvents.pointerout="pointerout"):window.hasOwnProperty("MSPointerEvent")?(i._pointerEvents.pointerdown="MSPointerDown",i._pointerEvents.pointerup="MSPointerUp",i._pointerEvents.pointermove="MSPointerMove",i._pointerEvents.pointercancel="MSPointerUp",i._pointerEvents.pointerover="MSPointerOver",i._pointerEvents.pointerout="MSPointerOut"):"undefined"!==typeof matchMedia&&matchMedia("(pointer:fine)").matches?"ontouchstart"in window&&(i._addHoverEvents=!1,i._useTouchEventsOnly=!0):window.navigator.userAgent.match(/MSIE /)||i.fullFF()?i._usePointerEventsOnly=!0:i._useTouchEventsOnly=!0,"onwheel"in document.createElement("div")?i._pointerEvents.wheel="wheel":nl(document.onmousewheel)&&(i._pointerEvents.wheel="mousewheel"),i.inertiaOptions.setKey("move",{time:100,duration:500,factor:1,easing:sh}),i.inertiaOptions.setKey("resize",{time:100,duration:500,factor:1,easing:sh}),i._passiveSupported=t.passiveSupported,i.applyTheme(),i}return Us(t,e),t.prototype.fullFF=function(){return window.navigator.userAgent.match(/Firefox/)&&!window.navigator.userAgent.match(/Android/)},t.prototype.debug=function(){},t.prototype.addGlobalEvents=function(){var e=this;this._globalEventsAdded||(this._useTouchEventsOnly||(this._disposers.push(Ih(document,this._pointerEvents.pointerdown,(function(t){e.handleGlobalPointerDown(t)}))),this._disposers.push(Ih(document,this._pointerEvents.pointermove,(function(t){e.handleGlobalPointerMove(t)}))),this._disposers.push(Ih(document,this._pointerEvents.pointerup,(function(t){e.handleGlobalPointerUp(t)}))),this._disposers.push(Ih(document,this._pointerEvents.pointercancel,(function(t){e.handleGlobalPointerUp(t,!0)}))),this._disposers.push(Ih(document,"mouseenter",(function(t){nl(t.relatedTarget)||0!=t.buttons&&0!=t.which||e.handleDocumentLeave(t)})))),this._usePointerEventsOnly||(this._disposers.push(Ih(document,"touchstart",(function(t){e.handleGlobalTouchStart(t)}))),this._disposers.push(Ih(document,"touchmove",(function(t){e.handleGlobalTouchMove(t)}))),this._disposers.push(Ih(document,"touchend",(function(t){e.handleGlobalTouchEnd(t)})))),this._disposers.push(Ih(document,"keydown",(function(t){e.handleGlobalKeyDown(t)}))),this._disposers.push(Ih(document,"keyup",(function(t){e.handleGlobalKeyUp(t)}))),this._globalEventsAdded=!0)},t.prototype.processClickable=function(e){this.processTouchable(e)},t.prototype.processContextMenu=function(e){e.contextMenuDisabled?e.eventDisposers.hasKey("contextMenuDisabled")||e.eventDisposers.setKey("contextMenuDisabled",Ih(e.element,"contextmenu",(function(e){e.preventDefault()}))):e.eventDisposers.hasKey("contextMenuDisabled")&&e.eventDisposers.getKey("contextMenuDisabled").dispose()},t.prototype.processHoverable=function(e){var t=this;if(e.hoverable||e.trackable)this.addGlobalEvents(),this.applyCursorOverStyle(e),!e.eventDisposers.hasKey("hoverable")&&this._addHoverEvents&&e.eventDisposers.setKey("hoverable",new tu([Ih(e.element,this._pointerEvents.pointerout,(function(i){return t.handlePointerOut(e,i)})),Ih(e.element,this._pointerEvents.pointerover,(function(i){return t.handlePointerOver(e,i)}))])),e.trackable;else{var i=e.eventDisposers.getKey("hoverable");null!=i&&(i.dispose(),e.eventDisposers.removeKey("hoverable"))}this.processTouchable(e)},t.prototype.processMovable=function(e){(e.draggable||e.swipeable||e.trackable||e.resizable)&&(this.isGlobalElement(e)||e.isTouchProtected||this.prepElement(e),this.applyCursorOverStyle(e)),this.processTouchable(e)},t.prototype.processTrackable=function(e){this.processHoverable(e),this.processMovable(e),e.trackable?this.trackedObjects.moveValue(e):this.trackedObjects.removeValue(e)},t.prototype.processDraggable=function(e){this.processMovable(e)},t.prototype.processSwipeable=function(e){this.processMovable(e)},t.prototype.processResizable=function(e){this.processMovable(e)},t.prototype.processWheelable=function(e){var t=this;if(e.wheelable)e.eventDisposers.hasKey("wheelable")||e.eventDisposers.setKey("wheelable",new tu([Ih(e.element,this._pointerEvents.wheel,(function(i){return t.handleMouseWheel(e,i)}),!!this._passiveSupported&&{passive:!1}),e.events.on("out",(function(i){e.wheelable&&t.unlockWheel()})),e.events.on("over",(function(i){e.wheelable&&t.lockWheel()}))]));else{var i=e.eventDisposers.getKey("wheelable");null!=i&&(i.dispose(),e.eventDisposers.removeKey("wheelable"))}},t.prototype.processFocusable=function(e){var t=this;if(!0===e.focusable&&e.tabindex>-1&&!this._useTouchEventsOnly)e.eventDisposers.hasKey("focusable")||e.eventDisposers.setKey("focusable",new tu([Ih(e.element,"focus",(function(i){return t.handleFocus(e,i)})),Ih(e.element,"blur",(function(i){return t.handleBlur(e,i)})),Ih(e.element,this._pointerEvents.pointerdown,(function(i){return t.handleFocusBlur(e,i)})),Ih(e.element,"touchstart",(function(i){return t.handleFocusBlur(e,i)}),!!this._passiveSupported&&{passive:!1})]));else{var i=e.eventDisposers.getKey("focusable");null!=i&&(i.dispose(),e.eventDisposers.removeKey("focusable"))}},t.prototype.processTouchable=function(e){var t=this;if(e.clickable||e.hoverable||e.trackable||e.draggable||e.swipeable||e.resizable)this.addGlobalEvents(),e.eventDisposers.hasKey("touchable")||(this._useTouchEventsOnly||this._usePointerEventsOnly?this._useTouchEventsOnly?this._usePointerEventsOnly||e.eventDisposers.setKey("touchable",Ih(e.element,"touchstart",(function(i){return t.handleTouchDown(e,i)}),!!this._passiveSupported&&{passive:!1})):e.eventDisposers.setKey("touchable",Ih(e.element,this._pointerEvents.pointerdown,(function(i){return t.handlePointerDown(e,i)}))):e.eventDisposers.setKey("touchable",new tu([Ih(e.element,this._pointerEvents.pointerdown,(function(i){return t.handlePointerDown(e,i)})),Ih(e.element,"touchstart",(function(i){return t.handleTouchDown(e,i)}),!!this._passiveSupported&&{passive:!1})])));else{var i=e.eventDisposers.getKey("touchable");null!=i&&(i.dispose(),e.eventDisposers.removeKey("touchable"))}},t.prototype.handleFocus=function(e,t){if(e.focusable){if(e.isFocused=!0,e.events.isEnabled("focus")&&!Zp.isPaused){var i={type:"focus",target:e,event:t};e.events.dispatchImmediately("focus",i)}}else t.preventDefault()},t.prototype.handleFocusBlur=function(e,t){!1!==e.focusable&&this.getHitOption(e,"noFocus")&&e.events.once("focus",(function(){e.events.disableType("blur"),Rh(),e.sprite&&e.sprite.handleBlur(),e.events.enableType("blur")}))},t.prototype.handleBlur=function(e,t){if(e.focusable){if(e.isFocused=!1,e.events.isEnabled("blur")&&!Zp.isPaused){var i={type:"blur",target:e,event:t};e.events.dispatchImmediately("blur",i)}}else t.preventDefault()},t.prototype.handleGlobalKeyDown=function(e){if(this.focusedObject)if(ep.isKey(e,"esc"))Rh();else if(this.focusedObject.draggable&&ep.isKey(e,["up","down","left","right"])){e.preventDefault();var t=this.focusedObject,i="interactionKeyboardObject";if(t.eventDisposers.hasKey(i))return;var n=new Jh(t,e);switch(t.eventDisposers.setKey(i,n),ep.getEventKey(e)){case"up":n.directionY=-1;break;case"down":n.directionY=1;break;case"left":n.directionX=-1;break;case"right":n.directionX=1}}},t.prototype.handleGlobalKeyUp=function(e){var t="interactionKeyboardObject";if(this.focusedObject){var i=this.focusedObject.eventDisposers.getKey(t);null!=i&&(e.preventDefault(),i.dispose(),this.focusedObject.eventDisposers.removeKey(t)),ep.isKey(e,"enter")&&this.focusedObject.sprite&&!this.focusedObject.sprite.events.isEnabled("toggled")&&(this.focusedObject.sprite.events.isEnabled("hit")?this.focusedObject.dispatchImmediately("hit"):"hit"==this.focusedObject.sprite.showTooltipOn&&this.focusedObject.dispatchImmediately("up"))}},t.prototype.handleGlobalPointerMove=function(e){var t=this.getPointer(e);if(t.point=this.getPointerPoint(e),this.events.isEnabled("track")&&!Zp.isPaused){var i={type:"track",target:this,event:e,pointer:t,touch:t.touch};this.events.dispatchImmediately("track",i)}this.addBreadCrumb(t,t.point),this.handleGlobalMove(t,e)},t.prototype.handleGlobalPointerDown=function(e){this.processDelayed();var t=this.getPointer(e);if(this.events.isEnabled("down")&&!Zp.isPaused){var i={type:"down",target:this,event:e,pointer:t,touch:t.touch};this.events.dispatchImmediately("down",i)}},t.prototype.preventTouchAction=function(e){e.defaultPrevented||e.preventDefault()},t.prototype.handleGlobalPointerUp=function(e,t){void 0===t&&(t=!1);var i=this.getPointer(e);if(this.events.isEnabled("up")&&!Zp.isPaused){var n={type:"up",target:this,event:e,pointer:i,touch:i.touch};this.events.dispatchImmediately("up",n)}this.handleGlobalUp(i,e,t)},t.prototype.handleGlobalTouchMove=function(e){for(var t=0;t<e.changedTouches.length;t++){var i=this.getPointer(e.changedTouches[t]);if(i.point=this.getPointerPoint(e.changedTouches[t]),this.events.isEnabled("track")&&!Zp.isPaused){var n={type:"track",target:this,event:e,pointer:i,touch:i.touch};this.events.dispatchImmediately("track",n)}this.addBreadCrumb(i,i.point),this.handleGlobalMove(i,e)}},t.prototype.handleGlobalTouchStart=function(e){this.processDelayed();for(var t=0;t<e.changedTouches.length;t++){var i=this.getPointer(e.changedTouches[t]);if(!this._usePointerEventsOnly&&this.events.isEnabled("down")&&!Zp.isPaused){var n={type:"down",target:this,event:e,pointer:i,touch:i.touch};this.events.dispatchImmediately("down",n)}}},t.prototype.handleGlobalTouchEnd=function(e){for(var t=0;t<e.changedTouches.length;t++){var i=this.getPointer(e.changedTouches[t]);if(this.events.isEnabled("up")&&!Zp.isPaused){var n={type:"up",target:this,event:e,pointer:i,touch:i.touch};this.events.dispatchImmediately("up",n)}this.handleGlobalUp(i,e)}},t.prototype.handlePointerDown=function(e,t){var i=this.getPointer(t);(i.touch||1==t.which||3==t.which)&&(i.button=t.which,this.resetPointer(i,t),this.handleDown(e,i,t))},t.prototype.handlePointerOver=function(e,t){var i=this.getPointer(t);this.handleOver(e,i,t)},t.prototype.handlePointerOut=function(e,t){var i=this.getPointer(t);this.handleOut(e,i,t)},t.prototype.handleMouseWheel=function(e,t){var i=this.getPointer(t);i.point=this.getPointerPoint(t);var n=0,r=0,a=1;if(1==t.deltaMode&&(a=50),a*=this.getMouseOption(e,"sensitivity"),!(t instanceof WheelEvent))throw new Error("Invalid event type");n=Math.round(-1*t.wheelDeltaX||t.deltaX*a),r=Math.round(-1*t.wheelDeltaY||t.deltaY*a),this.handleWheel(e,i,n,r,t)},t.prototype.handleTouchDown=function(e,t){for(var i=0;i<t.changedTouches.length;i++){var n=this.getPointer(t.changedTouches[i]);this.maybePreventDefault(e,t,n),this.resetPointer(n,t.changedTouches[i]),this.handleDown(e,n,t)}},t.prototype.handleHit=function(e,t,i){var n=tp();if(e.lastHit&&e.lastHit>=n-this.getHitOption(e,"doubleHitTime")){if(n-e.lastHit<100)return;if(e.lastHit=void 0,e.lastHitPointer=void 0,e.events.isEnabled("doublehit")&&!Zp.isPaused){var r={type:"doublehit",target:e,point:t.point,event:i,touch:t.touch};e.events.dispatchImmediately("doublehit",r)}}else if(e.lastHit=n,e.lastHitPointer=t,3===t.button){if(e.events.isEnabled("rightclick")&&!Zp.isPaused){r={type:"rightclick",target:e,event:i};e.events.dispatchImmediately("rightclick",r)}}else if(e.events.isEnabled("hit")&&!Zp.isPaused){r={type:"hit",target:e,event:i,point:t.point,touch:t.touch};e.events.dispatchImmediately("hit",r)}},t.prototype.handleOver=function(e,t,i,n){if(void 0===n&&(n=!1),e.hoverable){var r=!1;if(this.shouldCancelHovers(t)&&this.areTransformed()&&this.moved(t,this.getHitOption(e,"hitTolerance"))&&(r=!0,this.cancelAllHovers(i)),this.processDelayed(),e.overPointers.moveValue(t),!e.isRealHover&&(r||(e.isHover=!0,e.isRealHover=!0,this.overObjects.moveValue(e)),this.handleTrack(this.body,t,i,!0),e.events.isEnabled("over")&&!Zp.isPaused&&!r)){var a={type:"over",target:e,event:i,pointer:t,touch:t.touch};e.events.dispatchImmediately("over",a)}}},t.prototype.handleOut=function(e,t,i,n,r){var a=this;if(void 0===n&&(n=!1),void 0===r&&(r=!1),e.hoverable&&(e.overPointers.removeValue(t),e.isHover&&(!e.hasDelayedOut||r))){if(n&&e.overPointers.length)return;if(t&&t.touch&&!r&&!this.old(t)){var o=this.getHoverOption(e,"touchOutBehavior");if("leave"==o)return this._delayedEvents.out.push({type:"out",io:e,pointer:t,event:i,keepUntil:tp()+500}),void(e.hasDelayedOut=!0);if("delay"==o&&this.getHoverOption(e,"touchOutDelay"))return void this._delayedEvents.out.push({type:"out",io:e,pointer:t,event:i,keepUntil:tp()+500,timeout:this.setTimeout((function(){a.handleOut(e,t,i,!0)}),this.getHoverOption(e,"touchOutDelay"))})}if(e.isHover=!1,this.overObjects.removeValue(e),!e.isDisposed()&&e.events.isEnabled("out")&&!Zp.isPaused){var s={type:"out",target:e,event:i,pointer:t,touch:t.touch};e.events.dispatchImmediately("out",s)}e.overPointers.clear(),e.hasDelayedOut=!1}},t.prototype.processDelayed=function(){for(var e;e=this._delayedEvents.out.pop();)e.timeout&&e.timeout.dispose(),this.handleOut(e.io,e.pointer,e.event,!1,!0)},t.prototype.handleDown=function(e,t,i){if(this.maybePreventDefault(e,i,t),e.inert&&this.stopInertia(e),this.handleOver(e,t,i,!0),e.downPointers.moveValue(t),this.applyCursorDownStyle(e,t),e.isDown||(!1!==e.focusable&&this.getHitOption(e,"noFocus")&&this.focusedObject&&Rh(),e.isDown=!0,this.downObjects.moveValue(e),e.draggable&&this.processDragStart(e,t,i),e.resizable&&this.processResizeStart(e,t,i)),e.events.isEnabled("down")&&!Zp.isPaused){var n={type:"down",target:e,event:i,pointer:t,touch:t.touch};e.events.dispatchImmediately("down",n)}},t.prototype.handleGlobalUp=function(e,t,i){var n=this;void 0===i&&(i=!1);var r=this.downObjects.values.slice();r.sort((function(e,t){if(e&&t){var i=e.element.compareDocumentPosition(t.element);return i&Node.DOCUMENT_POSITION_CONTAINED_BY?1:i&Node.DOCUMENT_POSITION_CONTAINS?-1:0}return 0})),Nl(r,(function(r){r&&r.downPointers.contains(e)&&n.handleUp(r,e,t,i)}))},t.prototype.handleDocumentLeave=function(e){var t=this;Tu(this.downObjects.backwards().iterator(),(function(i){i.downPointers.each((function(n){t.handleUp(i,n,e)}))}))},t.prototype.handleUp=function(e,t,i,n){if(void 0===n&&(n=!1),this.restoreCursorDownStyle(e,t),e.downPointers.removeValue(t),(t.touch||this._useTouchEventsOnly)&&this.handleOut(e,t,i,!0),e.isDown){if(0==e.downPointers.length&&(e.isDown=!1,this.downObjects.removeValue(e)),e.events.isEnabled("up")&&!Zp.isPaused){var r={type:"up",target:e,event:i,pointer:t,touch:t.touch};e.events.dispatchImmediately("up",r)}n||(e.swipeable&&this.swiped(e,t)?this.handleSwipe(e,t,i):(e.clickable&&!this.moved(t,this.getHitOption(e,"hitTolerance"))&&this.handleHit(e,t,i),e.inert&&this.moved(t,this.getHitOption(e,"hitTolerance"))?this.handleInertia(e,t):e.draggable&&this.processDragStop(e,t,i),e.resizable&&this.processResizeStop(e,t,i)))}},t.prototype.maybePreventDefault=function(e,t,i){!nl(t)||!(e.draggable||e.swipeable||e.trackable||e.resizable)||this.isGlobalElement(e)||!1===t.cancelable||e.isTouchProtected&&i&&i.touch||t.preventDefault()},t.prototype.cancelAllHovers=function(e){var t=this;Tu(this.overObjects.backwards().iterator(),(function(i){if(i){var n=i.overPointers.getIndex(0);t.handleOut(i,n,e,!0,!0)}}))},t.prototype.shouldCancelHovers=function(e){return"always"==_h.disableHoverOnTransform||"touch"==_h.disableHoverOnTransform&&e.touch},t.prototype.handleGlobalMove=function(e,t){var i,n=this;if(!e.touch){var r="function"===typeof(i=e.lastEvent).composedPath?i.composedPath()[0]:i.target;Tu(this.overObjects.backwards().iterator(),(function(i){if(i&&i.overPointers.contains(e)&&i.hoverable){var a=!1;i.element&&e.lastEvent&&Fh(i.element,r)||(a=!0),a&&n.handleOut(i,e,t,!0)}}))}Tu(this.transformedObjects.backwards().iterator(),(function(i){!i.downPointers.contains(e)||i.swipeable&&n.swiping(i,e)||!i.draggable&&!i.resizable||n.handleTransform(i,t)})),Tu(this.trackedObjects.backwards().iterator(),(function(i){i.overPointers.contains(e)||n.handleTrack(i,e,t)}))},t.prototype.handleTrack=function(e,t,i,n){if(void 0===n&&(n=!1),(n||this.moved(t,0))&&e.events.isEnabled("track")&&!Zp.isPaused){var r={type:"track",target:e,event:i,point:t.point,pointer:t,touch:t.touch};e.events.dispatchImmediately("track",r)}},t.prototype.handleSwipe=function(e,t,i){if(e.events.isEnabled("swipe")&&!Zp.isPaused){var n={type:"swipe",target:e,event:i,touch:t.touch};e.events.dispatchImmediately("swipe",n)}if(t.startPoint.x<t.point.x){if(e.events.isEnabled("swiperight")&&!Zp.isPaused){n={type:"swiperight",target:e,event:i,touch:t.touch};e.events.dispatchImmediately("swiperight",n)}}else if(e.events.isEnabled("swipeleft")&&!Zp.isPaused){n={type:"swipeleft",target:e,event:i,touch:t.touch};e.events.dispatchImmediately("swipeleft",n)}},t.prototype.handleWheel=function(e,t,i,n,r){var a={x:i,y:n};e.events.isEnabled("wheel")&&!Zp.isPaused&&e.events.dispatchImmediately("wheel",{type:"wheel",target:e,event:r,point:t.point,shift:a}),i<0?e.events.isEnabled("wheelleft")&&!Zp.isPaused&&e.events.dispatchImmediately("wheelleft",{type:"wheelleft",target:e,event:r,point:t.point,shift:a}):i>0?e.events.isEnabled("swiperight")&&!Zp.isPaused&&e.events.dispatchImmediately("wheelright",{type:"wheelright",target:e,event:r,point:t.point,shift:a}):n<0?e.events.isEnabled("wheelup")&&!Zp.isPaused&&e.events.dispatchImmediately("wheelup",{type:"wheelup",target:e,event:r,point:t.point,shift:a}):n>0&&e.events.isEnabled("wheeldown")&&!Zp.isPaused&&e.events.dispatchImmediately("wheeldown",{type:"wheeldown",target:e,event:r,point:t.point,shift:a})},t.prototype.handleInertia=function(e,t){e.draggable&&0===e.downPointers.length&&this.handleMoveInertia(e,t),e.resizable&&e.downPointers.length>1&&this.handleResizeInertia(e,t)},t.prototype.handleMoveInertia=function(e,t){var i=e,n={x:t.point.x,y:t.point.y},r={x:t.startPoint.x,y:t.startPoint.y},a=new Qh(i,"move",n,r),o=this.getTrailPoint(t,tp()-this.getInertiaOption(e,"move","time"));if("undefined"!==typeof o){var s=this.getInertiaOption(e,"move","factor"),l=[{to:t.point.x+(t.point.x-o.point.x)*s,property:"x"},{to:t.point.y+(t.point.y-o.point.y)*s,property:"y"}],u=new Th(a,l,this.getInertiaOption(e,"move","duration"),this.getInertiaOption(e,"move","easing")).start();this._disposers.push(u.events.on("animationended",(function(e){a.done()}))),e.inertias.setKey("move",a)}else this.processDragStop(e,t,t.lastUpEvent)},t.prototype.handleResizeInertia=function(e,t){},t.prototype.handleTransform=function(e,t){var i,n,r,a=e.downPointers.getIndex(0),o=null,s=null;a&&(o=a.point,s=a.startPoint),r=n={x:e.originalPosition.x,y:e.originalPosition.y};for(var l=!0,u=1;u<e.downPointers.length;u++){var c=e.downPointers.getIndex(u);if(s.x!=c.startPoint.x&&s.y!=c.startPoint.y){l=!1,n=(i=c).point,r=i.startPoint;break}}var h=a&&this.moved(a,0);if(e.draggable&&a&&a.dragStartEvents&&a.dragStartEvents.length&&h&&e.events.isEnabled("dragstart")&&!Zp.isPaused&&e.events.dispatchImmediately("dragstart",a.dragStartEvents.shift()),l&&e.draggable)this.handleTransformMove(e,o,s,t,h,a.touch),this.shouldCancelHovers(a)&&this.moved(a,this.getHitOption(e,"hitTolerance"))&&this.cancelAllHovers(t);else{var p=i&&this.moved(i,0);(this.shouldCancelHovers(a)&&this.moved(a,this.getHitOption(e,"hitTolerance"))||this.shouldCancelHovers(i)&&this.moved(i,this.getHitOption(e,"hitTolerance")))&&this.cancelAllHovers(t),e.draggable&&e.resizable?(this.handleTransformMove(e,o,s,t,h&&p,a.touch),this.handleTransformResize(e,o,s,n,r,t,h&&p,a.touch)):(e.draggable&&this.handleTransformMove(e,o,s,t,h,a.touch),!e.resizable||l&&!t.ctrlKey||this.handleTransformResize(e,o,s,n,r,t,h&&p,a.touch))}},t.prototype.handleTransformMove=function(e,t,i,n,r,a){if(r&&e.events.isEnabled("drag")&&!Zp.isPaused&&(!e.isTouchProtected||!a)){var o={type:"drag",target:e,event:n,shift:{x:t.x-i.x,y:t.y-i.y},startPoint:i,point:t,touch:a};e.events.dispatchImmediately("drag",o)}},t.prototype.handleTransformResize=function(e,t,i,n,r,a,o,s){if(e.events.isEnabled("resize")&&!Zp.isPaused&&(!e.isTouchProtected||!s)){var l={type:"resize",target:e,event:a,scale:Tl(t,i,n,r),startPoint1:i,point1:t,startPoint2:r,point2:n,touch:s};e.events.dispatchImmediately("resize",l)}},t.prototype.processDragStart=function(e,t,i){this.transformedObjects.moveValue(e),this.shouldCancelHovers(t)&&this.cancelAllHovers(i);var n={type:"dragstart",target:e,event:i,touch:!!t&&t.touch};t&&(t.dragTarget=e),t&&t.dragStartEvents?t.dragStartEvents.push(n):Zp.isPaused||e.dispatchImmediately("dragstart",n)},t.prototype.processDragStop=function(e,t,i){if(t||(t=this.getDragPointer(e)),t&&(t.dragTarget=void 0),this.transformedObjects.removeValue(e),(!t||this.moved(t,0))&&e.events.isEnabled("dragstop")&&!Zp.isPaused){var n={type:"dragstop",target:e,touch:!!t&&t.touch};e.events.dispatchImmediately("dragstop",n)}},t.prototype.processResizeStart=function(e,t,i){this.transformedObjects.moveValue(e)},t.prototype.processResizeStop=function(e,t,i){this.transformedObjects.removeValue(e)},t.prototype.dragStart=function(e,t){t||(t=this.getDragPointer(e)),t&&this.handleDown(e,t,t.lastDownEvent)},t.prototype.dragStop=function(e,t,i){t||(t=this.getDragPointer(e)),t&&!i&&this.handleGlobalUp(t,t.lastUpEvent,i)},t.prototype.getDragPointer=function(e){return e?e.downPointers.getIndex(0):this.transformedObjects.length?this.getDragPointer(this.transformedObjects.getIndex(0)):void 0},t.prototype.getPointerId=function(e){return(nl(e.identifier)?""+e.identifier:nl(e.pointerId)?""+e.pointerId:"m").replace("-","")},t.prototype.getPointerPoint=function(e){return{x:e.clientX,y:e.clientY}},t.prototype.getPointer=function(e){var t,i=this.getPointerId(e),n=this.getPointerPoint(e);return this.pointers.hasKey(i)?(t=this.pointers.getKey(i)).touch=this.isPointerTouch(e):(t={id:i,touch:this.isPointerTouch(e),startPoint:n,startTime:tp(),point:n,track:[],swipeCanceled:!1,dragStartEvents:[]},this.addBreadCrumb(t,n),this.pointers.setKey(i,t)),t.lastEvent=e,this.lastPointer=t,t},t.prototype.isPointerTouch=function(e){if("undefined"!==typeof Touch&&e instanceof Touch)return!0;if("undefined"!==typeof PointerEvent&&e instanceof PointerEvent&&nl(e.pointerType))switch(e.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(e instanceof MouseEvent)}else if(nl(e.type)&&e.type.match(/^mouse/))return!1;return!0},t.prototype.resetPointer=function(e,t){var i=this.getPointerPoint(t);e.startTime=tp(),e.startPoint={x:i.x,y:i.y},e.point={x:i.x,y:i.y},e.track=[],e.swipeCanceled=!1},t.prototype.addBreadCrumb=function(e,t){e.track.push({timestamp:tp(),point:t})},t.prototype.lockDocument=function(){this.prepElement(this.body)},t.prototype.unlockDocument=function(){0==this.transformedObjects.length&&this.restoreAllStyles(this.body)},t.prototype.lockElement=function(e){this.prepElement(e)},t.prototype.unlockElement=function(e){this.restoreAllStyles(e)},t.prototype.lockWheel=function(){window.addEventListener(this._pointerEvents.wheel,this.wheelLockEvent,!!this._passiveSupported&&{passive:!1})},t.prototype.unlockWheel=function(){window.removeEventListener(this._pointerEvents.wheel,this.wheelLockEvent)},t.prototype.isLocalElement=function(e,t,i){var n=this.getCache("local_pointer_"+e.id);if(nl(n))return n;var r=Bh(t)||document;if(r.elementFromPoint){var a=r.elementFromPoint(e.point.x,e.point.y),o=a&&Fh(t,a);return this.setCache("local_pointer_"+e.id+"_"+i,o,100),o}return!1},t.prototype.wheelLockEvent=function(e){return e.preventDefault(),!1},t.prototype.prepElement=function(e){var t=e.element;if(t){for(var i=["touchAction","webkitTouchAction","MozTouchAction","MSTouchAction","msTouchAction","oTouchAction","userSelect","webkitUserSelect","MozUserSelect","MSUserSelect","msUserSelect","oUserSelect","touchSelect","webkitTouchSelect","MozTouchSelect","MSTouchSelect","msTouchSelect","oTouchSelect","touchCallout","webkitTouchCallout","MozTouchCallout","MSTouchCallout","msTouchCallout","oTouchCallout","contentZooming","webkitContentZooming","MozContentZooming","MSContentZooming","msContentZooming","oContentZooming","userDrag","webkitUserDrag","MozUserDrag","MSUserDrag","msUserDrag","oUserDrag"],n=0;n<i.length;n++)i[n]in t.style&&this.setTemporaryStyle(e,i[n],"none");this.setTemporaryStyle(e,"tapHighlightColor","rgba(0, 0, 0, 0)")}},t.prototype.unprepElement=function(e){var t=e.element;if(t){for(var i=["touchAction","webkitTouchAction","MozTouchAction","MSTouchAction","msTouchAction","oTouchAction","userSelect","webkitUserSelect","MozUserSelect","MSUserSelect","msUserSelect","oUserSelect","touchSelect","webkitTouchSelect","MozTouchSelect","MSTouchSelect","msTouchSelect","oTouchSelect","touchCallout","webkitTouchCallout","MozTouchCallout","MSTouchCallout","msTouchCallout","oTouchCallout","contentZooming","webkitContentZooming","MozContentZooming","MSContentZooming","msContentZooming","oContentZooming","userDrag","webkitUserDrag","MozUserDrag","MSUserDrag","msUserDrag","oUserDrag"],n=0;n<i.length;n++)i[n]in t.style&&this.restoreStyle(e,i[n]);this.restoreStyle(e,"tapHighlightColor")}},t.prototype.getHitOption=function(e,t){var i=e.hitOptions[t];return"undefined"===typeof i&&(i=this.hitOptions[t]),i},t.prototype.getHoverOption=function(e,t){var i=e.hoverOptions[t];return"undefined"===typeof i&&(i=this.hoverOptions[t]),i},t.prototype.getSwipeOption=function(e,t){var i=e.swipeOptions[t];return"undefined"===typeof i&&(i=this.swipeOptions[t]),i},t.prototype.getKeyboardOption=function(e,t){var i=e.keyboardOptions[t];return"undefined"===typeof i&&(i=this.keyboardOptions[t]),i},t.prototype.getMouseOption=function(e,t){var i=e.mouseOptions[t];return"undefined"===typeof i&&(i=this.mouseOptions[t]),i},t.prototype.getInertiaOption=function(e,t,i){var n=e.inertiaOptions.getKey(t);return n&&nl(n[i])?n[i]:this.inertiaOptions.getKey(t)[i]},t.prototype.stopInertia=function(e){for(var t,i=["move","resize"],n=0;n<i.length;n++)if(t=i[n],e.inertias.hasKey(t)){var r=e.inertias.getKey(t);if(r){r.dispose();continue}}},t.prototype.swiping=function(e,t){var i=tp();return!(t.swipeCanceled||!e.swipeable)&&(Math.abs(t.startPoint.y-t.point.y)<this.getSwipeOption(e,"verticalThreshold")&&t.startTime>i-this.getSwipeOption(e,"time"))},t.prototype.swiped=function(e,t){var i=tp();return!t.swipeCanceled&&(Math.abs(t.startPoint.x-t.point.x)>this.getSwipeOption(e,"horizontalThreshold")&&Math.abs(t.startPoint.y-t.point.y)<this.getSwipeOption(e,"verticalThreshold")&&t.startTime>i-this.getSwipeOption(e,"time"))},t.prototype.applyCursorOverStyle=function(e){var t=e.cursorOptions;if(nl(t.overStyle))for(var i=0;i<t.overStyle.length;i++)Lh(e.element,t.overStyle[i].property,t.overStyle[i].value)},t.prototype.applyCursorDownStyle=function(e,t){if(!t||!t.touch){var i=e.cursorOptions.downStyle;if(e.downPointers.contains(t)&&nl(i))for(var n=0;n<i.length;n++)this.setTemporaryStyle(this.body,i[n].property,i[n].value),this.setTemporaryStyle(e,i[n].property,i[n].value)}},t.prototype.restoreCursorDownStyle=function(e,t){if(!t||!t.touch){var i=e.cursorOptions.downStyle;if(e.downPointers.contains(t)&&nl(i))for(var n=0;n<i.length;n++)this.restoreStyle(this.body,i[n].property),this.restoreStyle(e,i[n].property)}},t.prototype.setGlobalStyle=function(e){for(var t=ap().body,i=cl(e)?e:[e],n=0;n<i.length;n++)this.setTemporaryStyle(t,i[n].property,i[n].value)},t.prototype.restoreGlobalStyle=function(e){for(var t=ap().body,i=cl(e)?e:[e],n=0;n<i.length;n++)this.restoreStyle(t,i[n].property)},t.prototype.isGlobalElement=function(e){return document.body===e.element},t.prototype.moved=function(e,t,i){void 0===i&&(i=300);var n=this.getShift(e);return Math.abs(n.x)>t||Math.abs(n.y)>t},t.prototype.old=function(e,t){return void 0===t&&(t=300),tp()-e.startTime>t},t.prototype.getShift=function(e){return{x:e.startPoint.x-e.point.x,y:e.startPoint.y-e.point.y}},t.prototype.getTrailPoint=function(e,t){for(var i,n=0;n<e.track.length;n++)if(e.track[n].timestamp>=t){i=e.track[n];break}return i},t.prototype.pointerExists=function(e,t){var i=!1;return e.each((function(e){e!=t&&(i=e.point.x==t.point.x&&e.point.y==t.point.y)})),i},t.prototype.getInteraction=function(e){return new $h(e)},t.prototype.setTemporaryStyle=function(e,t,i){var n=e.element;nl(n.style[t])&&!e.replacedStyles.hasKey(t)&&e.replacedStyles.setKey(t,n.style[t]),Lh(n,t,i)},t.prototype.restoreStyle=function(e,t){e.replacedStyles.hasKey(t)?(e.element.style[t]=e.replacedStyles.getKey(t),e.replacedStyles.removeKey(t)):delete e.element.style[t]},t.prototype.restoreAllStyles=function(e){Tu(e.replacedStyles.iterator(),(function(t){var i=t[0],n=t[1];e.element.style[i]=n,e.replacedStyles.removeKey(i)}))},t.prototype.dispose=function(){this.isDisposed()||(e.prototype.dispose.call(this),this.restoreAllStyles(this.body),this.unlockWheel())},t.prototype.log=function(e,t,i){if(t.changedTouches)for(var n=0;n<t.changedTouches.length;n++)this.logTouch(e,t.type,t.changedTouches[n]);else{var r="";if(t.pointerType)switch(t.pointerType){case 2:r="touch";break;case 4:r="mouse";break;default:r=t.pointerType}else r="undefined"!=typeof TouchEvent&&t instanceof TouchEvent?"touch":t.type.match(/^mouse/)?"mouse":"???";var a="";a=nl(t.identifier)?t.identifier:nl(t.pointerId)?t.pointerId:"???",i?console.log(e+" ("+i.uid+")  "+t.type+"  "+r+"  "+a):console.log(e+"  "+t.type+"  "+r+"  "+a)}},t.prototype.areTransformed=function(e){var t=this.transformedObjects.length;if(e)for(var i=cl(e)?e:[e],n=0;n<i.length;n++)this.transformedObjects.contains(i[n])&&t--;return t>0},t.prototype.logTouch=function(e,t,i){console.log(e+"  "+t+"  touch  "+i.identifier)},Object.defineProperty(t,"passiveSupported",{get:function(){var e=this;if(null==this._passiveSupported)try{var t=Object.defineProperty({},"passive",{get:function(){e._passiveSupported=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(i){this._passiveSupported=!1}return this._passiveSupported},enumerable:!0,configurable:!0}),t}(pc),rp=null;function ap(){return null==rp&&(rp=new np),rp}var op=function(e){function t(){var t=e.call(this)||this;return t.adapter=new ec(t),t._elements={},t._IOs={},t._content="",t._title="",t._classPrefix="ampopup",t._defaultStyles=!0,t._showCurtain=!1,t._draggable=!0,t._align="center",t._dynamicResize=!0,t._verticalAlign="middle",t._shift={x:0,y:0},t._tempShift={x:0,y:0},t._readerTitle="",t._closable=!0,t._cssLoaded=!1,t._fitTo="window",t.isTemplate=!1,t._sized=!1,t.className="Popup",t}return Us(t,e),t.prototype.open=function(){this.container&&(this._elements.wrapper&&this.container.appendChild(this._elements.wrapper),this._elements.curtain&&(this.container.appendChild(this._elements.curtain),this.showCurtain=this.showCurtain),this.positionElement(),this.dispatchImmediately("opened"))},t.prototype.close=function(){this._elements.wrapper&&this._elements.wrapper.parentElement&&this._elements.wrapper.parentElement.removeChild(this._elements.wrapper),this._elements.curtain&&this._elements.curtain.parentElement&&this._elements.curtain.parentElement.removeChild(this._elements.curtain),this.dispatchImmediately("closed"),this.releasePointers()},t.prototype.dispose=function(){this.close(),e.prototype.dispose.call(this)},t.prototype.positionElement=function(e){var t=this;void 0===e&&(e=!0),this._elements.wrapper&&setTimeout((function(){if(t._elements.wrapper){if(e||!t._sized){t._elements.wrapper.style.opacity="0.01",t._elements.wrapper.style.left="0",t._elements.wrapper.style.top="0",t._elements.wrapper.style.margin="0 0 0 0",t._elements.wrapper.style.width="",t._elements.wrapper.style.height="";var i=t._elements.wrapper.getBoundingClientRect();t._elements.wrapper.style.width=i.width+"px",t._elements.wrapper.style.height=i.height+"px",t._sized=!0}if(t.dynamicResize)for(var n=t._elements.wrapper.getElementsByTagName("img"),r=0;r<n.length;r++){var a=n[r];if(!a.complete){a.addEventListener("load",(function(){t.positionElement(!0)}));break}}setTimeout((function(){if(t._elements.wrapper){var i;switch(!e&&t._sized||!t._bbox?(i=t._elements.wrapper.getBoundingClientRect(),t._elements.wrapper.style.opacity=""):i=t._bbox,t.align){case"left":t._elements.wrapper.style.left="0",t._elements.wrapper.style.right="auto",t._elements.wrapper.style.marginLeft=t.toStyle(t._shift.x+t._tempShift.x);break;case"center":t._elements.wrapper.style.left="50%",t._elements.wrapper.style.right="auto",t._elements.wrapper.style.marginLeft=t.toStyle(Math.round(-i.width/2)+(t._shift.x+t._tempShift.x));break;case"right":t._elements.wrapper.style.left="auto",t._elements.wrapper.style.right="0",t._elements.wrapper.style.marginLeft=t.toStyle(t._shift.x+t._tempShift.x);break;default:t._elements.wrapper.style.left=t.toStyle(t.left)||"auto",t._elements.wrapper.style.right=t.toStyle(t.right)||"auto",t._elements.wrapper.style.marginLeft=t.toStyle(t._shift.x+t._tempShift.x)}switch(t.verticalAlign){case"top":t._elements.wrapper.style.top="0",t._elements.wrapper.style.bottom="auto",t._elements.wrapper.style.marginTop=t.toStyle(t._shift.y+t._tempShift.y);break;case"middle":t._elements.wrapper.style.top="50%",t._elements.wrapper.style.bottom="auto",t._elements.wrapper.style.marginTop=t.toStyle(Math.round(-i.height/2)+(t._shift.y+t._tempShift.y));break;case"bottom":t._elements.wrapper.style.top="auto",t._elements.wrapper.style.bottom="0",t._elements.wrapper.style.marginTop=t.toStyle(t._shift.y+t._tempShift.y);break;default:t._elements.wrapper.style.top=t.toStyle(t.top)||"auto",t._elements.wrapper.style.bottom=t.toStyle(t.bottom)||"auto",t._elements.wrapper.style.marginTop=t.toStyle(t._shift.y+t._tempShift.y)}}}),1)}}),1)},t.prototype.setupDragging=function(){var e=this;this.draggable?(this._IOs.header.events.has("drag")||this._IOs.header.events.on("drag",(function(t){e._tempShift.x=t.shift.x,e._tempShift.y=t.shift.y,e.positionElement(!1)})),this._IOs.header.events.has("dragstop")||this._IOs.header.events.on("dragstop",(function(t){e._shift.x+=e._tempShift.x,e._shift.y+=e._tempShift.y,e._tempShift.x=0,e._tempShift.y=0,e.positionElement(!1)}))):this._IOs.header&&(ap().unprepElement(this._IOs.header),this._IOs.header.events.has("drag")&&this._IOs.header.events.off("drag"),this._IOs.header.events.has("dragstop")&&this._IOs.header.events.off("dragstop"))},t.prototype.toStyle=function(e){return nl(e)?ll(e)?e+"px":e.toString():null},Object.defineProperty(t.prototype,"classPrefix",{get:function(){return this.adapter.apply("classPrefix",this._classPrefix)},set:function(e){this._classPrefix=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classPrefixRaw",{get:function(){return this._classPrefix},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.adapter.apply("content",this._content)},set:function(e){this._content!=e&&(this._content=e,this._elements.content||this.createContentElement(),this._elements.content.innerHTML=e,this.positionElement())},enumerable:!0,configurable:!0}),t.prototype.getClassNames=function(){return this.adapter.apply("classNames",{wrapperClass:this.classPrefix+"",headerClass:this.classPrefix+"-header",titleClass:this.classPrefix+"-title",contentClass:this.classPrefix+"-content",insideClass:this.classPrefix+"-inside",curtainClass:this.classPrefix+"-curtain",closeClass:this.classPrefix+"-close"})},t.prototype.createContentElement=function(){if(!this._elements.wrapper){var e=this.getClassNames(),t=document.createElement("div");t.className=e.contentClass,t.style.opacity="0.01";var i=document.createElement("a");i.className=e.closeClass;var n=document.createElement("div");n.className=e.headerClass;var r=document.createElement("div");r.innerHTML=this.title,r.className=e.titleClass,this.title||(r.style.display="none");var a=document.createElement("div");a.className=e.insideClass,a.innerHTML=this.content,this._IOs.wrapper=ap().getInteraction(t),this._IOs.header=ap().getInteraction(n),this._disposers.push(this._IOs.wrapper),this._IOs.wrapper.events.on("over",this.disablePointers,this),this._IOs.wrapper.events.on("out",this.releasePointers,this),this._IOs.close=ap().getInteraction(i),this._disposers.push(this._IOs.close),i.style.visibility="hidden",t.setAttribute("role","dialog"),n.appendChild(i),n.appendChild(r),t.appendChild(n),t.appendChild(a),this.container.appendChild(t),this._elements.wrapper=t,this._elements.header=n,this._elements.content=a,this._elements.title=r,this._elements.close=i,this.defaultStyles&&this.loadDefaultCSS(),this.createCurtainElement(),this.applyEvents(),this.applyReaderSettings(),this.setupDragging()}},Object.defineProperty(t.prototype,"title",{get:function(){return this.adapter.apply("title",this._title)},set:function(e){this._title!=e&&(this._title=e,this._elements.content||this.createContentElement(),this._elements.title.innerHTML=e,this.positionElement(),this.applyReaderSettings())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerTitle",{get:function(){return this.adapter.apply("readerTitle",""!=this._readerTitle?this._readerTitle:this.title)},set:function(e){this._readerTitle!=e&&(this._readerTitle=e,this.applyReaderSettings())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closable",{get:function(){return this.adapter.apply("closable",this._closable)},set:function(e){e!==this._closable&&(this._closable=e,this.applyEvents())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitTo",{get:function(){return this.adapter.apply("fitTo",this._fitTo)},set:function(e){e!=this._fitTo&&(this._fitTo=e,this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyles",{get:function(){return this.adapter.apply("defaultStyles",this._defaultStyles)},set:function(e){this._defaultStyles!=e&&(this._defaultStyles=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCurtain",{get:function(){return this.adapter.apply("showCurtain",this._showCurtain)},set:function(e){this._showCurtain!=e&&(this._showCurtain=e,this._elements.curtain&&(this._elements.curtain.style.display=e?"block":"none"))},enumerable:!0,configurable:!0}),t.prototype.createCurtainElement=function(){var e=this.getClassNames(),t=document.createElement("div");t.className=e.curtainClass,this.container.appendChild(t),this._IOs.curtain=ap().getInteraction(t),this._disposers.push(this._IOs.curtain),this._IOs.curtain.events.on("over",this.disablePointers,this),this._IOs.curtain.events.on("out",this.releasePointers,this),t.style.display=this.showCurtain?"block":"none",this._elements.curtain=t},Object.defineProperty(t.prototype,"draggable",{get:function(){return this.adapter.apply("draggable",this._draggable)},set:function(e){this._draggable!=e&&(this._draggable=e,this.setupDragging())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dynamicResize",{get:function(){return this.adapter.apply("dynamicResize",this._dynamicResize)},set:function(e){this._dynamicResize!=e&&(this._dynamicResize=e,this.positionElement(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.adapter.apply("align",this._align)},set:function(e){this._align!=e&&(this._align=e,this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlign",{get:function(){return this.adapter.apply("verticalAlign",this._verticalAlign)},set:function(e){this._verticalAlign!=e&&(this._verticalAlign=e,this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.adapter.apply("left",this._left)},set:function(e){this.left!=e&&(this._left=e,this._align="none",this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.adapter.apply("right",this._right)},set:function(e){this.right!=e&&(this._right=e,this._align="none",this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.adapter.apply("top",this._top)},set:function(e){this.top!=e&&(this._top=e,this._verticalAlign="none",this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.adapter.apply("bottom",this._bottom)},set:function(e){this.bottom!=e&&(this._bottom=e,this._verticalAlign="none",this.positionElement())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),t.prototype.loadDefaultCSS=function(){this._cssLoaded||(this._disposers.push(function(e,t){t||(t="ampopup");var i=new Xh,n=i.getFor("text"),r=i.getFor("background");r.alpha=.8;var a=i.getFor("alternativeBackground");return a.alpha=.05,Kh.insertKeyIfEmpty(t,(function(){var i=new tu([new Nh(e,"."+t,{overflow:"visible",position:"absolute",top:"0",left:"0","z-index":"2000"}),new Nh(e,"."+t+"-curtain",{width:"100%",height:"100%",position:"absolute",top:"0",left:"0","z-index":"2001","background-color":r.hex,opacity:"0.5"}),new Nh(e,"."+t+"-header",{display:"block",width:"100%","min-height":"1.8em",background:a.rgba}),new Nh(e,"."+t+"-title",{"font-weight":"bold","font-size":"110%",padding:"0.5em 1.2em 0.5em 1em"}),new Nh(e,"."+t+"-content",{background:r.hex,"background-color":r.rgba,color:n.hex,display:"inline-block",position:"absolute",top:"0",left:"0","max-width":"90%","max-height":"90%",overflow:"auto","z-index":"2002"}),new Nh(e,"."+t+"-inside",{padding:"1em"}),new Nh(e,"."+t+"-close",{display:"block",position:"absolute",top:"0.3em",right:"0.3em","background-color":"rgb(100, 100, 100)",background:"rgba(100, 100, 100, 0.1) url(data:image/svg+xml;charset=utf-8;base64,PHN2ZyBoZWlnaHQ9IjUxMiIgdmVyc2lvbj0iMSIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHdpZHRoPSI1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQ0NS4yIDEwOS4ybC00Mi40LTQyLjRMMjU2IDIxMy42IDEwOS4yIDY2LjhsLTQyLjQgNDIuNEwyMTMuNiAyNTYgNjYuOCA0MDIuOGw0Mi40IDQyLjRMMjU2IDI5OC40bDE0Ni44IDE0Ni44IDQyLjQtNDIuNEwyOTguNCAyNTYiLz48L3N2Zz4=) no-repeat center","background-size":"80%",width:"1.2em",height:"1.2em",cursor:"pointer"})]);return new nu((function(){Kh.removeKey(t),i.dispose()}))})).increment()}(jh(this.container),this.classPrefix)),gu(this._elements,(function(e,t){t.style.display=""})),this._cssLoaded=!0)},t.prototype.applyEvents=function(){var e=this;if(this._IOs.close)if(this.closable){this._IOs.close.element.style.visibility="visible";var t=[ap().body.events.on("keyup",(function(t){ep.isKey(t.event,"esc")&&e.closable&&e.close()})),this._IOs.close.events.on("hit",(function(t){e.close()}))];t.push(this._IOs.curtain.events.on("hit",(function(t){e.showCurtain&&e.closable&&e.close()}))),this._disposers.push(new tu(t))}else this._IOs.close.element.style.visibility="hidden"},t.prototype.disablePointers=function(){this.sprite&&(this._spriteInteractionsEnabled=this.sprite.interactionsEnabled,this.sprite.interactionsEnabled=!1)},t.prototype.releasePointers=function(){nl(this._spriteInteractionsEnabled)&&(this.sprite.interactionsEnabled=this._spriteInteractionsEnabled,this._spriteInteractionsEnabled=void 0)},t.prototype.applyReaderSettings=function(){this.elements.wrapper.setAttribute("aria-label",this.readerTitle)},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.container=t.container,this.sprite=t.sprite,this.classPrefix=t.classPrefixRaw,this.content=t.content,this.title=t.title,this.readerTitle=t.readerTitle,this.defaultStyles=t.defaultStyles,this.showCurtain=t.showCurtain,this.align=t.align,this.verticalAlign=t.verticalAlign,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.adapter.copyFrom(t.adapter)},t}(pc),sp=function(e){function t(){var t=e.call(this)||this;return t.adapter=new ec(t),t.className="Modal",t.showCurtain=!0,t.draggable=!1,t}return Us(t,e),t}(op);function lp(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_h.suppressWarnings||console&&console.warn.apply(console,qs(e))}var up=function(){function e(){var e=this;this._targets=[],this._observer=new ResizeObserver((function(t){Nl(t,(function(t){Nl(e._targets,(function(e){e.target===t.target&&e.callback()}))}))}))}return e.prototype.addTarget=function(e,t){this._observer.observe(e,{box:"content-box"}),this._targets.push({target:e,callback:t})},e.prototype.removeTarget=function(e){this._observer.unobserve(e),Ql(this._targets,(function(t){return t.target!==e}))},e}(),cp=function(){function e(){this._targets=[]}return e.prototype.addTarget=function(t,i){var n=this;if(0===this._targets.length){var r=null;this._timer=requestAnimationFrame((function t(){var i=Date.now();(null===r||i>r+e.delay)&&(r=i,Nl(n._targets,(function(e){var t=e.target.getBoundingClientRect();t.width===e.size.width&&t.height===e.size.height||(e.size=t,e.callback())}))),n._timer=requestAnimationFrame(t)}))}var a=t.getBoundingClientRect();this._targets.push({target:t,callback:i,size:a})},e.prototype.removeTarget=function(e){Ql(this._targets,(function(t){return t.target!==e})),0===this._targets.length&&cancelAnimationFrame(this._timer)},e.delay=200,e}(),hp=null;var pp=function(){function e(e,t){this._disposed=!1,this._sensor=(null===hp&&(hp="undefined"!==typeof ResizeObserver?new up:new cp),hp),this._element=e,this._sensor.addTarget(e,t)}return e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element))},Object.defineProperty(e.prototype,"sensor",{get:function(){return this._sensor},enumerable:!0,configurable:!0}),e.prototype.reset=function(){lp("resizeSensor.reset() is no longer needed and can be removed")},e}(),dp=[],fp=function(){function e(e,t){var i=this;this._disposed=!1,this.autoResize=!0,this.nonExportableSprites=[],this._disposers=[],this.cssScale=1,this._printing=!1,this.htmlElement=e,t||(this._printing=!1,this.initSensor(),this._disposers.push(Ih(window,"beforeprint",(function(){i._printing=!0}))),this._disposers.push(Ih(window,"afterprint",(function(){i._printing=!1})))),dp.push(this);var n=document.createElement("div"),r=n.style;r.width="100%",r.height="100%",r.position="relative",e.appendChild(n),this.SVGContainer=n}return e.prototype.initSensor=function(){var e=this;this.resizeSensor&&this.resizeSensor.dispose();this.resizeSensor=new pp(this.htmlElement,(function(){e.autoResize&&!e._printing&&e.measure()})),this._disposers.push(this.resizeSensor)},e.prototype.measure=function(){var e=function(e){var t=getComputedStyle(e),i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),n=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth);return e.clientWidth-i-n}(this.htmlElement),t=function(e){var t=getComputedStyle(e),i=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth);return e.clientHeight-i-n}(this.htmlElement),i=this.container;i&&(this.width==e&&this.height==t||(this.width=e,this.height=t,e>0&&(i.maxWidth=e),t>0&&(i.maxHeight=t),Vh(this.SVGContainer)),i.maxWidth||(i.maxWidth=0),i.maxHeight||(i.maxHeight=0),this.cssScale=1,this.checkTransform(this.htmlElement))},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},set:function(e){this._container=e,this.measure()},enumerable:!0,configurable:!0}),e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){this._disposed||Gl(dp,this),Nl(this._disposers,(function(e){e.dispose()}))},Object.defineProperty(e.prototype,"hideOverflow",{set:function(e){this.SVGContainer.style.overflow=e?"hidden":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modal",{get:function(){return nl(this._modal)||(this._modal=new sp,this._modal.container=this.SVGContainer,this._disposers.push(this._modal)),this._modal},enumerable:!0,configurable:!0}),e.prototype.openModal=function(e,t){this.closeModal();var i=this.modal;return i.content=e,i.readerTitle=t||"",i.title=t||"",i.open(),i},e.prototype.closeModal=function(){this._modal&&this.modal.close()},Object.defineProperty(e.prototype,"popups",{get:function(){if(!nl(this._popups)){var e=new op;e.container=this.SVGContainer,this._popups=new Hu(e),this._disposers.push(new Uu(this._popups)),this._disposers.push(this._popups.template)}return this._popups},enumerable:!0,configurable:!0}),e.prototype.openPopup=function(e,t){var i=this.popups.create();return i.content=e,nl(t)&&(i.title=t),i.open(),i},e.prototype.closeAllPopups=function(){this.popups.each((function(e){e.close()}))},Object.defineProperty(e.prototype,"readerAlertElement",{get:function(){if(!nl(this._readerAlertElement)){var e=document.createElement("div");e.setAttribute("role","alert"),e.style.zIndex="-100000",e.style.opacity="0",e.style.position="absolute",e.style.top="0",this.SVGContainer.appendChild(e),this._readerAlertElement=e}return this._readerAlertElement},enumerable:!0,configurable:!0}),e.prototype.readerAlert=function(e){this.readerAlertElement.innerHTML=e},e.prototype.checkTransform=function(e){if(window.getComputedStyle){if(e&&e.style){var t=window.getComputedStyle(e,null);if(t){var i=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(i&&"none"!==i){var n=i.split("(")[1].split(")")[0].split(","),r=Number(n[0]),a=Number(n[1]),o=Math.sqrt(r*r+a*a);isNaN(o)||(this.cssScale*=o)}}}e.parentNode&&e.parentNode instanceof HTMLElement&&this.checkTransform(e.parentNode)}},e}(),mp=function(){function e(e,t){this.container=e,this.id=t;var i=document.createElementNS(Eh,"svg");i.setAttribute("version","1.1"),i.setAttributeNS(Ch,"xmlns",Eh),i.setAttributeNS(Ch,"xmlns:xlink",Mh),i.setAttribute("role","group"),this.container.appendChild(i),this.defs=document.createElementNS(Eh,"defs"),i.appendChild(this.defs),i.style.width="100%",i.style.height="100%",i.style.overflow="visible",this.svg=i}return e.prototype.add=function(e){return new Zh(e)},e.prototype.addGroup=function(e){return new qh(e)},e.prototype.append=function(e){e&&this.svg.appendChild(e.node)},e.prototype.appendDef=function(e){e&&this.defs.appendChild(e.node)},e.prototype.foreignObject=function(){return new Zh("foreignObject")},e.prototype.supportsForeignObject=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Extensibility","1.1")},e}(),vp=null;function yp(){if(null===vp){var e=document.createElement("div");e.hidden=!0,e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.zIndex="-1000000",document.body.appendChild(e);var t=new fp(e,!0);vp=new mp(t.SVGContainer,"ghost")}return vp}var gp=function(e){function t(){var t=e.call(this)||this;t._elements=new Wu,t.properties={},t.className="Pattern",t.width=10,t.height=10,t.x=0,t.y=0,t.patternUnits="userSpaceOnUse";var i=new Xh;return t.backgroundFill=i.getFor("background"),t.backgroundOpacity=0,t.fillOpacity=1,t.fill=i.getFor("alternativeBackground"),t.stroke=i.getFor("alternativeBackground"),t.strokeOpacity=1,t.strokeWidth=1,t.shapeRendering="crispEdges",t.rotation=0,t.element=t.paper.addGroup("pattern"),t.id="pattern-"+Bu.getUniqueId(),t.element.attr({id:t.id}),t._disposers.push(t.element),t._disposers.push(new Uu(t._elements)),t.patternUnits=t.patternUnits,t.width=t.width,t.height=t.height,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){var e=this,t=this.element;if(t){t.removeChildNodes();var i=this.paper.add("rect");i.attr({width:this.width,height:this.height,"shape-rendering":"crispEdges",fill:this.backgroundFill.hex,"fill-opacity":this.backgroundOpacity,stroke:this.backgroundFill.hex,"stroke-opacity":0}),t.add(i),t.attr({x:this.x,y:this.y,width:this.width,height:this.height,stroke:this.stroke.hex,fill:this.fill.hex,"fill-opacity":this.fillOpacity,"stroke-opacity":this.strokeOpacity,"stroke-width":this.strokeWidth,"shape-rendering":this.shapeRendering,patternUnits:this.patternUnits,"stroke-dasharray":this.strokeDasharray}),Tu(this._elements.iterator(),(function(t){t.rotation=e.rotation,t.rotationX=e.properties.rotationX,t.rotationY=e.properties.rotationY,e.element.add(t)}))}},t.prototype.animate=function(e,t,i){return new Th(this,e,t,i).start()},t.prototype.addElement=function(e){this._elements.push(e),this._disposers.push(e)},t.prototype.removeElement=function(e){this._elements.removeValue(e),this.removeDispose(e)},Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillOpacity",{get:function(){return this.properties.fillOpacity},set:function(e){this.properties.fillOpacity=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this.properties.fill},set:function(e){this.properties.fill=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundFill",{get:function(){return this.properties.backgroundFill},set:function(e){this.properties.backgroundFill=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundOpacity",{get:function(){return this.properties.backgroundOpacity},set:function(e){this.properties.backgroundOpacity=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this.properties.stroke},set:function(e){this.properties.stroke=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeOpacity",{get:function(){return this.properties.strokeOpacity},set:function(e){this.properties.strokeOpacity=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return this.properties.strokeWidth},set:function(e){this.properties.strokeWidth=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shapeRendering",{get:function(){return this.properties.shapeRendering},set:function(e){this.properties.shapeRendering=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.properties.rotation},set:function(e){this.properties.rotation=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"patternUnits",{get:function(){return this.properties.patternUnits},set:function(e){this.properties.patternUnits=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.properties.width},set:function(e){this.properties.width=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.properties.height},set:function(e){this.properties.height=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.properties.x},set:function(e){this.properties.x=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.properties.y},set:function(e){this.properties.y=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paper",{get:function(){return this._paper?this._paper:yp()},set:function(e){this._paper!=e&&(this._paper=e,this.draw(),e.appendDef(this.element))},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){var i=this;e.prototype.copyFrom.call(this,t),gu(t.properties,(function(e,t){i[e]=t}))},Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations||(this._animations=[],this._disposers.push(new Sh(this._animations))),this._animations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeDasharray",{get:function(){return this.properties.strokeDashArray},set:function(e){this.properties.strokeDashArray=e,this.draw()},enumerable:!0,configurable:!0}),t.prototype.processConfig=function(t){if(t&&nl(t.elements)&&cl(t.elements))for(var i=0,n=t.elements.length;i<n;i++){var r=t.elements[i];if(nl(r.type)){var a=this.createEntryInstance(r);a instanceof hc&&(a.config=r),this.addElement(nl(r.typeProperty)?a[r.typeProperty]:a.element)}}e.prototype.processConfig.call(this,t)},t}(hc);Bu.registeredClasses.Pattern=gp;var _p=function(e){function t(){var t=e.call(this)||this;return t._stops=new Wu,t._rotation=0,t.className="LinearGradient",t._stops.events.on("setIndex",t.validate,t),t._stops.events.on("inserted",t.validate,t),t.element=t.paper.addGroup("linearGradient"),t.id="gradient-"+Bu.getUniqueId(),t.element.attr({id:t.id}),t._disposers.push(t.element),t.applyTheme(),t}return Us(t,e),t.prototype.validate=function(){var e=this,t=(this._rotation+90)*dl,i=Math.round(50+50*Math.sin(t+Math.PI))+"%",n=Math.round(50+50*Math.cos(t))+"%",r=Math.round(50+50*Math.sin(t))+"%",a=Math.round(50+50*Math.cos(t+Math.PI))+"%",o=this.element;o.removeChildNodes(),o.attr({x1:i,x2:r,y1:n,y2:a}),Tu(Cu(this._stops.iterator()),(function(t){var i=t[0],n=t[1],r=n.offset;ll(r)||(r=i/(e._stops.length-1));var a=e.paper.add("stop");nl(n.color)&&a.attr({"stop-color":n.color.toString()}),ll(n.opacity)&&a.attr({"stop-opacity":n.opacity}),ll(r)&&a.attr({offset:r}),o.add(a)}))},t.prototype.clear=function(){this._stops.clear()},t.prototype.addColor=function(e,t,i){this._stops.push({color:e,opacity:t,offset:i})},Object.defineProperty(t.prototype,"stops",{get:function(){return this._stops},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paper",{get:function(){return this._paper?this._paper:yp()},set:function(e){this._paper!=e&&(this._paper=e,this.validate(),e.appendDef(this.element))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this.validate()},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.stops.copyFrom(t.stops),this._rotation=t.rotation},Object.defineProperty(t.prototype,"gradientUnits",{set:function(e){this.element.attr({gradientUnits:e})},enumerable:!0,configurable:!0}),t}(hc);Bu.registeredClasses.LinearGradient=_p;var bp=function(e){function t(){var t=e.call(this)||this;return t._stops=new Wu,t.element=t.paper.addGroup("radialGradient"),t.id="gradient-"+Bu.getUniqueId(),t.element.attr({id:t.id}),t._disposers.push(t.element),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){var e,t=this,i=this.element;ll(this.cx)&&((e=this.cx)instanceof Xs&&(e=e.percent+"%"),i.attr({cx:e}));ll(this.cy)&&((e=this.cy)instanceof Xs&&(e=e.percent+"%"),i.attr({cy:e}));this.fx&&((e=this.fx)instanceof Xs&&(e=e.percent+"%"),i.attr({fx:e}));this.fy&&((e=this.fy)instanceof Xs&&(e=e.percent+"%"),i.attr({fy:e}));i.removeChildNodes(),Tu(Cu(this._stops.iterator()),(function(e){var n=e[0],r=e[1],a=r.offset;ll(a)||(a=n/(t._stops.length-1));var o=t.paper.add("stop");nl(r.color)&&o.attr({"stop-color":r.color.toString()}),ll(r.opacity)&&o.attr({"stop-opacity":r.opacity}),ll(a)&&o.attr({offset:a}),i.add(o)}))},t.prototype.addColor=function(e,t,i){this._stops.push({color:e,opacity:t,offset:i}),this.draw()},Object.defineProperty(t.prototype,"paper",{get:function(){return this._paper?this._paper:yp()},set:function(e){this._paper!=e&&(this._paper=e,this.draw(),e.appendDef(this.element))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cx",{get:function(){return this._cx},set:function(e){this._cx=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cy",{get:function(){return this._cy},set:function(e){this._cy=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fx",{get:function(){return this._fx},set:function(e){this._fx=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fy",{get:function(){return this._fy},set:function(e){this._fy=e,this.draw()},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.stops.copyFrom(t.stops),this.cx=t.cx,this.cy=t.cy,this.fx=t.fx,this.fy=t.fy},Object.defineProperty(t.prototype,"stops",{get:function(){return this._stops},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._stops.clear()},t}(hc);Bu.registeredClasses.RadialGradient=bp;var xp,wp=function(){function e(){}return e.grab=[{property:"cursor",value:"move"},{property:"cursor",value:"grab"},{property:"cursor",value:"-webkit-grab"}],e.grabbing=[{property:"cursor",value:"move"},{property:"cursor",value:"grabbing"},{property:"cursor",value:"-webkit-grabbing"}],e.pointer=[{property:"cursor",value:"pointer"}],e.default=[{property:"cursor",value:"default"}],e.horizontalResize=[{property:"cursor",value:"ew-resize"}],e.verticalResize=[{property:"cursor",value:"ns-resize"}],e.notAllowed=[{property:"cursor",value:"not-allowed"}],e.text=[{property:"cursor",value:"text"}],e}(),kp={_decimalSeparator:".",_thousandSeparator:",",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"\u03bc",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_second:"HH:mm:ss",_date_minute:"HH:mm",_date_hour:"HH:mm",_date_day:"MMM dd",_date_week:"ww",_date_month:"MMM",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(e){var t="th";if(e<11||e>13)switch(e%10){case 1:t="st";break;case 2:t="nd";break;case 3:t="rd"}return t},"Zoom Out":"",Play:"",Stop:"",Legend:"","Click, tap or press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Click, tap or press ENTER to open":"","Click, tap or press ENTER to print.":"","Click, tap or press ENTER to export as %1.":"",'To save the image, right-click this link and choose "Save picture as..."':"",'To save the image, right-click thumbnail on the left and choose "Save picture as..."':"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""},Pp=function(e){function t(){var t=e.call(this)||this;return t.adapter=new ec(t),t._locale=kp,t._defaultLocale=kp,t.className="Language",nl(_h.defaultLocale)&&(t.locale=_h.defaultLocale),t.applyTheme(),t}return Us(t,e),t.prototype.getLocale=function(e){return null==e&&(e=this._locale),this.adapter.apply("locale",{locale:e}).locale},t.prototype.translate=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t=this.getLocale(t);var r=e,a=this.getTranslations(t),o=a[e];if(null===o)o="";else if(nl(o))o&&(r=o);else if(t!==this._defaultLocale)return this.translate.apply(this,qs([e,this._defaultLocale],i));if(i.length)for(var s=i.length,l=0;l<s;++l)r=r.split("%"+(l+1)).join(i[l]);return this.adapter.apply("translate",{translation:r,locale:t}).translation},t.prototype.translateAny=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this.translate.apply(this,qs([e,t],i))},t.prototype.setTranslationAny=function(e,t,i){(i||this.locale)[e]=t},t.prototype.translateEmpty=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=this.translate.apply(this,qs([e,t],i));return r==e?"":r},t.prototype.translateFunc=function(e,t){t=this.getLocale(t);var i=this.getTranslations(t)[e];return null!=i?i:t!==this._defaultLocale?this.translateFunc(e,this._defaultLocale):function(){return""}},t.prototype.translateAll=function(e,t){var i=this;return this.isDefault()?e:Vl(e,(function(e){return i.translate(e,t)}))},t.prototype.isDefault=function(){return this._defaultLocale===this._locale},Object.defineProperty(t.prototype,"locale",{get:function(){return this._locale},set:function(e){if(this._locale!=e&&(this._locale=e,this.events.isEnabled("localechanged"))){var t={type:"localechanged",locale:e,target:this};this.events.dispatchImmediately("localechanged",t)}},enumerable:!0,configurable:!0}),t.prototype.getTranslations=function(e){return this.adapter.apply("translations",{translations:e,locale:e}).translations},t}(pc),Sp=function(e){function t(){var t=e.call(this)||this;return t.adapter=new ec(t),t.className="TextFormatter",t.applyTheme(),t}return Us(t,e),t.prototype.debug=function(){},t.prototype.format=function(e,t){nl(t)||(t="svg");var i="",n=(e=this.escape(e)).match(/\[([^\]]*?)\]/gm);if(!n)return this.wrap(e,"",t);for(var r=e.split(/\[[^\[\]]*\]/),a=0,o=r.length;a<o;a++){var s=r[a];if(""!==s){s=this.adapter.apply("chunk",s);var l="";a>0&&(l=n[a-1].replace("[","").replace("]","")),i+=this.wrap(s,l,t)}}return i=this.unescape(i),this.cleanUp(i)},t.prototype.escape=function(e){return e.replace(/\[\[/g,Bu.getPlaceholder("1")).replace(/([^\/\]]{1})\]\]/g,"$1"+Bu.getPlaceholder("2")).replace(/\]\]/g,Bu.getPlaceholder("2")).replace(/\{\{/g,Bu.getPlaceholder("3")).replace(/\}\}/g,Bu.getPlaceholder("4")).replace(/\'\'/g,Bu.getPlaceholder("5"))},t.prototype.unescape=function(e){return e.replace(new RegExp(Bu.getPlaceholder("1"),"g"),"[[").replace(new RegExp(Bu.getPlaceholder("2"),"g"),"]]").replace(new RegExp(Bu.getPlaceholder("3"),"g"),"{{").replace(new RegExp(Bu.getPlaceholder("4"),"g"),"}}").replace(new RegExp(Bu.getPlaceholder("5"),"g"),"''")},t.prototype.cleanUp=function(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")},t.prototype.wrap=function(e,t,i){return""!==t&&"/"!==t||(t=""),"html"===i?this.wrapHtml(e,this.translateStyleShortcuts(t)):this.wrapSvg(e,this.translateStyleShortcuts(t))},t.prototype.wrapSvg=function(e,t){return""===t?"<tspan>"+e+"</tspan>":"<tspan style='"+t+"'>"+e+"</tspan>"},t.prototype.getSvgElement=function(e,t){var i=new Zh("tspan");return i.textContent=e,t&&i.node.setAttribute("style",t),i},t.prototype.wrapHtml=function(e,t){return""===t?"<span>"+e+"</span>":"<span style='"+this.styleSvgToHtml(t)+"'>"+e+"</span>"},t.prototype.getHtmlElement=function(e,t){var i=document.createElement("span");return i.innerHTML=e,t&&i.setAttribute("style",t),i},t.prototype.styleSvgToHtml=function(e){return e=e.replace(/fill:/,"color:")},t.prototype.translateStyleShortcuts=function(e){if(""==e||"[ ]"==e)return"";var t=Bu.getCache("translateStyleShortcuts_"+e);if(t)return t;var i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(var n=0;n<i.length;n++)e=e.replace(i[n],i[n].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));var r=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w]+)|(\/)/gi);if(!r)return e;for(n=0;n<r.length;n++)r[n].match(/^bold$/i)?r[n]="font-weight:"+r[n]:"/"==r[n]?r[n]="":r[n].match(/:/)?r[n]=r[n].replace(/\+/g," "):r[n]="fill:"+r[n];var a=r.join(";");return Bu.setCache("translateStyleShortcuts_"+e,a),a},t.prototype.chunk=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=[];e=this.escape(e);for(var r=t?e.split("'"):[e],a=0;a<r.length;a++){var o=r[a];if(""!==o)if(a%2===0)for(var s=(o=(o=o.replace(/\]\[/g,"]__\xa7\xa7\xa7__[")).replace(/\[\]/g,"[ ]")).split(/[\[\]]+/),l=0;l<s.length;l++){(u=this.cleanUp(this.unescape(s[l])))!==yc&&(""!==u&&(l%2===0?n.push({type:"value",text:this.adapter.apply("chunk",u)}):n.push({type:i?"value":"format",text:"["+u+"]"})))}else for(s=o.split(/[\[\]]+/),l=0;l<s.length;l++){var u;""!==(u=this.cleanUp(this.unescape(s[l])))&&(l%2===0?n.push({type:"text",text:u}):this.isImage(u)?n.push({type:"image",text:"["+u+"]"}):n.push({type:"format",text:"["+u+"]"}))}}return n},t.prototype.isImage=function(e){return!!e.match(/img[ ]?:/)},t}(hc);function Tp(){return null==xp&&(xp=new Sp),xp}Bu.registeredClasses.TextFormatter=Sp;var Ep=function(e){function t(){var t=e.call(this)||this;return t._negativeBase=0,t._numberFormat="#,###.#####",t._outputFormat="svg",t._smallNumberThreshold=1,t._forceLTR=!1,t.className="NumberFormatter",t.applyTheme(),t}return Us(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.language&&this.language.dispose()},Object.defineProperty(t.prototype,"language",{get:function(){return this._language||(this.sprite?this._language=this.sprite.language:this._language=new Pp),this._language},set:function(e){this._language=e},enumerable:!0,configurable:!0}),t.prototype.format=function(e,t,i){var n;("undefined"===typeof t||sl(t)&&"number"===t.toLowerCase())&&(t=this._numberFormat);var r=Number(e);if(ul(t))try{return this.intlLocales?new Intl.NumberFormat(this.intlLocales,t).format(r):new Intl.NumberFormat(void 0,t).format(r)}catch(s){return"Invalid"}else{t=Ac(t);var a=this.parseFormat(t,this.language),o=void 0;o=r>this._negativeBase?a.positive:r<this._negativeBase?a.negative:a.zero,nl(i)&&!o.mod&&(o=function(e){return JSON.parse(JSON.stringify(e))}(o),o.decimals.active=0==r?0:i),n=o.template.split(yc).join(this.applyFormat(r,o))}return this.forceLTR&&(n="\u200e"+n),n},t.prototype.parseFormat=function(e,t){var i=this,n=this.getCache(e);if(nl(n))return n;var r={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:t.translateEmpty("_thousandSeparator")},decimals:{active:-1,passive:-1,separator:t.translateEmpty("_decimalSeparator")},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:t.translateEmpty("_thousandSeparator")},decimals:{active:-1,passive:-1,separator:t.translateEmpty("_decimalSeparator")},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:t.translateEmpty("_thousandSeparator")},decimals:{active:-1,passive:-1,separator:t.translateEmpty("_decimalSeparator")},template:"",source:"",parsed:!1}},a=(e=e.replace("||",gc)).split("|");return r.positive.source=a[0],"undefined"===typeof a[2]?r.zero=r.positive:r.zero.source=a[2],"undefined"===typeof a[1]?r.negative=r.positive:r.negative.source=a[1],gu(r,(function(e,t){if(!t.parsed)if("undefined"===typeof i.getCache(t.source)){var n=t.source;"number"===n.toLowerCase()&&(n=sl(i._numberFormat)?i._numberFormat:"#,###.#####");for(var a=Tp().chunk(n,!0),o=0;o<a.length;o++){var s=a[o];if(s.text=s.text.replace(gc,"|"),"value"===s.type){var l=s.text.match(/[#0.,]+[ ]?[abesABES%!]?[abesABES\u2030!]?/);if(l)if(null===l||""===l[0])t.template+=s.text;else{var u=l[0].match(/[abesABES%\u2030!]{2}|[abesABES%\u2030]{1}$/);u&&(t.mod=u[0].toLowerCase(),t.modSpacing=!!l[0].match(/[ ]{1}[abesABES%\u2030!]{1}$/));var c=l[0].split(".");if(""===c[0]);else{t.thousands.active=(c[0].match(/0/g)||[]).length,t.thousands.passive=(c[0].match(/\#/g)||[]).length+t.thousands.active;var h=c[0].split(",");1===h.length||(t.thousands.interval=rl(h.pop()).length,0===t.thousands.interval&&(t.thousands.interval=-1))}"undefined"===typeof c[1]||(t.decimals.active=(c[1].match(/0/g)||[]).length,t.decimals.passive=(c[1].match(/\#/g)||[]).length+t.decimals.active),t.template+=s.text.split(l[0]).join(yc)}}else t.template+=s.text}i.setCache(t.source,t),t.parsed=!0}else r[e]=i.getCache(t.source)})),this.setCache(e,r),r},t.prototype.applyFormat=function(e,t){var i=e<0;e=Math.abs(e);var n="",r="",a=t.mod?t.mod.split(""):[];if(-1!==a.indexOf("b")){var o=this.applyPrefix(e,this.bytePrefixes,-1!==a.indexOf("!"));e=o[0],n=o[1],r=o[2],t.modSpacing&&(r=" "+r)}else if(-1!==a.indexOf("a")){var s=this.applyPrefix(e,e<this.smallNumberThreshold?this.smallNumberPrefixes:this.bigNumberPrefixes,-1!==a.indexOf("!"));e=s[0],n=s[1],r=s[2],t.modSpacing&&(r=" "+r)}else if(-1!==a.indexOf("%")){var l=wl(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(l)),r="%"}else if(-1!==a.indexOf("\u2030")){l=wl(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(l)),r="\u2030"}if(-1!==a.indexOf("e")){var u=void 0;u=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(u[0]),r="e"+u[1],t.modSpacing&&(r=" "+r)}else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){var c=Math.pow(10,t.decimals.passive);e=Math.round(e*c)/c}var h="",p=function(e){if(Ys(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(0===e&&1/e===-1/0)return"-0";var t=e<0;e=Math.abs(e);var i,n=rl(/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+e)),r=n[1],a=n[2]||"";if(null==n[3])i=""===a?r:r+"."+a;else{var o,s=+n[3];i=e<1?"0."+Du("0",o=s-1)+r+a:0===(o=s-a.length)?r+a:o<0?r+a.slice(0,o)+"."+a.slice(o):r+a+Du("0",o)}return t?"-"+i:i}(e).split("."),d=p[0];if(d.length<t.thousands.active&&(d=Array(t.thousands.active-d.length+1).join("0")+d),t.thousands.interval>0){for(var f=[],m=d.split("").reverse().join(""),v=0,y=d.length;v<=y;v+=t.thousands.interval){var g=m.substr(v,t.thousands.interval).split("").reverse().join("");""!==g&&f.unshift(g)}d=f.join(t.thousands.separator)}h+=d,1===p.length&&p.push("");var _=p[1];return _.length<t.decimals.active&&(_+=Array(t.decimals.active-_.length+1).join("0")),""!==_&&(h+=t.decimals.separator+_),""===h&&(h="0"),0!==e&&i&&-1===a.indexOf("s")&&(h="-"+h),n&&(h=n+h),r&&(h+=r),h},t.prototype.applyPrefix=function(e,t,i){void 0===i&&(i=!1);for(var n=e,r="",a="",o=!1,s=1,l=0,u=t.length;l<u;l++)t[l].number<=e&&(0===t[l].number?n=0:(n=e/t[l].number,s=t[l].number),r=t[l].prefix,a=t[l].suffix,o=!0);return!o&&i&&t.length&&0!=e&&(n=e/t[0].number,r=t[0].prefix,a=t[0].suffix,o=!0),o&&(n=parseFloat(n.toPrecision(wl(s.toString().length+Math.floor(n).toString().replace(/[^0-9]*/g,"").length,21)))),[n,r,a]},t.prototype.invalidateSprite=function(){this.sprite&&this.sprite.invalidate()},Object.defineProperty(t.prototype,"numberFormat",{get:function(){return this._numberFormat},set:function(e){this._numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"intlLocales",{get:function(){return this._intlLocales},set:function(e){this._intlLocales=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"negativeBase",{get:function(){return this._negativeBase},set:function(e){this._negativeBase=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bigNumberPrefixes",{get:function(){return nl(this._bigNumberPrefixes)||(this._bigNumberPrefixes=[{number:1e3,suffix:this.language.translate("_big_number_suffix_3")},{number:1e6,suffix:this.language.translate("_big_number_suffix_6")},{number:1e9,suffix:this.language.translate("_big_number_suffix_9")},{number:1e12,suffix:this.language.translate("_big_number_suffix_12")},{number:1e15,suffix:this.language.translate("_big_number_suffix_15")},{number:1e18,suffix:this.language.translate("_big_number_suffix_18")},{number:1e21,suffix:this.language.translate("_big_number_suffix_21")},{number:1e24,suffix:this.language.translate("_big_number_suffix_24")}]),this._bigNumberPrefixes},set:function(e){this._bigNumberPrefixes=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"smallNumberPrefixes",{get:function(){return nl(this._smallNumberPrefixes)||(this._smallNumberPrefixes=[{number:1e-24,suffix:this.language.translate("_small_number_suffix_24")},{number:1e-21,suffix:this.language.translate("_small_number_suffix_21")},{number:1e-18,suffix:this.language.translate("_small_number_suffix_18")},{number:1e-15,suffix:this.language.translate("_small_number_suffix_15")},{number:1e-12,suffix:this.language.translate("_small_number_suffix_12")},{number:1e-9,suffix:this.language.translate("_small_number_suffix_9")},{number:1e-6,suffix:this.language.translate("_small_number_suffix_6")},{number:.001,suffix:this.language.translate("_small_number_suffix_3")}]),this._smallNumberPrefixes},set:function(e){this._smallNumberPrefixes=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"smallNumberThreshold",{get:function(){return this._smallNumberThreshold},set:function(e){this._smallNumberThreshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytePrefixes",{get:function(){return nl(this._bytePrefixes)||(this._bytePrefixes=[{number:1,suffix:this.language.translate("_byte_suffix_B")},{number:1024,suffix:this.language.translate("_byte_suffix_KB")},{number:1048576,suffix:this.language.translate("_byte_suffix_MB")},{number:1073741824,suffix:this.language.translate("_byte_suffix_GB")},{number:1099511627776,suffix:this.language.translate("_byte_suffix_TB")},{number:0x4000000000000,suffix:this.language.translate("_byte_suffix_PB")}]),this._bytePrefixes},set:function(e){this._bytePrefixes=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return this._outputFormat},set:function(e){this._outputFormat=e.toLowerCase(),this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forceLTR",{get:function(){return this._forceLTR},set:function(e){this._forceLTR=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),t.prototype.escape=function(e){return e.replace("||",gc)},t.prototype.unescape=function(e){return e.replace(gc,"|")},t}(hc);Bu.registeredClasses.NumberFormatter=Ep;var Cp=function(e){function t(){var t=e.call(this)||this;return t._dateFormat="yyyy-MM-dd",t._inputDateFormat="yyyy-MM-dd",t._utc=!1,t.timezoneMinutes=0,t._firstDayOfWeek=1,t.months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.monthsShort=["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t._outputFormat="svg",t.capitalize=!0,t.className="DateFormatter",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"language",{get:function(){return this._language},set:function(e){this._language=e,this.dateFormat=this._language.translate("_date")},enumerable:!0,configurable:!0}),t.prototype.format=function(e,t,i){var n,r;if(this.language||(this.sprite?this.language=this.sprite.language:this.language=new Pp),"undefined"!==typeof t&&""!==t||(t=this._dateFormat),r=sl(e)?this.parse(e):Rc(e),ul(t))try{return this.intlLocales?new Intl.DateTimeFormat(this.intlLocales,t).format(r):new Intl.DateTimeFormat(void 0,t).format(r)}catch(o){return"Invalid"}else{t=Ac(t);var a=this.parseFormat(t);if(nl(this.timezoneOffset)?r.setMinutes(r.getMinutes()+r.getTimezoneOffset()-this.timezoneOffset):nl(this.timezone)&&!1!==i&&(r=ip(r,this.timezone)),!ll(r.getTime()))return this.language.translate("Invalid date");n=this.applyFormat(r,a,this.language),this.capitalize&&(n=n.replace(/^.{1}/,n.substr(0,1).toUpperCase()))}return n},t.prototype.parseFormat=function(e){var t=this.getCache(e);if(nl(t))return t;for(var i={template:"",parts:[]},n=Tp().chunk(e,!0),r=0;r<n.length;r++){var a=n[r];if("value"===a.type){a.text.match(/^date$/i)&&sl(this._dateFormat)&&(a.text=this._dateFormat);var o=a.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(o)for(var s=0;s<o.length;s++)i.parts.push(o[s]),a.text=a.text.replace(o[s],yc)}i.template+=a.text}return this.setCache(e,i),i},t.prototype.applyFormat=function(e,t,i){var n,r,a,o,s,l,u,c,h=t.template,p=e.getTimezoneOffset(),d=e.getTime();this.utc?(n=e.getUTCFullYear(),r=e.getUTCMonth(),a=e.getUTCDay(),o=e.getUTCDate(),s=e.getUTCHours(),l=e.getUTCMinutes(),u=e.getUTCSeconds(),c=e.getUTCMilliseconds()):(n=e.getFullYear(),r=e.getMonth(),a=e.getDay(),o=e.getDate(),s=e.getHours(),l=e.getMinutes(),u=e.getSeconds(),c=e.getMilliseconds());for(var f=0,m=t.parts.length;f<m;f++){var v="";switch(t.parts[f]){case"G":v=i.translate(n<0?"_era_bc":"_era_ad");break;case"yyyy":v=Math.abs(n).toString(),n<0&&(v+=i.translate("_era_bc"));break;case"yyy":case"yy":case"y":v=Math.abs(n).toString().substr(-t.parts[f].length),n<0&&(v+=i.translate("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":var y=n;1==Bc(e)&&a>4&&y--,v="YYYY"==t.parts[f]?Math.abs(y).toString():Math.abs(y).toString().substr(-t.parts[f].length),y<0&&(v+=i.translate("_era_bc"));break;case"u":case"F":case"g":break;case"q":v=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":v=i.translate(this.months[r]).substr(0,1);break;case"MMMM":v=i.translate(this.months[r]);break;case"MMM":v=i.translate(this.monthsShort[r]);break;case"MM":v=Dc(r+1,2,"0");break;case"M":v=(r+1).toString();break;case"ww":v=Dc(Bc(e,this.utc),2,"0");break;case"w":v=Bc(e,this.utc).toString();break;case"W":v=Vc(e,this.utc).toString();break;case"dd":v=Dc(o,2,"0");break;case"d":v=o.toString();break;case"DD":case"DDD":v=Dc(jc(e,this.utc).toString(),t.parts[f].length,"0");break;case"D":v=jc(e,this.utc).toString();break;case"t":v=i.translateFunc("_dateOrd").call(this,o);break;case"E":v=(a||7).toString();break;case"EE":v=Dc((a||7).toString(),2,"0");break;case"EEE":case"eee":v=i.translate(this.weekdaysShort[a]);break;case"EEEE":case"eeee":v=i.translate(this.weekdays[a]);break;case"EEEEE":case"eeeee":v=i.translate(this.weekdays[a]).substr(0,1);break;case"e":case"ee":v=(a-this.firstDayOfWeek+1).toString(),"ee"==t.parts[f]&&(v=Dc(v,2,"0"));break;case"a":v=s>=12?i.translate("PM"):i.translate("AM");break;case"aa":v=s>=12?i.translate("P.M."):i.translate("A.M.");break;case"aaa":v=s>=12?i.translate("P"):i.translate("A");break;case"h":v=Nc(s).toString();break;case"hh":v=Dc(Nc(s),2,"0");break;case"H":v=s.toString();break;case"HH":v=Dc(s,2,"0");break;case"K":v=Nc(s,0).toString();break;case"KK":v=Dc(Nc(s,0),2,"0");break;case"k":v=(s+1).toString();break;case"kk":v=Dc(s+1,2,"0");break;case"m":v=l.toString();break;case"mm":v=Dc(l,2,"0");break;case"s":v=u.toString();break;case"ss":v=Dc(u,2,"0");break;case"S":case"SS":case"SSS":v=Math.round(c/1e3*Math.pow(10,t.parts[f].length)).toString();break;case"x":v=d.toString();break;case"n":case"nn":case"nnn":v=Dc(c,t.parts[f].length,"0");break;case"z":v=Uc(e,!1,!1,this.utc);break;case"zz":v=Uc(e,!0,!1,this.utc);break;case"zzz":v=Uc(e,!1,!0,this.utc);break;case"zzzz":v=Uc(e,!0,!0,this.utc);break;case"Z":case"ZZ":var g=Math.abs(p)/60,_=Math.floor(g),b=60*g-60*_;this.utc&&(_=0,b=0),"Z"==t.parts[f]?(v="GMT",v+=p>0?"-":"+",v+=Dc(_,2)+":"+Dc(b,2)):(v=p>0?"-":"+",v+=Dc(_,2)+Dc(b,2));break;case"i":v=e.toISOString();break;case"I":v=e.toUTCString()}h=h.replace(yc,v)}return h},t.prototype.parse=function(e,t){if(nl(t)||(t=this.inputDateFormat),e instanceof Date)return e;if("number"===typeof e)return new Date(e);var i;"string"!==typeof e&&(e=e.toString()),this.language||(this.sprite?this.language=this.sprite.language:this.language=new Pp);var n="";t=(t=Ac(t)).substr(0,e.length);for(var r=this.parseFormat(t),a={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this.utc},s=0,l=0,u=0;u<r.parts.length;u++){switch(l=u+s+1,r.parts[u]){case"yyyy":case"YYYY":n+="([0-9]{4})",a.year=l;break;case"yyy":case"YYY":n+="([0-9]{3})",a.year3=l;break;case"yy":case"YY":n+="([0-9]{2})",a.year2=l;break;case"y":case"Y":n+="([0-9]{1})",a.year1=l;break;case"MMMM":n+="("+this.getStringList(this.months).join("|")+")",a.monthLong=l;break;case"MMM":n+="("+this.getStringList(this.monthsShort).join("|")+")",a.monthShort=l;break;case"MM":case"M":n+="([0-9]{2}|[0-9]{1})",a.month=l;break;case"ww":case"w":n+="([0-9]{2}|[0-9]{1})",a.week=l;break;case"dd":case"d":n+="([0-9]{2}|[0-9]{1})",a.day=l;break;case"DDD":case"DD":case"D":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.yearDay=l;break;case"dddd":n+="("+this.getStringList(this.weekdays).join("|")+")",a.weekdayLong=l;break;case"ddd":n+="("+this.getStringList(this.weekdaysShort).join("|")+")",a.weekdayShort=l;break;case"aaa":case"aa":case"a":n+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",a.am=l;break;case"hh":case"h":n+="([0-9]{2}|[0-9]{1})",a.hour12Base1=l;break;case"HH":case"H":n+="([0-9]{2}|[0-9]{1})",a.hourBase0=l;break;case"KK":case"K":n+="([0-9]{2}|[0-9]{1})",a.hour12Base0=l;break;case"kk":case"k":n+="([0-9]{2}|[0-9]{1})",a.hourBase1=l;break;case"mm":case"m":n+="([0-9]{2}|[0-9]{1})",a.minute=l;break;case"ss":case"s":n+="([0-9]{2}|[0-9]{1})",a.second=l;break;case"SSS":case"SS":case"S":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=l,a.millisecondDigits=r.parts[u].length;break;case"nnn":case"nn":case"n":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=l;break;case"x":n+="([0-9]{1,})",a.timestamp=l;break;case"Z":n+="GMT([-+]+[0-9]{2}:[0-9]{2})",a.zone=l;break;case"ZZ":n+="([\\-+]+[0-9]{2}[0-9]{2})",a.zone=l;break;case"i":n+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2}).?([0-9]{0,3})([zZ]|[+-][0-9]{2}:?[0-9]{2}|$)",a.iso=l,s+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":s--}n+="[^0-9]*"}var c=new RegExp(n),h=e.match(c);if(h){if(a.year>-1&&(o.year=parseInt(h[a.year])),a.year3>-1){var p=parseInt(h[a.year3]);p+=1e3,o.year=p}if(a.year2>-1){p=parseInt(h[a.year2]);p+=p>50?1e3:2e3,o.year=p}if(a.year1>-1){p=parseInt(h[a.year1]);p=10*Math.floor((new Date).getFullYear()/10)+p,o.year=p}if(a.monthLong>-1&&(o.month=this.resolveMonth(h[a.monthLong])),a.monthShort>-1&&(o.month=this.resolveShortMonth(h[a.monthShort])),a.month>-1&&(o.month=parseInt(h[a.month])-1),a.week>-1&&-1===a.day&&(o.month=0,o.day=function(e,t,i,n){void 0===i&&(i=1),void 0===n&&(n=!1);var r=new Date(t,0,4,0,0,0,0);return n&&r.setUTCFullYear(t),7*e+i-((r.getDay()||7)+3)}(parseInt(h[a.week]),o.year,1,this.utc)),a.day>-1&&(o.day=parseInt(h[a.day])),a.yearDay>-1&&(o.month=0,o.day=parseInt(h[a.yearDay])),a.hourBase0>-1&&(o.hour=parseInt(h[a.hourBase0])),a.hourBase1>-1&&(o.hour=parseInt(h[a.hourBase1])-1),a.hour12Base0>-1)11==(p=parseInt(h[a.hour12Base0]))&&(p=0),a.am>-1&&!this.isAm(h[a.am])&&(p+=12),o.hour=p;if(a.hour12Base1>-1)12==(p=parseInt(h[a.hour12Base1]))&&(p=0),a.am>-1&&!this.isAm(h[a.am])&&(p+=12),o.hour=p;if(a.minute>-1&&(o.minute=parseInt(h[a.minute])),a.second>-1&&(o.second=parseInt(h[a.second])),a.millisecond>-1){p=parseInt(h[a.millisecond]);2==a.millisecondDigits?p*=10:1==a.millisecondDigits&&(p*=100),o.millisecond=p}if(a.timestamp>-1){o.timestamp=parseInt(h[a.timestamp]);var d=new Date(o.timestamp);o.year=d.getUTCFullYear(),o.month=d.getUTCMonth(),o.day=d.getUTCDate(),o.hour=d.getUTCHours(),o.minute=d.getUTCMinutes(),o.second=d.getUTCSeconds(),o.millisecond=d.getUTCMilliseconds()}a.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),h[a.zone])),a.iso>-1&&(o.year=el(h[a.iso+0]),o.month=el(h[a.iso+1])-1,o.day=el(h[a.iso+2]),o.hour=el(h[a.iso+3]),o.minute=el(h[a.iso+4]),o.second=el(h[a.iso+5]),o.millisecond=el(h[a.iso+6]),"Z"==h[a.iso+7]||"z"==h[a.iso+7]?o.utc=!0:""!=h[a.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),h[a.iso+7]))),i=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else i=new Date(e);return i},t.prototype.resolveTimezoneOffset=function(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){var i=rl(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)),n=i[1],r=i[2],a=i[3],o=60*parseInt(r)+parseInt(a);return"+"==n&&(o*=-1),o-(e||new Date).getTimezoneOffset()}return 0},t.prototype.resolveMonth=function(e){var t=this.months.indexOf(e);return t>-1||this.language&&!this.language.isDefault()&&(t=this.language.translateAll(this.months).indexOf(e))>-1?t:0},t.prototype.resolveShortMonth=function(e){var t=this.monthsShort.indexOf(e);return t>-1||(t=this.months.indexOf(e))>-1||this.language&&!this.language.isDefault()&&(t=this.language.translateAll(this.monthsShort).indexOf(e))>-1?t:0},t.prototype.isAm=function(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1},t.prototype.invalidateSprite=function(){this.sprite&&this.sprite.invalidate()},t.prototype.getStringList=function(e){for(var t=[],i=0;i<e.length;i++)this.language?t.push(Tc(this.language.translate(e[i]))):t.push(Tc(e[i]));return t},Object.defineProperty(t.prototype,"dateFormat",{get:function(){return this._dateFormat},set:function(e){this._dateFormat=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDateFormat",{get:function(){return this._inputDateFormat},set:function(e){this._inputDateFormat=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"intlLocales",{get:function(){return this._intlLocales},set:function(e){this._intlLocales=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"utc",{get:function(){return this._utc},set:function(e){this._utc=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timezoneOffset",{get:function(){return this._timezoneOffset},set:function(e){this._timezoneOffset!=e&&(this._timezoneOffset=e,this.invalidateSprite())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timezone",{get:function(){return this._timezone},set:function(e){this._timezone!=e&&(this._timezone=e,this.timezoneMinutes=function(e){var t=new Date;return t.setHours(0,0,0,0),ip(t,e).getMinutes()}(e),this.invalidateSprite())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstDayOfWeek",{get:function(){return this._firstDayOfWeek},set:function(e){this._firstDayOfWeek=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return this._outputFormat},set:function(e){this._outputFormat=e.toLowerCase(),this.invalidateSprite()},enumerable:!0,configurable:!0}),t}(hc);Bu.registeredClasses.DateFormatter=Cp;var Mp=function(e){function t(){var t=e.call(this)||this;return t._negativeBase=0,t._baseUnit="second",t._outputFormat="svg",t._unitValues={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6},t._unitAliases={Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"},t.className="DurationFormatter",t.applyTheme(),t}return Us(t,e),t.prototype.format=function(e,t,i){this.language||(this.sprite?this.language=this.sprite.language:this.language=new Pp);var n=i||this._baseUnit;"undefined"!==typeof t&&""!==t||(t=nl(this.durationFormat)?this.durationFormat:this.getFormat(el(e),null,n)),t=Ac(t);var r,a=this.parseFormat(t,n),o=Number(e);r=o>this._negativeBase?a.positive:o<this._negativeBase?a.negative:a.zero;var s=this.applyFormat(o,r);return""!==r.color&&("svg"===this._outputFormat?s="<tspan fill='"+r.color+"'>"+s+"</tspan>":"html"===this._outputFormat&&(s="<span style='color: "+r.color+";'>"+s+"</span>")),s},t.prototype.parseFormat=function(e,t){var i=this,n=this.getCache(e);if(nl(n))return n;var r=t||this._baseUnit,a={positive:{color:"",template:"",parts:[],source:"",baseUnit:r,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:r,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:r,parsed:!1,absolute:!1}},o=(e=e.replace("||",gc)).split("|");return a.positive.source=o[0],"undefined"===typeof o[2]?a.zero=a.positive:a.zero.source=o[2],"undefined"===typeof o[1]?a.negative=a.positive:a.negative.source=o[1],gu(a,(function(e,t){if(!t.parsed)if("undefined"===typeof i.getCache(t.source)){var n,r=t.source;(n=t.source.match(/^\[([^\]]*)\]/))&&n.length&&""!==n[0]&&(r=t.source.substr(n[0].length),t.color=n[1]);for(var o=Tp().chunk(r,!0),s=0;s<o.length;s++){var l=o[s];if(l.text=l.text.replace(gc,"|"),"value"===l.type){l.text.match(/[yYMdDwhHKkmsSn]+a/)&&(t.absolute=!0,l.text=l.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));var u=l.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(u)for(var c=0;c<u.length;c++)nl(u[c])||(u[c]=i._unitAliases[u[c]]),t.parts.push(u[c]),l.text=l.text.replace(u[c],yc)}t.template+=l.text}i.setCache(t.source,t),t.parsed=!0}else a[e]=i.getCache(t.source)})),this.setCache(e,a),a},t.prototype.applyFormat=function(e,t){var i=!t.absolute&&e<this._negativeBase;e=Math.abs(e);for(var n=this.toTimeStamp(e,t.baseUnit),r=t.template,a=0,o=t.parts.length;a<o;a++){var s=t.parts[a],l=this.toTimeUnit(s.substr(0,1)),u=s.length,c=Math.floor(n/this._unitValues[l]);r=r.replace(yc,Dc(c,u,"0")),n-=c*this._unitValues[l]}return i&&(r="-"+r),r},t.prototype.toTimeStamp=function(e,t){return e*this._unitValues[t]},t.prototype.toTimeUnit=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}},t.prototype.invalidateSprite=function(){this.sprite&&this.sprite.invalidate()},Object.defineProperty(t.prototype,"baseUnit",{get:function(){return this._baseUnit},set:function(e){this._baseUnit=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return this._outputFormat},set:function(e){this._outputFormat=e.toLowerCase(),this.invalidateSprite()},enumerable:!0,configurable:!0}),t.prototype.getFormat=function(e,t,i){if(nl(this.durationFormat))return this.durationFormat;if(i||(i=this.baseUnit),nl(t)&&e!=t){e=Math.abs(e),t=Math.abs(t);var n=this.getValueUnit(xl(e,t),i);return this.durationFormats[i][n]}var r=this.getValueUnit(e,i);return this.durationFormats[i][r]},t.prototype.getValueUnit=function(e,t){var i;t||(t=this.baseUnit);var n=this.getMilliseconds(e,t);return yu(this._unitValues,(function(e,r){if(e==t||i){if(n/r<=1)return i||(i=e),!1;i=e}return!0})),i},t.prototype.getMilliseconds=function(e,t){return t||(t=this.baseUnit),e*this._unitValues[t]},Object.defineProperty(t.prototype,"durationFormat",{get:function(){return this._durationFormat},set:function(e){this._durationFormat!=e&&(this._durationFormat=e,this.invalidateSprite())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationFormats",{get:function(){return this._durationFormats||(this._durationFormats={millisecond:{millisecond:this.language.translate("_duration_millisecond"),second:this.language.translate("_duration_millisecond_second"),minute:this.language.translate("_duration_millisecond_minute"),hour:this.language.translate("_duration_millisecond_hour"),day:this.language.translate("_duration_millisecond_day"),week:this.language.translate("_duration_millisecond_week"),month:this.language.translate("_duration_millisecond_month"),year:this.language.translate("_duration_millisecond_year")},second:{second:this.language.translate("_duration_second"),minute:this.language.translate("_duration_second_minute"),hour:this.language.translate("_duration_second_hour"),day:this.language.translate("_duration_second_day"),week:this.language.translate("_duration_second_week"),month:this.language.translate("_duration_second_month"),year:this.language.translate("_duration_second_year")},minute:{minute:this.language.translate("_duration_minute"),hour:this.language.translate("_duration_minute_hour"),day:this.language.translate("_duration_minute_day"),week:this.language.translate("_duration_minute_week"),month:this.language.translate("_duration_minute_month"),year:this.language.translate("_duration_minute_year")},hour:{hour:this.language.translate("_duration_hour"),day:this.language.translate("_duration_hour_day"),week:this.language.translate("_duration_hour_week"),month:this.language.translate("_duration_hour_month"),year:this.language.translate("_duration_hour_year")},day:{day:this.language.translate("_duration_day"),week:this.language.translate("_duration_day_week"),month:this.language.translate("_duration_day_month"),year:this.language.translate("_duration_day_year")},week:{week:this.language.translate("_duration_week"),month:this.language.translate("_duration_week_month"),year:this.language.translate("_duration_week_year")},month:{month:this.language.translate("_duration_month"),year:this.language.translate("_duration_month_year")},year:{year:this.language.translate("_duration_year")}}),this._durationFormats},set:function(e){this._durationFormats=e,this.invalidateSprite()},enumerable:!0,configurable:!0}),t}(hc);Bu.registeredClasses.DurationFormatter=Mp;var Ip=new Lu;var Op,Dp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._validateDisposer=null,t}return Us(t,e),t.prototype.invalidate=function(){null===this._validateDisposer&&(this._validateDisposer=Bu.events.on("exitframe",this.validate,this))},t.prototype.validate=function(){null!==this._validateDisposer&&(this._validateDisposer.dispose(),this._validateDisposer=null)},t.prototype.dispose=function(){null!==this._validateDisposer&&(this._validateDisposer.dispose(),this._validateDisposer=null),e.prototype.dispose.call(this)},t}(pc),Ap=function(e){function t(){var t=e.call(this)||this;return t.adapter=new ec(t),t.closeDelay=1e3,t.closeOnClick=!0,t._language=new iu,t._menuTag="ul",t._itemTag="li",t._labelTag="a",t._iconTag="img",t._classPrefix="amexport",t._defaultStyles=!0,t._align="right",t._verticalAlign="top",t._tabindex=0,t._ignoreNextClose=!1,t._items=[{label:"...",menu:[{label:"Image",menu:[{type:"png",label:"PNG"},{type:"jpg",label:"JPG"},{type:"svg",label:"SVG"},{type:"pdf",label:"PDF"}]},{label:"Data",menu:[{type:"json",label:"JSON"},{type:"csv",label:"CSV"},{type:"xlsx",label:"XLSX"},{type:"html",label:"HTML"},{type:"pdfdata",label:"PDF"}]},{label:"Print",type:"print"}]}],t.className="ExportMenu",t._disposers.push(t._language),t.invalidate(),t.applyTheme(),t}return Us(t,e),t.prototype.validate=function(){this.draw(),e.prototype.validate.call(this)},t.prototype.draw=function(){var e=this;this._element?(this._element.innerHTML="",this._element.className=this.getMenuItemClass(0)):this._element=this.createMenuElement(0),this.defaultStyles&&(this._element.style.display="none"),rl(this._container).appendChild(this._element);for(var t=this.adapter.apply("items",{items:this._items}).items,i=t.length,n=0;n<i;n++)this.drawBranch(this._element,t[n],0);this._element=this.adapter.apply("menuElement",{menuElement:this._element}).menuElement,this._disposers.push(ap().body.events.on("down",(function(t){t.pointer.touch||(e._ignoreNextClose=!1),e.close()}))),this._disposers.push(ap().body.events.on("keydown",(function(t){var i=ep.getEventKey(t.event);switch(i){case"esc":e.close();break;case"up":case"down":case"left":case"right":e._currentSelection&&t.event.preventDefault(),e.moveSelection(i)}}))),this.defaultStyles&&this.loadDefaultCSS()},t.prototype.drawBranch=function(e,t,i){var n=this;if(!0!==(t=this.adapter.apply("branch",{branch:t,level:i}).branch).unsupported){t.ascendants||(t.ascendants=new Wu);var r,a=t.type,o=this.createItemElement(i,a);t.icon?((r=this.createIconElement(i,a)).src=t.icon,(t.label||t.title)&&(r.title=t.title||t.label)):t.svg?(r=this.createSvgElement(i,a,t.svg),(t.label||t.title)&&(r.title=t.title||t.label)):((r=this.createLabelElement(i,a)).innerHTML=t.label?this.language.translate(t.label):"",t.title&&(r.title=t.title));var s=this.getReaderLabel(t,r.innerHTML);r.setAttribute("aria-label",s),o.appendChild(r),t.interactions=ap().getInteraction(o),t.element=o,this.typeClickable(a)&&(t.interactions.events.on("hit",(function(e){if(n.events.isEnabled("hit")&&!n.isDisposed()){var i={type:"hit",event:e.event,target:n,branch:t};n.events.dispatchImmediately("hit",i)}})),t.interactions.events.on("keyup",(function(e){if(ep.isKey(e.event,"enter")&&n.events.isEnabled("enter")){var i={type:"enter",event:e.event,target:n,branch:t};n.events.dispatchImmediately("enter",i)}})));var l=this.getSubMenu(t);null!=l&&(t.interactions.events.on("keyup",(function(e){ep.isKey(e.event,"enter")&&(n.selectBranch(l[0]),n.setFocus(l[0]))})),t.interactions.events.on("hit",(function(e){n.selectBranch(t)}))),t.interactions.events.on("over",(function(e){if(e.pointer.touch&&(n._ignoreNextClose=!0),n.selectBranch(t),n.events.isEnabled("over")){var i={type:"over",event:e.event,target:n,branch:t};n.events.dispatchImmediately("over",i)}})),t.interactions.events.on("out",(function(e){if(!n.isDisposed()&&(e.pointer.touch||n.delayUnselectBranch(t),n.events.isEnabled("out"))){var i={type:"out",event:e.event,target:n,branch:t};n.events.dispatchImmediately("out",i)}})),t.interactions.events.on("focus",(function(e){n.selectBranch(t)})),t.interactions.events.on("blur",(function(e){n.delayUnselectBranch(t)}));var u=i+1;if(t.menu){var c=this.createMenuElement(u);t.submenuElement=c;for(var h=t.menu.length,p=0;p<h;p++){var d=new Wu;t.menu[p].ascendants=d,t.ascendants.length&&d.copyFrom(t.ascendants),d.push(t),this.drawBranch(c,t.menu[p],u)}if(""==c.innerHTML)return;o.appendChild(c)}t.hidden&&this.hideBranch(t),t.id&&o.setAttribute("id",t.id),t.color&&(o.style.backgroundColor=t.color.hex),e.appendChild(o)}},t.prototype.createMenuElement=function(e){var t=document.createElement(this.menuTag);return t.className=this.getMenuItemClass(e),0===e?t.setAttribute("role","menubar"):t.setAttribute("role","menu"),t},t.prototype.getMenuItemClass=function(e){var t=this.classPrefix+"-menu "+this.classPrefix+"-menu-level-"+e;return 0===e&&(t+=" "+this.classPrefix+"-menu-root "+this.classPrefix+"-"+this.align+" "+this.classPrefix+"-"+this.verticalAlign),this.adapter.apply("menuClass",{className:t,level:e}).className},t.prototype.createItemElement=function(e,t){var i=document.createElement(this.itemTag),n=this.classPrefix+"-item "+this.classPrefix+"-item-level-"+e+" "+this.classPrefix+"-item-"+(t||"blank");return i.className=this.adapter.apply("itemClass",{className:n,level:e,type:t}).className,i.setAttribute("role","menuitem"),i.setAttribute("tabindex",this.tabindex.toString()),i},t.prototype.createLabelElement=function(e,t){var i=document.createElement(this.labelTag),n=this.classPrefix+"-label "+this.classPrefix+"-label-level-"+e+" "+this.classPrefix+"-item-"+(t||"blank");return this.typeClickable(t)&&(n+=" "+this.classPrefix+"-clickable"),i.className=this.adapter.apply("labelClass",{className:n,level:e,type:t}).className,i},t.prototype.createIconElement=function(e,t){var i=document.createElement(this.iconTag),n=this.classPrefix+"-icon "+this.classPrefix+"-icon-level-"+e+" "+this.classPrefix+"-item-"+(t||"blank");return this.typeClickable(t)&&(n+=" "+this.classPrefix+"-clickable"),i.className=this.adapter.apply("labelClass",{className:n,level:e,type:t}).className,i.setAttribute("tabindex",this.tabindex.toString()),i.setAttribute("role","menuitem"),i},t.prototype.createSvgElement=function(e,t,i){var n=(new DOMParser).parseFromString(i,"image/svg+xml").documentElement,r=this.classPrefix+"-icon "+this.classPrefix+"-icon-level-"+e+" "+this.classPrefix+"-item-"+(t||"blank");return this.typeClickable(t)&&(r+=" "+this.classPrefix+"-clickable"),n.setAttribute("class",this.adapter.apply("labelClass",{className:r,level:e,type:t}).className),n.setAttribute("tabindex",this.tabindex.toString()),n.setAttribute("role","menuitem"),n},t.prototype.dispose=function(){this._disposed||(e.prototype.dispose.call(this),this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element))},t.prototype.typeClickable=function(e){return nl(e)},t.prototype.hasSubMenu=function(e){return!(!e.menu||!e.menu.length)},t.prototype.getSubMenu=function(e){if(e.menu&&e.menu.length)return e.menu},t.prototype.getReaderLabel=function(e,t){return t=Lc(t),0==e.ascendants.length?(t="..."==t?this.language.translate("Export"):t,t+=" ["+this.language.translate("Press ENTER or use arrow keys to navigate")+"]"):this.hasSubMenu(e)?t+=" ["+this.language.translate("Click, tap or press ENTER to open")+"]":"print"==e.type?t=this.language.translate("Click, tap or press ENTER to print."):this.typeClickable(e.type)&&(t=this.language.translate("Click, tap or press ENTER to export as %1.",void 0,t)),this.adapter.apply("rederLabel",{label:t,branch:e}).label},Object.defineProperty(t.prototype,"container",{get:function(){return this._container},set:function(e){this._container=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},set:function(e){this._items=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tag",{set:function(e){this._menuTag=e,this._itemTag="ul"==e?"li":"div",this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menuTag",{get:function(){return this.adapter.apply("menuTag",{tag:this._menuTag}).tag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemTag",{get:function(){return this.adapter.apply("itemTag",{tag:this._itemTag}).tag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelTag",{get:function(){return this.adapter.apply("labelTag",{tag:this._labelTag}).tag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconTag",{get:function(){return this.adapter.apply("iconTag",{tag:this._iconTag}).tag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.adapter.apply("align",{align:this._align}).align},set:function(e){this._align=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlign",{get:function(){return this.adapter.apply("verticalAlign",{verticalAlign:this._verticalAlign}).verticalAlign},set:function(e){this._verticalAlign=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classPrefix",{get:function(){return this.adapter.apply("classPrefix",{classPrefix:this._classPrefix}).classPrefix},set:function(e){this._classPrefix=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyles",{get:function(){return this.adapter.apply("defaultStyles",{defaultStyles:this._defaultStyles}).defaultStyles},set:function(e){this._defaultStyles!=e&&(this._defaultStyles=e,e&&this.loadDefaultCSS()),this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.loadDefaultCSS=function(){this._disposers.push(function(e,t){var i=t||"amexport",n=new Xh;return Ip.insertKeyIfEmpty(i,(function(){var t=new tu([new Nh(e,"."+i+"-menu *",{"box-sizing":"border-box"}),new Nh(e,"."+i+"-menu-level-0",{position:"absolute",top:"5px",right:"5px"}),new Nh(e,"."+i+"-menu-level-0."+i+"-left",{right:"auto",left:"5px"}),new Nh(e,"."+i+"-menu-level-0."+i+"-right",{right:"5px",left:"auto"}),new Nh(e,"."+i+"-menu-level-0."+i+"-top",{top:"5px",bottom:"auto"}),new Nh(e,"."+i+"-menu-level-0."+i+"-bottom",{top:"auto",bottom:"5px"}),new Nh(e,"."+i+"-item."+i+"-item-level-0",{opacity:"0.3",width:"30px","min-height":"30px",transition:"all 100ms ease-in-out"}),new Nh(e,"div:hover > div > ."+i+"-menu ."+i+"-item."+i+"-item-level-0, ."+i+"-item."+i+"-item-level-0.active",{opacity:"0.9"}),new Nh(e,"."+i+"-item."+i+"-item-level-0 > a",{padding:"0","text-align":"center",overflow:"hidden"}),new Nh(e,"."+i+"-item."+i+"-item-level-0:before",{display:"block"}),new Nh(e,"."+i+"-item",{position:"relative",display:"block",opacity:"0","z-index":"1","border-radius":"3px","background-color":n.getFor("secondaryButton").hex,padding:"0",margin:"1px 1px 0 0",color:n.getFor("secondaryButton").alternative.hex,transition:"all 100ms ease-in-out, opacity 0.5s ease 0.5s"}),new Nh(e,"."+i+"-left ."+i+"-item",{margin:"1px 0 0 1px"}),new Nh(e,"."+i+"-item:hover, ."+i+"-item.active",{background:n.getFor("secondaryButtonHover").hex,color:n.getFor("secondaryButtonText").hex}),new Nh(e,"."+i+"-item > ."+i+"-menu",{position:"absolute",top:"-1px",right:"0","margin-right":"100%"}),new Nh(e,"."+i+"-left ."+i+"-item > ."+i+"-menu",{left:"0",right:"auto","margin-left":"100%","margin-right":"auto"}),new Nh(e,"."+i+"-right ."+i+"-item > ."+i+"-menu",{left:"auto",right:"0","margin-left":"auto","margin-right":"100%"}),new Nh(e,"."+i+"-top ."+i+"-item > ."+i+"-menu",{top:"-1px",bottom:"auto"}),new Nh(e,"."+i+"-bottom ."+i+"-item > ."+i+"-menu",{top:"auto",bottom:"0"}),new Nh(e,"."+i+"-item > ."+i+"-menu",{display:"none"}),new Nh(e,"."+i+"-item:hover > ."+i+"-menu, ."+i+"-item.active > ."+i+"-menu",{display:"block"}),new Nh(e,"."+i+"-item:hover > ."+i+"-menu > ."+i+"-item, ."+i+"-item.active > ."+i+"-menu > ."+i+"-item",{opacity:"1"}),new Nh(e,"."+i+"-menu",{display:"block","list-style":"none",margin:"0",padding:"0"}),new Nh(e,"."+i+"-label",{display:"block",cursor:"default",padding:"0.5em 1em"}),new Nh(e,"."+i+"-icon",{display:"block",cursor:"default",padding:"0.2em 0.4em",width:"1.2em",height:"1.2em","min-width":"32px","min-height":"32px",margin:"auto auto","border-radius":"3px"}),new Nh(e,"."+i+"-item-level-0 > ."+i+"-icon",{padding:"0.1em 0.2em"}),new Nh(e,"."+i+"-clickable",{cursor:"pointer"})]);return new nu((function(){Ip.removeKey(i),t.dispose()}))})).increment()}(jh(this.container),this.classPrefix)),this._element&&(this._element.style.display="")},Object.defineProperty(t.prototype,"tabindex",{get:function(){return this.adapter.apply("tabindex",{tabindex:this._tabindex}).tabindex},set:function(e){this._tabindex=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){var e=this,t=this._language.get();return null==t&&(t=new Pp,this._language.set(t,t.events.on("localechanged",(function(t){e.invalidate()})))),t},set:function(e){var t=this;this._language.set(e,e.events.on("localechanged",(function(e){t.invalidate()}))),this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.close=function(){var e=this;if(!this.isDisposed())if(this._ignoreNextClose)this._ignoreNextClose=!1;else{if(this.closeOnClick&&(this._element.style.pointerEvents="none",setTimeout((function(){e._element.style.pointerEvents="auto"}),100)),this._currentSelection&&(this.setBlur(this._currentSelection),this._currentSelection=void 0),this._element)for(var t=this._element.getElementsByClassName("active"),i=t.length-1;i>=0;i--)t[i]&&Ah(t[i],"active");this.events.dispatchImmediately("closed",{type:"closed",target:this})}},t.prototype.selectBranch=function(e){var t=this;if(!this.isDisposed()&&(e.closeTimeout&&(this.removeDispose(e.closeTimeout),e.closeTimeout=void 0),Dh(e.element,"active"),e.submenuElement&&e.submenuElement.setAttribute("aria-expanded","true"),this._currentSelection&&this._currentSelection!==e&&this._currentSelection.ascendants&&Tu(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var i=!0,n=function(e){return i=t(e)},r=e.length,a=0;a<r&&(e[a](n),i);++a);}}(ku([this._currentSelection]),this._currentSelection.ascendants.iterator()),(function(i){e.ascendants.contains(i)||e===i||t.unselectBranch(i,!0)})),Tu(e.ascendants.iterator(),(function(e){e.closeTimeout&&(t.removeDispose(e.closeTimeout),e.closeTimeout=void 0),Dh(e.element,"active")})),this._currentSelection=e,this.events.isEnabled("branchselected"))){var i={type:"branchselected",target:this,branch:e};this.events.dispatchImmediately("branchselected",i)}},t.prototype.unselectBranch=function(e,t){if(!this.isDisposed()&&(Ah(e.element,"active"),e.submenuElement&&e.submenuElement.removeAttribute("aria-expanded"),this._currentSelection==e&&(this._currentSelection=void 0),this.events.isEnabled("branchunselected"))){var i={type:"branchunselected",target:this,branch:e};this.events.dispatchImmediately("branchunselected",i)}},t.prototype.delayUnselectBranch=function(e,t){var i=this;this.isDisposed()||(e.closeTimeout&&(this.removeDispose(e.closeTimeout),e.closeTimeout=void 0),e.closeTimeout=this.setTimeout((function(){i.unselectBranch(e,t)}),this.closeDelay),!0!==t&&e.ascendants&&Tu(e.ascendants.iterator(),(function(e){i.delayUnselectBranch(e,!0)})))},t.prototype.moveSelection=function(e){if(!this.isDisposed()&&this._currentSelection){var t;if("up"==e)t=this.getPrevSibling(this._currentSelection);else if("down"==e)t=this.getNextSibling(this._currentSelection);else if("left"==e&&"right"==this.align||"right"==e&&"left"==this.align){var i=this.getSubMenu(this._currentSelection);null!=i&&(t=i[0])}else("right"==e&&"right"==this.align||"left"==e&&"left"==this.align)&&(t=this.getParentItem(this._currentSelection));t&&t!==this._currentSelection&&(this.selectBranch(t),this.setFocus(t),this._currentSelection=t)}},t.prototype.getSiblings=function(e){var t=this.getParentItem(e);return t&&t.menu?t.menu:[]},t.prototype.getParentItem=function(e){return e.ascendants&&e.ascendants.length?e.ascendants.getIndex(e.ascendants.length-1):void 0},t.prototype.getNextSibling=function(e){var t=this.getSiblings(e);if(t.length>1){var i=t.indexOf(e)+1;return t[i=t.length==i?0:i].unsupported?this.getNextSibling(t[i]):t[i]}return e},t.prototype.getPrevSibling=function(e){var t=this.getSiblings(e);if(t.length>1){var i=t.indexOf(e)-1;return t[i=-1==i?t.length-1:i].unsupported?this.getPrevSibling(t[i]):t[i]}return e},t.prototype.setFocus=function(e){if(e.interactions)try{e.interactions.element.focus()}catch(t){}},t.prototype.setBlur=function(e){if(e.interactions)try{e.interactions.element.blur()}catch(t){}},t.prototype.hideBranch=function(e){e.element.style.display="none"},t.prototype.showBranch=function(e){e.element.style.display=""},Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),t}(Dp);function Lp(e,t,i){return new Promise((function(n,r){var a=nl(i)&&"blob"==i.responseType,o=new XMLHttpRequest;if(o.onload=function(){if(200===o.status){var e,i=void 0;if(a)return e=o.response,void(l=e,new Promise((function(e,t){var i=new FileReader;i.onload=function(t){e(i.result)},i.onerror=function(e){t(e)},i.readAsText(l)}))).then((function(i){var r={xhr:o,error:!1,response:i,blob:e,type:o.getResponseHeader("Content-Type"),target:t};n(r)}));i=o.responseText||o.response;var s={xhr:o,error:!1,response:i,blob:e,type:o.getResponseHeader("Content-Type"),target:t};n(s)}else r({xhr:o,error:!0,type:o.getResponseHeader("Content-Type"),target:t});var l},o.onerror=function(){r({xhr:o,error:!0,type:o.getResponseHeader("Content-Type"),target:t})},o.open("GET",e,!0),i&&i.withCredentials&&(o.withCredentials=!0),nl(i)){if(nl(i.requestHeaders))for(var s=0;s<i.requestHeaders.length;s++){var l=i.requestHeaders[s];o.setRequestHeader(l.key,l.value)}nl(i.responseType)&&(o.responseType=i.responseType)}o.send()}))}var zp=/src: ([^;]+);/;function Rp(e){return Gs(this,void 0,void 0,(function(){var t;return Ws(this,(function(i){switch(i.label){case 0:t=e.sheet,i.label=1;case 1:return i.trys.push([1,2,,4]),[2,t.cssRules];case 2:return i.sent(),[4,new Promise((function(i,n){e.addEventListener("load",(function(){i(t.cssRules)}),!0),e.addEventListener("error",(function(e){n(e)}),!0),setTimeout((function(){n(new Error("Timeout while waiting for <style> to load"))}),1e4)}))];case 3:return[2,i.sent()];case 4:return[2]}}))}))}function Fp(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o;return Ws(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Lp(t)];case 1:return n=s.sent(),[3,3];case 2:return r=s.sent(),console.error("Failed to load stylesheet",t,r),[2];case 3:(a=e.createElement("style")).textContent=n.response,""!=_h.nonce&&a.setAttribute("nonce",_h.nonce),e.head.appendChild(a),s.label=4;case 4:return s.trys.push([4,,7,8]),[4,Rp(a)];case 5:return o=s.sent(),[4,jp(e,t,o,i)];case 6:return s.sent(),[3,8];case 7:return e.head.removeChild(a),[7];case 8:return[2]}}))}))}function jp(e,t,i,n){return Gs(this,void 0,void 0,(function(){var r,a,o,s,l;return Ws(this,(function(u){switch(u.label){case 0:for(r=[],a=i.length,o=0;o<a;o++)(s=i[o]).type===CSSRule.IMPORT_RULE?(l=s.href)&&(l=ih(t,l),r.push(Fp(e,l,n))):n(t,s);return r.length?[4,Promise.all(r)]:[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}}))}))}function Bp(e){return Gs(this,void 0,void 0,(function(){var t,i;return Ws(this,(function(n){switch(n.label){case 0:(t=document.createElement("iframe")).src="about:blank",t.setAttribute("title",""),document.head.appendChild(t),n.label=1;case 1:return n.trys.push([1,,3,4]),i=t.contentDocument,[4,Promise.all(Vl(document.styleSheets,(function(t){var n=t.href;return null==n?jp(i,location.href,t.cssRules,e):(n=ih(location.href,n),Fp(i,n,e))})))];case 2:return n.sent(),[3,4];case 3:return document.head.removeChild(t),[7];case 4:return[2]}}))}))}var Vp=function(e){function t(t){var i=e.call(this)||this;return i.adapter=new ec(i),i._formatOptions=new Lu,i._extraSprites=[],i._validateSprites=[],i.dataFieldsOrder=[],i._dynamicDataFields=!0,i._removedObjects=new Wu,i._hiddenObjects=[],i._objectsAlreadyHidden=!1,i._filePrefix="amCharts",i.useWebFonts=!0,i.useRetina=!0,i.useSimplifiedExport=!0,i.timeoutDelay=2e3,i._exportRunning=!1,i._prevHasData=!1,i._container=t,i.className="Export",i._formatOptions.setKey("png",{}),i._formatOptions.setKey("jpg",{quality:.8}),i._formatOptions.setKey("gif",{}),i._formatOptions.setKey("svg",{}),i._formatOptions.setKey("pdf",{fontSize:14,imageFormat:"png",align:"left",addURL:!0,addColumnNames:!0}),i._formatOptions.setKey("json",{indent:2,useLocale:!0}),i._formatOptions.setKey("csv",{addColumnNames:!0,emptyAs:"",addBOM:!0}),i._formatOptions.setKey("xlsx",{addColumnNames:!0,useLocale:!0,emptyAs:""}),i._formatOptions.setKey("html",{addColumnNames:!0,emptyAs:""}),i._formatOptions.setKey("pdfdata",{fontSize:14,imageFormat:"png",addURL:!0,addColumnNames:!0,emptyAs:""}),i._formatOptions.setKey("print",{delay:500,printMethod:"iframe"}),i.adapter.add("options",(function(e){var t=i._formatOptions.getKey(e.type);return e.options?e.options=bu(t,e.options):e.options=t,e})),i.applyTheme(),i.dispatchImmediately("inited"),i}return Us(t,e),Object.defineProperty(t.prototype,"menu",{get:function(){return this._menu},set:function(e){var t=this;this._menu&&this.removeDispose(this._menu),this._menu=e,this._menu.container=this.container,this._menu.language=this._language,this._menu.adapter.add("branch",(function(e){return e.branch.unsupported=!t.typeSupported(e.branch.type),e})),this._menu.events.on("hit",(function(e){t.export(e.branch.type,e.branch.options),t.menu.close()})),this._menu.events.on("enter",(function(e){t.export(e.branch.type,e.branch.options),t.menu.close()})),this._menu.events.on("over",(function(e){t._disablePointers()})),this._menu.events.on("out",(function(e){setTimeout((function(){t._releasePointers()}),10)})),this.dispatchImmediately("menucreated"),this._menu.adapter.add("classPrefix",(function(e){return e.classPrefix=_h.classNamePrefix+e.classPrefix,e})),this._disposers.push(this._menu)},enumerable:!0,configurable:!0}),t.prototype.typeSupported=function(e){var t=!0,i=this.getFormatOptions(e);return nl(i)&&i.disabled?t=!1:"pdf"===e||("xlsx"===e?t=!!this._hasData():("print"!=e||window.print)&&(-1===["json","csv","html","pdfdata"].indexOf(e)||this._hasData())||(t=!1)),this.adapter.apply("supported",{supported:t,type:e}).supported},t.prototype._hasData=function(){return this.data&&this.data.length},t.prototype._getFunction=function(e){switch(e){case"png":case"gif":case"jpg":return this.getImage;case"svg":return this.getSVG;case"pdf":case"pdfdata":return this.getPDF;case"xlsx":return this.getExcel;case"csv":return this.getCSV;case"json":return this.getJSON;case"html":return this.getHTML;case"print":return this.getPrint;default:return this.unsupported}},t.prototype.export=function(e,t){return Gs(this,void 0,void 0,(function(){var i,n,r,a,o,s=this;return Ws(this,(function(l){switch(l.label){case 0:return"custom"==e?(this.handleCustom(t),[2,!0]):(this._exportRunning=!0,this.events.isEnabled("exportstarted")&&(i={type:"exportstarted",target:this,format:e,options:t},this.events.dispatchImmediately("exportstarted",i)),this.showPreloader(),this.timeoutDelay&&(this.hideTimeout(),this._timeoutTimeout=this.setTimeout((function(){if(s.events.isEnabled("exporttimedout")){var i={type:"exporttimedout",target:s,format:e,options:t};s.events.dispatchImmediately("exporttimedout",i)}s.showTimeout()}),this.timeoutDelay)),this.hideNonExportableSprites(),n=this._getFunction(e),t=this.adapter.apply("options",{options:t,type:e}).options,[4,(n=this.adapter.apply("exportFunction",{func:n,type:e,options:t}).func).call(this,e,t)]);case 1:return r=l.sent(),this._exportRunning=!1,this._releasePointers(),this.restoreNonExportableSprites(),r?(this.events.isEnabled("exportfinished")&&(a={type:"exportfinished",target:this,format:e,options:t},this.events.dispatchImmediately("exportfinished",a)),this.hidePreloader(),this.hideTimeout(),this.menu&&this.menu.close(),"print"===e?[2,this.print(r,t,this.adapter.apply("title",{title:this.title,options:t}).title)]:"pdfdata"==e?[2,this.download(r,this.filePrefix+".pdf")]:[2,this.download(r,this.filePrefix+"."+e,t&&t.addBOM)]):(this.events.isEnabled("error")&&(o={type:"error",target:this,format:e,options:t},this.events.dispatchImmediately("error",o)),[2,!1])}}))}))},t.prototype.unsupported=function(e,t){return Gs(this,void 0,void 0,(function(){return Ws(this,(function(e){return[2,""]}))}))},t.prototype.handleCustom=function(e){nl(e)&&nl(e.callback)&&e.callback.call(e.callbackTarget||this,e)},t.prototype.getPrint=function(e,t){return Gs(this,void 0,void 0,(function(){return Ws(this,(function(e){return[2,this.getImage("png",t)]}))}))},t.prototype.getFontFamilies=function(){return Gs(this,void 0,void 0,(function(){var e,t,i,n,r=this;return Ws(this,(function(a){switch(a.label){case 0:return e=this.getDOMURL(),t=[],i=[],[4,Bp((function(n,a){if(a.type===CSSRule.FONT_FACE_RULE){var o=a.cssText,s=zp.exec(o);if(null!==s){var l=s[1].split(/ *, */).map((function(i){return Gs(r,void 0,void 0,(function(){var r,a,o,s,l,u;return Ws(this,(function(c){switch(c.label){case 0:return null!==(r=/^url\(["']?([^"'\)]+)["']?\)([^,]*)$/.exec(i))?[3,1]:[2,i];case 1:if(a=r[2],o=ih(n,r[1]),this.webFontFilter&&!o.match(this.webFontFilter))return[2,null];c.label=2;case 2:return c.trys.push([2,7,,8]),[4,Lp(o,void 0,{responseType:"blob"})];case 3:return s=c.sent(),null==window.navigator.msSaveOrOpenBlob?[3,4]:(l=e.createObjectURL(s.blob),t.push(l),[3,6]);case 4:return[4,(h=s.blob,new Promise((function(e,t){var i=new FileReader;i.onload=function(t){e(i.result)},i.onerror=function(e){t(e)},i.readAsDataURL(h)})))];case 5:l=c.sent(),c.label=6;case 6:return[2,'url("'+l+'")'+a];case 7:return u=c.sent(),console.error("Failed to load font",o,u),[2,null];case 8:return[2]}var h}))}))}));i.push(Promise.all(l).then((function(e){return 0===(e=e.filter((function(e){return null!=e}))).length?"":o.replace(zp,"src: "+e.join(", ")+";")})))}}}))];case 1:return a.sent(),[4,Promise.all(i)];case 2:return n=a.sent(),[2,{blobs:t,cssText:n.filter((function(e){return!!e})).join("\n")}]}}))}))},t.prototype.getImage=function(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o,s;return Ws(this,(function(l){switch(l.label){case 0:return(n=this._objectsAlreadyHidden)||this.hideNonExportableSprites(),nl(t)||(t=this.getFormatOptions(e)),[4,this.awaitValidSprites()];case 1:return l.sent(),[4,this.simplifiedImageExport()];case 2:if(!l.sent())return[3,10];r=void 0,l.label=3;case 3:return l.trys.push([3,7,,9]),[4,this.getCanvas(t)];case 4:return r=l.sent(),!1===i?[3,6]:[4,this.addExtras(r,t)];case 5:r=l.sent(),l.label=6;case 6:return a=r.toDataURL(this.getContentType(e),t.quality),this.disposeCanvas(r),n||this.restoreNonExportableSprites(),[2,a];case 7:return o=l.sent(),console.error(o.message+"\n"+o.stack),lp("Simple export failed, falling back to advanced export"),r&&this.disposeCanvas(r),[4,this.getImageAdvanced(e,t,i)];case 8:return s=l.sent(),n||this.restoreNonExportableSprites(),[2,s];case 9:return[3,12];case 10:return[4,this.getImageAdvanced(e,t,i)];case 11:return s=l.sent(),n||this.restoreNonExportableSprites(),[2,s];case 12:return[2]}}))}))},t.prototype.addExtras=function(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c,h,p,d,f,m,v,y=this;return Ws(this,(function(g){switch(g.label){case 0:return this.extraSprites.length?(n=0,r=0,a=e.width,o=e.height,s=0,l=0,[4,Promise.all(Vl(this.extraSprites,(function(e){return Gs(y,void 0,void 0,(function(){var u,c,h,p;return Ws(this,(function(d){switch(d.label){case 0:return(u=e instanceof Up?{sprite:e,position:"bottom"}:e).position=u.position||"bottom",u.marginTop=u.marginTop||0,u.marginRight=u.marginRight||0,u.marginBottom=u.marginBottom||0,u.marginLeft=u.marginLeft||0,i?[4,u.sprite.exporting.getCanvasAdvanced(t)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,u.sprite.exporting.getCanvas(t)];case 3:c=d.sent(),d.label=4;case 4:return h=c.width+u.marginLeft+u.marginRight,p=c.height+u.marginTop+u.marginBottom,"top"==u.position?(a=u.crop?o:xl(a,h),r+=p):"right"==u.position?(o=u.crop?o:xl(o,p),s+=h):"left"==u.position?(o=u.crop?o:xl(o,p),n+=h):"bottom"===u.position&&(a=u.crop?o:xl(a,h),l+=p),[2,{canvas:c,position:u.position,left:u.marginLeft,top:u.marginTop,width:h,height:p}]}}))}))})))]):[3,2];case 1:return u=g.sent(),(c=this.getDisposableCanvas()).width=n+a+s,c.height=r+o+l,h=c.getContext("2d"),(p=this.backgroundColor||this.findBackgroundColor(this.sprite.dom))&&(h.fillStyle=p.toString(),h.fillRect(0,0,c.width,c.height)),m=(d=n)+a,v=(f=r)+o,Nl(u,(function(e){"top"==e.position?(f-=e.height,h.drawImage(e.canvas,n+e.left,f+e.top)):"right"==e.position?(h.drawImage(e.canvas,m+e.left,r+e.top),m+=e.width):"left"==e.position?(d-=e.width,h.drawImage(e.canvas,d+e.left,r+e.top)):"bottom"===e.position&&(h.drawImage(e.canvas,n+e.left,v+e.top),v+=e.height),y.disposeCanvas(e.canvas)})),h.drawImage(e,n,r),[2,c];case 2:return[2,e]}}))}))},t.prototype.getCanvas=function(e){return Gs(this,void 0,void 0,(function(){var t,i,n,r,a,o,s,l,u,c,h,p,d,f,m,v,y;return Ws(this,(function(g){switch(g.label){case 0:nl(e)||(e={}),t=this.backgroundColor||this.findBackgroundColor(this.sprite.dom),i=this.getDOMURL(),n=null,r=null,g.label=1;case 1:return g.trys.push([1,,4,5]),o=this.sprite.pixelWidth,s=this.sprite.pixelHeight,l=Gh(this.sprite.dom),u=Wh(this.sprite.dom),c=e.scale||1,h=this.getPixelRatio(e),c=this.getAdjustedScale(o*h,s*h,c,e),(a=this.getDisposableCanvas()).style.width=o*c+"px",a.style.height=s*c+"px",a.width=o*c,a.height=s*c,p=a.getContext("2d"),t&&(p.fillStyle=t.toString(),p.fillRect(0,0,o*c,s*c)),d=[],this.useWebFonts&&d.push(this.getFontFamilies().then((function(e){return r=e.blobs,e.cssText}))),d.push(this.imagesToDataURI(this.sprite.dom,e)),d.push(this.prepForeignObjects(this.sprite.dom,e)),[4,Promise.all(d)];case 2:return f=g.sent(),m=this.normalizeSVG("<style>"+f[0]+"</style>"+this.serializeElement(this.sprite.paper.defs)+this.serializeElement(this.sprite.dom),e,o,s,c,l,u),v=new Blob([m],{type:"image/svg+xml"}),n=i.createObjectURL(v),[4,this.loadNewImage(n,o*c*h,s*c*h,"anonymous")];case 3:return y=g.sent(),p.drawImage(y,0,0),[3,5];case 4:return null!==n&&i.revokeObjectURL(n),null!==r&&Nl(r,(function(e){i.revokeObjectURL(e)})),this.restoreRemovedObjects(),[7];case 5:return[2,a]}}))}))},t.prototype.getCanvasAdvanced=function(e){return Gs(this,void 0,void 0,(function(){var t,i,n,r,a,o,s,l,u,c,h;return Ws(this,(function(p){switch(p.label){case 0:return nl(e)||(e={}),[4,this.imagesToDataURI(this.sprite.dom,e)];case 1:return p.sent(),t=this.backgroundColor||this.findBackgroundColor(this.sprite.dom),[4,this.canvg];case 2:return i=p.sent(),n=this.sprite.pixelWidth,r=this.sprite.pixelHeight,a=Gh(this.sprite.dom),o=Wh(this.sprite.dom),s=e.scale||1,l=this.getPixelRatio(e),s=this.getAdjustedScale(n*l,r*l,s,e),u=this.normalizeSVG(this.serializeElement(this.sprite.paper.defs)+this.serializeElement(this.sprite.dom),e,n,r,s,a,o,t),(c=this.getDisposableCanvas()).style.width=n*l*s+"px",c.style.height=r*l*s+"px",c.width=n*l*s,c.height=r*l*s,h={useCORS:!0},1!=l&&(h.ignoreDimensions=!0,h.scaleWidth=n*l*s,h.scaleHeight=r*l*s),[4,i.fromString(c.getContext("2d"),u,h).render()];case 3:return p.sent(),[2,c]}}))}))},t.prototype.getImageAdvanced=function(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r,a;return Ws(this,(function(o){switch(o.label){case 0:return(n=this._objectsAlreadyHidden)||this.hideNonExportableSprites(),nl(t)||(t=this.getFormatOptions(e)),[4,this.getCanvasAdvanced(t)];case 1:return r=o.sent(),!1===i?[3,3]:[4,this.addExtras(r,t,!0)];case 2:r=o.sent(),o.label=3;case 3:return a=r.toDataURL(this.getContentType(e),t.quality),this.disposeCanvas(r),n||this.restoreNonExportableSprites(),[2,a]}}))}))},t.prototype.getDisposableCanvas=function(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="-10000px",document.body.appendChild(e),e},t.prototype.disposeCanvas=function(e){document.body.removeChild(e)},t.prototype.getPixelRatio=function(e){return this.useRetina&&window.devicePixelRatio||1},t.prototype.getAdjustedScale=function(e,t,i,n){if(!n)return i;var r,a,o=e*i,s=e*i;return n.maxWidth&&o>n.maxWidth&&(r=n.maxWidth/e),n.maxHeight&&s>n.maxHeight&&(a=n.maxHeight/t),r||a?wl(r,a):(n.minWidth&&o<n.minWidth&&(r=n.minWidth/e),n.minHeight&&s<n.minHeight&&(a=n.minHeight/t),r||a?xl(r,a):i)},t.prototype.imagesToDataURI=function(e,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l;return Ws(this,(function(u){switch(u.label){case 0:if(!(n=e.querySelectorAll("image")).length)return[3,2];for(r=[],a=n.length,o=0;o<a;o++)s=n[o],(l=s.getAttributeNS(t.XLINK,"href"))&&(-1!==l.indexOf("data:image")||(-1!==l.indexOf(".svg")?r.push(this.svgToDataURI(s,i)):r.push(this.imageToDataURI(s,i))));return[4,Promise.all(r)];case 1:return u.sent(),[2];case 2:return[2]}}))}))},t.prototype.prepForeignObjects=function(e,t){return Gs(this,void 0,void 0,(function(){var t,i,n;return Ws(this,(function(r){if((t=e.querySelectorAll("foreignObject")).length)for(i=t.length,n=0;n<i;n++)this.temporarilyRemoveObject(t[n]);return[2]}))}))},t.prototype.imageToDataURI=function(e,i){return Gs(this,void 0,void 0,(function(){var n,r,a;return Ws(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.loadNewImage(e.getAttributeNS(t.XLINK,"href"),null,null,"anonymous")];case 1:n=o.sent(),(r=document.createElement("canvas")).width=n.width,r.height=n.height,r.getContext("2d").drawImage(n,0,0);try{return a=r.toDataURL(),e.setAttribute("href",a),[2,a]}catch(s){return!1!==i.keepTainted&&this.temporarilyRemoveObject(e),[2,void 0]}return[3,3];case 2:return o.sent(),i&&!1===i.keepTainted||this.temporarilyRemoveObject(e),[2,void 0];case 3:return[2]}}))}))},t.prototype.svgToDataURI=function(e,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o;return Ws(this,(function(s){switch(s.label){case 0:n=e.getAttributeNS(t.XLINK,"href"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Lp(n)];case 2:return r=s.sent(),a=this.adapter.apply("charset",{charset:"base64",type:"svg",options:i}).charset,o=this.adapter.apply("svgToDataURI",{data:"data:"+this.getContentType("svg")+";"+a+","+btoa(r.response),options:i}).data,e.setAttributeNS(t.XLINK,"href",o),[2,o];case 3:return s.sent(),i&&!1===i.keepTainted||this.temporarilyRemoveObject(e),[2,void 0];case 4:return[2]}}))}))},t.prototype.temporarilyRemoveObject=function(e,t){var i=e.parentElement||e.parentNode;t||(t=this.sprite.paper.add("g").node),i.insertBefore(t,e),e.textContent,i.removeChild(e),this._removedObjects.push({element:e,placeholder:t})},t.prototype.restoreRemovedObjects=function(){for(var e;e=this._removedObjects.pop();){(e.placeholder.parentElement||e.placeholder.parentNode).insertBefore(e.element,e.placeholder)}},t.prototype.simplifiedImageExport=function(){return Gs(this,void 0,void 0,(function(){var e,t,i,n,r,a,o;return Ws(this,(function(s){switch(s.label){case 0:if(!1===this.useSimplifiedExport)return[2,!1];if(!1===(e=Bu.getCache("simplifiedImageExport"))||!0===e)return[2,e];s.label=1;case 1:s.trys.push([1,6,,7]),(t=document.createElement("canvas")).width=1,t.height=1,i=t.getContext("2d"),n=this.getDOMURL(),r=new Blob([this.normalizeSVG("<g></g>",{},1,1)],{type:"image/svg+xml"}),a=n.createObjectURL(r),o=void 0,s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.loadNewImage(a,1,1)];case 3:return o=s.sent(),[3,5];case 4:return s.sent(),[2,!1];case 5:i.drawImage(o,0,0),n.revokeObjectURL(a);try{return Bu.setCache("simplifiedImageExport",!0),[2,!0]}catch(l){return Bu.setCache("simplifiedImageExport",!1),[2,!1]}return[3,7];case 6:return s.sent(),Bu.setCache("simplifiedImageExport",!1),[2,!1];case 7:return[2]}}))}))},t.prototype.loadNewImage=function(e,t,i,n){return new Promise((function(r,a){var o;function s(){if(n){var t=o.src;o.onerror=function(){a(new Error('Loading image "'+e+'" failed'))},o.removeAttribute("crossorigin"),o.src="",o.src=t}else a(new Error('Loading image "'+e+'" failed'))}o=t&&i?new Image(t,i):new Image,n&&o.setAttribute("crossOrigin",n),o.onload=function(){r(o)},o.onabort=s,o.onerror=s,o.src=e}))},t.prototype.getDOMURL=function(){return self.URL||self.webkitURL||self},t.prototype.getSVG=function(e,t,i){return void 0===i&&(i=!0),Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c,h,p;return Ws(this,(function(d){switch(d.label){case 0:return(n=this._objectsAlreadyHidden)||this.hideNonExportableSprites(),nl(t)||(t=this.getFormatOptions("svg")),[4,this.awaitValidSprites()];case 1:return d.sent(),r=this.sprite.pixelWidth,a=this.sprite.pixelHeight,o=Gh(this.sprite.dom),s=Wh(this.sprite.dom),l=t.scale||1,u=this.getPixelRatio(t),l=this.getAdjustedScale(r*u,a*u,l,t),c=this.normalizeSVG(this.serializeElement(this.sprite.paper.defs)+this.serializeElement(this.sprite.dom),t,r,a,l,o,s),h=this.adapter.apply("charset",{charset:"charset=utf-8",type:"svg",options:t}).charset,p=this.adapter.apply("getSVG",{data:i?"data:"+this.getContentType(e)+";"+h+","+encodeURIComponent(c):c,options:t}).data,n||this.restoreNonExportableSprites(),[2,p]}}))}))},t.prototype.normalizeSVG=function(e,t,i,n,r,a,o,s){var l="";i&&(l+='width="'+Math.round(i*(r||1))+'px" '),n&&(l+='height="'+Math.round(n*(r||1))+'px" ');var u="";a&&(u+="font-family: "+a.replace(/"/g,"")+";"),o&&(u+="font-size: "+o+";"),r&&(l+='viewBox="0 0 '+i+" "+n+'" ');var c=[],h=e.match(/<foreignObject[\s\S]*<\/foreignObject>/gi);if(h)for(var p=0;p<h.length;p++)e=e.replace(h[p],yc),c.push(h[p]);e.match(/<svg/)?""!==l&&(e=(e=(e=e.replace(/(<svg[^>]*)width="[^"]*"/,"$1")).replace(/(<svg[^>]*)height="[^"]*"/,"$1")).replace(/(<svg)/,"$1"+l)):e='<?xml version="1.0" encoding="utf-8"?><svg '+l+' style="'+u+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e+"</svg>",s&&(e=e.replace(/(<svg[^>]*>)/,'$1<rect width="100%" height="100%" fill="'+s.rgba+'"/>')),/MSIE |Trident\//.test(navigator.userAgent)&&(e=e.replace(/<feColorMatrix [^\/>]*\/>/gi,""));var d=new RegExp("url\\("+Tc(xc()),"g");if(e=(e=e.replace(d,"url(#")).replace(/url\(&quot;([^)]*)&quot;\)/gm,"url($1)"),c.length)for(p=0;p<c.length;p++)e=e.replace(yc,c[p]);return e=this.adapter.apply("normalizeSVG",{data:e,options:t}).data},t.prototype.serializeElement=function(e){return(new XMLSerializer).serializeToString(e)},t.prototype.getPDF=function(e,t){return Gs(this,void 0,void 0,(function(){function i(e){var t={};t.normal=e.normal.path,d[e.normal.path]=e.normal.bytes,e.bold?(t.bold=e.bold.path,d[e.bold.path]=e.bold.bytes):t.bold=e.normal.path,e.italics?(t.italics=e.italics.path,d[e.italics.path]=e.italics.bytes):t.italics=e.normal.path,e.bolditalics?(t.bolditalics=e.bolditalics.path,d[e.bolditalics.path]=e.bolditalics.bytes):t.bolditalics=e.normal.path,p[e.name]=t}var n,r,a,o,s,l,u,c,h,p,d;return Ws(this,(function(f){switch(f.label){case 0:return[4,this.getImage(t.imageFormat||"png",t)];case 1:return n=f.sent(),[4,this.pdfmake];case 2:return r=f.sent(),a=[30,30,30,30],o={pageSize:t.pageSize||"A4",pageOrientation:t.pageOrientation||"portrait",pageMargins:t.pageMargins||a,defaultStyle:{font:t.font?t.font.name:void 0},content:[]},s=this.adapter.apply("title",{title:this.title,options:t}).title,l=0,s&&(o.content.push({text:s,fontSize:t.fontSize||14,bold:!0,margin:[0,0,0,15]}),l+=50),t.addURL&&(o.content.push({text:this.language.translate("Saved from")+": "+document.location.href,fontSize:t.fontSize,margin:[0,0,0,15]}),l+=50),"pdfdata"!=e&&o.content.push({image:n,alignment:t.align||"left",fit:this.getPageSizeFit(o.pageSize,o.pageMargins,l)}),"pdfdata"==e||t.addData?(c=(u=o.content).push,h={},[4,this.getPDFData("pdf",t)]):[3,4];case 3:c.apply(u,[(h.table=f.sent(),h.fontSize=t.fontSize||14,h)]),f.label=4;case 4:return o=this.adapter.apply("pdfmakeDocument",{doc:o,options:t}).doc,p=null,d=null,t.font&&(p={},d={},i(t.font),t.extraFonts&&Nl(t.extraFonts,i)),[4,new Promise((function(e,t){r.createPdf(o,null,p,d).getDataUrl((function(t){e(t)}))}))];case 5:return[2,f.sent()]}}))}))},t.prototype.getPDFData=function(e,t){return Gs(this,void 0,void 0,(function(){var e,i,n,r,a,o,s=this;return Ws(this,(function(l){if(e={body:[]},i=this.adapter.apply("formatDataFields",{dataFields:this.dataFields,format:"pdf"}).dataFields,n=this.data,t.pivot)r=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"pdfdata"}).dataFieldsOrder,_u(i,(function(i,r){var a=[];t.addColumnNames&&a.push(r);for(var o=n.length,l=0;l<o;l++){var u=n[l][i];a.push(s.convertToSpecialFormat(i,u,t,!0))}e.body.push(s.getPDFDataRow(a,t,void 0,!0))}),(function(e,t){var i=r.indexOf(e),n=r.indexOf(t);return i>n?1:i<n?-1:0}));else for(t.addColumnNames&&(e.body.push(this.getPDFDataRow(i,t,void 0,!0)),e.headerRows=1),a=n.length,o=0;o<a;o++)e.body.push(this.getPDFDataRow(n[o],t,i));return[2,this.adapter.apply("pdfmakeTable",{table:e,options:t}).table]}))}))},t.prototype.getPDFDataRow=function(e,t,i,n){var r=this;void 0===n&&(n=!1);var a=[];i||(i=e);var o=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"pdfdata"}).dataFieldsOrder;return _u(i,(function(i,o){var s=r.convertEmptyValue(i,e[i],t),l=n?s:r.convertToSpecialFormat(i,s,t);l=""+l,a.push(l)}),(function(e,t){var i=o.indexOf(e),n=o.indexOf(t);return i>n?1:i<n?-1:0})),a},t.prototype.getPageSizeFit=function(e,t,i){void 0===i&&(i=0);var n=[0,0,0,0];"number"==typeof t?n=[t,t,t,t]:2==t.length?n=[t[0],t[1],t[0],t[1]]:4==t.length&&(n=t);var r={"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]}[e];return r[0]-=n[0]+n[2],r[1]-=n[1]+n[3]+i,r},t.prototype.getExcel=function(e,t){return Gs(this,void 0,void 0,(function(){var i,n,r,a,o,s,l,u,c,h=this;return Ws(this,(function(p){switch(p.label){case 0:return nl(t)||(t=this.getFormatOptions("xlsx")),[4,this.xlsx];case 1:if(i=p.sent(),n=this.adapter.apply("xlsxWorkbookOptions",{xlsx:i,options:{bookType:"xlsx",bookSST:!1,type:"base64"}}).options,r=this.normalizeExcelSheetName(this.adapter.apply("xlsxSheetName",{xlsx:i,name:this.title||this.language.translate("Data")}).name),a={SheetNames:[r],Sheets:{}},o=[],s=this.adapter.apply("formatDataFields",{dataFields:this.dataFields,format:"xslx"}).dataFields,t.pivot)l=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"xlsx"}).dataFieldsOrder,_u(s,(function(e,i){var n=[];t.addColumnNames&&n.push(i);for(var r=h.data.length,a=0;a<r;a++){var s=h.data[a][e];n.push(h.convertToSpecialFormat(e,s,t,!0))}o.push(h.getExcelRow(n,t,void 0,!0))}),(function(e,t){var i=l.indexOf(e),n=l.indexOf(t);return i>n?1:i<n?-1:0}));else for(t.addColumnNames&&o.push(this.getExcelRow(s,t,void 0,!0)),u=this.data.length,c=0;c<u;c++)o.push(this.getExcelRow(this.data[c],t,s));return a.Sheets[r]=i.utils.aoa_to_sheet(o),a=this.adapter.apply("xlsxWorkbook",{xlsx:i,workbook:a,options:t}).workbook,[2,this.adapter.apply("getExcel",{data:"data:"+this.getContentType(e)+";base64,"+i.write(a,n),options:t}).data]}}))}))},t.prototype.normalizeExcelSheetName=function(e){return Cc(e=e.replace(/([:\\\/?*\[\]]+)/g," "),31,"...",!0)},t.prototype.getExcelRow=function(e,t,i,n){var r=this;void 0===n&&(n=!1);var a=[];i||(i=e);var o=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"xlsx"}).dataFieldsOrder;return _u(i,(function(i,o){var s=r.convertEmptyValue(i,e[i],t),l=n?s:r.convertToSpecialFormat(i,s,t,!0);a.push(l)}),(function(e,t){var i=o.indexOf(e),n=o.indexOf(t);return i>n?1:i<n?-1:0})),a},t.prototype.getCSV=function(e,t,i){return void 0===i&&(i=!0),Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c,h,p=this;return Ws(this,(function(d){if(nl(t)||(t=this.getFormatOptions("csv")),n="",r=this.adapter.apply("formatDataFields",{dataFields:this.dataFields,format:"csv"}).dataFields,a="",o=this.data,t.pivot)s=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"csv"}).dataFieldsOrder,_u(r,(function(e,i){var r=[];t.addColumnNames&&r.push(i);for(var s=o.length,l=0;l<s;l++){var u=o[l][e];r.push(p.convertToSpecialFormat(e,u,t,!0))}n+=a+p.getCSVRow(r,t,void 0,!0),a="\n"}),(function(e,t){var i=s.indexOf(e),n=s.indexOf(t);return i>n?-1:i<n?1:0}));else{for(l=o.length,u=0;u<l;u++)c=this.getCSVRow(o[u],t,r),t.reverse?n=c+a+n:n+=a+c,a="\n";t.addColumnNames&&(n=this.getCSVRow(r,t,void 0,!0)+a+n)}return h=this.adapter.apply("charset",{charset:"charset=utf-8",type:e,options:t}).charset,[2,this.adapter.apply("getCSV",{data:i?"data:"+this.getContentType(e)+";"+h+","+encodeURIComponent(n):n,options:t}).data]}))}))},t.prototype.getCSVRow=function(e,t,i,n){var r=this;void 0===n&&(n=!1);var a=t.separator||",",o=[];i||(i=e);var s=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"csv"}).dataFieldsOrder;return _u(i,(function(i,s){var l=r.convertEmptyValue(i,e[i],t),u=n?l:r.convertToSpecialFormat(i,l,t);u=(u=""+u).replace(/"/g,'""'),(t.forceQuotes||u.search(new RegExp('"|\n|'+a,"g"))>=0)&&(u='"'+u+'"'),o.push(u)}),(function(e,t){var i=s.indexOf(e),n=s.indexOf(t);return i>n?1:i<n?-1:0})),o.join(a)},t.prototype.getHTML=function(e,t,i){return void 0===i&&(i=!0),Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c=this;return Ws(this,(function(h){if(nl(t)||(t=this.getFormatOptions("html")),n="<table>",t.tableClass&&(n='<table class="'+t.tableClass+'">'),r=this.adapter.apply("formatDataFields",{dataFields:this.dataFields,format:"html"}).dataFields,a=this.data,t.pivot)o=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"html"}).dataFieldsOrder,n+="\n<tbody>",_u(r,(function(e,i){var r=[];t.addColumnNames&&r.push(i);for(var o=a.length,s=0;s<o;s++){var l=a[s][e];r.push(c.convertToSpecialFormat(e,l,t,!0))}n+="\n"+c.getHTMLRow(r,t,void 0,!0)}),(function(e,t){var i=o.indexOf(e),n=o.indexOf(t);return i>n?-1:i<n?1:0})),n+="\n</tbody>";else{for(t.addColumnNames&&(n+="\n<thead>\n"+this.getHTMLRow(r,t,void 0,!0,!0)+"\n</thead>"),n+="\n<tbody>",s=a.length,l=0;l<s;l++)n+="\n"+this.getHTMLRow(a[l],t,r);n+="\n</tbody>"}return n+="\n</table>",u=this.adapter.apply("charset",{charset:"charset=utf-8",type:e,options:t}).charset,[2,this.adapter.apply("getHTML",{data:i?"data:"+this.getContentType(e)+";"+u+","+encodeURIComponent(n):n,options:t}).data]}))}))},t.prototype.getHTMLRow=function(e,t,i,n,r){var a=this;void 0===n&&(n=!1),void 0===r&&(r=!1);var o="\t<tr>";t.rowClass&&(o='\t<tr class="'+t.rowClass+'">'),i||(i=e);var s=this.adapter.apply("dataFieldsOrder",{dataFieldsOrder:this.dataFieldsOrder,format:"html"}).dataFieldsOrder,l=r?"th":"td",u=!0;return _u(i,(function(i,r){var s=a.convertEmptyValue(i,e[i],t),c=n?s:a.convertToSpecialFormat(i,s,t);c=(c=""+c).replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}));var h=l;t.pivot&&u&&(h="th"),t.cellClass?o+="\n\t\t<"+h+' class="'+t.cellClass+'">'+c+"</"+h+">":o+="\n\t\t<"+h+">"+c+"</"+h+">",u=!1}),(function(e,t){var i=s.indexOf(e),n=s.indexOf(t);return i>n?1:i<n?-1:0})),o+="\n\t</tr>"},t.prototype.getJSON=function(e,t,i){return void 0===i&&(i=!0),Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c,h=this;return Ws(this,(function(p){if(nl(t)||(t=this.getFormatOptions("json")),r=this.adapter.apply("formatDataFields",{dataFields:this.dataFields,format:"json"}).dataFields,this._dynamicDataFields)n=this.data;else for(n=[],a=this.data,o=function(e,i){var o=a[i];if("object"==typeof o){var s={};gu(o,(function(e,i){nl(r[e])&&(s[r[e]]=h.convertToSpecialFormat(e,i,t))})),n.push(s)}},s=a.length,l=0;l<s;l++)o(0,l);return u=JSON.stringify(n,(function(e,i){return"object"==typeof i&&gu(i,(function(e,n){i[e]=h.convertToSpecialFormat(e,n,t)})),i}),t.indent),c=this.adapter.apply("charset",{charset:"charset=utf-8",type:e,options:t}).charset,[2,this.adapter.apply("getJSON",{data:i?"data:"+this.getContentType(e)+";"+c+","+encodeURIComponent(u):u,options:t}).data]}))}))},t.prototype.convertToSpecialFormat=function(e,t,i,n){if("number"==typeof t)if(this.isDateField(e))t=new Date(t);else{if(this.isDurationField(e))return this.durationFormatter.format(t,this.durationFormat);if(this.isNumberField(e)&&this.numberFormat)return this.numberFormatter.format(t,this.numberFormat)}return t instanceof Date?i.useTimestamps?t=t.getTime():i.useLocale?n||(t=t.toLocaleString()):t=this.dateFormatter.format(t,this.dateFormat):sl(t)&&this.isDateField(e)&&this.dateFormat&&(t=this.dateFormatter.format(this.dateFormatter.parse(t),this.dateFormat)),t},t.prototype.convertEmptyValue=function(e,t,i){return nl(t)?t:i.emptyAs},t.prototype.download=function(e,t,i){return void 0===i&&(i=!1),Gs(this,void 0,void 0,(function(){var n,r,a,o,s,l,u,c,h,p,d,f,m,v,y;return Ws(this,(function(g){if(this.msBlobDownloadSupport()){if(f=e.split(";"),m=f.shift().replace(/data:/,""),e=decodeURIComponent(f.join(";").replace(/^[^,]*,/,"")),-1!=["image/svg+xml","application/json","text/csv"].indexOf(m))return n=new Blob([e],{type:m}),window.navigator.msSaveBlob(n,t),[2,!0];try{a=atob(e),e=a}catch(_){return[2,!1]}for(l=new Array(e.length),u=0;u<e.length;++u)c=e.charCodeAt(u),l[u]=c;h=new Blob([new Uint8Array(l)],{type:m}),window.navigator.msSaveBlob(h,t)}else if(this.blobDownloadSupport()){if((r=document.createElement("a")).download=t,document.body.appendChild(r),f=e.split(";"),m=f.shift().replace(/data:/,""),e=decodeURIComponent(f.join(";").replace(/^[^,]*,/,"")),-1!=["image/svg+xml","application/json","text/csv","text/html"].indexOf(m))return i&&(e="\ufeff"+e),o=new Blob([e],{type:m}),s=window.URL.createObjectURL(o),r.href=s,r.download=t,r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(s)}),100),[2,!0];try{a=atob(e),e=a}catch(_){return[2,!1]}for(l=new Array(e.length),u=0;u<e.length;++u)c=e.charCodeAt(u),l[u]=c;i&&(l=[239,187,191].concat(l)),h=new Blob([new Uint8Array(l)],{type:m}),p=window.URL.createObjectURL(h),r.href=p,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout((function(){window.URL.revokeObjectURL(p)}),100)}else this.linkDownloadSupport()?((d=document.createElement("a")).download=t,d.href=e,document.body.appendChild(d),d.click(),document.body.removeChild(d)):this.legacyIE()?4===(f=e.match(/^data:(.*);[ ]*([^,]*),(.*)$/)).length&&("base64"==f[2]?f[1].match(/^image\//)&&this.showModal('<img src="'+e+'" style="float: left; max-width: 50%; max-height: 80%; margin: 0 1em 0.5em 0; border: 1px solid #eee;" /><p>'+this.language.translate('To save the image, right-click thumbnail on the left and choose "Save picture as..."')+'</p><p style="text-align: center;"><small>'+this.language.translate("(Press ESC to close this message)")+"</small></p>",this.language.translate("Image Export Complete")):(m=void 0,t.match(/\.svg$/)?m="image/svg+xml":(m="text/plain",t+=".txt"),(v=document.createElement("iframe")).width="1px",v.height="1px",v.style.display="none",document.body.appendChild(v),(y=v.contentDocument).open(m,"replace"),y.write(decodeURIComponent(f[3])),y.close(),y.execCommand("SaveAs",!0,t),document.body.removeChild(v))):window.location.href=e;return[2,!0]}))}))},t.prototype.downloadSupport=function(){return this.linkDownloadSupport()||this.msBlobDownloadSupport()},t.prototype.linkDownloadSupport=function(){var e=Bu.getCache("linkDownloadSupport");if(!1===e||!0===e)return e;var t="undefined"!==typeof document.createElement("a").download;return Bu.setCache("linkDownloadSupport",t),t},t.prototype.blobDownloadSupport=function(){return nl(window.Blob)},t.prototype.msBlobDownloadSupport=function(){return nl(window.navigator.msSaveOrOpenBlob)},t.prototype.legacyIE=function(){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1==e.getElementsByTagName("i").length},t.prototype.print=function(e,t,i){return Gs(this,void 0,void 0,(function(){return Ws(this,(function(n){return"css"==t.printMethod?[2,this.printViaCSS(e,t,i)]:[2,this.printViaIframe(e,t,i)]}))}))},t.prototype.printViaCSS=function(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r,a,o;return Ws(this,(function(s){return n=document.documentElement.scrollTop||document.body.scrollTop,r=new Nh(jh(this.container),"body > *",{display:"none",position:"fixed",visibility:"hidden",opacity:"0",clipPath:"polygon(0px 0px,0px 0px,0px 0px,0px 0px);"}),i&&document&&document.title&&(a=document.title,document.title=i),(o=new Image).src=e,o.style.maxWidth="100%",o.style.display="block",o.style.position="relative",o.style.visibility="visible",o.style.opacity="1",o.style.clipPath="none",document.body.appendChild(o),this.setTimeout((function(){window.print()}),50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&t.delay<1e3?t.delay=1e3:t.delay<100&&(t.delay=100),this.setTimeout((function(){document.body.removeChild(o),r.dispose(),a&&(document.title=document.title),document.documentElement.scrollTop=document.body.scrollTop=n}),t.delay||500),[2,!0]}))}))},t.prototype.printViaIframe=function(e,t,i){return Gs(this,void 0,void 0,(function(){var n,r;return Ws(this,(function(a){return(n=document.createElement("iframe")).style.visibility="hidden",document.body.appendChild(n),n.contentWindow.document.open(),n.contentWindow.document.close(),(r=new Image).src=e,r.style.maxWidth="100%",r.style.height="auto",i&&(n.contentWindow.document.title=i),n.contentWindow.document.body.appendChild(r),n.load=function(){n.contentWindow.document.body.appendChild(r)},this.setTimeout((function(){try{n.contentWindow.document.execCommand("print",!1,null)||n.contentWindow.print()}catch(e){n.contentWindow.print()}}),t.delay||50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&t.delay<1e3?t.delay=1e3:t.delay<100&&(t.delay=100),this.setTimeout((function(){document.body.removeChild(n)}),t.delay+50||100),[2,!0]}))}))},t.prototype.findBackgroundColor=function(e){var t=1,i=zh(e,"background-color");if((i.match(/[^,]*,[^,]*,[^,]*,[ ]?0/)||"transparent"==i)&&(t=0),0==t){var n=e.parentElement;return n?this.findBackgroundColor(n):uc("#fff")}return uc(i,t)},Object.defineProperty(t.prototype,"container",{get:function(){return this.adapter.apply("container",{container:this._container}).container},set:function(e){this._container=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprite",{get:function(){return this.adapter.apply("sprite",{sprite:this._sprite}).sprite},set:function(e){this._sprite=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraSprites",{get:function(){return this.adapter.apply("extraSprites",{extraSprites:this._extraSprites}).extraSprites},set:function(e){this._extraSprites=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validateSprites",{get:function(){return this.adapter.apply("validateSprites",{validateSprites:this._validateSprites}).validateSprites},set:function(e){this._validateSprites=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.adapter.apply("data",{data:this._data}).data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataFields",{get:function(){return this._dataFields||this.generateDataFields(),this.adapter.apply("dataFields",{dataFields:this._dataFields}).dataFields},set:function(e){this._dataFields=e,this._dynamicDataFields=!1},enumerable:!0,configurable:!0}),t.prototype.handleDataUpdated=function(){this._dynamicDataFields&&(this._dataFields=void 0);var e=this.data.length>0;this._prevHasData!=e&&(this._prevHasData=e,this.menu&&this.menu.invalidate())},Object.defineProperty(t.prototype,"dateFormatter",{get:function(){return this._dateFormatter||(this._dateFormatter=new Cp,this._dateFormatter.language=this.language),this.adapter.apply("dateFormatter",{dateFormatter:this._dateFormatter}).dateFormatter},set:function(e){this._dateFormatter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateFormat",{get:function(){return this.adapter.apply("dateFormat",{dateFormat:this._dateFormat}).dateFormat},set:function(e){this._dateFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateFields",{get:function(){return this._dateFields||(this._dateFields=new Wu),this.adapter.apply("dateFields",{dateFields:this._dateFields}).dateFields},set:function(e){this._dateFields=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberFormatter",{get:function(){return this._numberFormatter||(this._numberFormatter=new Ep,this._numberFormatter.language=this.language),this.adapter.apply("numberFormatter",{numberFormatter:this._numberFormatter}).numberFormatter},set:function(e){this._numberFormatter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberFormat",{get:function(){return this.adapter.apply("numberFormat",{numberFormat:this._numberFormat}).numberFormat},set:function(e){this._numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberFields",{get:function(){return this._numberFields||(this._numberFields=new Wu),this.adapter.apply("numberFields",{numberFields:this._numberFields}).numberFields},set:function(e){this._numberFields=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationFormatter",{get:function(){return this._durationFormatter||(this._durationFormatter=new Mp,this._durationFormatter.language=this.language),this.adapter.apply("durationFormatter",{durationFormatter:this._durationFormatter}).durationFormatter},set:function(e){this._durationFormatter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationFormat",{get:function(){return this.adapter.apply("durationFormat",{durationFormat:this._durationFormat}).durationFormat},set:function(e){this._durationFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationFields",{get:function(){return this._durationFields||(this._durationFields=new Wu),this.adapter.apply("durationFields",{durationFields:this._durationFields}).durationFields},set:function(e){this._durationFields=e},enumerable:!0,configurable:!0}),t.prototype.generateDataFields=function(){var e=this;this._dataFields={},this.data.length&&Nl(this.data,(function(t){gu(t,(function(t,i){nl(e._dataFields[t])||(e._dataFields[t]=e.adapter.apply("dataFieldName",{name:t,field:t}).name)}))}))},t.prototype.isDateField=function(e){return this.adapter.apply("isDateField",{isDateField:this.dateFields.contains(e),field:e}).isDateField},t.prototype.isNumberField=function(e){return this.adapter.apply("isNumberField",{isNumberField:this.numberFields.contains(e),field:e}).isNumberField},t.prototype.isDurationField=function(e){return this.adapter.apply("isDurationField",{isDurationField:this.durationFields.contains(e),field:e}).isDurationField},t.prototype.getContentType=function(e){var t="";switch(e){case"png":case"gif":t="image/"+e;break;case"jpg":t="image/jpeg";break;case"svg":t="image/svg+xml";break;case"csv":t="text/csv";break;case"json":t="application/json";break;case"html":t="text/html";break;case"pdf":case"pdfdata":t="application/pdf";break;case"xlsx":t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}return this.adapter.apply("contentType",{contentType:t,type:e}).contentType},Object.defineProperty(t.prototype,"filePrefix",{get:function(){return this.adapter.apply("filePrefix",{filePrefix:this._filePrefix}).filePrefix},set:function(e){this._filePrefix=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this.adapter.apply("backgroundColor",{backgroundColor:this._backgroundColor}).backgroundColor},set:function(e){this._backgroundColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.adapter.apply("title",{title:this._title}).title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),t.prototype.showPreloader=function(){var e=this.preloader;e&&(e.progress=.5,e.label.text="...")},t.prototype.hidePreloader=function(){var e=this.preloader;e&&(e.progress=1)},Object.defineProperty(t.prototype,"preloader",{get:function(){return this._sprite&&this._sprite.parent&&this._sprite.parent.preloader?this._sprite.parent.preloader:void 0},enumerable:!0,configurable:!0}),t.prototype.showTimeout=function(){this.showModal(this.adapter.apply("timeoutMessage",{message:this.language.translate("Export operation took longer than expected. Something might have gone wrong.")}).message)},t.prototype.hideTimeout=function(){this._timeoutTimeout&&(this.removeDispose(this._timeoutTimeout),this._timeoutTimeout=null),this.hideModal()},Object.defineProperty(t.prototype,"language",{get:function(){return this._language||(this._language=new Pp),this._language},set:function(e){this._language=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modal",{get:function(){return this._modal||(this._modal=new sp,this._modal.adapter.add("classPrefix",(function(e){return e=_h.classNamePrefix+e}))),this._modal},enumerable:!0,configurable:!0}),t.prototype.showModal=function(e,t){this.hideModal(),this.hidePreloader();var i=this.modal;i.container=this.sprite.svgContainer.SVGContainer,i.content=e,i.readerTitle=t,i.open()},t.prototype.hideModal=function(){this._modal&&this.modal.close()},t.prototype._canvg=function(){return Gs(this,void 0,void 0,(function(){var e;return Ws(this,(function(t){switch(t.label){case 0:return[4,i.e(265).then(i.bind(i,2256))];case 1:return null!=(e=t.sent()).default?[2,e.default]:[2,e]}}))}))},Object.defineProperty(t.prototype,"canvg",{get:function(){return this._canvg()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pdfmake",{get:function(){return null==Op&&(Op=function(){return Gs(this,void 0,void 0,(function(){var e,t,n,r;return Ws(this,(function(a){switch(a.label){case 0:return[4,Promise.all([i.e(643).then(i.t.bind(i,6435,23)),i.e(643).then(i.bind(i,7693))])];case 1:return e=a.sent(),t=e[0],n=e[1],(r=window).pdfMake=r.pdfMake||{},r.pdfMake.vfs=n.default,t.vfs=n.default,[2,t]}}))}))}()),Op},enumerable:!0,configurable:!0}),t.prototype._xlsx=function(){return Gs(this,void 0,void 0,(function(){return Ws(this,(function(e){switch(e.label){case 0:return[4,Promise.all([i.e(458),i.e(297)]).then(i.t.bind(i,5458,23))];case 1:return[2,e.sent()]}}))}))},Object.defineProperty(t.prototype,"xlsx",{get:function(){return this._xlsx()},enumerable:!0,configurable:!0}),t.prototype.setFormatOptions=function(e,t){this._formatOptions.setKey(e,t)},t.prototype.getFormatOptions=function(e){return this._formatOptions.getKey(e)},Object.defineProperty(t.prototype,"formatOptions",{get:function(){return this._formatOptions},enumerable:!0,configurable:!0}),t.prototype._disablePointers=function(){nl(this._spriteInteractionsEnabled)||(this._spriteInteractionsEnabled=this.sprite.interactionsEnabled),this.sprite.interactionsEnabled=!1},t.prototype._releasePointers=function(){nl(this._spriteInteractionsEnabled)&&!this._exportRunning&&(this.sprite.interactionsEnabled=this._spriteInteractionsEnabled)},t.prototype.hideNonExportableSprites=function(){var e=this;if(!this._objectsAlreadyHidden){var t=this.sprite.svgContainer;t&&Nl(t.nonExportableSprites,(function(t){t.isHidden||t.isHiding||!t.visible||e._hiddenObjects.push(t),t.hide(0)})),this._objectsAlreadyHidden=!0}},t.prototype.restoreNonExportableSprites=function(){this._objectsAlreadyHidden&&(Nl(this._hiddenObjects,(function(e){e.show(0)})),this._hiddenObjects=[],this._objectsAlreadyHidden=!1)},t.prototype.awaitValidSprites=function(){return Gs(this,void 0,void 0,(function(){var e;return Ws(this,(function(t){switch(t.label){case 0:return e=[],this.validateSprites.length&&Nl(this.validateSprites,(function(t,i){t.invalid&&e.push(new Promise((function(e,i){t.events.once("validated",(function(t){e()}))})))})),e.length?[4,Promise.all(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.processConfig=function(t){Bu.registeredClasses.ExportMenu=Ap,t&&(nl(t.menu)&&!nl(t.menu.type)&&(t.menu.type="ExportMenu"),nl(t.dataFields)&&ul(t.dataFields)&&(this.dataFields=t.dataFields,delete t.dataFields)),e.prototype.processConfig.call(this,t)},t.XLINK="http://www.w3.org/1999/xlink",t}(Dp),Np=["fill","fillOpacity","stroke","strokeOpacity","strokeWidth","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin"],Up=function(e){function t(){var t=e.call(this)||this;return t.properties={},t._eventDispatcher=new yh(t),t._bindings={},t._isTemplate=!1,t._isPath=!1,t._inited=!1,t._ready=!1,t.isHiding=!1,t._isHidden=!1,t.isShowing=!1,t.isStandaloneInstance=!1,t._isActive=!1,t._mask=new iu,t._positionPrecision=3,t._language=new iu,t._exporting=new iu,t._exportable=!0,t._bbox={x:0,y:0,width:0,height:0},t.invalid=!1,t.positionInvalid=!1,t.propertyFields={},t.applyOnClones=!1,t._measuredWidthSelf=0,t._measuredHeightSelf=0,t.maxLeft=0,t.maxRight=0,t.maxTop=0,t.maxBottom=0,t.maxLeftSelf=0,t.maxRightSelf=0,t.maxTopSelf=0,t.maxBottomSelf=0,t._isDragged=!1,t._isResized=!1,t._disabled=!1,t._internalDisabled=!1,t._updateDisabled=!1,t._internalDefaultsApplied=!1,t.rollOutDelay=0,t.isBaseSprite=!1,t.shouldClone=!0,t.appeared=!1,t.ex=0,t.ey=0,t.dragWhileResize=!1,t.measureFailed=!1,t.preventShow=!1,t.cloneTooltip=!0,t.className="Sprite",t._disposers.push(t._eventDispatcher),t.uid,t.group=t.paper.addGroup("g"),t.setPropertyValue("scale",1),t.setPropertyValue("rotation",0),t.setPropertyValue("align","none"),t.setPropertyValue("valign","none"),t.setPropertyValue("pixelPerfect",!1),t.setPropertyValue("visible",!0),t.setPropertyValue("tooltipPosition","fixed"),t.setPropertyValue("verticalCenter","none"),t.setPropertyValue("horizontalCenter","none"),t.setPropertyValue("tooltipX",Ks(50)),t.setPropertyValue("tooltipX",Ks(50)),t.setPropertyValue("marginTop",0),t.setPropertyValue("marginBottom",0),t.setPropertyValue("marginLeft",0),t.setPropertyValue("marginRight",0),t.setPropertyValue("dx",0),t.setPropertyValue("dy",0),t.setPropertyValue("paddingTop",0),t.setPropertyValue("paddingBottom",0),t.setPropertyValue("paddingRight",0),t.setPropertyValue("paddingLeft",0),t.setPropertyValue("togglable",!1),t.setPropertyValue("hidden",!1),t.setPropertyValue("urlTarget","_self"),t.setPropertyValue("alwaysShowTooltip",!1),t.setPropertyValue("showTooltipOn","hover"),t._prevMeasuredWidth=0,t._prevMeasuredHeight=0,t._measuredWidth=0,t._measuredHeight=0,t._isMeasured=!0,t.invalidate(),t.applyTheme(),t._disposers.push(t.events),t._disposers.push(t.group),t._disposers.push(t._mask),t._disposers.push(t._language),t._disposers.push(t._exporting),t._disposers.push(new eu((function(){gu(t._bindings,(function(e,t){t.dispose()}))}))),t.setPropertyValue("interactionsEnabled",!0),t}return Us(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return this._eventDispatcher},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adapter",{get:function(){return this._adapterO||(this._adapterO=new ec(this)),this._adapterO},enumerable:!0,configurable:!0}),t.prototype.applyTheme=function(){e.prototype.applyTheme.call(this),_h.autoSetClassName&&this.setClassName()},t.prototype.getCurrentThemes=function(){var e=this._themes;if(e)return e;var t=this._parent;return t?t.getCurrentThemes():Bu.themes},t.prototype.applyInternalDefaults=function(){this._internalDefaultsApplied=!0},t.prototype.invalidate=function(){this.disabled||this._isTemplate||this.__disabled||this.invalid||(this.invalid=!0,Bu.addToInvalidSprites(this),Zp.requestFrame())},t.prototype.validate=function(){this.dispatchImmediately("beforevalidated"),this._internalDefaultsApplied||this.applyInternalDefaults(),this.beforeDraw(),this.draw(),this.invalid=!1,Bu.removeFromInvalidSprites(this),this.afterDraw()},t.prototype.invalidatePosition=function(){this.disabled||this._isTemplate||this.positionInvalid||(this.positionInvalid=!0,Bu.addToInvalidPositions(this),Zp.requestFrame())},t.prototype.validatePosition=function(){var e=this.pixelX,t=this.pixelY,i=this.dx,n=this.dy,r=e+i,a=t+n;this._updateDisabled&&(this._internalDisabled?this.group.attr({display:"none"}):this.disabled||this.removeSVGAttribute("display"),this._updateDisabled=!1);var o=this.measure(),s=this.group.transformString;this.group.moveTo({x:r,y:a}),this.group.rotation=this.rotation,this.nonScaling?this.group.scale=this.scale/this.globalScale:this.group.scale=this.scale,(s!=this.group.transformString||o)&&(null==s?this.dispatch("transformed"):this.dispatchImmediately("transformed"),this.dispatch("positionchanged"),"hit"!=this.showTooltipOn&&"always"!=this.showTooltipOn||this.updateTooltipPosition()),e+i==r&&t+n==a&&(Bu.removeFromInvalidPositions(this),this.positionInvalid=!1);var l=this._maskRectangle;l&&this._clipElement.moveTo({x:l.x-e,y:l.y-t})},t.prototype.beforeDraw=function(){},t.prototype.draw=function(){},t.prototype.afterDraw=function(){var e,t;if((this.isMeasured||"none"!==this.horizontalCenter||"none"!==this.verticalCenter)&&this.measureElement(),this._inited)this.dispatch("validated");else{if(this._adapterO)try{for(var i=Hs(this._adapterO.keys()),n=i.next();!n.done;n=i.next()){var r=n.value;switch(r){case"mask":case"fill":case"opacity":case"fillOpacity":case"stroke":case"strokeOpacity":case"strokeWidth":case"shapeRendering":case"strokeDasharray":case"strokeDashoffset":case"strokeLinecap":case"strokeLinejoin":case"textDecoration":case"fontSize":case"fontFamily":case"fontWeight":this[r]=this[r]}}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.applyFilters(),this.visible=this.visible,this.interactionsEnabled=this.getPropertyValue("interactionsEnabled"),this._inited=!0,this.showOnInit||(this.appeared=!0),this.hidden&&this.hide(0),this.applyMask(),this.dispatch("validated"),this.dispatch("inited"),this.dispatchReady()}"always"==this.showTooltipOn&&(!this.visible||this.disabled||this.__disabled?this.hideTooltip(0):this.showTooltip())},t.prototype.dispatchReady=function(){this.isReady()||(this._ready=!0,this.dispatch("ready"))},t.prototype.reinit=function(){this._inited=!1,this.setState(this.defaultState),this.invalidate()},t.prototype.handleGlobalScale=function(){this.dispatch("globalscalechanged"),this.nonScalingStroke&&(this.strokeWidth=this.strokeWidth),this.nonScaling&&this.validatePosition(),this.updateFilterScale()},t.prototype.updateFilterScale=function(){var e=this;Tu(this.filters.iterator(),(function(t){t.scale=e.globalScale}))},t.prototype.removeFromInvalids=function(){Bu.removeFromInvalidSprites(this),Bu.removeFromInvalidPositions(this)},t.prototype.copyFrom=function(t){var i=this;e.prototype.copyFrom.call(this,t),this.isMeasured=t.isMeasured,this.states.copyFrom(t.states),t.filters.length>0&&t.filters.each((function(e){i.filters.push(e.clone())})),t._adapterO&&this.adapter.copyFrom(t._adapterO),t._interaction&&this.interactions.copyFrom(t.interactions),t._plugins&&this.plugins.copyFrom(t.plugins),this.configField=t.configField,this.applyOnClones=t.applyOnClones,this.disabled=t.disabled,this.virtualParent=t.virtualParent,this.exportable=t.exportable,t._tooltip&&(this._tooltip?this._tooltip.copyFrom(t.tooltip):t.cloneTooltip?this.tooltip=t.tooltip.clone():this._tooltip=t.tooltip),this._showSystemTooltip=t.showSystemTooltip,_c(t.propertyFields,this.propertyFields),_c(t.properties,this),t.fillModifier&&(this.fillModifier=t.fillModifier.clone()),t.strokeModifier&&(this.strokeModifier=t.strokeModifier.clone()),t.focusFilter&&(this.focusFilter=t.focusFilter.clone())},t.prototype.dispose=function(){if(!this.isDisposed()){if("always"==this.showTooltipOn&&this.tooltip&&this.tooltip.hide(),this.dispatchImmediately("beforedisposed"),this.isBaseSprite){if(this.htmlContainer)for(;this.htmlContainer.childNodes.length>0;)this.htmlContainer.removeChild(this.htmlContainer.firstChild);this.isBaseSprite=!1}if(e.prototype.dispose.call(this),this._adapterO&&this._adapterO.clear(),this.applyOnClones&&this._clones)for(var t=this._clones.length-1;t>=0;t--){this._clones.getIndex(t).dispose()}this._svgContainer&&this._svgContainer.dispose(),this._interactionDisposer&&(this._interactionDisposer.dispose(),this._interactionDisposer=void 0),this._urlDisposer&&this._urlDisposer.dispose(),this.removeFromInvalids(),this.element&&this.element.dispose(),this.group&&this.group.dispose(),this._numberFormatter&&this._numberFormatter.dispose(),this._focusFilter&&this._focusFilter.dispose();var i=this.stroke;!i||i instanceof lc||!i.dispose||this.clonedFrom&&this.clonedFrom.stroke==i||i.dispose();var n=this.fill;if(!n||n instanceof lc||!n.dispose||this.clonedFrom&&this.clonedFrom.fill==n||n.dispose(),nl(this.id)&&this.map.removeKey(this.id),this.parent=void 0,this._filters)for(;this._filters.length>0;){var r=this._filters.getIndex(0);r.dispose(),this._filters.removeValue(r)}this._alwaysShowDisposers=void 0}},Object.defineProperty(t.prototype,"isTemplate",{get:function(){return this._isTemplate},set:function(e){e=Qs(e),this._isTemplate!=e&&(this._isTemplate=e,this instanceof Wp&&Tu(this.children.iterator(),(function(t){t.isTemplate=e})),e?(this.parent=this._parent,this.removeFromInvalids()):this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSystemTooltip",{get:function(){return nl(this._showSystemTooltip)?this._showSystemTooltip:this.virtualParent?this.virtualParent.showSystemTooltip:!!this._parent&&this._parent.showSystemTooltip},set:function(e){e=Qs(e),this._showSystemTooltip!=e&&(this._showSystemTooltip=e,this.applyAccessibility())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topParent",{get:function(){return this._topParent?this._topParent:this._parent?this._parent.topParent:void 0},set:function(e){this._topParent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},set:function(e){if(!this._isTemplate){this.paper;var t=this._parent;t!=e&&(t&&t.children.removeValue(this),this._parent=e,e?(this.topParent=e.topParent,e.isTemplate&&(this.isTemplate=!0),this.baseId=e.baseId,e.children.push(this),this._tooltip&&!this._tooltipContainer&&(this._tooltip.parent=e.tooltipContainer),this._dataItem||(this.dataItem=e.dataItem),this.handleAlwaysShowTooltip(),this.dataItem&&this.applyAccessibility(),this.dispatchImmediately("parentset")):this.topParent=void 0)}},enumerable:!0,configurable:!0}),t.prototype.handleAlwaysShow=function(){this.showTooltip()},t.prototype.handleAlwaysShowTooltip=function(){var e=this,t=this._alwaysShowDisposers;if(t&&Nl(t,(function(e){e.dispose()})),this._alwaysShowDisposers=[],"always"==this.showTooltipOn)for(;void 0!=e;){var i=e.events.on("visibilitychanged",this.handleAlwaysShow,this,!1);this.addDisposer(i),this._alwaysShowDisposers.push(i),e=e.parent}},Object.defineProperty(t.prototype,"virtualParent",{get:function(){return this._virtualParent},set:function(e){this._virtualParent=e,this.dataItem&&this.applyAccessibility()},enumerable:!0,configurable:!0}),t.prototype.appendDefs=function(){this.filterElement&&this.paper.appendDef(this.filterElement);var e=this.fill;e&&e.element&&this.paper.appendDef(e.element);var t=this.stroke;if(t&&t.element&&this.paper.appendDef(t.element),this.fillModifier&&this.fill instanceof lc){var i=this.fillModifier.modify(this.fill);i&&i.element&&this.paper.appendDef(i.element)}if(this.strokeModifier&&this.stroke instanceof lc){var n=this.strokeModifier.modify(this.stroke);n&&n.element&&this.paper.appendDef(n.element)}this._clipPath&&this.paper.appendDef(this._clipPath),!1===this._exportable&&(this.exportable=!1)},Object.defineProperty(t.prototype,"map",{get:function(){var e=this.topParent;return e?e.map:(this._map||(this._map=new Lu),this._map)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delayedMap",{get:function(){var e=this.topParent;return e?e.delayedMap:(this._delayedMap||(this._delayedMap=new Lu),this._delayedMap)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){if(this._id!=e){if(this._id=e,this.map.hasKey(e))throw Error("Duplicate id ("+e+") used on multiple objects.");this.map.setKey(e,this),_h.autoSetClassName&&this.setClassName()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dom",{get:function(){return this.group.node},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paper",{get:function(){if(this._paper)return this._paper;var e=this._parent;return e?e.paper:yp()},set:function(e){this.setPaper(e)},enumerable:!0,configurable:!0}),t.prototype.setPaper=function(e){return this._paper!=e&&(this._paper=e,this.appendDefs(),!0)},Object.defineProperty(t.prototype,"htmlContainer",{get:function(){if(this._htmlContainer)return this._htmlContainer;var e=this._parent;return e?e.htmlContainer:void 0},set:function(e){this._htmlContainer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titleElement",{get:function(){return this._titleElement||(this._titleElement=this.paper.add("title"),this.group.add(this._titleElement)),this._titleElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptionElement",{get:function(){return this._descriptionElement||(this._descriptionElement=this.paper.add("desc"),this.group.add(this._descriptionElement)),this._descriptionElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters||(this._filters=new Wu,this._disposers.push(this._filters.events.onAll(this.applyFilters,this)),this._disposers.push(new Uu(this._filters))),this._filters},enumerable:!0,configurable:!0}),t.prototype.setSVGAttributes=function(){this.fill=this.fill,this.opacity=this.opacity,this.fillOpacity=this.fillOpacity,this.stroke=this.stroke,this.strokeOpacity=this.strokeOpacity,this.shapeRendering=this.shapeRendering,this.strokeDasharray=this.strokeDasharray,this.strokeDashoffset=this.strokeDashoffset,this.strokeLinecap=this.strokeLinecap,this.strokeLinejoin=this.strokeLinejoin,this.focusable=this.focusable,this.tabindex=this.tabindex,this.role=this.role},t.prototype.setSVGAttribute=function(e){this.group.attr(e)},t.prototype.removeSVGAttribute=function(e){this.group.removeAttr(e)},t.prototype.setClassName=function(){var e=this.className,t=_h.classNamePrefix;this.element&&this.element.addClass(t+e),this.group.addClass(t+e+"-group"),nl(this.id)&&this.group.addClass(t+this.id),this.userClassName&&this.group.addClass(this.userClassName)},t.prototype.uidAttr=function(){return this.setSVGAttribute({id:this.uid}),this.uid},t.prototype.updateClipPath=function(){var e=this._clipElement;e&&e.moveTo({x:this.mask.pixelX,y:this.mask.pixelY})},t.prototype.createClipPath=function(){if(!this._clipPath){this._clipPath=this.paper.addGroup("clipPath"),this.paper.appendDef(this._clipPath),this._disposers.push(this._clipPath);var e=Bu.getUniqueId();this._clipPath.attr({id:e}),this.group.attr({"clip-path":'url("'+xc()+e+'")'})}},t.prototype.applyMask=function(){var e=this.mask;if(this._clipPath&&e)if(e instanceof Wp){this._clipElement.attr({width:xl(0,e.pixelWidth),height:xl(0,e.pixelHeight)});var t=qc({x:e.pixelX,y:e.pixelY},e.parent,this);this._clipPath.x=t.x,this._clipPath.y=t.y}else e.element&&e.element!=this._clipElement&&(this._clipElement=e.element,this._clipPath.add(this._clipElement)),this._clipPath.scale=e.scale,this._clipPath.x=e.pixelX,this._clipPath.y=e.pixelY,this._clipPath.rotation=e.rotation},t.prototype.applyFilters=function(){var e=this;if(this._filters&&this._filters.length>0){var t=100,i=100;this.filterElement?this.filterElement.removeChildNodes():(this.filterElement=this.paper.addGroup("filter"),this._disposers.push(this.filterElement)),this.paper.appendDef(this.filterElement);var n="filter-"+this.uid;this.filterElement.attr({id:n}),Tu(this.filters.iterator(),(function(n){n.sprite=e,n.paper=e.paper,e.filterElement.attr({filterUnits:n.filterUnits}),n.appendPrimitives(e.filterElement),n.width>t&&(t=n.width),n.height>i&&(i=n.height),n.scale=e.globalScale}));var r=t+"%",a=i+"%";this.filterElement.attr({width:r,height:a,x:-(t-100)/2+"%",y:-(i-100)/2+"%"}),this.group.attr({filter:'url("'+xc()+n+'")'})}else this.filterElement&&(this.group.removeAttr("filter"),this.filterElement.removeChildNodes())},t.prototype.removeClipPath=function(){this._clipPath&&(this.removeDispose(this._clipPath),this._clipPath=void 0)},t.prototype.setElement=function(e){this.element=e,this.setSVGAttributes(),this.applyAccessibility()},Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(e){this.removeElement(),this._element=e,this.group.add(e),e.node instanceof SVGPathElement&&(this._isPath=!0),this.invalid||this.validate(),_h.autoSetClassName&&this.setClassName()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"svgContainer",{get:function(){return this._svgContainer?this._svgContainer:this._parent?this._parent.svgContainer:void 0},set:function(e){this._svgContainer=e},enumerable:!0,configurable:!0}),t.prototype.measureElement=function(){if(this.element)if(this.definedBBox)this._bbox=this.definedBBox;else{var e=this.element.getBBox();this._bbox={x:e.x,y:e.y,width:e.width,height:e.height}}},t.prototype.updateCenter=function(){if(this.element){var e=this.element.transformString,t=this.bbox,i=0,n=0,r=t.x,a=t.y,o=t.width,s=t.height,l=this.pixelPaddingLeft,u=this.pixelPaddingRight,c=this.pixelPaddingTop,h=this.pixelPaddingBottom,p=xl(o+l+u,this.pixelWidth),d=xl(s+c+h,this.pixelHeight),f=t.x,m=t.x+p,v=t.y,y=t.y+d,g=this.horizontalCenter,_=this.verticalCenter;switch(g){case"none":i=r+l;break;case"left":i=l;break;case"middle":i=l-(o+u+l)/2;break;case"right":i=-u-o}switch(_){case"none":n=a+c;break;case"top":n=c;break;case"middle":n=c-(s+h+c)/2;break;case"bottom":n=-h-s}this._measuredHeight=d,this._measuredWidth=p;var b=vl(i-r,this._positionPrecision,!0),x=vl(n-a,this._positionPrecision,!0);this.ex=b-l,this.ey=x-c,this.maxLeft=f+b-l,this.maxRight=m+b-l,this.maxTop=v+x-c,this.maxBottom=y+x-c,this.pixelPerfect&&0==_h.pixelPerfectPrecision&&(b-=.5,x-=.5),this.element.moveTo({x:b,y:x}),e!=this.element.transformString&&this.dispatchImmediately("transformed")}},t.prototype.measure=function(){this.updateCenter();var e=this._measuredWidth,t=this._measuredHeight,i=this.maxLeft,n=this.maxRight,r=this.maxTop,a=this.maxBottom;this._measuredWidthSelf=e,this._measuredHeightSelf=t;var o=this._positionPrecision;if(this.maxLeftSelf=this.maxLeft,this.maxRightSelf=this.maxRight,this.maxTopSelf=this.maxTop,this.maxBottomSelf=this.maxBottom,0!==this.rotation||1!==this.scale||this.nonScaling){this.nonScalingStroke&&(this.strokeWidth=this.strokeWidth);var s=this.paper.svg,l=s.createSVGMatrix(),u=this.rotation,c=this.scale;this.nonScaling&&(c=this.scale/this.globalScale),l.a=bl(u)*c,l.c=-_l(u)*c,l.e=0,l.b=_l(u)*c,l.d=bl(u)*c,l.f=0;var h=s.createSVGPoint();h.x=i,h.y=r;var p=s.createSVGPoint();p.x=n,p.y=r;var d=s.createSVGPoint();d.x=n,d.y=a;var f=s.createSVGPoint();f.x=i,f.y=a;var m=h.matrixTransform(l),v=p.matrixTransform(l),y=d.matrixTransform(l),g=f.matrixTransform(l);i=Math.min(m.x,v.x,y.x,g.x),n=Math.max(m.x,v.x,y.x,g.x),r=Math.min(m.y,v.y,y.y,g.y),e=n-i,t=(a=Math.max(m.y,v.y,y.y,g.y))-r,this.maxLeft=vl(i,o,!0),this.maxRight=vl(n,o,!0),this.maxTop=vl(r,o,!0),this.maxBottom=vl(a,o,!0)}return this._measuredWidth=vl(e,o,!0),this._measuredHeight=vl(t,o,!0),(this._measuredWidth!=this._prevMeasuredWidth||this._measuredHeight!=this._prevMeasuredHeight)&&(this._prevMeasuredHeight=this._measuredHeight,this._prevMeasuredWidth=this._measuredWidth,this.dispatch("sizechanged"),(this.isHover||"hit"==this.showTooltipOn||"always"==this.showTooltipOn)&&this.tooltip&&this.tooltip.visible&&(nl(this.tooltipText)||nl(this.tooltipHTML))&&this.updateTooltipPosition(),!0)},t.prototype.insertBefore=function(e){var t=this._parent;if(t){var i=t.children.indexOf(e);-1!==i&&(t.children.moveValue(this,i),t.sortChildren())}return this},t.prototype.insertAfter=function(e){var t=this._parent;if(t){var i=t.children.indexOf(e);-1!==i&&(t.children.moveValue(this,i+1),t.sortChildren())}return this},t.prototype.removeElement=function(){this._element&&(this.removeDispose(this._element),this._element=void 0)},t.prototype.getRelativeX=function(e){return e instanceof Xs?e.value:this._parent?e/this._parent.innerWidth:0},t.prototype.getRelativeY=function(e){return e instanceof Xs?e.value:this._parent?e/this._parent.innerHeight:0},t.prototype.getPixelX=function(e){var t=0;if(ll(e))t=e;else if(e instanceof Xs){var i=e.value;this._parent&&(t=vl(this._parent.innerWidth*i,this._positionPrecision,!0))}return t},t.prototype.getPixelY=function(e){var t=0;if(ll(e))t=e;else if(e instanceof Xs){var i=e.value;this._parent&&(t=vl(this._parent.innerHeight*i,this._positionPrecision,!0))}return t},t.prototype.moveTo=function(e,t,i,n){this.isDragged&&!n||(e&&(ll(e.x)&&this.setPropertyValue("x",vl(e.x,this._positionPrecision,!0)),ll(e.y)&&this.setPropertyValue("y",vl(e.y,this._positionPrecision,!0))),ll(t)&&(this.rotation=t),ll(i)&&(this.scale=i),this.invalidatePosition())},Object.defineProperty(t.prototype,"mask",{get:function(){return this._adapterO?this._adapterO.apply("mask",this._mask.get()):this._mask.get()},set:function(e){var t=this;this._mask.get()!==e&&(e?(this.createClipPath(),e instanceof Wp?this._clipElement=this.paper.add("rect"):(e.isMeasured=!1,e.element&&(this._clipElement=e.element)),this._clipElement&&this._clipPath.add(this._clipElement),this._mask.set(e,new tu([e.events.on("maxsizechanged",(function(){t.inited&&t.applyMask()}),void 0,!1),e.events.on("validated",this.applyMask,this,!1),e.events.on("positionchanged",this.applyMask,this,!1)])),this.applyMask()):(this._mask.reset(),this.group.removeAttr("clip-path"),this.removeClipPath()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskRectangle",{get:function(){return this._maskRectangle},set:function(e){e?(this.createClipPath(),this._clipElement||(this._clipElement=this.paper.add("rect"),this._clipPath.add(this._clipElement)),this._clipElement.attr({width:e.width,height:e.height})):(this.removeClipPath(),this._clipElement=void 0),this._maskRectangle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMeasured",{get:function(){return this._isMeasured},set:function(e){(e=Qs(e))||(this._measuredWidth=0,this._measuredHeight=0),this._isMeasured!=e&&(this._isMeasured=e,this.invalidatePosition())},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e){this.invalid&&this.validate(),e.invalid&&e.validate();var t=this.pixelX+this.maxLeft,i=this.pixelY+this.maxTop,n=t+this.maxRight,r=i+this.maxBottom,a=e.pixelX+e.maxLeft,o=e.pixelY+e.maxTop,s=a+e.maxRight,l=o+e.maxBottom;return!(a>n||s<t||o>r||l<i)},Object.defineProperty(t.prototype,"inited",{get:function(){return this._inited},enumerable:!0,configurable:!0}),t.prototype.isReady=function(){return this._ready},Object.defineProperty(t.prototype,"states",{get:function(){if(!this._states){var e=new vh;this._states=new zu(e),this._disposers.push(this._states.events.on("insertKey",this.processState,this,!1)),this._disposers.push(this._states.events.on("setKey",this.processState,this,!1)),this._disposers.push(new Au(this._states)),this._disposers.push(e)}return this._states},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hiddenState",{get:function(){if(!this.states.getKey("hidden")){var e=this.states.create("hidden");e.properties.opacity=0,e.properties.visible=!1}return this.states.getKey("hidden")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultState",{get:function(){this.states.getKey("default")||(this.states.create("default").properties.opacity=1);return this.states.getKey("default")},enumerable:!0,configurable:!0}),t.prototype.processState=function(e){var t=e.newValue;if(t.sprite=this,t.name=e.key,(this.states.hasKey("hover")||"hover"==this.showTooltipOn&&(nl(this.tooltipHTML)||nl(this.tooltipText)))&&(this.hoverable=!0),(this.states.hasKey("down")||"hover"==this.showTooltipOn&&(nl(this.tooltipHTML)||nl(this.tooltipText)))&&(this.clickable=!0),this.states.hasKey("focus")&&(this.focusable=!0),this.applyOnClones)for(var i=this.clones.values,n=i.length,r=0;r<n;++r){var a=i[r];a.isDisposed()||a.states.setKey(t.name,t)}},Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations||(this._animations=[],this._disposers.push(new Sh(this._animations))),this._animations},enumerable:!0,configurable:!0}),t.prototype.getSvgPoint=function(e){try{var t=this.htmlContainer.getBoundingClientRect();return{x:e.x-t.left,y:e.y-t.top}}catch(i){return e}},t.prototype.animate=function(e,t,i){return new Th(this,e,t,i).start()},t.prototype.setState=function(e,t,i){var n;if(e instanceof vh)this.states.setKey(e.name,e),n=e;else if(!(n=this.states.getKey(e)))return;if("hover"==n.name){if(this.isHidden)return;this.isHover=!0}return"hidden"==n.name?this.isHiding=!0:this.visible||this.setVisibility(n.properties.visible||this.defaultState.properties.visible),"active"==n.name&&(this.isActive=!0),ll(t)||(t=n.transitionDuration),nl(i)||(i=n.transitionEasing),this.transitTo(n,t,i)},t.prototype.applyCurrentState=function(e){var t=this.setState(this.defaultState,e);return this.isHover&&(t=this.setState("hover",e)),this.isDown&&this.interactions.downPointers.length&&(t=this.setState("down",e)),this.isFocused=this.isFocused,this.isActive&&(t=this.setState("active",e),this.isHover&&this.states.hasKey("hoverActive")&&(t=this.setState("hoverActive",e))),t},t.prototype.transitTo=function(e,t,i){var n,r=this,a=[];if(gu(e.allValues,(function(e,t){var i=r[e];if(t!=i&&void 0==r.defaultState.properties[e]&&(r.defaultState.properties[e]=i),"__unset"!=t){var n={from:i,to:t,property:e};a.push(n)}})),a.length>0&&((n=this.animate(a,t,i))&&!n.isFinished()?this._disposers.push(n.events.on("animationended",(function(){r.dispatchImmediately("transitionended")}))):this.dispatchImmediately("transitionended")),e.filters.length>0){var o=[];Tu(e.filters.iterator(),(function(e){var n=e.clone();o.push(n);var a=[];Tu(r.filters.iterator(),(function(e){e.className==n.className&&(Iu(r.defaultState.filters.iterator(),(function(e){return e.className===n.className}))||r.defaultState.filters.push(e),gu(n.properties,(function(t,i){var n=e.properties[t];n!=i&&a.push({property:t,from:n,to:i})})))})),n.animate(a,t,i)})),this.filters.clear(),this.filters.pushAll(o)}return n},t.prototype.isInTransition=function(){return this.animations.length>0},Object.defineProperty(t.prototype,"isHover",{get:function(){return!!this.isInteractive()&&this.interactions.isHover},set:function(e){(e=Qs(e))!==this.isHover&&this.isInteractive()&&(this.interactions.isHover=e,e?this.handleOver():(this.interactions.isRealHover=!1,this.handleOut()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDragged",{get:function(){return this._isDragged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResized",{get:function(){return this._isResized},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDown",{get:function(){return!!this.isInteractive()&&this.interactions.isDown},set:function(e){e=Qs(e),this.isInteractive()&&this.isDown!=e&&(this.interactions.isDown=e,e?this.handleDown():this.handleUp())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return!!this.isInteractive()&&this.interactions.isFocused},set:function(e){e=Qs(e),this.focusable&&this.isFocused!=e&&this.isInteractive()&&(this.interactions.isFocused=e,!0===e?this.handleFocus():this.handleBlur())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},set:function(e){this.setActive(e)},enumerable:!0,configurable:!0}),t.prototype.setActive=function(e){e=Qs(e),this._isActive!==e&&(this._isActive=e,e&&this.states.hasKey("active")?(this.setState("active"),this.isHover&&this.states.hasKey("hoverActive")&&this.setState("hoverActive")):this.applyCurrentState(),this.dispatchImmediately("toggled"))},Object.defineProperty(t.prototype,"disabled",{get:function(){var e=this.getPropertyValue("disabled");return nl(e)?e:this.virtualParent?this.virtualParent.disabled:!!this._parent&&this._parent.disabled},set:function(e){this.setDisabled(e)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(e){if(e=Qs(e),this.getPropertyValue("disabled")!=e){if(this.setPropertyValue("disabled",e,!0),e)this.parent=this._parent,this.removeFromInvalids(),this.group.attr({display:"none"}),this.dispatch("disabled");else{if(this._parent){var t=this._parent.element;t.hasChild(this.group)||t.add(this.group)}this instanceof Wp?(this.deepInvalidate(),this._background&&this._background.invalidate()):this.invalidate(),this.__disabled||this.removeSVGAttribute("display"),this.dispatch("enabled")}return this.dispatch("transformed"),Zp.requestFrame(),!0}return!1},Object.defineProperty(t.prototype,"__disabled",{get:function(){return this._internalDisabled},set:function(e){this._internalDisabled!=e&&(this._internalDisabled=e,this._updateDisabled=!0,this.invalidatePosition(),e||this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberFormatter",{get:function(){return this._numberFormatter?this._numberFormatter:this.virtualParent?this.virtualParent.numberFormatter:this._parent?this._parent.numberFormatter:(this._numberFormatter=new Ep,this._numberFormatter.language=this.language,this.numberFormatter)},set:function(e){this._numberFormatter=e,this._numberFormatter.language=this.language},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateFormatter",{get:function(){return this._dateFormatter?this._dateFormatter:this.virtualParent?this.virtualParent.dateFormatter:this._parent?this._parent.dateFormatter:(this._dateFormatter=new Cp,this._dateFormatter.language=this.language,this.dateFormatter)},set:function(e){this._dateFormatter=e,this._dateFormatter.language=this.language},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationFormatter",{get:function(){return this._durationFormatter?this._durationFormatter:this.virtualParent?this.virtualParent.durationFormatter:this._parent?this._parent.durationFormatter:(this._durationFormatter=new Mp,this._durationFormatter.language=this.language,this.durationFormatter)},set:function(e){this._durationFormatter=e,this._durationFormatter.language=this.language},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){var e=this._language.get();return e||(this.virtualParent?this.virtualParent.language:this._parent?this._parent.language:(e=new Pp,this.language=e,e))},set:function(e){var t=this;this._language.get()!==e&&this._language.set(e,e.events.on("localechanged",(function(e){if(t._numberFormatter&&(t._numberFormatter.language=t.language),t._dateFormatter&&(t._dateFormatter.language=t.language),t._durationFormatter&&(t._durationFormatter.language=t.language),t._exporting.get()){var i=t._exporting.get();i.numberFormatter.language=t.language,i.dateFormatter.language=t.language,i.durationFormatter.language=t.language,i.language=t.language}t instanceof Wp&&t.deepInvalidate()})))},enumerable:!0,configurable:!0}),t.prototype.populateString=function(e,t){if(nl(e)){e=Js(e);var i=(e=Tp().escape(e)).match(/\{([^}]+)\}/g),n=void 0;if(i)for(n=0;n<i.length;n++){var r=i[n].replace(/\{([^}]+)\}/,"$1"),a=this.getTagValue(r,"",t);nl(a)||(a=""),e=e.split(i[n]).join(a)}e=Tp().unescape(e)}else e="";return this._adapterO?this._adapterO.apply("populateString",e):e},t.prototype.getTagValue=function(e,t,i){var n;nl(i)||(i=this.dataItem);for(var r,a=[],o=/([^.]+)\(([^)]*)\)|([^.]+)/g;null!==(r=o.exec(e));)if(r[3])a.push({prop:r[3]});else{var s=[];if(""!=Mc(r[2]))for(var l=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g,u=void 0;null!==(u=l.exec(r[2]));)s.push(u[1]||u[2]||u[3]);a.push({method:r[1],params:s})}if(i){nl(n=this.getTagValueFromObject(a,i.values))&&!ul(n)||(n=this.getTagValueFromObject(a,i));var c=i.dataContext;!nl(n)&&c&&(nl(n=this.getTagValueFromObject(a,i.dataContext))||(n=this.getTagValueFromObject([{prop:e}],c)),!nl(n)&&c.dataContext&&(n=this.getTagValueFromObject(a,c.dataContext))),!nl(n)&&i.component&&i.component.dataItem!==i&&(n=i.component.getTagValue(e,t))}return nl(n)||(n=this.getTagValueFromObject(a,this.populateStringFrom||this)),!nl(n)&&this._parent&&(n=this._parent.getTagValue(e,t)),n},t.prototype.getTagValueFromObject=function(e,t,i){for(var n=t,r=!1,a=0,o=e.length;a<o;a++){var s=e[a];if(s.prop){if(!nl(n=n[s.prop]))return}else switch(s.method){case"formatNumber":var l=Fc(n);nl(l)&&(n=this.numberFormatter.format(l,i||s.params[0]||void 0),r=!0);break;case"formatDate":var u=void 0;if(!ol(u=sl(n)?this.dateFormatter.parse(n):Rc(n))||Ys(u.getTime()))return;nl(u)&&(n=this.dateFormatter.format(u,i||s.params[0]||void 0),r=!0);break;case"formatDuration":var c=Fc(n);nl(c)&&(n=this.durationFormatter.format(c,i||s.params[0]||void 0,s.params[1]||void 0),r=!0);break;case"urlEncode":case"encodeURIComponent":n=encodeURIComponent(n);break;default:n[s.method]&&n[s.method].apply(this,s.params)}}if(!r){var h=[{method:"",params:i}];if(nl(i)){var p=function(e){if("undefined"===typeof e)return dc;var t=(e=(e=(e=e.toLowerCase().replace(/^\[[^\]]*\]/,"")).replace(/\[[^\]]+\]/,"")).trim()).match(/\/(date|number|duration)$/);return t?t[1]:e===fc?fc:e===mc?mc:e===vc?vc:e.match(/[#0]/)?fc:e.match(/[ymwdhnsqaxkzgtei]/)?mc:dc}(i);p===fc?h[0].method="formatNumber":p===mc?h[0].method="formatDate":p===vc&&(h[0].method="formatDuration")}else ll(n)?(h[0].method="formatNumber",h[0].params=""):ol(n)&&(h[0].method="formatDate",h[0].params="");h[0].method&&(n=this.getTagValueFromObject(h,n))}return n},Object.defineProperty(t.prototype,"dataItem",{get:function(){if(!this._dataItem){if(this.virtualParent)return this.virtualParent.dataItem;if(this._parent)return this._parent.dataItem}return this._dataItem},set:function(e){this.setDataItem(e)},enumerable:!0,configurable:!0}),t.prototype.setDataItem=function(e){var t=this;if(this._dataItem!=e){if(this._dataItem=e,e){if(this.configField){var i=e.dataContext;i&&(this.config=i[this.configField],!this.config&&i.dataContext&&(this.config=i.dataContext[this.configField]))}var n=e.dataContext;if(n){var r=n.dataContext;gu(this.propertyFields,(function(e,i){if(nl(n[i]))t[e]=n[i];else if(r){var a=r[i];if(nl(a))t[e]=a}}))}}this.invalidate()}},t.prototype.getPropertyValue=function(e){var t=this.properties[e];return this._isTemplate||(this._adapterO&&(t=this._adapterO.apply(e,t)),t=Qu.applyAll(this,e,t)),t},t.prototype.setColorProperty=function(e,t,i){var n=this.properties[e];return!(t instanceof lc&&n instanceof lc&&t.toString()==n.toString())&&this.setPropertyValue(e,t,i)},t.prototype.setPercentProperty=function(e,t,i,n,r,a){if(ll(t=il(t)))return ll(r)&&(t=vl(t,r,a)),this.setPropertyValue(e,t,i,n);var o=this.properties[e];return!(t instanceof Xs&&o instanceof Xs&&t.value==o.value)&&this.setPropertyValue(e,t,i,n)},t.prototype.setPropertyValue=function(e,t,i,n){if(this.properties[e]!==t&&!this.isDisposed()){if(this.properties[e]=t,this.events.isEnabled("propertychanged")){var r={type:"propertychanged",target:this,property:e};this.events.dispatchImmediately("propertychanged",r)}if(i&&this.invalidate(),n&&this.invalidatePosition(),this.applyOnClones)for(var a=this.clones.values,o=a.length,s=0;s<o;++s){var l=a[s];l.isDisposed()||(l[e]=t)}return!0}return!1},t.prototype.bind=function(e,t,i,n){var r=this;void 0===i&&(i=e),nl(this._bindings[e])&&this._bindings[e].dispose(),this[e]=t[i],this._bindings[e]=t.events.on("propertychanged",(function(a){if(a.property===i){var o=t[i];n&&(o=n(o)),r[e]=o}}))},t.prototype.observe=function(e,t,i,n){var r=this;return new tu(Vl(Zl(e),(function(e){return r.events.on("propertychanged",(function(n){n.property===e&&t.call(i,n)}),i,n)})))},t.prototype.applyAccessibility=function(){var e=this.readerTitle,t=this.readerDescription,i=this.role,n=this.readerHidden,r=this.readerChecked,a=this.readerControls,o=this.readerLive,s=this.readerOrientation,l=this.readerValueNow,u=this.readerValueText,c=[],h=[],p=this.readerLabelledBy;p&&c.push(p);var d=this.readerDescribedBy;if(d&&h.push(d),e)if(c.length||this.showSystemTooltip){var f=this.titleElement,m=this.uid+"-title";f.node.textContent!=e&&(f.node.textContent=e,f.attr({id:m})),c.push(m)}else this._titleElement&&(this.group.removeElement(this._titleElement),this._titleElement=void 0),this.setSVGAttribute({"aria-label":e});else this.removeSVGAttribute("aria-label"),this._titleElement&&(this.group.removeElement(this._titleElement),this._titleElement=void 0);if(t){var v=this.descriptionElement,y=this.uid+"-description";v.node.textContent!=t&&(v.node.textContent=t,v.attr({id:y})),h.push(y)}else this._descriptionElement&&(this.group.removeElement(this._descriptionElement),this._descriptionElement=void 0);c.length?this.setSVGAttribute({"aria-labelledby":c.join(" ")}):this.removeSVGAttribute("aria-labelledby"),h.length?this.setSVGAttribute({"aria-describedby":h.join(" ")}):this.removeSVGAttribute("aria-describedby"),i?this.setSVGAttribute({role:i}):this.removeSVGAttribute("role"),n?this.setSVGAttribute({"aria-hidden":"true"}):this.removeSVGAttribute("aria-hidden"),r?this.setSVGAttribute({"aria-checked":"true"}):!1===r?this.setSVGAttribute({"aria-checked":"false"}):this.removeSVGAttribute("aria-checked"),a?this.setSVGAttribute({"aria-controls":a}):this.removeSVGAttribute("aria-controls"),o?this.setSVGAttribute({"aria-live":o}):this.removeSVGAttribute("aria-live"),s?this.setSVGAttribute({"aria-orientation":s}):this.removeSVGAttribute("aria-orientation"),l?this.setSVGAttribute({"aria-valuenow":l}):this.removeSVGAttribute("aria-valuenow"),u?this.setSVGAttribute({"aria-valuetext":u}):this.removeSVGAttribute("aria-valuetext")},Object.defineProperty(t.prototype,"readerTitle",{get:function(){var e=this.getPropertyValue("readerTitle");return nl(e)&&this.dataItem?this.populateString(e):e},set:function(e){e=tl(e),this.setPropertyValue("readerTitle",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerDescription",{get:function(){var e=this.getPropertyValue("readerDescription");return nl(e)&&this.dataItem?this.populateString(e):this.getPropertyValue("readerDescription")},set:function(e){e=tl(e),this.setPropertyValue("readerDescription",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){return this.getPropertyValue("role")},set:function(e){e=tl(e),this.setPropertyValue("role",e)&&(this.applyAccessibility(),"slider"==e&&(this.setSVGAttribute({"aria-valuemin":"0"}),this.setSVGAttribute({"aria-valuemax":"100"})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerHidden",{get:function(){return this.getPropertyValue("readerHidden")},set:function(e){e=Qs(e),this.setPropertyValue("readerHidden",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerChecked",{get:function(){return this.getPropertyValue("readerChecked")},set:function(e){e=Qs(e),this.setPropertyValue("readerChecked",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerControls",{get:function(){return this.getPropertyValue("readerControls")},set:function(e){e=tl(e),this.setPropertyValue("readerControls",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerLive",{get:function(){return this.getPropertyValue("readerLive")},set:function(e){e=tl(e),this.setPropertyValue("readerLive",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerLabelledBy",{get:function(){return this.getPropertyValue("readerLabelledBy")},set:function(e){e=tl(e),this.setPropertyValue("readerLabelledBy",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerDescribedBy",{get:function(){return this.getPropertyValue("readerDescribedBy")},set:function(e){e=tl(e),this.setPropertyValue("readerDescribedBy",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerOrientation",{get:function(){return this.getPropertyValue("readerOrientation")},set:function(e){e=tl(e),this.setPropertyValue("readerOrientation",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerValueNow",{get:function(){return this.getPropertyValue("readerValueNow")},set:function(e){e=tl(e),this.setPropertyValue("readerValueNow",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerValueText",{get:function(){return this.getPropertyValue("readerValueText")},set:function(e){e=tl(e),this.setPropertyValue("readerValueText",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keyboardOptions",{get:function(){if(!this.interactions.keyboardOptions){if(this.virtualParent)return this.virtualParent.keyboardOptions;if(this._parent)return this._parent.keyboardOptions}return this.interactions.keyboardOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseOptions",{get:function(){if(!this.interactions.mouseOptions){if(this.virtualParent)return this.virtualParent.mouseOptions;if(this._parent)return this._parent.mouseOptions}return this.interactions.mouseOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interactions",{get:function(){if(!this._interaction){var e=ap().getInteraction(this.dom);this._interaction=e,this._interaction.clickable=this.clickable,this._interaction.hoverable=this.hoverable,this._interaction.trackable=this.trackable,this._interaction.draggable=this.draggable,this._interaction.swipeable=this.swipeable,this._interaction.resizable=this.resizable,this._interaction.wheelable=this.wheelable,this._interaction.contextMenuDisabled=this.contextMenuDisabled,this._interaction.inert=this.inert,this._interaction.sprite=this,this._disposers.push(this._interaction)}return this._interaction},enumerable:!0,configurable:!0}),t.prototype.isInteractive=function(){return!!this._interaction},Object.defineProperty(t.prototype,"focusable",{get:function(){return this.getPropertyValue("focusable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("focusable",e)&&(e||this.isInteractive())&&(this.interactions.focusable=e,e?(this.setSVGAttribute({focusable:e}),nl(this._tabindex)||(this.tabindex=0)):(this.removeSVGAttribute("focusable"),this.tabindex=void 0),this.interactions.setEventDisposer("sprite-focusable",e,(function(){return new tu([t.events.on("blur",t.handleBlur,t,!1),t.events.on("focus",t.handleFocus,t,!1)])})))},enumerable:!0,configurable:!0}),t.prototype.handleFocus=function(e){this.focusable&&(this.topParent&&(this.topParent.hasFocused=!0,this.topParent.focusedElement=this),this.focusFilter&&this.filters.push(this.focusFilter),this.hoverOnFocus&&(this.isHover=!0,this.handleOver()))},t.prototype.handleBlur=function(e){this.focusable&&(this.topParent&&(this.topParent.hasFocused=!1,this.topParent.focusedElement=void 0),this.focusFilter&&this.filters.removeValue(this.focusFilter),this.hoverOnFocus&&(this.isHover=!1,this.handleOut()))},Object.defineProperty(t.prototype,"focusFilter",{get:function(){var e=this._focusFilter;return e||(this.virtualParent?this.virtualParent.focusFilter:this._parent?this._parent.focusFilter:void 0)},set:function(e){this._focusFilter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hoverOnFocus",{get:function(){return this.getPropertyValue("hoverOnFocus")},set:function(e){e!==this.hoverOnFocus&&this.setPropertyValue("hoverOnFocus",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabindex",{get:function(){var e=this._tabindex;return null!=e?e:this.virtualParent?this.virtualParent.tabindex:this._parent?this._parent.tabindex:void 0},set:function(e){e=el(e),this.setPropertyValue("tabindex",e)&&ll(e)&&(this.interactions.tabindex=e,this.setSVGAttribute({tabindex:e}),this._tabindex=e,this.focusable=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inertiaOptions",{get:function(){return!this.interactions.inertiaOptions&&this._parent?this._parent.inertiaOptions:this.interactions.inertiaOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"draggable",{get:function(){return this.getPropertyValue("draggable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("draggable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.draggable=e,this.interactions.setEventDisposer("sprite-draggable",e,(function(){return new tu([t.events.on("down",t.handleDown,t,!1),t.events.on("dragstart",t.handleDragStart,t,!1),t.events.on("drag",t.handleDragMove,t,!1),t.events.on("dragstop",t.handleDragStop,t,!1)])})))},enumerable:!0,configurable:!0}),t.prototype.handleDragStart=function(e){this.interactions.isTouchProtected&&e.touch||(this.interactions.originalPosition={x:this.pixelX,y:this.pixelY},this._isDragged=!0,this.hideTooltip(0))},t.prototype.dragStart=function(e){this._isDragged=!0,ap().dragStart(this.interactions,e)},t.prototype.handleDragStop=function(e){this.interactions.isTouchProtected&&e.touch||(this._isDragged=!1,this.showTooltip(),this.interactions.originalPosition=void 0)},t.prototype.dragStop=function(e,t){this._isDragged=!1,ap().dragStop(this.interactions,e,t)},t.prototype.handleDragMove=function(e){if(!this.interactions.isTouchProtected||!e.touch){var t=this.interactions.originalPosition;if(t&&this._isDragged){var i=this._parent.globalScale*this.svgContainer.cssScale;this.moveTo({x:t.x+e.shift.x/i,y:t.y+e.shift.y/i},void 0,void 0,!0)}this.dispatchImmediately("dragged",e)}},Object.defineProperty(t.prototype,"inert",{get:function(){return this.getPropertyValue("inert")},set:function(e){e=Qs(e),this.setPropertyValue("inert",e)&&(e||this.isInteractive())&&(this.interactions.inert=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hoverOptions",{get:function(){if(!this.interactions.hoverOptions){if(this.virtualParent)return this.virtualParent.hoverOptions;if(this._parent)return this._parent.hoverOptions}return this.interactions.hoverOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hoverable",{get:function(){return this.getPropertyValue("hoverable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("hoverable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.hoverable=e,this.interactions.setEventDisposer("sprite-hoverable",e,(function(){return new tu([t.events.on("over",t.handleOver,t,!1),t.events.on("out",t.handleOut,t,!1)])})))},enumerable:!0,configurable:!0}),t.prototype.handleOver=function(e){if(this._outTimeout&&this._outTimeout.dispose(),this.isHover){this.states.hasKey("hover")&&(this.isHidden||this.applyCurrentState());var t=void 0;e&&e.pointer&&(t=Kc(e.pointer.point,this.svgContainer.SVGContainer,this.svgContainer.cssScale)),"hover"==this.showTooltipOn&&this.showTooltip(t)}else"hover"==this.showTooltipOn&&this.hideTooltip(),!this.isHidden&&this.states.hasKey("hover")&&this.applyCurrentState()},t.prototype.handleOut=function(e){var t=this;this.tooltip&&this.tooltip.targetSprite==this&&this.tooltip.keepTargetHover?this._outTimeout=this.setTimeout((function(){t.tooltip.isHover||(t.tooltip.targetSprite==t&&t.hideTooltip(),t._outTimeout=t.setTimeout(t.handleOutReal.bind(t),t.rollOutDelay))}),10):("hover"==this.showTooltipOn&&this.hideTooltip(),this._outTimeout=this.setTimeout(this.handleOutReal.bind(this),this.rollOutDelay))},t.prototype.handleOutReal=function(){this.isHidden||this.isHiding||!this.states.hasKey("hover")||this.applyCurrentState()},Object.defineProperty(t.prototype,"hitOptions",{get:function(){if(!this.interactions.hitOptions){if(this.virtualParent)return this.virtualParent.hitOptions;if(this._parent)return this._parent.hitOptions}return this.interactions.hitOptions},enumerable:!0,configurable:!0}),t.prototype.handleDown=function(e){1===this.interactions.downPointers.length&&(this.interactions.originalPosition={x:this.pixelX,y:this.pixelY},this.interactions.originalAngle=this.rotation,this.interactions.originalScale=this.scale,this.states.hasKey("down")&&this.setState("down"))},t.prototype.handleUp=function(e){var t=this;this._isResized=!1,this.states.hasKey("down")&&this.applyCurrentState(),"hit"==this.showTooltipOn&&(this.updateTooltipPosition(e.pointer?e.pointer.point:void 0),this._disposers.push(Bu.events.once("exitframe",(function(){t.showTooltip()}))),this._disposers.push(ap().body.events.once("down",(function(e){t.hideTooltip()}))))},Object.defineProperty(t.prototype,"clickable",{get:function(){return this.getPropertyValue("clickable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("clickable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.clickable=e,this.interactions.setEventDisposer("sprite-clickable",e,(function(){return new tu([t.events.on("down",t.handleDown,t,!1),t.events.on("up",t.handleUp,t,!1)])})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"togglable",{get:function(){return this.getPropertyValue("togglable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("togglable",e)&&(e||this.isInteractive())&&this.interactions.setEventDisposer("sprite-togglable",e,(function(){return t.events.on("hit",t.handleToggle,t,!1)}))},enumerable:!0,configurable:!0}),t.prototype.handleToggle=function(e){this.isActive=!this.isActive},Object.defineProperty(t.prototype,"contextMenuDisabled",{get:function(){return this.getPropertyValue("contextMenuDisabled")},set:function(e){e=Qs(e),this.setPropertyValue("contextMenuDisabled",e)&&(this.interactions.contextMenuDisabled=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.getPropertyValue("url")},set:function(e){this.setPropertyValue("url",e)&&(this._urlDisposer&&this._urlDisposer.dispose(),kc(e)&&(this._urlDisposer=this.events.on("hit",this.urlHandler,this,!1),this.clickable=!0,this.cursorOverStyle=wp.pointer))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseId",{get:function(){return!this._baseId&&this._parent&&(this.baseId=this._parent.baseId),this._baseId},set:function(e){this.setBaseId(e)},enumerable:!0,configurable:!0}),t.prototype.setBaseId=function(e){e!=this._baseId&&(this.invalid&&(this.invalid=!1,Bu.removeFromInvalidSprites(this),this.invalidate()),this._baseId=e)},Object.defineProperty(t.prototype,"baseSprite",{get:function(){return this.isBaseSprite?this:this._parent?this._parent.baseSprite:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"urlTarget",{get:function(){return this.getPropertyValue("urlTarget")},set:function(e){this.setPropertyValue("urlTarget",e)},enumerable:!0,configurable:!0}),t.prototype.urlHandler=function(e){if(kc(this.url)){var t=this.populateString(this.url);"_self"===this.urlTarget?window.location.href=t:window.open(t,this.urlTarget)}},Object.defineProperty(t.prototype,"swipeOptions",{get:function(){if(!this.interactions.swipeOptions){if(this.virtualParent)return this.virtualParent.swipeOptions;if(this._parent)return this._parent.swipeOptions}return this.interactions.swipeOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"swipeable",{get:function(){return this.getPropertyValue("swipeable")},set:function(e){e=Qs(e),this.setPropertyValue("swipeable",e)&&(this.applyCursorStyle(),(e||this.isInteractive())&&(this.interactions.swipeable=e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trackable",{get:function(){return this.getPropertyValue("trackable")},set:function(e){e=Qs(e),this.setPropertyValue("trackable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.trackable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wheelable",{get:function(){return this.getPropertyValue("wheelable")},set:function(e){this.setPropertyValue("wheelable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.wheelable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resizable",{get:function(){return this.getPropertyValue("resizable")},set:function(e){var t=this;e=Qs(e),this.setPropertyValue("resizable",e)&&(e||this.isInteractive())&&(this.applyCursorStyle(),this.interactions.resizable=e,this.interactions.setEventDisposer("sprite-resizable",e,(function(){return new tu([t.events.on("down",t.handleDown,t,!1),t.events.on("resize",t.handleResize,t,!1)])})))},enumerable:!0,configurable:!0}),t.prototype.handleResize=function(e){if((!this.interactions.isTouchProtected||!e.touch)&&(this._isResized=!0,this.scale=this.interactions.originalScale*e.scale,this.validatePosition(),this.draggable||this.dragWhileResize)){this._isDragged=!1;var t=El(Kc(e.point1,this.htmlContainer,this.svgContainer.cssScale),Kc(e.point2,this.htmlContainer,this.svgContainer.cssScale)),i=Yc(e.startPoint1,this._parent),n=Yc(e.startPoint2,this._parent),r=this.interactions.originalPosition,a=this.interactions.originalScale;if(r){var o=El({x:(i.x-r.x)/a,y:(i.y-r.y)/a},{x:(n.x-r.x)/a,y:(n.y-r.y)/a}),s=Hc(t,this._parent);this.moveTo({x:s.x-o.x*this.scale,y:s.y-o.y*this.scale},void 0,void 0,!0)}}},Object.defineProperty(t.prototype,"cursorOptions",{get:function(){if(!this.interactions.cursorOptions){if(this.virtualParent)return this.virtualParent.cursorOptions;if(this._parent)return this._parent.cursorOptions}return this.interactions.cursorOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursorOverStyle",{set:function(e){this.cursorOptions.overStyle||(this.interactions.cursorOptions={defaultStyle:this.cursorOptions.defaultStyle}),this.cursorOptions.overStyle=e,ap().applyCursorOverStyle(this.interactions)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursorDownStyle",{set:function(e){this.cursorOptions.downStyle=e},enumerable:!0,configurable:!0}),t.prototype.applyCursorStyle=function(){},Object.defineProperty(t.prototype,"interactionsEnabled",{get:function(){return!1!==this.getPropertyValue("interactionsEnabled")&&(this.virtualParent?this.virtualParent.interactionsEnabled:!this._parent||this._parent.interactionsEnabled)},set:function(e){if(e=Qs(e),this.setPropertyValue("interactionsEnabled",e)){var t=null;e?this.group.node.style.pointerEvents="":t="none",this.group.node.style.pointerEvents=t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exporting",{get:function(){return this.getExporting()},set:function(e){this._exporting.set(e,e)},enumerable:!0,configurable:!0}),t.prototype.getExporting=function(){var e=this._exporting.get();return e||(!this.isStandaloneInstance&&this._parent?this._parent.exporting:((e=new Vp(this.svgContainer.SVGContainer)).sprite=this,e.language=this.language,e.numberFormatter=this.numberFormatter,e.dateFormatter=this.dateFormatter,e.durationFormatter=this.durationFormatter,this._exporting.set(e,e),e))},Object.defineProperty(t.prototype,"exportable",{get:function(){return this._exportable},set:function(e){var t=this.svgContainer;this._exportable=e,t&&(e?Gl(t.nonExportableSprites,this):-1==jl(t.nonExportableSprites,this)&&t.nonExportableSprites.push(this))},enumerable:!0,configurable:!0}),t.prototype.modalPrefix=function(e){return e=_h.classNamePrefix+e},Object.defineProperty(t.prototype,"modal",{get:function(){var e=this.svgContainer;if(e){var t=e.modal;return t.adapter.has("classPrefix",this.modalPrefix)||t.adapter.add("classPrefix",this.modalPrefix),t}},enumerable:!0,configurable:!0}),t.prototype.openModal=function(e,t){var i=this.svgContainer;if(i)return i.openModal(e,t)},t.prototype.closeModal=function(){var e=this.svgContainer;e&&e.closeModal()},Object.defineProperty(t.prototype,"popups",{get:function(){var e=this.svgContainer;if(e){var t=e.popups;return t.template.sprite=this,t.template.adapter.has("classPrefix",this.modalPrefix)||t.template.adapter.add("classPrefix",this.modalPrefix),t}},enumerable:!0,configurable:!0}),t.prototype.openPopup=function(e,t){var i=this.svgContainer;if(i)return i.openPopup(e,t)},t.prototype.closeAllPopups=function(){var e=this.svgContainer;e&&e.closeAllPopups()},Object.defineProperty(t.prototype,"x",{get:function(){return this.getPropertyValue("x")},set:function(e){this.isDragged||this.setPercentProperty("x",e,!1,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelX",{get:function(){var e=gl(this.getPixelX(this.x),this.minX,this.maxX);return this._adapterO?this._adapterO.apply("pixelX",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeX",{get:function(){return this._adapterO?this._adapterO.apply("relativeX",this.getRelativeX(this.x)):this.getRelativeX(this.x)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this.getPropertyValue("minX")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("minX",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this.getPropertyValue("maxX")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("maxX",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getPropertyValue("y")},set:function(e){this.isDragged||this.setPercentProperty("y",e,!1,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelY",{get:function(){var e=gl(this.getPixelY(this.y),this.minY,this.maxY);return this._adapterO?this._adapterO.apply("pixelY",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeY",{get:function(){return this._adapterO?this._adapterO.apply("relativeY",this.getRelativeX(this.y)):this.getRelativeX(this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this.getPropertyValue("minY")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("minY",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this.getPropertyValue("maxY")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("maxY",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dx",{get:function(){return this.getPropertyValue("dx")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("dx",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dy",{get:function(){return this.getPropertyValue("dy")},set:function(e){ll(e)&&(e=vl(e,this._positionPrecision,!0),this.setPropertyValue("dy",e,!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.getPropertyValue("rotation")},set:function(e){ll(e=el(e))||(e=0),this.setPropertyValue("rotation",e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.getPropertyValue("align")},set:function(e){e=tl(e),this.setPropertyValue("align",e)&&this._parent&&this._parent.invalidateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valign",{get:function(){return this.getPropertyValue("valign")},set:function(e){e=tl(e),this.setPropertyValue("valign",e)&&this._parent&&this._parent.invalidateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalCenter",{get:function(){return this.getPropertyValue("horizontalCenter")},set:function(e){e=tl(e),this.setPropertyValue("horizontalCenter",e)&&this.updateCenter()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalCenter",{get:function(){return this.getPropertyValue("verticalCenter")},set:function(e){e=tl(e),this.setPropertyValue("verticalCenter",e)&&this.updateCenter()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){var e=this.getPropertyValue("maxWidth");if(!ll(e)&&this._parent){var t=this._parent.maxWidth;return"absolute"!=this._parent.layout&&"none"!=this.align&&void 0!=this.align&&(t=t-this.pixelMarginLeft-this.pixelMarginRight),t}return e},set:function(e){this.setMaxWidth(e)},enumerable:!0,configurable:!0}),t.prototype.setMaxWidth=function(e){var t=this.maxWidth,i=this.maxHeight;if(this.setPropertyValue("maxWidth",e)){ll(this.relativeWidth)&&this.invalidate();var n={type:"maxsizechanged",target:this,previousWidth:t,previousHeight:i};this.dispatchImmediately("maxsizechanged",n)}},Object.defineProperty(t.prototype,"maxHeight",{get:function(){var e=this.getPropertyValue("maxHeight");if(!ll(e)&&this._parent){var t=this._parent.maxHeight;return"absolute"!=this._parent.layout&&"none"!=this.valign&&void 0!=this.valign&&(t=t-this.pixelMarginTop-this.pixelMarginBottom),t}return e},set:function(e){this.setMaxHeight(e)},enumerable:!0,configurable:!0}),t.prototype.setMaxHeight=function(e){var t=this.maxWidth,i=this.maxHeight;if(this.setPropertyValue("maxHeight",e)){ll(this.relativeHeight)&&this.invalidate();var n={type:"maxsizechanged",target:this,previousWidth:t,previousHeight:i};this.dispatchImmediately("maxsizechanged",n)}},Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.getPropertyValue("minWidth")},set:function(e){this.setPropertyValue("minWidth",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.getPropertyValue("minHeight")},set:function(e){this.setPropertyValue("minHeight",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPercentProperty("width",e,!0,!1,this._positionPrecision,!0)&&(this.percentWidth=void 0,this.relativeWidth=void 0,e instanceof Xs?(this.percentWidth=e.percent,ll(this._pixelWidth)&&(this.maxWidth=void 0),this._pixelWidth=void 0):(this._pixelWidth=Number(e),this.maxWidth=this._pixelWidth),this.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){this.setPercentProperty("height",e,!0,!1,this._positionPrecision,!0)&&(this.percentHeight=void 0,this._relativeHeight=void 0,e instanceof Xs?(this.percentHeight=e.percent,ll(this._pixelHeight)&&(this.maxHeight=void 0),this._pixelHeight=void 0):(this._pixelHeight=Number(e),this.maxHeight=this._pixelHeight),this.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelWidth",{get:function(){var e;e=ll(this.percentWidth)?this.maxWidth:ll(this._pixelWidth)?this._pixelWidth:0;var t=this.minWidth;null!=t&&e<t&&(e=t);var i=vl(e,this._positionPrecision,!0);return this._adapterO?this._adapterO.apply("pixelWidth",i):i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelHeight",{get:function(){var e;e=ll(this.percentHeight)?this.maxHeight:ll(this._pixelHeight)?this._pixelHeight:0;var t=this.minHeight;null!=t&&e<t&&(e=t);var i=vl(e,this._positionPrecision,!0);return this._adapterO?this._adapterO.apply("pixelHeight",i):i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeWidth",{get:function(){var e=this._relativeWidth;if(ll(e))return this._adapterO?this._adapterO.apply("relativeWidth",e):e},set:function(e){this._relativeWidth!=e&&(this._relativeWidth=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeHeight",{get:function(){var e=this._relativeHeight;if(ll(e))return this._adapterO?this._adapterO.apply("relativeHeight",e):e},set:function(e){this._relativeHeight!=e&&(this._relativeHeight=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"measuredWidth",{get:function(){return this.disabled||this.__disabled?0:this._adapterO?this._adapterO.apply("measuredWidth",this._measuredWidth):this._measuredWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"measuredHeight",{get:function(){return this.disabled||this.__disabled?0:this._adapterO?this._adapterO.apply("measuredHeight",this._measuredHeight):this._measuredHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outerWidth",{get:function(){var e=this.pixelWidth+this.pixelMarginRight+this.pixelMarginLeft;return this._adapterO?this._adapterO.apply("outerWidth",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outerHeight",{get:function(){var e=this.pixelHeight+this.pixelMarginTop+this.pixelMarginBottom;return this._adapterO?this._adapterO.apply("outerHeight",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){var e=Math.max(0,this.pixelWidth-this.pixelPaddingRight-this.pixelPaddingLeft);return this._adapterO?this._adapterO.apply("innerWidth",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){var e=Math.max(0,this.pixelHeight-this.pixelPaddingTop-this.pixelPaddingBottom);return this._adapterO?this._adapterO.apply("innerHeight",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalScale",{get:function(){var e=this.scale;return this._parent&&(e*=this._parent.globalScale),this._adapterO?this._adapterO.apply("globalScale",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.getPropertyValue("scale")},set:function(e){(e=el(e))<0&&(e=0),e!=this.getPropertyValue("scale")&&(this.setPropertyValue("scale",e,!1,!0),this.handleGlobalScale())},enumerable:!0,configurable:!0}),t.prototype.margin=function(e,t,i,n){return this.marginTop=e,this.marginRight=t,this.marginBottom=i,this.marginLeft=n,this},Object.defineProperty(t.prototype,"marginLeft",{get:function(){return this.getPropertyValue("marginLeft")},set:function(e){this.setPercentProperty("marginLeft",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginRight",{get:function(){return this.getPropertyValue("marginRight")},set:function(e){this.setPercentProperty("marginRight",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginTop",{get:function(){return this.getPropertyValue("marginTop")},set:function(e){this.setPercentProperty("marginTop",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginBottom",{get:function(){return this.getPropertyValue("marginBottom")},set:function(e){this.setPercentProperty("marginBottom",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelMarginRight",{get:function(){var e=this.getPixelX(this.marginRight);return this._adapterO?this._adapterO.apply("pixelMarginRight",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeMarginRight",{get:function(){var e=this.getRelativeX(this.marginRight);return this._adapterO?this._adapterO.apply("relativeMarginRight",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelMarginLeft",{get:function(){var e=this.getPixelX(this.marginLeft);return this._adapterO?this._adapterO.apply("pixelMarginLeft",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeMarginLeft",{get:function(){var e=this.getRelativeX(this.marginLeft);return this._adapterO?this._adapterO.apply("relativeMarginLeft",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelMarginTop",{get:function(){var e=this.getPixelY(this.marginTop);return this._adapterO?this._adapterO.apply("pixelMarginTop",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeMarginTop",{get:function(){var e=this.getRelativeY(this.marginTop);return this._adapterO?this._adapterO.apply("relativeMarginTop",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelMarginBottom",{get:function(){var e=this.getPixelY(this.marginBottom);return this._adapterO?this._adapterO.apply("pixelMarginBottom",e):e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeMarginBottom",{get:function(){var e=this.getRelativeY(this.marginBottom);return this._adapterO?this._adapterO.apply("relativeMarginBottom",e):e},enumerable:!0,configurable:!0}),t.prototype.padding=function(e,t,i,n){return this.paddingTop=e,this.paddingRight=t,this.paddingBottom=i,this.paddingLeft=n,this},Object.defineProperty(t.prototype,"paddingLeft",{get:function(){return this.getPropertyValue("paddingLeft")},set:function(e){this.setPercentProperty("paddingLeft",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingRight",{get:function(){return this.getPropertyValue("paddingRight")},set:function(e){this.setPercentProperty("paddingRight",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingTop",{get:function(){return this.getPropertyValue("paddingTop")},set:function(e){this.setPercentProperty("paddingTop",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingBottom",{get:function(){return this.getPropertyValue("paddingBottom")},set:function(e){this.setPercentProperty("paddingBottom",e,!0,!0,this._positionPrecision,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelPaddingRight",{get:function(){return this.getPixelX(this.paddingRight)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePaddingRight",{get:function(){return this.getRelativeX(this.paddingRight)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelPaddingLeft",{get:function(){return this.getPixelX(this.paddingLeft)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePaddingLeft",{get:function(){return this.getRelativeX(this.paddingLeft)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelPaddingTop",{get:function(){return this.getPixelY(this.paddingTop)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePaddingTop",{get:function(){return this.getRelativeY(this.paddingTop)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelPaddingBottom",{get:function(){return this.getPixelY(this.paddingBottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePaddingBottom",{get:function(){return this.getRelativeY(this.paddingBottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.getPropertyValue("path")},set:function(e){this.setPath(e)},enumerable:!0,configurable:!0}),t.prototype.setPath=function(e){return!!this.setPropertyValue("path",e)&&(this._adapterO&&(e=this._adapterO.apply("path",e)),this._isPath||(this.element&&(!this.element.node||this.element.node instanceof SVGPathElement)||(this.element=this.paper.add("path")),this._isPath=!0),nl(e)?this.element.attr({d:e}):this.element.removeAttr("d"),this.invalidatePosition(),this.inited||this.events.once("inited",this.validatePosition,this,!1),!0)},Object.defineProperty(t.prototype,"fillModifier",{get:function(){return this.getPropertyValue("fillModifier")},set:function(e){this.setPropertyValue("fillModifier",e)&&this.setFill(this.fill)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeModifier",{get:function(){return this.getPropertyValue("strokeModifier")},set:function(e){this.setPropertyValue("strokeModifier",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillOpacity",{get:function(){return this.getPropertyValue("fillOpacity")},set:function(e){e=ml(e,0,1),this.setPropertyValue("fillOpacity",e)&&this.setSVGAttribute({"fill-opacity":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this.getPropertyValue("fill")},set:function(e){this.setFill(e)},enumerable:!0,configurable:!0}),t.prototype.setFill=function(e){if(ul(e)&&!("r"in e)||(e=cc(e)),this.setColorProperty("fill",e)||this.fillModifier)if(e instanceof lc&&this.fillModifier&&(e=this.fillModifier.modify(e)),this.realFill=e,e instanceof lc)this.setSVGAttribute({fill:e.toString()});else if(nl(e)){if(e instanceof gp||e instanceof _p||e instanceof bp){var t=e;t.paper=this.paper,this.setSVGAttribute({fill:'url("'+xc()+t.id+'")'})}}else this.removeSVGAttribute("fill")},Object.defineProperty(t.prototype,"opacity",{get:function(){return this.getPropertyValue("opacity")},set:function(e){e=ml(e,0,1),this.setPropertyValue("opacity",e)&&this.setSVGAttribute({opacity:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this.getPropertyValue("stroke")},set:function(e){this.setStroke(e)},enumerable:!0,configurable:!0}),t.prototype.setStroke=function(e){if(ul(e)&&!("r"in e)||(e=cc(e)),this.setColorProperty("stroke",e)||this.strokeModifier)if(e instanceof lc&&this.strokeModifier&&(e=this.strokeModifier.modify(e)),this.realStroke=e,e instanceof lc)"none"==e.hex?this.removeSVGAttribute("stroke"):this.setSVGAttribute({stroke:e.toString()});else if(nl(e)){if(e instanceof gp||e instanceof _p||e instanceof bp){var t=e;t.paper=this.paper,this.setSVGAttribute({stroke:'url("'+xc()+t.id+'")'})}}else this.removeSVGAttribute("stroke")},Object.defineProperty(t.prototype,"strokeOpacity",{get:function(){return this.getPropertyValue("strokeOpacity")},set:function(e){e=ml(e,0,1),this.setPropertyValue("strokeOpacity",e)&&this.setSVGAttribute({"stroke-opacity":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonScalingStroke",{get:function(){return this.getPropertyValue("nonScalingStroke")},set:function(e){e=Qs(e),this.setPropertyValue("nonScalingStroke",e)&&(this.strokeWidth=this.strokeWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonScaling",{get:function(){return this.getPropertyValue("nonScaling")},set:function(e){e=Qs(e),this.setPropertyValue("nonScaling",e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return this.getPropertyValue("strokeWidth")},set:function(e){e=el(e),this.setPropertyValue("strokeWidth",e,!0),this.nonScalingStroke&&(ll(e)||(e=1),e/=this.globalScale),this.setSVGAttribute({"stroke-width":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeDasharray",{get:function(){return this.getPropertyValue("strokeDasharray")},set:function(e){e=tl(e),this.setPropertyValue("strokeDasharray",e)&&this.setSVGAttribute({"stroke-dasharray":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeDashoffset",{get:function(){return this.getPropertyValue("strokeDashoffset")},set:function(e){e=el(e),this.setPropertyValue("strokeDashoffset",e)&&this.setSVGAttribute({"stroke-dashoffset":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeLinecap",{get:function(){return this.getPropertyValue("strokeLinecap")},set:function(e){this.setPropertyValue("strokeLinecap",e)&&this.setSVGAttribute({"stroke-linecap":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeLinejoin",{get:function(){return this.getPropertyValue("strokeLinejoin")},set:function(e){this.setPropertyValue("strokeLinejoin",e)&&this.setSVGAttribute({"stroke-linejoin":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shapeRendering",{get:function(){return this.getPropertyValue("shapeRendering")},set:function(e){e=tl(e),this.setPropertyValue("shapeRendering",e)&&this.setSVGAttribute({"shape-rendering":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelPerfect",{get:function(){return this.getPropertyValue("pixelPerfect")},set:function(e){e=Qs(e),this._positionPrecision=e?_h.pixelPerfectPrecision:3,this.setPropertyValue("pixelPerfect",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rtl",{get:function(){return nl(this._rtl)?this._rtl:!!this._topParent&&this._topParent.rtl},set:function(e){e=Qs(e),this.isBaseSprite&&(this.topParent.rtl=e),this._rtl=e},enumerable:!0,configurable:!0}),t.prototype.show=function(e){return this.showReal(e)},t.prototype.showReal=function(e){var t=this;if(!this.preventShow){var i,n=this.defaultState.properties;if(!this.disabled&&(this.isHidden||!this.visible||this.isHiding||null!=n.opacity&&this.opacity<n.opacity&&!this.isShowing)&&!this.isDisposed()){this.invalid&&this.validate(),this.positionInvalid&&this.validatePosition(),ll(e)||(e=this.defaultState.transitionDuration),this._hideAnimation&&(this._hideAnimation.kill(),this._hideAnimation=void 0),this._showHideDisposer&&this.removeDispose(this._showHideDisposer),this._isHidden=!1,this.isHiding=!1,this.isShowing=!0,(i=this.applyCurrentState(e))&&!i.isFinished()?(this._showHideDisposer=i.events.on("animationended",(function(){t.isShowing=!1})),this._disposers.push(this._showHideDisposer)):this.isShowing=!1;var r=this.defaultState.properties.visible;nl(r)||(r=!0),this.visible=r,this.readerHidden=!1,this.dispatchImmediately("shown")}return i}},t.prototype.hide=function(e){return this.hideReal(e)},t.prototype.hideReal=function(e){var t,i=this;if(!this.isHiding&&this.visible&&!this.isDisposed()){this.tooltip&&this.tooltip.currentSprite==this&&this.hideTooltip(0),this._hideAnimation&&(this._hideAnimation.kill(),this._hideAnimation=void 0),this.isShowing=!1,this._showHideDisposer&&this.removeDispose(this._showHideDisposer);var n=this.hiddenState;n?(t=this.setState(n,e,void 0))&&!t.isFinished()?(this._hideAnimation=t,this._showHideDisposer=t.events.on("animationended",(function(){i.isHiding=!1,i._isHidden=!0,0==n.properties.visible&&(i.visible=!1)}),this),this._disposers.push(this._showHideDisposer),this._disposers.push(t)):(this.isHiding=!1,this._isHidden=!0):(this.visible=!1,this.isHiding=!1,this._isHidden=!0),this.readerHidden=!0,this.dispatchImmediately("hidden"),this.invalidate()}return ll(e)||(e=this.hiddenState.transitionDuration),t},Object.defineProperty(t.prototype,"visible",{get:function(){return this.getVisibility()},set:function(e){e=Qs(e),this.setVisibility(e)},enumerable:!0,configurable:!0}),t.prototype.getVisibility=function(){var e=this.getPropertyValue("visible");return nl(e)||(e=!0),e},t.prototype.setVisibility=function(e){if(this.setPropertyValue("visible",e)&&(e?this.group.removeAttr("visibility"):this.group.attr({visibility:"hidden"}),this.events.isEnabled("visibilitychanged"))){var t={type:"visibilitychanged",target:this,visible:e};this.events.dispatchImmediately("visibilitychanged",t)}},Object.defineProperty(t.prototype,"zIndex",{get:function(){return this.getPropertyValue("zIndex")},set:function(e){e=el(e),this.setPropertyValue("zIndex",e)&&this.dispatch("zIndexChanged")},enumerable:!0,configurable:!0}),t.prototype.toFront=function(){var e=this._parent;e&&e.children.indexOf(this)!=e.children.length-1&&(e.children.moveValue(this,e.children.length-1),this.dispatch("zIndexChanged"))},t.prototype.toBack=function(){var e=this._parent;e&&0!=e.children.indexOf(this)&&(e.children.moveValue(this,0),this.dispatch("zIndexChanged"))},Object.defineProperty(t.prototype,"userClassName",{get:function(){return this.getPropertyValue("userClassName")},set:function(e){this.setPropertyValue("userClassName",e)&&(!e&&this.userClassName&&this.group.removeClass(this.userClassName),this.setClassName())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this._tooltip?this._tooltip:this.virtualParent?this.virtualParent.tooltip:this._parent?this._parent.tooltip:void 0},set:function(e){this._tooltip&&this.removeDispose(this._tooltip),this._tooltip=e,e&&(e.parent=this.tooltipContainer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipDataItem",{get:function(){var e=this._tooltipDataItem;return e||this.dataItem},set:function(e){this._tooltipDataItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipColorSource",{get:function(){return this._tooltipColorSource},set:function(e){this._tooltipColorSource=e},enumerable:!0,configurable:!0}),t.prototype.showTooltip=function(e){"always"==this.showTooltipOn&&!this._tooltip&&this.tooltip&&(this._tooltip=this.tooltip.clone()),!e&&"pointer"==this.tooltipPosition&&this.isHover&&(e=Kc(ap().lastPointer.point,this.svgContainer.SVGContainer,this.svgContainer.cssScale));for(var t=this;void 0!=t;){if(!t.visible||t.disabled||t.__disabled)return void(this._tooltip&&this._tooltip.visible&&this._tooltip.hide(0));t=t.parent}if(nl(this.tooltipText)||nl(this.tooltipHTML)){var i=this.tooltip,n=this.tooltipDataItem;if(i){i.targetSprite=this;var r=this,a=this.tooltipColorSource;if((i.getStrokeFromObject||i.getFillFromObject)&&a&&(a.isTemplate?n&&Ul(n.sprites,(function(e){return e.clonedFrom!=a||(r=e,!1)})):r=a),i.getStrokeFromObject){for(var o=this.stroke,s=r;void 0!=s.parent&&(void 0==(o=s.stroke)&&(s=s.parent),void 0==o););o instanceof lc?i.background.animate({property:"stroke",to:o},i.animationDuration):i.background.stroke=o}if(i.dataItem=n,i.label.populateStringFrom=this,i.getFillFromObject){var l=this.fill;for(s=r;void 0!=s.parent;)if(void 0==(l=s.fill)||l instanceof lc&&void 0==l.rgb)s=s.parent;else if(void 0!=l)break;void 0==l&&(l=uc("#000000")),l instanceof lc&&i.visible?i.background.animate({property:"fill",to:l},i.animationDuration):i.background.fill=l,i.autoTextColor&&l instanceof lc&&(i.label.fill=l.alternative)}var u="";if(this.tooltipHTML&&(i.html=this.tooltipHTML,u=this.tooltipHTML),this.tooltipText&&(i.text=this.tooltipText,u=this.tooltipText),this.updateTooltipPosition(e)){if(i.readerDescribedBy=this.uidAttr(),i.label.invalid&&i.label.validate(),void 0!=u&&""!=u&&""!=i.label.currentText){i&&!i.parent&&(i.parent=this.tooltipContainer);var c=i.defaultState.transitionDuration;return c<=0&&(c=1),i.show(c),i.currentSprite=this,!0}this.hideTooltip(0)}else this.hideTooltip(0)}}return!1},t.prototype.updateTooltipPosition=function(e){var t=this;if("pointer"!=this.tooltipPosition){var i=Zc({x:this.getTooltipX(),y:this.getTooltipY()},this);return this.pointTooltipTo(i)}if(this._interactionDisposer&&this._interactionDisposer.dispose(),this._interactionDisposer=ap().body.events.on("track",(function(e){return t.pointTooltipTo(Kc(e.point,t.svgContainer.SVGContainer,t.svgContainer.cssScale),!0)})),e)return this.pointTooltipTo(e,!0)},t.prototype.pointTooltipTo=function(e,t){var i=this.tooltip;if(i&&this.topParent){if(i.showInViewport)return i.pointTo(e,t),!0;if(function(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height}(e,{x:0,y:0,width:this.topParent.maxWidth,height:this.topParent.maxHeight}))return i.pointTo(e,t),!0}return!1},t.prototype.hideTooltip=function(e){if("always"!=this.showTooltipOn){var t=this.tooltip;t&&(t.targetSprite==this&&(t.targetSprite=void 0),t.hide(e),this._interactionDisposer&&(this._interactionDisposer.dispose(),this._interactionDisposer=void 0))}},Object.defineProperty(t.prototype,"tooltipHTML",{get:function(){return this.getPropertyValue("tooltipHTML")},set:function(e){e=tl(e),this.hoverable=!0,this.setPropertyValue("tooltipHTML",e)&&this.tooltip&&this.tooltip.visible&&this.showTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this.getPropertyValue("tooltipText")},set:function(e){(e=tl(e))&&(this.hoverable=!0),this.setPropertyValue("tooltipText",e)&&this.tooltip&&this.tooltip.visible&&this.showTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipContainer",{get:function(){return this._tooltipContainer?this._tooltipContainer:this._parent?this._parent.tooltipContainer:void 0},set:function(e){this._tooltipContainer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipX",{get:function(){return this.getTooltipX()},set:function(e){this.setPercentProperty("tooltipX",e)&&this.tooltip&&this.tooltip.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alwaysShowTooltip",{get:function(){return"always"==this.getPropertyValue("showTooltipOn")},set:function(e){(e=Qs(e))&&(this.showTooltipOn="always")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showTooltipOn",{get:function(){return this.getPropertyValue("showTooltipOn")},set:function(e){this.setPropertyValue("showTooltipOn",e)&&("hit"==e&&(this.clickable=!0),this.tooltip&&("always"==e?this.showTooltip():this.handleAlwaysShowTooltip()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipPosition",{get:function(){return this.getPropertyValue("tooltipPosition")},set:function(e){this.setPropertyValue("tooltipPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipY",{get:function(){return this.getTooltipY()},set:function(e){this.setPercentProperty("tooltipY",e)&&this.tooltip&&this.tooltip.invalidate()},enumerable:!0,configurable:!0}),t.prototype.getTooltipX=function(){var e,t=this.getPropertyValue("tooltipX");return nl(t)||(t=Ks(50)),ll(t)&&(e=t),t instanceof Xs&&(e=this.maxLeftSelf+this._measuredWidthSelf*t.value-this.pixelPaddingLeft-this.ex),ll(e)||(e=0),e},t.prototype.getTooltipY=function(){var e,t=this.getPropertyValue("tooltipY");return nl(t)||(t=Ks(50)),ll(t)&&(e=t),t instanceof Xs&&(e=this.maxTopSelf+this._measuredHeightSelf*t.value-this.pixelPaddingTop-this.ey),ll(e)||(e=0),e},t.prototype.raiseCriticalError=function(e,t){this.svgContainer&&(this._adapterO?this.modal.content=this._adapterO.apply("criticalError",e).message:this.modal.content=e.message,t?this.modal.closable=!0:this.disabled=!0,_h.suppressErrors||this.modal.open()),_h.verbose&&console.log(e)},t.prototype.processConfig=function(t){t&&(nl(t.tooltipColorSource)&&sl(t.tooltipColorSource)&&this.map.hasKey(t.tooltipColorSource)&&(t.tooltipColorSource=this.map.getKey(t.tooltipColorSource)),nl(t.cursorOverStyle)&&sl(t.cursorOverStyle)&&(t.cursorOverStyle=this.getCursorStyle(t.cursorOverStyle)),nl(t.cursorDowntyle)&&sl(t.cursorDowntyle)&&(t.cursorDowntyle=this.getCursorStyle(t.cursorDowntyle)),nl(t.cursorOptions)&&(nl(t.cursorOptions.overStyle)&&sl(t.cursorOptions.overStyle)&&(t.cursorOptions.overStyle=this.getCursorStyle(t.cursorOptions.overStyle)),nl(t.cursorOptions.downStyle)&&sl(t.cursorOptions.downStyle)&&(t.cursorOptions.downStyle=this.getCursorStyle(t.cursorOptions.downStyle)))),e.prototype.processConfig.call(this,t),this.processDelayedMap()},t.prototype.getCursorStyle=function(e){switch(e){case"grab":return wp.grab;case"grabbing":return wp.grabbing;case"pointer":return wp.pointer;case"horizontalResize":return wp.horizontalResize;case"verticalResize":return wp.verticalResize;default:return wp.default}},t.prototype.configOrder=function(t,i){return t==i?0:"tooltipColorSource"==t?1:"tooltipColorSource"==i?-1:e.prototype.configOrder.call(this,t,i)},Object.defineProperty(t.prototype,"isHidden",{get:function(){return this._isHidden?this._isHidden:!!this._parent&&this._parent.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showOnInit",{get:function(){return this.getPropertyValue("showOnInit")},set:function(e){e=Qs(e),this.setShowOnInit(e)},enumerable:!0,configurable:!0}),t.prototype.setShowOnInit=function(e){this.setPropertyValue("showOnInit",e)&&(this.isTemplate||(!e||this.inited||this.hidden?this._showOnInitDisposer&&this._showOnInitDisposer.dispose():(this._showOnInitDisposer=new tu([Bu.events.once("enterframe",this.hideInitially,this),this.events.once("beforevalidated",this.hideInitially,this,!1),this.events.on("inited",this.appear,this,!1)]),this._disposers.push(this._showOnInitDisposer))))},t.prototype.hideInitially=function(){this.isDisposed()||(this.appeared=!1,this.inited||this.hide(0))},t.prototype.appear=function(){var e=this;if(this.appeared=!1,this.hidden||this.isHidden||this.hide(0),this.hidden)this.appeared=!0,this.dispatch("appeared");else{var t=this.show();t&&!t.isFinished()?this.addDisposer(t.events.on("animationended",(function(){e.appeared=!0,e.dispatch("appeared")}))):(this.appeared=!0,this.dispatch("appeared"))}},Object.defineProperty(t.prototype,"hidden",{get:function(){return this.getPropertyValue("hidden")},set:function(e){e=Qs(e),this.setPropertyValue("hidden",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){return this.definedBBox?this.definedBBox:this._bbox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugins",{get:function(){var e=this;return this._plugins||(this._plugins=new Wu,this._disposers.push(this._plugins.events.on("inserted",(function(t){t.newValue.target=e,t.newValue.init()}))),this._disposers.push(new Uu(this._plugins))),this._plugins},enumerable:!0,configurable:!0}),t.prototype._systemUpdate=function(e){this.validate()},t.prototype._systemCheckIfValidate=function(){return!0},t.prototype._systemValidatePositions=function(){this.validatePosition()},t.prototype._systemValidateLayouts=function(){},t}(pc);Bu.registeredClasses.Sprite=Up;var Gp=function(e){function t(){var t=e.call(this)||this;return t.className="Rectangle",t.element=t.paper.add("rect"),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this._positionPrecision;this.pixelPerfect&&(t=0);var i=vl(this.innerWidth,t),n=vl(this.innerHeight,t);this.element.attr({width:i,height:n})},t.prototype.measureElement=function(){},Object.defineProperty(t.prototype,"bbox",{get:function(){return this.definedBBox?this.definedBBox:this.isMeasured?{x:0,y:0,width:this.innerWidth,height:this.innerHeight}:{x:0,y:0,width:0,height:0}},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Rectangle=Gp;var Wp=function(e){function t(){var t=e.call(this)||this;return t._childrenByLayout=[],t._childrenDisposers=new Lu,t.hasFocused=!1,t.setStateOnSprites=[],t.layoutInvalid=!1,t._absoluteWidth=0,t._absoluteHeight=0,t._shouldBeReady=[],t._tapToActivate=!1,t.tapTimeout=3e3,t.className="Container",t._element=t.paper.addGroup("g"),t.group.add(t.element),t.setPropertyValue("pixelPerfect",!1),t.setPropertyValue("layout","absolute"),t.setPropertyValue("fixedWidthGrid",!1),t.setPropertyValue("verticalCenter","none"),t.setPropertyValue("horizontalCenter","none"),t._positionPrecision=4,t._disposers.push(new Au(t._childrenDisposers)),t.children.events.on("inserted",t.handleChildAdded,t),t.children.events.on("removed",t.handleChildRemoved,t),t.applyTheme(),t}return Us(t,e),t.prototype.handleChildAdded=function(e){this.processChild(e.newValue)},t.prototype.processChild=function(e){try{this._childrenDisposers.insertKey(e.uid,new tu([e.events.on("transformed",this.handleChildTransform,this),e.events.on("zIndexChanged",this.sortAndAdd,this)]))}catch(t){}this.element&&this.element.add(e.group);e.parent=this,e.paper=this.paper,this.dispatchImmediately("childadded",{type:"childadded",newValue:e}),this.invalidate()},t.prototype.sortAndAdd=function(){this.sortChildren(),this.addChildren()},t.prototype.handleChildRemoved=function(e){var t=e.oldValue;(this._childrenDisposers.removeKey(t.uid),this.element)&&this.element.removeElement(t.group);t.isMeasured&&this.invalidateLayout(),this.dispatchImmediately("childremoved",{type:"childremoved",oldValue:t})},t.prototype.handleChildTransform=function(e){e.target.isMeasured&&this.invalidateLayout()},t.prototype.invalidateLayout=function(){this.layoutInvalid||this.disabled||this.isTemplate||"none"==this.layout||this.__disabled||(this.layoutInvalid=!0,Bu.addToInvalidLayouts(this),Zp.requestFrame())},t.prototype.invalidate=function(){e.prototype.invalidate.call(this),this.invalidateLayout()},t.prototype.deepInvalidate=function(){e.prototype.invalidate.call(this),Nl(this._childrenByLayout,(function(e){e instanceof t?e.deepInvalidate():e.invalidate()})),this.invalidateLayout()},Object.defineProperty(t.prototype,"children",{get:function(){return this._children||(this._children=new Wu),this._children},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.getPropertyValue("minWidth")},set:function(e){this.setPropertyValue("minWidth",e)&&this.invalidateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.getPropertyValue("minHeight")},set:function(e){this.setPropertyValue("minHeight",e)&&this.invalidateLayout()},enumerable:!0,configurable:!0}),t.prototype.removeElement=function(){},t.prototype.sortChildren=function(){var e=this;if(this._childrenByLayout=[],"none"!=this.layout&&"absolute"!=this.layout&&this.layout){var t=[],i=[];Tu(this.children.iterator(),(function(n){"horizontal"==e.layout||"grid"==e.layout?ll(n.percentWidth)?i.push(n):t.push(n):"vertical"==e.layout&&ll(n.percentHeight)?i.push(n):t.push(n)})),this._childrenByLayout=t.concat(i)}else this._childrenByLayout=this.children.values;this.calculateRelativeSize()},t.prototype.calculateRelativeSize=function(){var e=this,t=0,i=0;Nl(this._childrenByLayout,(function(e){e.isMeasured&&(ll(e.percentWidth)&&(t+=e.percentWidth),ll(e.percentHeight)&&(i+=e.percentHeight))})),Nl(this._childrenByLayout,(function(n){n.isMeasured&&("horizontal"==e.layout&&(ll(n.percentWidth)&&(n.relativeWidth=n.percentWidth/t),ll(n.percentHeight)&&(n.relativeHeight=n.percentHeight/100)),"vertical"==e.layout&&(ll(n.percentHeight)&&(n.relativeHeight=n.percentHeight/i),ll(n.percentWidth)&&(n.relativeWidth=n.percentWidth/100)),"grid"==e.layout&&(ll(n.percentHeight)&&(n.relativeHeight=n.percentHeight/100),ll(n.percentWidth)&&(n.relativeWidth=n.percentWidth/100))),"absolute"!=e.layout&&n.isMeasured||(ll(n.percentWidth)&&(n.relativeWidth=n.percentWidth/100),ll(n.percentHeight)&&(n.relativeHeight=n.percentHeight/100))}))},t.prototype.addChildren=function(){if(this.element){var e=ql(this.children.values),t=e.map((function(e,t){return{idx:t,data:e}}));t.sort((function(e,t){var i=e.data.zIndex||0,n=t.data.zIndex||0;return i<n?-1:i>n?1:e.idx-t.idx})),e=t.map((function(e){return e.data}));var i=this.element,n=!0;if(i.node&&i.node.childNodes)for(var r=0,a=i.node.childNodes.length;r<a;r++)if(i.node.childNodes[r]!=e[r].group.node){n=!1;break}n||(Nl(e,(function(e){e.group&&i.add(e.group)})),this._background&&this.group.addToBack(this._background.group),this.invalidateLayout())}},t.prototype.createChild=function(e){var t=new e;return t.parent=this,t},t.prototype.removeChildren=function(){for(;this.children.length>0;){var e=this.children.getIndex(0);e.parent=void 0,this.children.removeValue(e)}},t.prototype.disposeChildren=function(){for(;this.children.length>0;){var e=this.children.getIndex(0);e.dispose(),this.children.removeValue(e)}},Object.defineProperty(t.prototype,"background",{get:function(){return this._background||(this._background=this.createBackground(),this.processBackground()),this._background},set:function(e){this._background&&this.background!=e&&this.removeDispose(this._background),e&&(this._background=e,this._disposers.push(e),this.processBackground())},enumerable:!0,configurable:!0}),t.prototype.handleGlobalScale=function(){e.prototype.handleGlobalScale.call(this),this.children.each((function(e){e.handleGlobalScale()}))},t.prototype.createBackground=function(){return new Gp},t.prototype.processBackground=function(){var e=this._background;e&&(e.isMeasured=!1,this._background.fill=(new Xh).getFor("background"),e.parent=this,e.isMeasured=!1,this.children.removeValue(e),this._disposers.push(e),this.group.addToBack(this._background.group))},t.prototype.validateLayout=function(){var e=this;Bu.removeFromInvalidLayouts(this),this.layoutInvalid=!1,this._availableWidth=this.innerWidth,this._availableHeight=this.innerHeight;var t=0,i=0,n=!0;this.children&&(this.sortChildren(),Nl(this._childrenByLayout,(function(r){var a,o;if(ll(r.relativeWidth)?(a=vl(e._availableWidth*r.relativeWidth,2),"horizontal"==e.layout&&(a-=r.pixelMarginRight+r.pixelMarginLeft)):"horizontal"==e.layout&&r.invalid&&r.validate(),ll(r.relativeHeight)?(o=vl(e._availableHeight*r.relativeHeight,2),"vertical"==e.layout&&(o-=r.pixelMarginTop+r.pixelMarginBottom)):"vertical"==e.layout&&r.invalid&&r.validate(),0==r.invalid){if(ll(r.relativeWidth)&&(r.maxWidth=a),ll(r.relativeHeight)&&(r.maxHeight=o),r.isMeasured){"horizontal"==e.layout&&(ll(r.percentWidth)||r.measuredWidth>0&&(e._availableWidth-=r.measuredWidth+r.pixelMarginLeft+r.pixelMarginRight)),"vertical"==e.layout&&(ll(r.percentHeight)||r.measuredHeight>0&&(e._availableHeight-=r.measuredHeight+r.pixelMarginTop+r.pixelMarginBottom));var s=r.measuredWidth,l=r.measuredHeight;"none"!=r.align&&(s+=r.pixelMarginLeft+r.pixelMarginRight),"none"!=r.valign&&(l+=r.pixelMarginTop+r.pixelMarginBottom),t=Math.max(t,s),i=Math.max(i,l)}}else r.isMeasured&&(ll(r.relativeWidth)&&r.maxWidth!=a&&(r.maxWidth=a,n=!1),ll(r.relativeHeight)&&r.maxHeight!=o&&(r.maxHeight=o,n=!1))}))),this._absoluteWidth=t,this._absoluteHeight=i,n&&this.arrange()},t.prototype.arrange=function(){var e,t,i,n,r,a,o,s,l,u,c,h=this,p=this.children,d=0,f=0,m=xl(this.innerWidth,this._absoluteWidth),v=xl(this.innerHeight,this._absoluteHeight),y=this.pixelPaddingLeft,g=this.pixelPaddingRight,_=this.pixelPaddingTop,b=this.pixelPaddingBottom,x=0,w=0,k=0,P=0,S=[],T=[],E=this.maxWidth,C=this.maxHeight,M=this.minWidth,I=this.minHeight,O=ql(p.values);if(this.reverseOrder&&O.reverse(),"grid"==this.layout){a=E,r=1;for(var D=0,A=O.length;D<A;D++){if((z=O[D]).isMeasured&&!z.disabled&&!z.__disabled){var L=z.measuredWidth;L<a&&(a=L),L>r&&(r=L)}}a=gl(a,1,E),r=gl(r,1,E),o=this.fixedWidthGrid?E/r:E/a,o=xl(1,Math.floor(o)),o=wl(this.maxColumns,o),S=this.getColumnWidth(O,o,r)}for(D=0,A=O.length;D<A;D++){var z;if(!(z=O[D]).isMeasured||z.disabled||z.__disabled)z.validatePosition();else{var R=void 0,F=void 0,j=z.pixelMarginLeft,B=z.pixelMarginRight,V=z.pixelMarginTop,N=z.pixelMarginBottom,U=z.measuredWidth,G=z.measuredHeight,W=void 0,H=void 0,Z=void 0,q=void 0;switch(this.layout){case"none":break;case"absolute":switch(z.align){case"left":R=j-z.maxLeft;break;case"center":R=(m-U)/2-z.maxLeft;break;case"right":R=m-B-z.maxRight;break;default:z.x instanceof Xs||(R=z.pixelX)}switch(z.valign){case"top":F=V-z.maxTop;break;case"middle":F=(v-G)/2-z.maxTop;break;case"bottom":F=v-N-z.maxBottom;break;default:z.y instanceof Xs||(F=z.pixelY)}break;case"vertical":switch(z.align){case"left":R=j-z.maxLeft;break;case"center":R=(m-U)/2-z.maxLeft;break;case"right":R=m-B-z.maxRight;break;default:R=z.pixelX}w=(F=w+V-z.maxTop)+z.maxBottom+N;break;case"horizontal":switch(z.valign){case"top":F=V-z.maxTop;break;case"middle":F=(v-G)/2-z.maxTop;break;case"bottom":F=v-N-z.maxBottom;break;default:F=z.pixelY}x=(R=x+j-z.maxLeft)+z.maxRight+B;break;case"grid":switch(R=x+j-z.maxLeft,z.valign){case"top":F=w+V-z.maxTop;break;case"middle":F=w+(v-G)/2-z.maxTop;break;case"bottom":F=w+v-N-z.maxBottom;break;default:F=w-z.maxTop}x+=S[P],T[k]=xl(T[k],G);var X=S[++P];if(ll(X)||(X=r),x>wl(this.innerWidth,E)-X+1&&P<o){o=P,x=0,w=0,k=0,P=0,S=this.getColumnWidth(O,o,r),T=[],D=-1;continue}P>=o&&(P=0,w+=T[k],k++,x=0)}"none"!==this.layout&&(z.moveTo({x:R,y:F}),W=R+z.maxLeft-j,H=R+z.maxRight+B,Z=F+z.maxTop-V,q=F+z.maxBottom+N,(H>t||!ll(t))&&(t=H),(W<e||!ll(e))&&(e=W),(Z<i||!ll(i))&&(i=Z),(q>n||!ll(n))&&(n=q),(H>l||!ll(l))&&(l=H),(W<s||!ll(s))&&(s=W),(Z<u||!ll(u))&&(u=Z),q>c||ll(c))}}if("none"==this.layout){var K=this.bbox;e=K.x,t=K.x+K.width,i=K.y,n=K.y+K.height}ll(e)||(e=0,s=0),ll(t)||(l=t=this._availableWidth),ll(i)||(i=0,u=0),ll(n)||(c=n=this._availableHeight),ll(u)||(u=0),ll(c)||(c=u),ll(s)||(s=0),ll(l)||(l=s),d=t-e,f=n-i,ll(this.relativeWidth)&&(e=0,t=d=E-y-g),ll(this.relativeHeight)&&(i=0,n=f=C-_-b),ll(this._pixelWidth)&&(e=0,d=this._pixelWidth-y-g),ll(M)&&d<M&&(e=0,d=this.minWidth-y-g),ll(this._pixelHeight)&&(i=0,f=this._pixelHeight-_-b),ll(I)&&f<I&&(i=0,f=I-_-b);var Y=l-s,$=c-u;if("none"!=this.layout&&(this.contentAlign||this.contentValign)&&p.length>0){var J,Q,ee=d,te=f;ee<Y&&(ee=Y),te<$&&(te=$),"center"==this.contentAlign&&(J=(ee-Y)/2),"right"==this.contentAlign&&(J=ee-Y),"middle"==this.contentValign&&(Q=(te-$)/2),"bottom"==this.contentValign&&(Q=te-$),ll(J)&&Tu(p.iterator(),(function(e){var t=e.maxLeft,i=J;"horizontal"==h.layout&&(e.x=e.pixelX+i),"grid"==h.layout&&(e.x=e.pixelX+i),"vertical"==h.layout&&(i+=e.pixelMarginLeft,"none"==e.align&&(e.x=i-t)),"absolute"==h.layout&&(i+=e.pixelMarginLeft,"none"==e.align&&(e.x=i-t))})),ll(Q)&&Tu(p.iterator(),(function(e){var t=e.maxTop,i=Q;"horizontal"==h.layout&&(i+=e.pixelMarginTop,"none"==e.valign&&(e.y=i-t)),"grid"==h.layout&&(i+=e.pixelMarginTop,e.y=i-t),"vertical"==h.layout&&(e.y=e.pixelY+i),"absolute"==h.layout&&(i+=e.pixelMarginTop,"none"==e.valign&&(e.y=i-t))}))}var ie=this.bbox;d=xl(d,M),f=xl(f,I),this.contentWidth=d,this.contentHeight=f,d=wl(d,E),f=wl(f,C),this._bbox={x:e,y:i,width:d,height:f};var ne=this.maxLeft,re=this.maxTop,ae=this.maxBottom,oe=this.maxRight;if(this.measure(),(ne!=this.maxLeft||oe!=this.maxRight||re!=this.maxTop||ae!=this.maxBottom)&&this.events.isEnabled("transformed")){var se={type:"transformed",target:this};ie&&(se.dummyData=ie.width+" "+d+"  "+ie.height+" "+f),this.events.dispatchImmediately("transformed",se)}this.dispatchImmediately("layoutvalidated")},t.prototype.updateCenter=function(){e.prototype.updateCenter.call(this),this.updateBackground()},t.prototype.updateBackground=function(){var e=this._background;e&&(e.x=this.maxLeft,e.y=this.maxTop,e.width=this.maxRight-this.maxLeft,e.height=this.maxBottom-this.maxTop)},t.prototype.getColumnWidth=function(e,t,i){var n=this,r=[],a=0;return Nl(e,(function(e){!e.isMeasured||e.disabled||e.__disabled||(n.fixedWidthGrid?r[a]=i:r[a]=xl(r[a],e.measuredWidth+e.pixelMarginRight+e.pixelMarginLeft),++a==t&&(a=0))})),r},Object.defineProperty(t.prototype,"layout",{get:function(){return this.getPropertyValue("layout")},set:function(e){this.setPropertyValue("layout",e)&&this.invalidateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentValign",{get:function(){return this.getPropertyValue("contentValign")},set:function(e){this.setPropertyValue("contentValign",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentAlign",{get:function(){return this.getPropertyValue("contentAlign")},set:function(e){this.setPropertyValue("contentAlign",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedWidthGrid",{get:function(){return this.getPropertyValue("fixedWidthGrid")},set:function(e){this.setPropertyValue("fixedWidthGrid",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxColumns",{get:function(){return this.getPropertyValue("maxColumns")},set:function(e){this.setPropertyValue("maxColumns",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reverseOrder",{get:function(){return this.getPropertyValue("reverseOrder")},set:function(e){this.setPropertyValue("reverseOrder",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setStateOnChildren",{get:function(){return this.getPropertyValue("setStateOnChildren")},set:function(e){this.setPropertyValue("setStateOnChildren",e,!0)},enumerable:!0,configurable:!0}),t.prototype.fitsToBounds=function(e){var t=e.x,i=e.y,n=.5;return t>=-.5&&t<=this.pixelWidth+n&&i>=-.5&&i<=this.pixelHeight+n},t.prototype.copyFrom=function(t){var i=this;e.prototype.copyFrom.call(this,t),this.layout=t.layout,this.setStateOnChildren=t.setStateOnChildren,t._background&&(this.background=t._background.clone(),this.background.copyFrom(t._background)),Tu(t.children.iterator(),(function(e){e.shouldClone&&(e.clone().parent=i)}))},Object.defineProperty(t.prototype,"preloader",{get:function(){var e=this._preloader;return e||(this.parent?this.parent.preloader:void 0)},set:function(e){this._preloader&&this.removeDispose(this._preloader),this._preloader=e,e&&(e.parent=this.tooltipContainer,this._disposers.push(e))},enumerable:!0,configurable:!0}),t.prototype.setPaper=function(t){var i=this,n=e.prototype.setPaper.call(this,t);return n&&(this._background&&(this._background.paper=t,this._background.topParent=this.topParent),this.children.each((function(e){e.setPaper(t),e.topParent=i.topParent}))),n},t.prototype.removeFromInvalids=function(){e.prototype.removeFromInvalids.call(this),Bu.removeFromInvalidLayouts(this)},t.prototype.setDataItem=function(t){this._dataItem!=t&&(Tu(this.children.iterator(),(function(e){e.dataItem=t})),this._background&&(this._background.dataItem=t)),e.prototype.setDataItem.call(this,t)},t.prototype.measureElement=function(){this.disabled||this.isTemplate||"none"==this.layout||this.__disabled||this.validateLayout()},Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e,!0)&&(this.setSVGAttribute({"font-family":e}),this.invalidateLabels())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e,!0)&&(this.setSVGAttribute({"font-size":e}),this.invalidateLabels())},enumerable:!0,configurable:!0}),t.prototype.invalidateLabels=function(){this.children.each((function(e){e.hardInvalidate?(e.hardInvalidate(),e.events.once("validated",e.handleValidate,e,!1)):e instanceof t&&e.invalidateLabels()}))},Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this.getPropertyValue("fontWeight")},set:function(e){this.setPropertyValue("fontWeight",e),this.setSVGAttribute({"font-weight":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textDecoration",{get:function(){return this.getPropertyValue("textDecoration")},set:function(e){this.setPropertyValue("textDecoration",e),this.setSVGAttribute({"text-decoration":e})},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._background&&this._background.dispose(),this._shouldBeReady=[],this.disposeChildren(),e.prototype.dispose.call(this)},t.prototype.setState=function(t,i,n){var r=t;return t instanceof vh&&(r=t.name),this.setStateOnChildren&&Tu(this.children.iterator(),(function(e){e.setState(r,i,n),"active"!=r&&(e.isActive=!1)})),this._background&&this._background.setState(r),this.setStateOnSprites.length&&Nl(this.setStateOnSprites,(function(e){e.setState(r,i,n)})),e.prototype.setState.call(this,t,i,n)},t.prototype.setActive=function(t){e.prototype.setActive.call(this,t),this._background&&(this._background.isActive=t)},t.prototype.dispatchReady=function(){var t=this;if(!this.isReady()&&!this.isDisposed()){var i=!0;Su(this.children.iterator(),(function(e){return!!(e.__disabled||e.disabled||e.isReady())||(i=!1,!1)})),Ul(this._shouldBeReady,(function(e){return!!(e.__disabled||e.disabled||e.isReady())||(i=!1,!1)})),i?e.prototype.dispatchReady.call(this):Bu.events.once("exitframe",(function(){t.dispatchReady(),Zp.requestFrame()}),void 0,!1)}},t.prototype._systemUpdate=function(t){this.children.each((function(e){e.invalid&&(e._systemCheckIfValidate()?e.dataItem&&e.dataItem.component&&e.dataItem.component.dataInvalid?t.push(e):e.validate():t.push(e))})),e.prototype._systemUpdate.call(this,t)},t.prototype._systemValidatePositions=function(){this.children.each((function(e){e.positionInvalid&&e.validatePosition()})),e.prototype._systemValidatePositions.call(this)},t.prototype._systemValidateLayouts=function(){this.layoutInvalid&&!this.isDisposed()&&this.validateLayout()},Object.defineProperty(t.prototype,"tapToActivate",{get:function(){return this._tapToActivate},set:function(e){this._tapToActivate!=e&&this.setTapToActivate(e)},enumerable:!0,configurable:!0}),t.prototype.setTapToActivate=function(e){var t=this;this._tapToActivate=e,this.interactions.isTouchProtected=e,e&&this.interactions.setEventDisposer("container-tapToActivate",e,(function(){return new tu([t.events.on("hit",t.handleTapToActivate,t,!1),t.events.on("down",t.initTapTimeout,t,!1),t.events.on("track",t.initTapTimeout,t,!1),ap().body.events.on("down",(function(e){ap().isLocalElement(e.pointer,t.paper.svg,t.uid)||t.handleTapToActivateDeactivation()}),t,!1)])})),ap()},t.prototype.handleTapToActivate=function(){this.interactions.isTouchProtected=!1,this.initTapTimeout()},t.prototype.handleTapToActivateDeactivation=function(){this.interactions.isTouchProtected=!0},t.prototype.initTapTimeout=function(){var e=this;this._tapToActivateTimeout&&this._tapToActivateTimeout.dispose(),this.tapToActivate&&!this.interactions.isTouchProtected&&this.tapTimeout&&(this._tapToActivateTimeout=this.setTimeout((function(){e.handleTapToActivateDeactivation()}),this.tapTimeout))},t.prototype.moveHtmlContainer=function(e){var t=Oh(e);if(t){this.htmlContainer=t;var i=this.svgContainer;i.htmlElement=t,i.htmlElement.appendChild(i.SVGContainer),i.initSensor(),i.measure()}else sl(e)&&""!=e&&Zp.log("html container '"+e+"' not found")},t.prototype.hasLicense=function(){if(_h.commercialLicense)return!0;for(var e=0;e<_h.licenses.length;e++)if(_h.licenses[e].match(/^CH.{5,}/i))return!0;return!1},t}(Up);Bu.registeredClasses.Container=Wp;var Hp=function(){function e(){this._isPaused=!1,this.animations=[],this.uid=Bu.getUniqueId(),this.dummyCounter=0,this._frameRequested=!1,this.updateStepDuration=45,this.time=Date.now()}return e.prototype.reportTime=function(e,t){this.dummyCounter,t&&(this.time=Date.now())},e.prototype.update=function(){var e=this;if(!this._isPaused){this._frameRequested=!1;var t=Date.now();Bu.dispatchImmediately("enterframe");for(var i in Bu.invalidDatas)if(vu(Bu.invalidDatas,i)){for(var n=Bu.invalidDatas[i];n.length>0;){var r=(a=n[0]).dataProvider;if(a.isDisposed())Gl(n,a);else if(r&&r.dataInvalid)try{if(r.validateData(),r.dataValidationProgress<1)break}catch(u){Gl(n,r),r.raiseCriticalError(u)}else try{if(a.validateData(),a.dataValidationProgress<1)break}catch(u){Gl(n,a),a.raiseCriticalError(u)}}if(Date.now()-t>this.updateStepDuration)break}for(;Bu.invalidRawDatas.length>0;){if((a=Bu.invalidRawDatas[0]).isDisposed())Gl(Bu.invalidRawDatas,a);else try{a.validateRawData()}catch(u){Gl(Bu.invalidRawDatas,a),a.raiseCriticalError(u)}}for(;Bu.invalidDataItems.length>0;){r=(a=Bu.invalidDataItems[0]).dataProvider;if(a.isDisposed()||a.dataInvalid||r&&r.dataInvalid);else try{a.validateDataItems()}catch(u){Gl(Bu.invalidDataItems,a),a.raiseCriticalError(u)}Gl(Bu.invalidDataItems,a)}for(;Bu.invalidDataRange.length>0;){var a;r=(a=Bu.invalidDataRange[0]).dataProvider;if(a.isDisposed()||a.dataInvalid||r&&r.dataInvalid);else try{a.validateDataRange(),a.skipRangeEvent||a.dispatchImmediately("datarangechanged"),a.skipRangeEvent=!1}catch(u){Gl(Bu.invalidDataRange,a),a.raiseCriticalError(u)}Gl(Bu.invalidDataRange,a)}var o=[];gu(Bu.invalidLayouts,(function(t){e.validateLayouts(t)})),gu(Bu.invalidPositions,(function(t){e.validatePositions(t)}));var s=!1;if(t=Date.now(),gu(Bu.invalidSprites,(function(i,n){for(var r=0;n.length>0;){if(e.validateLayouts(i),e.validatePositions(i),5==++r){if(Date.now()-t>e.updateStepDuration)break;r=0}var a=n[n.length-1];if(a&&!a.isDisposed()){if(a._systemCheckIfValidate())if(e.checkIfValidate2(a))try{a._systemUpdate(o)}catch(u){a.invalid=!1,Gl(n,a),a.raiseCriticalError(u)}else o.push(a);else o.push(a);a.invalid=!1}Gl(n,a)}Bu.invalidSprites[i]=Bu.invalidSprites[i].concat(o)})),gu(Bu.invalidSprites,(function(e,t){t.length>0&&(s=!0)})),gu(Bu.invalidDatas,(function(e,t){t.length>0&&(s=!0)})),Nl(ql(this.animations),(function(e){e.update()})),gu(Bu.invalidLayouts,(function(t){e.validateLayouts(t)})),gu(Bu.invalidPositions,(function(t){e.validatePositions(t)})),function(){for(var e=Date.now(),t=lu.length,i=0;i<t;++i)lu.shift()(e)}(),gu(Bu.invalidLayouts,(function(t){e.validateLayouts(t)})),gu(Bu.invalidPositions,(function(t){e.validatePositions(t)})),Bu.dispatchImmediately("exitframe"),(s||this.animations.length>0||[].length>0)&&this.requestFrame(),this.updateStepDuration<200){var l=!0;gu(Bu.invalidDatas,(function(e,t){t.length>0&&(l=!1)})),gu(Bu.invalidSprites,(function(e,t){t.length>0&&(l=!1)})),l&&(this.updateStepDuration=200)}}},e.prototype.checkIfValidate2=function(e){return!(e.dataItem&&e.dataItem.component&&e.dataItem.component.dataInvalid&&!e.dataItem.component.isTemplate)},e.prototype.requestFrame=function(){var e=this;this._frameRequested||(uu((function(){e.update()})),this._frameRequested=!0)},e.prototype.softInvalidate=function(e){var t=this;e.children.each((function(e){e instanceof Wp&&t.softInvalidate(e),e.measureFailed&&(Vu(e,"Label")?e.hardInvalidate():e.invalidate(),e.measureFailed=!1)}))},e.prototype.validatePositions=function(e){for(var t=Bu.invalidPositions[e];t.length>0;){var i=t[t.length-1];if(i.isDisposed())Gl(t,i);else try{i._systemValidatePositions()}catch(n){i.positionInvalid=!1,Gl(t,i),i.raiseCriticalError(n)}}},e.prototype.validateLayouts=function(e){for(var t=Bu.invalidLayouts[e];t.length>0;){var i=t[t.length-1];if(i.isDisposed())Gl(t,i);else try{i.children.each((function(e){e._systemValidateLayouts()})),i.validateLayout()}catch(n){i.layoutInvalid=!1,Gl(t,i),i.raiseCriticalError(n)}}},e.prototype.log=function(e){!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_h.verbose&&console&&console.log.apply(console,qs(e))}(e)},Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},set:function(e){this._isPaused=e,e||(this._frameRequested=!1,this.requestFrame())},enumerable:!0,configurable:!0}),e.VERSION="4.10.26",e}(),Zp=new Hp,qp=function(){function e(){}return e.prototype.parse=function(e){return[]},Object.defineProperty(e.prototype,"parsableNumbers",{get:function(){return this.options.numberFields&&this.options.numberFields.length>0},enumerable:!0,configurable:!0}),e.prototype.maybeToNumber=function(e,t){return-1!==this.options.numberFields.indexOf(e)?Fc(t):t},Object.defineProperty(e.prototype,"parsableDates",{get:function(){return this.options.dateFields&&this.options.dateFields.length>0},enumerable:!0,configurable:!0}),e.prototype.maybeToDate=function(e,t){return-1!==this.options.dateFields.indexOf(e)?this.options.dateFormatter.parse(t,this.dateFormat):t},e.prototype.maybeToEmpty=function(e){return nl(e)&&""!=e||!nl(this.options.emptyAs)?e:this.options.emptyAs},Object.defineProperty(e.prototype,"dateFormatter",{get:function(){return this.options.dateFormatter||(this.options.dateFormatter=new Cp,this.options.dateFormat&&(this.options.dateFormat=this.options.dateFormat)),this.options.dateFormatter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateFormat",{get:function(){return this.options.dateFormat||this.dateFormatter.inputDateFormat},enumerable:!0,configurable:!0}),e}(),Xp=[",",";","\t"],Kp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentType="text/csv",t.options={delimiter:"",reverse:!1,skipRows:0,skipEmpty:!0,useColumnNames:!1},t}return Us(t,e),t.isCSV=function(e){return!!t.getDelimiterFromData(e)},t.getDelimiterFromData=function(e){var t,i=e.split("\n"),n=i.length;return Nl(Xp,(function(e){for(var r=0,a=0,o=0;o<n;++o){if(!((r=i[o].split(e).length)>1)){a=0;break}if(0===a)a=r;else if(r!=a){a=0;break}}a&&(t=e)})),t},t.prototype.parse=function(e){this.options.delimiter||(this.options.delimiter=t.getDelimiterFromData(e));var i,n,r,a=this.CSVToArray(e,this.options.delimiter),o=nl(this.options.emptyAs),s=this.parsableNumbers,l=this.parsableDates,u=[],c=[];for(n=0;n<this.options.skipRows;n++)a.shift();if(this.options.useColumnNames){c=a.shift();for(var h=0;h<c.length;h++)""===(i=nl(c[h])?c[h].replace(/^\s+|\s+$/gm,""):"")&&(i="col"+h),c[h]=i}for(;r=this.options.reverse?a.pop():a.shift();)if(!this.options.skipEmpty||1!==r.length||""!==r[0]){var p={};for(n=0;n<r.length;n++)p[i=void 0===c[n]?"col"+n:c[n]]=""===r[n]?this.options.emptyAs:r[n],o&&(p[i]=this.maybeToEmpty(p[i])),s&&(p[i]=this.maybeToNumber(i,p[i])),l&&(p[i]=this.maybeToDate(i,p[i]));u.push(p)}return u},t.prototype.CSVToArray=function(e,t){t=t||",";for(var i=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),n=[[]],r=null;r=i.exec(e);){var a=r[1];a.length&&a!==t&&n.push([]);var o=void 0;o=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(o)}return n},t}(qp),Yp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentType="application/json",t.options={},t}return Us(t,e),t.isJSON=function(e){try{return JSON.parse(e),!0}catch(t){return!1}},t.prototype.parse=function(e){var t,i=this;try{nl(JSON)&&(t=JSON.parse(e))}catch(u){return}var n=nl(this.options.emptyAs),r=this.parsableNumbers,a=this.parsableDates;if(Array.isArray(t)&&(r||a||n))for(var o=function(e,o){var s=t[e];gu(s,(function(e,t){n&&(s[e]=i.maybeToEmpty(s[e])),r&&(s[e]=i.maybeToNumber(e,s[e])),a&&(s[e]=i.maybeToDate(e,s[e]))}))},s=0,l=t.length;s<l;s++)o(s);return t},t}(qp),$p=new(function(){function e(){this.adapter=new ec(this)}return e.prototype.load=function(e){var t=Vl(Array.isArray(e)?e:[e],(function(e){return e.dispatchImmediately("started"),e.dispatchImmediately("loadstarted"),Lp(e.url,e,e.requestOptions)}));Promise.all(t).then((function(e){Nl(e,(function(e){var t=e.target;t.dispatchImmediately("loadended"),e.error?t.events.isEnabled("error")&&t.events.dispatchImmediately("error",{type:"error",code:e.xhr.status,message:t.language.translate("Unable to load file: %1",null,t.url),target:t}):t.processData(e.response,e.type),t.dispatchImmediately("ended")}))})).catch((function(e){e.target&&(e.target.dispatchImmediately("loadended"),e.target.events.isEnabled("error")&&e.target.events.dispatchImmediately("error",{type:"error",code:e.xhr.status,message:e.target.language.translate("Unable to load file: %1",null,e.target.url),target:e.target}),e.target.dispatchImmediately("ended"))}))},e.prototype.getParserByType=function(e){var t=this.adapter.apply("getParserByType",{parser:null,type:e}).parser;return t||("csv"==e||"text/csv"==e||"application/vnd.ms-excel"==e?new Kp:"json"==e||"application/json"==e?new Yp:void 0)},e.prototype.getParserByData=function(e,t){var i=this.adapter.apply("getParserByData",{parser:null,data:e,type:t}).parser;if(!i){if(i=this.getParserByType(t))return i;if(Yp.isJSON(e))return this.getParserByType("json");if(Kp.isCSV(e))return this.getParserByType("csv")}return i},e}()),Jp=function(e){function t(t,i){var n=e.call(this)||this;return n.adapter=new ec(n),n._requestOptions={},n._incremental=!1,n._incrementalParams={},n._keepCount=!1,n._updateCurrentData=!1,n.showPreloader=!0,n.className="DataSource",t&&(n.url=t),i&&(n.parser="string"==typeof i?$p.getParserByType(i):i),n}return Us(t,e),t.prototype.processData=function(e,t){if(this.dispatchImmediately("parsestarted"),this.parser||(this.parser=$p.getParserByData(e,t),this.parser)){if(this.parser.options=this.adapter.apply("parserOptions",this.parser.options),this.parser.options.dateFields=this.adapter.apply("dateFields",this.parser.options.dateFields||[]),this.parser.options.numberFields=this.adapter.apply("numberFields",this.parser.options.numberFields||[]),this.parser.options.dateFields&&!this.parser.options.dateFormatter&&(this.parser.options.dateFormatter=this.dateFormatter),this.data=this.adapter.apply("parsedData",this.parser.parse(this.adapter.apply("unparsedData",e))),!nl(this.data)&&this.events.isEnabled("parseerror")){var i={type:"parseerror",message:this.language.translate("Error parsing file: %1",null,this.url),target:this};this.events.dispatchImmediately("parseerror",i)}this.dispatchImmediately("parseended"),nl(this.data)&&this.dispatchImmediately("done",{data:this.data}),this.lastLoad=new Date}else{if(this.events.isEnabled("parseerror")){var n={type:"parseerror",message:this.language.translate("No parser available for file: %1",null,this.url),target:this};this.events.dispatchImmediately("parseerror",n)}this.dispatchImmediately("parseended")}},Object.defineProperty(t.prototype,"url",{get:function(){var e=this.disableCache?this.timestampUrl(this._url):this._url;return this.incremental&&this.component.data.length&&(e=this.addUrlParams(e,this.incrementalParams)),this.adapter.apply("url",e)},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestOptions",{get:function(){return this.adapter.apply("requestOptions",this._requestOptions)},set:function(e){this._requestOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser||(this._parser=new Yp),this.adapter.apply("parser",this._parser)},set:function(e){this._parser=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reloadFrequency",{get:function(){return this.adapter.apply("reloadTimeout",this._reloadFrequency)},set:function(e){var t=this;this._reloadFrequency!=e&&(this._reloadFrequency=e,e?nl(this._reloadDisposer)||(this._reloadDisposer=this.events.on("ended",(function(e){t._reloadTimeout=setTimeout((function(){t.load()}),t.reloadFrequency)}))):nl(this._reloadDisposer)&&(this._reloadDisposer.dispose(),this._reloadDisposer=void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incremental",{get:function(){return this.adapter.apply("incremental",this._incremental)},set:function(e){this._incremental=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incrementalParams",{get:function(){return this.adapter.apply("incrementalParams",this._incrementalParams)},set:function(e){this._incrementalParams=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepCount",{get:function(){return this.adapter.apply("keepCount",this._keepCount)},set:function(e){this._keepCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateCurrentData",{get:function(){return this.adapter.apply("updateCurrentData",this._updateCurrentData)},set:function(e){this._updateCurrentData=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this._language?this._language:this.component?(this._language=this.component.language,this._language):(this.language=new Pp,this.language)},set:function(e){this._language=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateFormatter",{get:function(){return this._dateFormatter?this._dateFormatter:this.component?(this._dateFormatter=this.component.dateFormatter,this._dateFormatter):(this.dateFormatter=new Cp,this.dateFormatter)},set:function(e){this._dateFormatter=e},enumerable:!0,configurable:!0}),t.prototype.timestampUrl=function(e){var t={};return t[(new Date).getTime().toString()]="",this.addUrlParams(e,t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._reloadTimeout&&clearTimeout(this._reloadTimeout),nl(this._reloadDisposer)&&(this._reloadDisposer.dispose(),this._reloadDisposer=void 0)},t.prototype.load=function(){this.url&&(this._reloadTimeout&&clearTimeout(this._reloadTimeout),$p.load(this))},t.prototype.addUrlParams=function(e,t){var i=e.match(/\?/)?"&":"?",n=[];return gu(t,(function(e,t){""!=t?n.push(e+"="+encodeURIComponent(t)):n.push(e)})),n.length?e+i+n.join("&"):e},t.prototype.processConfig=function(t){Bu.registeredClasses.json=Yp,Bu.registeredClasses.JSONParser=Yp,Bu.registeredClasses.csv=Kp,Bu.registeredClasses.CSVParser=Kp,e.prototype.processConfig.call(this,t)},t}(pc),Qp=function(e){function t(){var t=e.call(this)||this;return t._rules=new Wu,t._appliedRules={},t._appliedTargets=[],t._useDefault=!0,t.adapter=new ec(t),t._enabled=!1,t._responsiveDisposers=[],t._noStates=[],t.className="Responsive",t.rules.events.on("inserted",(function(){t.checkRules()}),!0),t.rules.events.on("removed",(function(){t.checkRules()}),!0),t._disposers.push(t.rules.events),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"component",{get:function(){return this._component},set:function(e){var t=this;e!=this._component&&(this.disposeResponsiveHandlers(),this._component=e,this._responsiveDisposers.push(rl(this.component).events.on("sizechanged",(function(){t.checkRules()}),this)),this._responsiveDisposers.push(rl(this.component).events.on("datavalidated",(function(){t._component.isReady()&&t.checkRules(!0)}),this)),this.enabled=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this.adapter.apply("enabled",this._enabled)},set:function(e){this._enabled!=e&&(this._enabled=e,this.applyRules())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useDefault",{get:function(){return this.adapter.apply("useDefault",this._useDefault)},set:function(e){this._useDefault!=e&&(this._useDefault=e,this.applyRules())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rules",{get:function(){return this.adapter.apply("rules",this._rules)},set:function(e){this._rules=e,this._enabled=!0,this.applyRules()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultRules",{get:function(){return this.adapter.apply("defaultRules",ed)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allRules",{get:function(){var e=new Wu;return this.useDefault&&e.copyFrom(this.defaultRules),e.copyFrom(this.rules),this.adapter.apply("allRules",e)},enumerable:!0,configurable:!0}),t.prototype.isApplied=function(e){var t=this._appliedRules[e];return!!nl(t)&&t},t.prototype.checkRules=function(e){var t=this;void 0===e&&(e=!1);var i=this.allRules;if(i&&0!=i.length){var n=!1,r=rl(this.component);if(Tu(i.iterator(),(function(e){e.id||(e.id=Bu.getUniqueId());var i=e.relevant(r);(i&&!t.isApplied(e.id)||!i&&t.isApplied(e.id))&&(n=!0),t._appliedRules[e.id]=i})),e&&(n=!0),n){if(!this.component.isReady())return r.hidden=!0,void r.events.once("ready",(function(e){e.target.show(0),t.applyRules()}));this.dispatchImmediately("ruleschanged"),this.applyRules()}}},t.prototype.applyRules=function(e){var t=this,i=nl(e)?e:rl(this.component),n=!1;if(this.enabled){var r=!1;Tu(this.allRules.iterator(),(function(e){var a=t.getState(e,i);a&&(n||(-1!==jl(t._appliedTargets,i.uid)&&i.setState(t.getDefaultState(i),0),n=!0),t.isApplied(rl(e.id))&&(a.transitionDuration=0,t.setTargetState(i,a),t.dispatchImmediately("ruleapplied",{rule:e}),r=!0))})),r?function(e,t,i){var n=e.indexOf(t);-1!==n&&e.splice(n,1),ll(i)?e.splice(i,0,t):e.push(t)}(this._appliedTargets,i.uid):Gl(this._appliedTargets,i.uid)}i.children&&Tu(i.children.iterator(),(function(e){t.applyRules(e)}))},t.prototype.getState=function(e,t){var i="responsive-"+e.id,n=t.uid+"_"+i;if(-1===jl(this._noStates,n)){if(t.states.hasKey(i))return t.states.getKey(i);var r=e.state(t,i);return r||this._noStates.push(n),r}},t.prototype.getDefaultState=function(e){return e.states.hasKey("responsive-default")?e.states.getKey("responsive-default"):e.states.create("responsive-default")},t.prototype.setTargetState=function(e,t){var i=this,n=this.getDefaultState(e);gu(t.properties,(function(t,r){nl(n.properties[t])||(n.properties[t]=i.getValue(e,t))})),e.setState(t)},t.prototype.getValue=function(e,t){var i=e.getPropertyValue(t);return!nl(i)&&nl(e[t])&&(i=e[t]),i},t.prototype.dispose=function(){this.disposeResponsiveHandlers(),e.prototype.dispose.call(this)},t.prototype.disposeResponsiveHandlers=function(){for(var e=this._responsiveDisposers.pop();e;)e.dispose(),e=this._responsiveDisposers.pop()},t}(pc),ed=new Wu;ed.events.on("inserted",(function(e){e.newValue.id=Bu.getUniqueId()}));var td=function(){function e(){}return e.widthXXS=function(t){return t.pixelWidth<=e.XXS},e.widthXS=function(t){return t.pixelWidth<=e.XS},e.widthS=function(t){return t.pixelWidth<=e.S},e.widthM=function(t){return t.pixelWidth<=e.M},e.widthL=function(t){return t.pixelWidth<=e.L},e.widthXL=function(t){return t.pixelWidth<=e.XL},e.widthXXL=function(t){return t.pixelWidth<=e.XXL},e.heightXXS=function(t){return t.pixelHeight<=e.XXS},e.heightXS=function(t){return t.pixelHeight<=e.XS},e.heightS=function(t){return t.pixelHeight<=e.S},e.heightM=function(t){return t.pixelHeight<=e.M},e.heightL=function(t){return t.pixelHeight<=e.L},e.heightXL=function(t){return t.pixelHeight<=e.XL},e.heightXXL=function(t){return t.pixelHeight<=e.XXL},e.isXXS=function(t){return t.pixelWidth<=e.XXS&&t.pixelHeight<=e.XXS},e.isXS=function(t){return t.pixelWidth<=e.XS&&t.pixelHeight<=e.XS},e.isS=function(t){return t.pixelWidth<=e.S&&t.pixelHeight<=e.S},e.isM=function(t){return t.pixelWidth<=e.M&&t.pixelHeight<=e.M},e.isL=function(t){return t.pixelWidth<=e.L&&t.pixelHeight<=e.L},e.isXL=function(t){return t.pixelWidth<=e.XL&&t.pixelHeight<=e.XL},e.isXXL=function(t){return t.pixelWidth<=e.XXL&&t.pixelHeight<=e.XXL},e.maybeXXS=function(t){return t.pixelWidth<=e.XXS||t.pixelHeight<=e.XXS},e.maybeXS=function(t){return t.pixelWidth<=e.XS||t.pixelHeight<=e.XS},e.maybeS=function(t){return t.pixelWidth<=e.S||t.pixelHeight<=e.S},e.maybeM=function(t){return t.pixelWidth<=e.M||t.pixelHeight<=e.M},e.maybeL=function(t){return t.pixelWidth<=e.L||t.pixelHeight<=e.L},e.maybeXL=function(t){return t.pixelWidth<=e.XL||t.pixelHeight<=e.XL},e.maybeXXL=function(t){return t.pixelWidth<=e.XXL||t.pixelHeight<=e.XXL},e.XXS=100,e.XS=200,e.S=300,e.M=400,e.L=600,e.XL=800,e.XXL=1e3,e}(),id=function(e){function t(){var t=e.call(this)||this;return t._disabled=!1,t.hasProperties=!1,t.values={},t.categories={},t.dates={},t.locations={},t.workingLocations={},t.properties={},t.sprites=[],t.isTemplate=!1,t._index=null,t._visible=!0,t._hidden=!1,t._ignoreMinMax=!1,t.hasChildren={},t.isHiding=!1,t._valueAnimations={},t._locationAnimations={},t.className="DataItem",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"adapter",{get:function(){return this._adapterO||(this._adapterO=new ec(this)),this._adapterO},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.component&&null!=this._index?this._index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations||(this._animations=[],this._disposers.push(new Sh(this._animations))),this._animations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!this._hidden&&this._visible},set:function(e){e&&(this.hidden=!1),this._visible!=e&&this.setVisibility(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hidden",{get:function(){return this._hidden},set:function(e){this._hidden!=e&&(this._hidden=e,e?this.setVisibility(!1):this.setVisibility(!0,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"__disabled",{get:function(){return this._disabled},set:function(e){this._disabled=e,Nl(this.sprites,(function(t){t.__disabled=e}))},enumerable:!0,configurable:!0}),t.prototype.setVisibility=function(e,t){if(Nl(this.sprites,(function(t){e?t.visible=t.defaultState.properties.visible:t.hiddenState?t.visible=t.hiddenState.properties.visible:t.visible=!1})),this._visible=e,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("visibilitychanged")){var i={type:"visibilitychanged",target:this,visible:e};this.events.dispatchImmediately("visibilitychanged",i)}},t.prototype.show=function(e,t,i){var n,r=this;if(!this.hidden)return this.setVisibility(!0,!0),this.isHiding=!1,this._hideDisposer&&this.removeDispose(this._hideDisposer),i&&Nl(i,(function(i){n=r.setWorkingValue(i,r.values[i].value,e,t)})),Nl(this.sprites,(function(i){var n=i.show(e);null==n||n.isFinished()||(r._disposers.push(n),null!=t&&t>0&&n.delay(t))})),n},t.prototype.dispose=function(){e.prototype.dispose.call(this),Nl(this.sprites,(function(e){e.dispose()})),this.sprites=[]},t.prototype.hide=function(e,t,i,n){var r=this;if(this.isHiding=!0,Nl(this.sprites,(function(i){var n=i.hide(e);null==n||n.isFinished()||(r._disposers.push(n),null!=t&&t>0&&n.delay(t))})),ll(i)&&n){var a;if(Nl(n,(function(n){var o=r.setWorkingValue(n,i,e,t);o&&(a=o)})),a&&!a.isFinished())return this._hideDisposer=a.events.on("animationended",(function(){r.setVisibility(!1,!0),r.isHiding=!1})),this._disposers.push(this._hideDisposer),a;this.isHiding=!1,this.setVisibility(!1,!0)}else this.isHiding=!1,this.setVisibility(!1)},t.prototype.getDuration=function(e){if(!ll(e)){var t=this.component;t&&(e=t.interpolationDuration)}if(null!=e)return this._adapterO?this._adapterO.apply("duration",e):e},t.prototype.getValue=function(e,t){if(e&&this.component){t||(t=this.component.dataFields[e+"Show"])||(t="value");var i=this.values[e][t];return this._adapterO&&this._adapterO.isEnabled("value")?this._adapterO.apply("value",{value:i,field:e}).value:i}},t.prototype.getWorkingValue=function(e){if(e&&this.component){var t=this.component.dataFields[e+"Show"];return t||(t="workingValue"),this._adapterO?this._adapterO.apply("workingValue",{workingValue:this.values[e][t],field:e}).workingValue:this.values[e][t]}},t.prototype.getActualWorkingValue=function(e){return this.values[e].workingValue},t.prototype.setValue=function(e,t,i,n){var r=this.values[e].value,a=this.getDuration(i);if(r!==(t=el(t))){if(this.values[e].value=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("valuechanged")){var o={type:"valuechanged",target:this,property:e};this.events.dispatchImmediately("valuechanged",o)}this.component&&this.component.handleDataItemValueChange(this,e)}this.setWorkingValue(e,t,a,n)},t.prototype.setCalculatedValue=function(e,t,i){if(this.values[e][i]!==t&&ll(t)){if(this.values[e][i]=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("calculatedvaluechanged")){var n={type:"calculatedvaluechanged",target:this,property:e};this.events.dispatchImmediately("calculatedvaluechanged",n)}this.component&&this.component.handleDataItemCalculatedValueChange(this,e)}},t.prototype.setWorkingValue=function(e,t,i,n){if(ll(this.values[e].value)){var r=this.getDuration(i),a=this.values[e].workingValue;if(null!=r&&r>0&&ll(a)&&this.component){if(a!=t){var o=this.animate({childObject:this.values[e],property:"workingValue",from:a,to:t,dummyData:e},r,this.component.interpolationEasing);return null!=n&&o.delay(n),o.events.on("animationstarted",this.handleInterpolationProgress,this),o.events.on("animationprogress",this.handleInterpolationProgress,this),o.events.on("animationended",this.handleInterpolationProgress,this),this._valueAnimations[e]=o,o}(s=this._valueAnimations[e])&&s.stop(),this.values[e].workingValue=t}else{var s;if((s=this._valueAnimations[e])&&s.stop(),this.values[e].workingValue=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("workingvaluechanged")){var l={type:"workingvaluechanged",target:this,property:e};this.events.dispatchImmediately("workingvaluechanged",l)}this.component&&this.component.handleDataItemWorkingValueChange(this,e)}}},t.prototype.setLocation=function(e,t,i,n){if(this.locations[e]!==t){if(this.locations[e]=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("locationchanged")){var r={type:"locationchanged",target:this,property:e};this.events.dispatchImmediately("locationchanged",r)}this.component&&this.component.handleDataItemValueChange(this,e),this.setWorkingLocation(e,t,i,n)}},t.prototype.setWorkingLocation=function(e,t,i,n){var r=this.getDuration(i),a=this.workingLocations[e];if(null!=r&&r>0&&ll(a)&&this.component){if(a!=t){var o=this.animate({childObject:this.workingLocations,property:e,from:a,to:t,dummyData:e},r,this.component.interpolationEasing);return null!=n&&o.delay(n),o.events.on("animationstarted",this.handleInterpolationProgress,this),o.events.on("animationprogress",this.handleInterpolationProgress,this),o.events.on("animationended",this.handleInterpolationProgress,this),this._locationAnimations[e]=o,o}(s=this._locationAnimations[e])&&s.stop(),this.workingLocations[e]=t}else{var s;if((s=this._locationAnimations[e])&&s.stop(),this.workingLocations[e]=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("workinglocationchanged")){var l={type:"workinglocationchanged",target:this,property:e};this.events.dispatchImmediately("workinglocationchanged",l)}this.component&&this.component.handleDataItemWorkingLocationChange(this,e)}},t.prototype.setDate=function(e,t,i){!ol(t)&&this.component&&(t=this.component.dateFormatter.parse(t)),this.dates[e]!==t&&(this.dates[e]=t,this.setValue(e,t.getTime(),i))},t.prototype.getDate=function(e){return this._adapterO?this._adapterO.apply("date",{date:this.dates[e],field:e}).date:this.dates[e]},t.prototype.setProperty=function(e,t){if(this.properties[e]!==t){if(this.hasProperties=!0,this.properties[e]=t,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("propertychanged")){var i={type:"propertychanged",target:this,property:e,value:t};this.events.dispatchImmediately("propertychanged",i)}this.component&&this.component.handleDataItemPropertyChange(this,e)}},t.prototype.setCategory=function(e,t){sl(t)||(t=Js(t)),this.categories[e]!==t&&(this.categories[e]=t)},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),t.dataContext&&(this.dataContext=function(e,t){return gu(e,(function(e,i){t[e]=i})),t}(t.dataContext,{})),_c(t.locations,this.locations),t._adapterO&&this.adapter.copyFrom(t._adapterO),this.component=t.component},Object.defineProperty(t.prototype,"opacity",{set:function(e){Nl(this.sprites,(function(t){t.opacity=e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ignoreMinMax",{get:function(){return this._ignoreMinMax},set:function(e){if(this._ignoreMinMax=e,this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("propertychanged")){var t={type:"propertychanged",target:this,property:"ignoreMinMax",value:e};this.events.dispatchImmediately("propertychanged",t)}this.component&&this.component.handleDataItemPropertyChange(this,"ignoreMinMax")},enumerable:!0,configurable:!0}),t.prototype.animate=function(e,t,i){return new Th(this,e,t,i).start()},t.prototype.handleInterpolationProgress=function(e){var t=e.target.animationOptions[0];if(t){if(this._eventDispatcher&&!this.__disabled&&this.events.isEnabled("workingvaluechanged")){var i={type:"workingvaluechanged",target:this,property:t.dummyData};this.events.dispatchImmediately("workingvaluechanged",i)}this.component&&this.component.handleDataItemWorkingValueChange(this,t.dummyData)}},t.prototype.hasValue=function(e){for(var t=0,i=e.length;t<i;t++){var n=this.values[e[t]];if(!n||!nl(n.value))return!1}return!0},Object.defineProperty(t.prototype,"depth",{get:function(){return this.parent?this.parent.depth+1:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(e){this._dataContext=e},enumerable:!0,configurable:!0}),t.prototype.addSprite=function(e){e.dataItem&&e.dataItem!=this&&Gl(e.dataItem.sprites,e),this.visible||e.hide(0),this.isHiding&&e.hide(),this.sprites.push(e),e.dataItem=this},t}(pc),nd=function(e){function t(){var t=e.call(this)||this;return t.dataFields={},t._dataSources={},t._parseDataFrom=0,t._dataDisposers=[],t._currentDataSetId="",t._start=0,t._end=1,t.skipRangeEvent=!1,t.rangeChangeDuration=0,t.rangeChangeEasing=uh,t.parsingStepDuration=50,t.dataInvalid=!1,t.rawDataInvalid=!1,t.dataRangeInvalid=!1,t.dataItemsInvalid=!1,t.interpolationDuration=0,t.interpolationEasing=uh,t.sequencedInterpolation=!0,t.sequencedInterpolationDelay=0,t.dataValidationProgress=0,t._addAllDataItems=!0,t._usesData=!0,t.className="Component",t.minZoomCount=1,t.maxZoomCount=0,t._dataItems=new Xu(t.createDataItem()),t._dataItems.events.on("inserted",t.handleDataItemAdded,t,!1),t._dataItems.events.on("removed",t.handleDataItemRemoved,t,!1),t._disposers.push(new Uu(t._dataItems)),t._disposers.push(t._dataItems.template),t.invalidateData(),t.dataUsers.events.on("inserted",t.handleDataUserAdded,t,!1),t._disposers.push(new tu(t._dataDisposers)),t._start=0,t._end=1,t.maxZoomDeclination=1,t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new id},t.prototype.handleDataUserAdded=function(e){e.newValue.dataProvider=this},t.prototype.handleDataItemValueChange=function(e,t){this.dataItemsInvalid||this.invalidateDataItems()},t.prototype.handleDataItemWorkingValueChange=function(e,t){},t.prototype.handleDataItemWorkingLocationChange=function(e,t){},t.prototype.handleDataItemCalculatedValueChange=function(e,t){},t.prototype.handleDataItemPropertyChange=function(e,t){},t.prototype.processDataItem=function(e,t){var i=this;if(e){t||(t={}),e.dataContext=t;var n=!1;gu(this.dataFields,(function(r,a){var o=r,s=t[a];if(i._adapterO&&i._adapterO.isEnabled("dataContextValue")&&(s=i._adapterO.apply("dataContextValue",{field:o,value:s,dataItem:e}).value),nl(s))if(n=!0,e.hasChildren[o]){var l=i.createDataItem();l.copyFrom(i.mainDataSet.template);var u=new Xu(l);u.events.on("inserted",i.handleDataItemAdded,i,!1),u.events.on("removed",i.handleDataItemRemoved,i,!1),i._dataDisposers.push(new Uu(u));for(var c=s.length,h=0;h<c;h++){var p=s[h],d=u.create();d.parent=e,i.processDataItem(d,p)}e[o]=u}else e[o]=s})),gu(this.propertyFields,(function(i,r){var a=i,o=t[r];nl(o)&&(n=!0,e.setProperty(a,o))})),this._addAllDataItems||n||this.mainDataSet.remove(e)}},t.prototype.updateDataItem=function(e){var t=this;if(e){var i=e.dataContext;gu(this.dataFields,(function(n,r){var a=n,o=i[r];(t._adapterO&&(o=t._adapterO.apply("dataContextValue",{field:a,value:o,dataItem:e}).value),nl(o))&&(e.hasChildren[a]?e[a].each((function(e){t.updateDataItem(e)})):e[a]=o)})),gu(this.propertyFields,(function(t,n){var r=t,a=i[n];nl(a)&&e.setProperty(r,a)}))}},t.prototype.validateDataElements=function(){for(var e=this.endIndex,t=this.startIndex;t<e;t++){var i=this.dataItems.getIndex(t);i&&this.validateDataElement(i)}},t.prototype.validate=function(){this.validateDataElements(),e.prototype.validate.call(this)},t.prototype.validateDataElement=function(e){},t.prototype.addData=function(e,t,i){var n=this;if(!this.dataInvalid&&this.inited&&(this._parseDataFrom=this.data.length),i||(e instanceof Array?Nl(e,(function(e){n.data.push(e)})):this.data.push(e)),this.inited)this.removeData(t,i);else if(ll(t))for(;t>0;)this.data.shift(),t--;this.invalidateData()},t.prototype.removeData=function(e,t){if(ll(e)&&e>0){for(;e>0;){var i=this.mainDataSet.getIndex(0);i&&this.mainDataSet.remove(i),this.dataUsers.each((function(e){if(!e.data||0==e.data.length){var t=e.mainDataSet.getIndex(0);t&&e.mainDataSet.remove(t)}})),t||this.data.shift(),this._parseDataFrom>0&&this._parseDataFrom--,e--}this.invalidateDataItems()}},t.prototype.invalidateData=function(){this.disabled||this.isTemplate||(Bu.addToInvalidComponents(this),Zp.requestFrame(),this.dataInvalid=!0,Tu(this.dataUsers.iterator(),(function(e){e.invalidateDataItems()})))},t.prototype.invalidateDataUsers=function(){Tu(this.dataUsers.iterator(),(function(e){e.invalidate()}))},t.prototype.invalidateDataItems=function(){this.disabled||this.isTemplate||(Wl(Bu.invalidDataItems,this),Zp.requestFrame(),this.dataItemsInvalid=!0,Tu(this.dataUsers.iterator(),(function(e){e.invalidateDataItems()})))},t.prototype.invalidateDataRange=function(){this.disabled||this.isTemplate||(this.dataRangeInvalid=!0,Wl(Bu.invalidDataRange,this),Zp.requestFrame())},t.prototype.validateDataRange=function(){Gl(Bu.invalidDataRange,this),this.dataRangeInvalid=!1,this.startIndex==this._prevStartIndex&&this.endIndex==this._prevEndIndex||(this.rangeChangeUpdate(),this.appendDataItems(),this.invalidate(),this.dispatchImmediately("datarangechanged"))},t.prototype.sliceData=function(){this._workingStartIndex=this.startIndex,this._workingEndIndex=this.endIndex},t.prototype.rangeChangeUpdate=function(){this.sliceData(),this._prevStartIndex=this.startIndex,this._prevEndIndex=this.endIndex},t.prototype.appendDataItems=function(){for(var e=this.endIndex,t=this.startIndex;t<e;t++){(i=this.dataItems.getIndex(t))&&(i.__disabled=!1)}for(t=0;t<this.startIndex;t++){(i=this.dataItems.getIndex(t))&&(i.__disabled=!0)}for(t=this.endIndex;t<this.dataItems.length;t++){var i;(i=this.dataItems.getIndex(t))&&(i.__disabled=!0)}},t.prototype.invalidateRawData=function(){this.disabled||this.isTemplate||(Wl(Bu.invalidRawDatas,this),Zp.requestFrame(),this.rawDataInvalid=!0,Tu(this.dataUsers.iterator(),(function(e){e.invalidateRawData()})))},t.prototype.validateRawData=function(){var e=this;Gl(Bu.invalidRawDatas,this),Tu(this.mainDataSet.iterator(),(function(t){t&&e.updateDataItem(t)}))},t.prototype.dispose=function(){var t=this;this.mainDataSet.template.clones.clear(),gu(this._dataSources,(function(e,i){t.removeDispose(i)})),this.disposeData(),e.prototype.dispose.call(this)},t.prototype.disposeData=function(){this.mainDataSet.template.clones.clear(),Nl(this._dataDisposers,(function(e){e.dispose()})),Tu(this.dataUsers.iterator(),(function(e){e.disposeData()})),this._dataDisposers.length=0,this._startIndex=void 0,this._endIndex=void 0,this.mainDataSet.clear(),this.mainDataSet.template.clones.clear(),this._dataSets&&this._dataSets.clear()},t.prototype.getDataItem=function(e){return this.mainDataSet.create()},t.prototype.validateData=function(){if(this.dispatchImmediately("beforedatavalidated"),this.dataInvalid=!1,Bu.removeFromInvalidComponents(this),!this.__disabled){if(this.dataValidationProgress=0,this._prevStartIndex=void 0,this._prevEndIndex=void 0,this._startIndex=void 0,this._endIndex=void 0,this.dataFields.data&&this.dataItem){var e=this.dataItem.dataContext;this._data=e[this.dataFields.data]}if(0===this._parseDataFrom&&this.data.length>0&&this.disposeData(),this.data.length>0){var t=this.preloader;Tu(this.dataUsers.iterator(),(function(e){e._startIndex=void 0,e._endIndex=void 0}));for(var i=0,n=Date.now(),r=this._parseDataFrom,a=this.data.length,o=function(){var e=s.data[r];if(s._usesData){var a=s.getDataItem(e);s.processDataItem(a,e)}if((s.dataUsers.each((function(t){if(0==t.data.length){var i=t.getDataItem(e);t.processDataItem(i,e)}})),100==++i)&&(i=0,Date.now()-n>s.parsingStepDuration&&r<s.data.length-10))return s._parseDataFrom=r+1,t&&(r/s.data.length>.5&&!t.visible||(t.progress=r/s.data.length)),s.dataValidationProgress=r/s.data.length,r=s.data.length,s.invalidateData(),{value:void 0}},s=this;r<a;r++){var l=o();if("object"===typeof l)return l.value}t&&(t.progress=1),this.dataUsers.each((function(e){e.hidden&&e.hide(0)}))}this.dataValidationProgress=1,this._parseDataFrom=0,this.invalidateDataItems(),this._internalDefaultsApplied||this.applyInternalDefaults(),this.dispatch("datavalidated")}},t.prototype.validateDataItems=function(){Gl(Bu.invalidDataItems,this),this.dataItemsInvalid=!1,this.invalidateDataRange(),this.invalidate(),this.dispatch("dataitemsvalidated")},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=[]),this._adapterO?this._adapterO.apply("data",this._data):this._data},set:function(e){this.setData(e)},enumerable:!0,configurable:!0}),t.prototype.setData=function(e){this.isDisposed()||(this._parseDataFrom=0,this.disposeData(),this._data=e,e&&e.length>0?this.invalidateData():(this.dispatchImmediately("beforedatavalidated"),this.dispatch("datavalidated")))},t.prototype.getDataSource=function(e){var t=this;return nl(this._dataSources[e])||(this._dataSources[e]=new Jp,this._dataSources[e].component=this,this.setDataSourceEvents(this._dataSources[e],e),this._dataSources[e].adapter.add("dateFields",(function(e){return t.dataSourceDateFields(e)})),this._dataSources[e].adapter.add("numberFields",(function(e){return t.dataSourceNumberFields(e)})),this.events.on("inited",(function(){t.loadData(e)}),this,!1)),this._dataSources[e]},Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._dataSources.data||this.getDataSource("data"),this._dataSources.data},set:function(e){var t=this;this._dataSources.data&&this.removeDispose(this._dataSources.data),this._dataSources.data=e,this._dataSources.data.component=this,this.events.on("inited",(function(){t.loadData("data")}),this,!1),this.setDataSourceEvents(e,"data")},enumerable:!0,configurable:!0}),t.prototype.loadData=function(e){this._dataSources[e].load()},t.prototype.dataSourceDateFields=function(e){return e},t.prototype.dataSourceNumberFields=function(e){return e},t.prototype.populateDataSourceFields=function(e,t,i){return Nl(i,(function(i){t[i]&&-1===jl(e,t[i])&&e.push(t[i])})),e},t.prototype.setDataSourceEvents=function(e,t){var i=this;e.events.on("started",(function(e){var t=i.preloader;t&&(t.progress=0)}),void 0,!1),e.events.on("loadstarted",(function(e){var t=i.preloader;t&&(t.progress=.25)}),void 0,!1),e.events.on("loadended",(function(e){var t=i.preloader;t&&(t.progress=.5)}),void 0,!1),e.events.on("parseended",(function(e){var t=i.preloader;t&&(t.progress=.75)}),void 0,!1),e.events.on("ended",(function(e){var t=i.preloader;t&&(t.progress=1)}),void 0,!1),e.events.on("error",(function(e){var t=i.preloader;t&&(t.progress=1),i.openModal(e.message)}),void 0,!1),t&&e.events.on("done",(function(n){var r=i.preloader;r&&(r.progress=1),"data"!=t||cl(n.data)||(n.data=[n.data]),e.incremental&&"data"==t&&i.data.length?i.addData(n.data,e.keepCount?n.data.length:0):e.updateCurrentData&&"data"==t&&i.data.length?(Nl(i.data,(function(e,t){nl(n.data[t])&&gu(e,(function(i,r){nl(n.data[t][i])&&(e[i]=n.data[t][i])}))})),i.invalidateRawData()):i[t]=n.data}))},Object.defineProperty(t.prototype,"responsive",{get:function(){return this._responsive||(this._responsive=new Qp,this._responsive.component=this),this._responsive},set:function(e){this._responsive=e,this._responsive.component=this},enumerable:!0,configurable:!0}),t.prototype.zoom=function(e,t,i,n){var r=this;void 0===t&&(t=!1),void 0===i&&(i=!1);var a=e.start,o=e.end,s=e.priority;if(e.start==e.end&&(e.start=e.start-.5/this.maxZoomFactor,e.end=e.end+.5/this.maxZoomFactor),"end"==s&&1==o&&0!=a&&a<this.start&&(s="start"),"start"==s&&0==a&&o>this.end&&(s="end"),ll(n)||(n=this.maxZoomDeclination),!ll(a)||!ll(o))return{start:this.start,end:this.end};if(this._finalStart!=a||this._finalEnd!=o){var l=this.maxZoomFactor/this.minZoomCount,u=this.maxZoomFactor/this.maxZoomCount;if("start"==s?(this.maxZoomCount>0&&1/(o-a)<u&&(o=a+1/u),1/(o-a)>l&&(o=a+1/l),o>1&&o-a<1/l&&(a=o-1/l)):(this.maxZoomCount>0&&1/(o-a)<u&&(a=o-1/u),1/(o-a)>l&&(a=o-1/l),a<0&&o-a<1/l&&(o=a+1/l)),a<-n&&(a=-n),1/(o-a)>l&&(o=a+1/l),o>1+n&&(o=1+n),1/(o-a)>l&&(a=o-1/l),this._finalEnd=o,this._finalStart=a,this.skipRangeEvent=t,this.dispatchImmediately("rangechangestarted"),this.rangeChangeDuration>0&&!i){var c=this.rangeChangeAnimation;if(c&&c.progress<1){var h=c.animationOptions;if(h.length>1){if(h[0].to==a&&h[1].to==o)return{start:a,end:o};c.isDisposed()||c.stop()}}this.rangeChangeAnimation&&this.rangeChangeAnimation.kill(),c=this.animate([{property:"start",to:a},{property:"end",to:o}],this.rangeChangeDuration,this.rangeChangeEasing),this.rangeChangeAnimation=c,c&&!c.isFinished()?c.events.on("animationended",(function(){r.dispatchImmediately("rangechangeended")})):this.dispatchImmediately("rangechangeended")}else this.start=a,this.end=o,this.dispatch("rangechangeended")}return{start:a,end:o}},t.prototype.zoomToIndexes=function(e,t,i,n){if(ll(e)&&ll(t)){var r=e/this.dataItems.length,a=t/this.dataItems.length;this.zoom({start:r,end:a},i,n)}},Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return gl(1/(this.end-this.start),1,this.maxZoomFactor)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxZoomFactor",{get:function(){return this.getPropertyValue("maxZoomFactor")},set:function(e){this.setPropertyValue("maxZoomFactor",e)&&(1==e&&(this.maxZoomDeclination=0),this.invalidateDataRange())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxZoomDeclination",{get:function(){return this.getPropertyValue("maxZoomDeclination")},set:function(e){this.setPropertyValue("maxZoomDeclination",e)&&this.invalidateDataRange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startIndex",{get:function(){return ll(this._startIndex)||(this._startIndex=0),this._startIndex},set:function(e){this._startIndex=gl(Math.round(e),0,this.dataItems.length),this.start=this.indexToPosition(this._startIndex)},enumerable:!0,configurable:!0}),t.prototype.indexToPosition=function(e){return e/this.dataItems.length},Object.defineProperty(t.prototype,"endIndex",{get:function(){var e=this.dataItems.length;return(!ll(this._endIndex)||this._endIndex>e)&&(this._endIndex=e),this._endIndex},set:function(e){this._endIndex=gl(Math.round(e),0,this.dataItems.length),this.end=this.indexToPosition(this._endIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._adapterO?this._adapterO.apply("start",this._start):this._start},set:function(e){if(this._start!=e){this._start=e;var t=Math.max(0,Math.floor(this.dataItems.length*e)||0);this._startIndex=Math.min(t,this.dataItems.length),this.invalidateDataRange(),this.invalidate(),this.dispatchImmediately("startchanged"),this.dispatch("startendchanged")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._adapterO?this._adapterO.apply("end",this._end):this._end},set:function(e){this._end!=e&&(this._end=e,this._endIndex=Math.min(this.dataItems.length,Math.ceil(this.dataItems.length*e)||0),this.invalidateDataRange(),this.invalidate(),this.dispatchImmediately("endchanged"),this.dispatch("startendchanged"))},enumerable:!0,configurable:!0}),t.prototype.removeFromInvalids=function(){e.prototype.removeFromInvalids.call(this),Bu.removeFromInvalidComponents(this),Gl(Bu.invalidDataItems,this),Gl(Bu.invalidDataRange,this),Gl(Bu.invalidRawDatas,this)},Object.defineProperty(t.prototype,"dataItems",{get:function(){if(""!=this._currentDataSetId){var e=this.dataSets.getKey(this._currentDataSetId);if(e)return e}return this._dataItems},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSets",{get:function(){return this._dataSets||(this._dataSets=new Lu),this._dataSets},enumerable:!0,configurable:!0}),t.prototype.setDataSet=function(e){if(this._currentDataSetId!=e){if(this.dataSets.getKey(e))return this.dataItems.each((function(e){e.__disabled=!0})),this._currentDataSetId=e,this.invalidateDataRange(),this._prevStartIndex=void 0,this.dataItems.each((function(e){e.__disabled=!1})),!0;if(""!=this._currentDataSetId)return this.dataItems.each((function(e){e.__disabled=!0})),this._currentDataSetId="",this.invalidateDataRange(),this._prevStartIndex=void 0,this.dataItems.each((function(e){e.__disabled=!1})),!0}return!1},Object.defineProperty(t.prototype,"currentDataSetId",{get:function(){return this._currentDataSetId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mainDataSet",{get:function(){return this._dataItems},enumerable:!0,configurable:!0}),t.prototype._updateDataItemIndexes=function(e){for(var t=this.mainDataSet.values,i=t.length,n=e;n<i;++n)t[n]._index=n},t.prototype.handleDataItemAdded=function(e){e.newValue.component=this,this._updateDataItemIndexes(e.index),this.dataItemsInvalid||this.invalidateDataItems()},t.prototype.handleDataItemRemoved=function(e){this._updateDataItemIndexes(e.index),this.dataItemsInvalid||this.invalidateDataItems()},t.prototype.bindDataField=function(e,t){this.dataFields[e]=t,this.invalidateDataRange()},t.prototype.invalidateProcessedData=function(){this.resetProcessedRange(),this.invalidateDataRange()},t.prototype.resetProcessedRange=function(){this._prevEndIndex=null,this._prevStartIndex=null},Object.defineProperty(t.prototype,"dataUsers",{get:function(){var e=this;return this._dataUsers||(this._dataUsers=new Wu,this._disposers.push(new eu((function(){Tu(e._dataUsers.iterator(),(function(e){e.dispose()}))})))),this._dataUsers},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t.dataFields=_c(this.dataFields,{}),t},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.data=t.data,this.sequencedInterpolation=t.sequencedInterpolation,this.sequencedInterpolationDelay=t.sequencedInterpolationDelay,this.interpolationDuration=t.interpolationDuration,this.interpolationEasing=t.interpolationEasing},t.prototype.reinit=function(){this._inited=!1,this.deepInvalidate()},t.prototype.getExporting=function(){var t=e.prototype.getExporting.call(this);return t.adapter.has("data",this._exportData,-1,this)||(t.adapter.add("data",this._exportData,-1,this),this.events.on("datavalidated",(function(e){t.handleDataUpdated()}))),t},t.prototype._exportData=function(e){return e.data=this.data,e},t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return i&&this.invalidateData(),i},t.prototype.setShowOnInit=function(t){t!=this.getPropertyValue("showOnInit")&&(!t||this.inited||this.hidden?this._showOnInitDisposer2&&this.removeDispose(this._showOnInitDisposer2):(this._showOnInitDisposer2=this.events.once("dataitemsvalidated",this.hideInitially,this,!1),this._disposers.push(this._showOnInitDisposer2))),e.prototype.setShowOnInit.call(this,t)},t.prototype.setBaseId=function(t){t!=this._baseId&&this.dataInvalid&&(this.dataInvalid=!1,Bu.removeFromInvalidComponents(this),this._baseId=t,this.invalidateData()),e.prototype.setBaseId.call(this,t)},Object.defineProperty(t.prototype,"minZoomCount",{get:function(){return this.getPropertyValue("minZoomCount")},set:function(e){this.setPropertyValue("minZoomCount",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxZoomCount",{get:function(){return this.getPropertyValue("maxZoomCount")},set:function(e){this.setPropertyValue("maxZoomCount",e)},enumerable:!0,configurable:!0}),t.prototype._systemCheckIfValidate=function(){return!(this.dataInvalid||this.dataProvider&&this.dataProvider.dataInvalid)},t.prototype.asFunction=function(t){return"interpolationEasing"==t||"rangeChangeEasing"==t||e.prototype.asIs.call(this,t)},t}(Wp);Bu.registeredClasses.Component=nd;var rd=function(e){function t(){var t=e.call(this)||this;return t.isOversized=!1,t.className="Label",t.fill=(new Xh).getFor("text"),t.wrap=!1,t.truncate=!1,t.fullWords=!0,t.ellipsis="\u2026",t.textAlign="start",t.textValign="top",t.layout="absolute",t.baseLineRatio=-.27,t._positionPrecision=1,t.events.on("maxsizechanged",(function(){t.inited&&t.handleMaxSize()}),t,!1),t.events.once("validated",t.handleValidate,t,!1),t.applyTheme(),t}return Us(t,e),t.prototype.afterDraw=function(){e.prototype.afterDraw.call(this),this.validatePosition()},t.prototype.setPaper=function(t){var i=e.prototype.setPaper.call(this,t);return i&&this.hardInvalidate(),i},t.prototype.handleValidate=function(){!this.currentText&&!this.text||0!=this.bbox.width&&0!=this.bbox.height||Bu.events.once("exitframe",this.hardInvalidate,this)},t.prototype.handleMaxSize=function(){(this.bbox.width>this.availableWidth||this.bbox.width<this.availableWidth&&(this.isOversized||this.truncate)||this.bbox.height>this.availableHeight||this.bbox.height<this.availableHeight&&this.isOversized)&&this.invalidate()},t.prototype.arrange=function(){},t.prototype.updateCurrentText=function(){var e,t;kc(this.html)&&this.paper.supportsForeignObject()?(e="html",t=this.html):(e="svg",t=this.text),ul(t)&&(t=t.toString()),nl(t)&&""!==t&&(t=this.populateString(t,this.dataItem)),"html"==e?this._adapterO&&(t=this._adapterO.apply("htmlOutput",t)):this._adapterO&&(t=this._adapterO.apply("textOutput",t));var i=t!=this.currentText||e!=this._currentFormat;return this.currentText=t,this._currentFormat=e,i},t.prototype.hardInvalidate=function(){this._prevStatus="",this.invalidate()},t.prototype.getLineBBox=function(e){var t=e&&e.element,i=t&&t.node;i&&i.parentNode&&(e.bbox=t.getBBox())},t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.bbox.width,i=this.bbox.height,n=this.topParent;if(!n||n.maxWidth&&n.maxHeight){var r=xl(this.availableWidth-this.pixelPaddingLeft-this.pixelPaddingRight,0),a=xl(this.availableHeight-this.pixelPaddingTop-this.pixelPaddingBottom,0),o=a+","+r+this.wrap+this.truncate+this.fullWords+this.rtl+this.ellipsis;if(this.updateCurrentText()||!this.inited||this._prevStatus!=o){this._measuredWidth=0,this._measuredHeight=0,this.isOversized=!1;var s=this._currentFormat,l=this.currentText;if(nl(l)&&""!=l){var u=l.split("\n");this._prevStatus=o,this.textAlign=this.textAlign;var c=this.group.getAttr("display");if("none"==c&&this.group.removeAttr("display"),this.textPathElement&&this.textPathElement.removeChildren(),"svg"===s){this.element.removeAttr("display");var h=this.element;this.resetBBox();for(var p=0,d="",f=0;f<u.length;f++){var m=u[f];if(""!=m){var v=Tp().chunk(m,null,this.ignoreFormatting),y=0,g=!0,_=!1,b=this.getLineInfo(f);b?(b.text="",b.element.textContent=""):(b={text:"",element:this.getSVGLineElement("",0),complex:!1},h.add(b.element)),b.element.removeAttr("display"),b.element.removeChildren(),this.textPathElement&&b.element.add(this.textPathElement);for(var x=0;x<v.length;x++){x&&(b.complex=!0);var w=v[x];if("format"===w.type)d=w.text;else{if(_)continue;if(b.text=w.text,b.style=Tp().translateStyleShortcuts(d),this.textPathElement?this.getSvgElement(b.text,b.style,this.textPathElement):this.getSvgElement(b.text,b.style,b.element),this.getLineBBox(b),b.bbox.width=Math.ceil(b.bbox.width),y<b.bbox.height&&(y=b.bbox.height),(this.wrap||this.truncate)&&b.bbox.width>r){this.isOversized=!0;var k=b.element.textContent,P=b.bbox.width/k.length,S=wl(Math.ceil((b.bbox.width-r)/P),k.length);if(this.truncate){var T=!1,E=b.element.node;if(E&&E.childNodes)for(var C=b.element.node.childNodes.length-1;C>=0;C--){var M=b.element.node.childNodes[C];if(T&&b.bbox.width<=r&&(M.textContent+=" "+this.ellipsis,b.bbox=b.element.getBBox(),b.bbox.width=Math.floor(b.bbox.width),b.bbox.width<=r))break;T=!1;var I=M.textContent;for(k=b.element.textContent,S=wl(Math.ceil((b.bbox.width-r)/P),k.length);b.bbox.width>r&&S<=k.length&&S>0;){(A=xl(k.length-S-this.ellipsis.length,1))<=1&&(S=0,C>0&&(T=!0,b.element.node.removeChild(M))),(I=Cc(I,A,this.ellipsis,this.fullWords,this.rtl)).length>A&&this.fullWords&&(I=Cc(I,A,this.ellipsis,!1,this.rtl)),M.textContent=I,b.bbox=b.element.getBBox(),b.bbox.width=Math.floor(b.bbox.width),S=Math.ceil(1.1*S)}_=!0}}else{if(b.element.node){for(var O=b.element.node.lastChild,D=void 0;b.bbox.width>r&&S<=k.length&&S>0;){var A=xl(w.text.length-S,1);if(g?D=Ec(w.text,A,!0,this.rtl):((D=Ec(w.text,A,!0,this.rtl,!1))[0].length>A||1===A)&&(b.element.node.removeChild(O),S=0),S>0){var L=D.shift();g&&(L=Mc(L)),O.textContent=Tp().cleanUp(L)}b.bbox=b.element.getBBox(),b.bbox.width=Math.floor(b.bbox.width),S++}if(D.length>0){var z="";nl(D)&&(this.rtl?z+=D.join("")+d:z+=d+D.join("").replace(/([\[\]]{1})/g,"$1$1"));for(var R=x+1;R<v.length;R++)"value"==v[R].type?z+=v[R].text.replace(/([\[\]]{1})/g,"$1$1"):z+=v[R].text;u.splice(f+1,0,z)}_=!0}}}this.bbox.width<b.bbox.width&&(this.bbox.width=b.bbox.width),this.bbox.height=p+y,this.textPathElement?b.element.attr({dy:-this.paddingBottom.toString()}):b.element.attr({x:"0",y:p+y,dy:vl(this.baseLineRatio*y,3).toString()}),g=!1}}var F=b.element.node;if(F)(O=F.lastChild)&&(O.textContent=this.rtl?O.textContent.replace(/^[\s\uFEFF\xA0]+/g,""):Ic(O.textContent));p+=y,this.addLineInfo(b,f)}else{var j=this.getSVGLineElement("",0);j.add(this.getSvgElement(".",Tp().translateStyleShortcuts(d))),h.add(j);var B=Math.ceil(j.getBBox().height);B>0&&(p+=B),h.removeElement(j);var V=this.getLineInfo(f);V&&(V.text="",V.element.textContent="")}}this.maybeHideOversized(),this.measureFailed=!1,0!=this.bbox.width&&0!=this.bbox.height||(this.measureFailed=!0),this._measuredWidth=vl(xl(this.bbox.width,this.pixelWidth-this.pixelPaddingLeft-this.pixelPaddingRight)),this._measuredHeight=vl(xl(this.bbox.height,this.pixelHeight-this.pixelPaddingTop-this.pixelPaddingBottom)),this.alignSVGText(),this.bbox.width=this._measuredWidth,this.bbox.height=this._measuredHeight,i==this._measuredHeight&&t==this._measuredWidth||this.dispatch("transformed"),this.hideUnused(u.length)}else{this.element.removeAttr("display"),this.resetBBox(),(h=this.element).removeChildren(),this.setCache("lineInfo",[],0);var N=this.paper.foreignObject();h.add(N),this.maxWidth&&N.attr({width:this.maxWidth-this.pixelPaddingLeft-this.pixelPaddingRight}),this.maxHeight&&N.attr({height:this.maxHeight-this.pixelPaddingTop-this.pixelPaddingBottom});var U=this.getHTMLLineElement(l);N.node.appendChild(U),U.style.display="inline-block";var G=U.clientWidth,W=U.clientHeight;U.style.display="block",this._bbox={x:0,y:0,width:G,height:W},N.attr({width:G+1,height:W}),this.maybeHideOversized(),this._measuredWidth=xl(this.bbox.width,this.pixelWidth-this.pixelPaddingLeft-this.pixelPaddingRight),this._measuredHeight=xl(this.bbox.height,this.pixelHeight-this.pixelPaddingTop-this.pixelPaddingBottom),this.bbox.width=this._measuredWidth,this.bbox.height=this._measuredHeight,this.truncate&&(U.style.overflow="hidden"),(G>r||W>a)&&(this.isOversized=!0)}this.setStyles(),this.updateCenter(),this.updateBackground(),"none"==c&&this.group.attr({display:"none"}),this.pathElement&&this.paper.appendDef(this.pathElement)}else this.element.attr({display:"none"})}}else n.events.once("maxsizechanged",this.hardInvalidate,this,!1)},t.prototype.maybeHideOversized=function(){this.hideOversized&&(this.availableWidth<this.bbox.width||this.availableHeight<this.bbox.height?(this.element.attr({display:"none"}),this.isOversized=!0):(this.element.removeAttr("display"),this.isOversized=!1))},t.prototype.alignSVGText=function(){var e=this.element,t=e.node.children||e.node.childNodes;if(t&&(!t||0!=t.length)){var i=this._measuredWidth,n=this._measuredHeight;this.pixelPaddingLeft,this.pixelPaddingRight,this.pixelPaddingTop,this.pixelPaddingBottom,this.rtl?e.attr({direction:"rtl"}):e.removeAttr("direction");for(var r=t.length-1;r>=0;r--){var a=t[r];if(a.setAttribute("text-anchor",this.textAlign),this.textPathElement)a.removeAttribute("x"),a.removeAttribute("y");else{switch(this.textAlign){case"middle":a.setAttribute("x",(i/2).toString()+"px");break;case"end":this.rtl||a.setAttribute("x",i.toString());break;default:this.rtl?a.setAttribute("x",i.toString()):a.removeAttribute("text-anchor")}var o=el(a.getAttribute("y"));switch(this.textValign){case"middle":a.setAttribute("y",((o||0)+(n-this.bbox.height)/2).toString());break;case"bottom":a.setAttribute("y",((o||0)+n-this.bbox.height).toString());break;default:a.setAttribute("y",(o||0).toString())}}}}},t.prototype.getSVGLineElement=function(e,t){var i=this.paper.addGroup("text");return i.textContent=e,i.attr({x:"0"}),nl(t)&&i.attr({y:t.toString()}),(this.truncate||this.wrap)&&i.attr({overflow:"hidden"}),i},Object.defineProperty(t.prototype,"rtl",{get:function(){return nl(this._rtl)?this._rtl:!!this._topParent&&this._topParent.rtl},set:function(e){e=Qs(e),this._rtl=e,this.element&&this.alignSVGText()},enumerable:!0,configurable:!0}),t.prototype.resetBBox=function(){this._bbox={x:0,y:0,width:0,height:0}},t.prototype.getHTMLLineElement=function(e){var t=document.createElement("div");switch(t.innerHTML=e,this.textAlign){case"middle":t.style.textAlign="center";break;case"end":t.style.textAlign="right"}return this.wrap?t.style.wordWrap="break-word":t.style.whiteSpace="nowrap",this.rtl&&(t.style.direction="rtl"),nl(this.fill)&&(t.style.color=this.fill.toString()),t},t.prototype.setStyles=function(){var e=this.element;!this.selectable||this.draggable||this.resizable||this.swipeable?e.addStyle({webkitUserSelect:"none",msUserSelect:"none"}):this.selectable&&(e.removeStyle("webkitUserSelect"),e.removeStyle("msUserSelect"))},t.prototype.hideUnused=function(e){this.initLineCache();var t=this.getCache("lineInfo");if(t.length>=e)for(var i=e;i<t.length;i++){var n=t[i];n&&n.element&&n.element.attr({display:"none"})}},Object.defineProperty(t.prototype,"text",{get:function(){return this.getPropertyValue("text")},set:function(e){this.setPropertyValue("text",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.getPropertyValue("path")},set:function(e){this.setPropertyValue("path",e,!0)&&(this.pathElement&&this.pathElement.dispose(),this.textPathElement&&this.textPathElement.dispose(),this.pathElement=this.paper.add("path"),this.pathElement.attr({d:e}),this.pathElement.attr({id:"text-path-"+this.uid}),this._disposers.push(this.pathElement),this.textPathElement=this.paper.addGroup("textPath"),this.textPathElement.attrNS(Mh,"xlink:href","#text-path-"+this.uid),this.textPathElement.attr({path:e}),this._disposers.push(this.textPathElement),this.hardInvalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"locationOnPath",{get:function(){return this.getPropertyValue("locationOnPath")},set:function(e){this.setPropertyValue("locationOnPath",e),this.textPathElement&&this.textPathElement.attr({startOffset:100*e+"%"})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseLineRatio",{get:function(){return this.getPropertyValue("baseLineRatio")},set:function(e){this.setPropertyValue("baseLineRatio",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getPropertyValue("wrap")},set:function(e){this.resetBBox(),this.setPropertyValue("wrap",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"truncate",{get:function(){return this.getPropertyValue("truncate")},set:function(e){this.resetBBox(),this.setPropertyValue("truncate",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullWords",{get:function(){return this.getPropertyValue("fullWords")},set:function(e){this.setPropertyValue("fullWords",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ellipsis",{get:function(){return this.getPropertyValue("ellipsis")},set:function(e){this.setPropertyValue("ellipsis",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this.getPropertyValue("selectable")},set:function(e){this.setPropertyValue("selectable",e,!0),this.setStyles()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAlign",{get:function(){return this.getPropertyValue("textAlign")},set:function(e){this.setPropertyValue("textAlign",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textValign",{get:function(){return this.getPropertyValue("textValign")},set:function(e){this.setPropertyValue("textValign",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this.getPropertyValue("html")},set:function(e){(this.setPropertyValue("html",e,!0),nl(e))||this.element.removeChildrenByTag("foreignObject")},enumerable:!0,configurable:!0}),t.prototype.setFill=function(t){if(e.prototype.setFill.call(this,t),this.html)for(var i=this.element.node.getElementsByTagName("div"),n=0;n<i.length;n++){var r=i[n];nl(this.fill)&&(r.style.color=this.fill.toString())}},Object.defineProperty(t.prototype,"hideOversized",{get:function(){return this.getPropertyValue("hideOversized")},set:function(e){this.setPropertyValue("hideOversized",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ignoreFormatting",{get:function(){return this.getPropertyValue("ignoreFormatting")},set:function(e){this.setPropertyValue("ignoreFormatting",e,!0)},enumerable:!0,configurable:!0}),t.prototype.measureElement=function(){},t.prototype.getLineInfo=function(e){this.initLineCache();var t=this.getCache("lineInfo");return t.length>e?t[e]:void 0},t.prototype.addLineInfo=function(e,t){this.initLineCache(),this.getCache("lineInfo")[t]=e},t.prototype.initLineCache=function(){nl(this.getCache("lineInfo"))||this.setCache("lineInfo",[],0)},t.prototype.setDataItem=function(t){this._sourceDataItemEvents&&this._sourceDataItemEvents.dispose(),t&&(this._sourceDataItemEvents=new tu([t.events.on("valuechanged",this.invalidate,this,!1),t.events.on("workingvaluechanged",this.invalidate,this,!1),t.events.on("calculatedvaluechanged",this.invalidate,this,!1),t.events.on("propertychanged",this.invalidate,this,!1)])),e.prototype.setDataItem.call(this,t)},Object.defineProperty(t.prototype,"availableWidth",{get:function(){return nl(this.maxWidth)?this.maxWidth:this.pixelWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableHeight",{get:function(){return nl(this.maxHeight)?this.maxHeight:this.pixelHeight},enumerable:!0,configurable:!0}),t.prototype.getSvgElement=function(e,t,i){var n=this.paper.add("tspan");if(n.textContent=e,t)if(_h.nonce&&i){var r="amcharts_element_style_"+btoa(t).replace(/[^\w]*/g,"");n.node.setAttribute("class",r);var a=document.createElementNS(Eh,"defs");i.node.appendChild(a);var o=document.createElement("style");o.type="text/css",o.innerHTML="."+r+" { "+t+"}",o.setAttribute("nonce",_h.nonce),a.appendChild(o)}else n.node.setAttribute("style",t);return i&&i.add(n),n},t.prototype.deepInvalidate=function(){e.prototype.deepInvalidate.call(this),this.hardInvalidate()},Object.defineProperty(t.prototype,"readerTitle",{get:function(){var e=this.getPropertyValue("readerTitle");return e?this.dataItem&&(e=this.populateString(e)):e=this.populateString(zc(kc(this.html)?this.html:this.text)),e},set:function(e){e=tl(e),this.setPropertyValue("readerTitle",e)&&this.applyAccessibility()},enumerable:!0,configurable:!0}),t}(Wp);Bu.registeredClasses.Label=rd,ed.push({relevant:td.heightXS,state:function(e,t){if(e instanceof rd&&e.parent&&e.parent.isBaseSprite){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var ad=function(e){function t(){var t=e.call(this)||this;return t.className="RoundedRectangle",t.element=t.paper.add("path"),t.cornerRadius(3,3,3,3),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.innerWidth,i=this.innerHeight;if(ll(t)&&ll(i)){var n=wl(t,i)/2,r=Pc(this.cornerRadiusTopLeft,n),a=Pc(this.cornerRadiusTopRight,n),o=Pc(this.cornerRadiusBottomRight,n),s=Pc(this.cornerRadiusBottomLeft,n),l=wl(Math.abs(t/2),Math.abs(i/2)),u=gl(r,0,l),c=gl(a,0,l),h=gl(o,0,l),p=gl(s,0,l),d="M"+u+",0 L"+(t-c)+",0"+(" a"+c+","+c+" 0 0 1 "+c+","+c)+(" L"+t+","+(i-h))+(" a"+h+","+h+" 0 0 1 -"+h+","+h)+(" L"+p+","+i)+(" a"+p+","+p+" 0 0 1 -"+p+",-"+p)+(" L0,"+u)+(" a"+u+","+u+" 0 0 1 "+u+",-"+u)+" Z";this.path=d}},t.prototype.cornerRadius=function(e,t,i,n){this.cornerRadiusTopLeft=e,this.cornerRadiusTopRight=t,this.cornerRadiusBottomLeft=i,this.cornerRadiusBottomRight=n},Object.defineProperty(t.prototype,"cornerRadiusTopLeft",{get:function(){return this.getPropertyValue("cornerRadiusTopLeft")},set:function(e){this.setPercentProperty("cornerRadiusTopLeft",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadiusTopRight",{get:function(){return this.getPropertyValue("cornerRadiusTopRight")},set:function(e){this.setPercentProperty("cornerRadiusTopRight",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadiusBottomRight",{get:function(){return this.getPropertyValue("cornerRadiusBottomRight")},set:function(e){this.setPercentProperty("cornerRadiusBottomRight",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadiusBottomLeft",{get:function(){return this.getPropertyValue("cornerRadiusBottomLeft")},set:function(e){this.setPercentProperty("cornerRadiusBottomLeft",e,!0)},enumerable:!0,configurable:!0}),t.prototype.measureElement=function(){},Object.defineProperty(t.prototype,"bbox",{get:function(){return this.definedBBox?this.definedBBox:this.isMeasured?{x:0,y:0,width:this.innerWidth,height:this.innerHeight}:{x:0,y:0,width:0,height:0}},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.RoundedRectangle=ad;var od=function(e){function t(){var t=e.call(this)||this;t.className="Button",t.tooltipY=0,t.iconPosition="left",t.layout="horizontal",t.contentAlign="center",t.contentValign="middle",t.padding(8,16,8,16),t.setStateOnChildren=!0;var i=new Xh,n=t.background;n.fill=i.getFor("secondaryButton"),n.stroke=i.getFor("secondaryButtonStroke"),n.fillOpacity=1,n.strokeOpacity=1,n.cornerRadius(3,3,3,3),t.label=new rd,t.label.fill=i.getFor("secondaryButtonText"),t.label.shouldClone=!1;var r=n.states.create("hover");r.properties.fillOpacity=1,r.properties.fill=i.getFor("secondaryButtonHover");var a=n.states.create("down");return a.transitionDuration=100,a.properties.fill=i.getFor("secondaryButtonDown"),a.properties.fillOpacity=1,t.role="button",t.focusable=!0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"icon",{get:function(){return this._icon},set:function(e){var t=this._icon;t&&(t.parent=void 0),e&&(this._icon=e,e.parent=this,e.interactionsEnabled=!1,e.shouldClone=!1,this.iconPosition=this.iconPosition,this._disposers.push(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconPosition",{get:function(){return this.getPropertyValue("iconPosition")},set:function(e){this.setPropertyValue("iconPosition",e),this.icon&&("left"==e?this.icon.toBack():this.icon.toFront())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(e){this._label&&this.removeDispose(this._label),this._label=e,e&&(e.parent=this,e.interactionsEnabled=!1,this._disposers.push(this._label))},enumerable:!0,configurable:!0}),t.prototype.createBackground=function(){return new ad},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),t.label&&this.label.copyFrom(t.label),t.icon&&(this.icon=t.icon.clone())},t}(Wp);Bu.registeredClasses.Button=od;var sd=function(e){function t(){var t=e.call(this)||this;return t.className="Circle",t.element=t.paper.add("circle"),t.setPercentProperty("radius",Ks(100)),t.setPropertyValue("horizontalCenter","middle"),t.setPropertyValue("verticalCenter","middle"),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),this.element.attr({r:this.pixelRadius})},Object.defineProperty(t.prototype,"radius",{get:function(){return this.getPropertyValue("radius")},set:function(e){this.setPercentProperty("radius",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRadius",{get:function(){return Pc(this.radius,wl(this.innerWidth/2,this.innerHeight/2))},enumerable:!0,configurable:!0}),t.prototype.measureElement=function(){var e=this.pixelRadius;this._bbox={x:-e,y:-e,width:2*e,height:2*e}},t}(Up);Bu.registeredClasses.Circle=sd;var ld=function(e){function t(){var t=e.call(this)||this;return t.className="Ellipse",t.element=t.paper.add("ellipse"),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),this.element.attr({rx:this.radius}),this.element.attr({ry:this.radiusY})},Object.defineProperty(t.prototype,"radiusY",{get:function(){return this.innerHeight/2},set:function(e){this.height=2*e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.innerWidth/2},set:function(e){this.width=2*e,this.invalidate()},enumerable:!0,configurable:!0}),t}(sd);Bu.registeredClasses.Ellipse=ld;var ud=function(e){function t(){var t=e.call(this)||this;return t.className="Image",t.element=t.paper.add("image"),t.applyTheme(),t.width=50,t.height=50,t}return Us(t,e),t.prototype.draw=function(){if(e.prototype.draw.call(this),this.href){var t=this.innerWidth,i=this.innerHeight;ll(this.widthRatio)&&(t=i*this.widthRatio,this.width=t),ll(this.heightRatio)&&(i=t*this.heightRatio,this.height=i),this.element.attr({width:t,height:i}),this.element.attrNS(Mh,"xlink:href",this.href)}},Object.defineProperty(t.prototype,"href",{get:function(){return this.getPropertyValue("href")},set:function(e){this.setPropertyValue("href",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widthRatio",{get:function(){return this.getPropertyValue("widthRatio")},set:function(e){this.setPropertyValue("widthRatio",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"heightRatio",{get:function(){return this.getPropertyValue("heightRatio")},set:function(e){this.setPropertyValue("heightRatio",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){return{x:0,y:0,width:this.pixelWidth,height:this.pixelHeight}},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Image=ud;var cd=function(e){function t(){var t=e.call(this)||this;return t.className="Line",t.element=t.paper.add("line"),t.fill=uc(),t.x1=0,t.y1=0,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),this.x1==this.x2||this.y1==this.y2?this.pixelPerfect=!0:this.pixelPerfect=!1,this.x1=this.x1,this.x2=this.x2,this.y1=this.y1,this.y2=this.y2},Object.defineProperty(t.prototype,"x1",{get:function(){return this.getPropertyValue("x1")},set:function(e){ll(e)||(e=0);var t=0;this.pixelPerfect&&this.stroke instanceof _p&&(t=1e-5),this.setPropertyValue("x1",e,!0),this.element.attr({x1:e+t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){var e=this.getPropertyValue("x2");return ll(e)||(e=this.pixelWidth),e},set:function(e){ll(e)||(e=0),this.setPropertyValue("x2",e,!0),this.element.attr({x2:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this.getPropertyValue("y1")},set:function(e){ll(e)||(e=0);var t=0;this.pixelPerfect&&this.stroke instanceof _p&&(t=1e-5),this.setPropertyValue("y1",e,!0),this.element.attr({y1:e+t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){var e=this.getPropertyValue("y2");return ll(e)||(e=this.pixelHeight),e},set:function(e){ll(e)||(e=0),this.setPropertyValue("y2",e,!0),this.element.attr({y2:e})},enumerable:!0,configurable:!0}),t.prototype.positionToPoint=function(e){var t={x:this.x1,y:this.y1},i={x:this.x2,y:this.y2},n=El(t,i,e),r=Cl(t,i);return{x:n.x,y:n.y,angle:r}},t}(Up);Bu.registeredClasses.Line=cd;var hd=function(e){function t(){var t=e.call(this)||this;return t.className="PointedShape",t.pointerBaseWidth=15,t.pointerLength=10,t.pointerY=0,t.pointerX=0,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),ll(this.pointerX)||(this.pointerX=this.pixelWidth/2),ll(this.pointerY)||(this.pointerY=this.pixelHeight+10)},Object.defineProperty(t.prototype,"pointerBaseWidth",{get:function(){return this.getPropertyValue("pointerBaseWidth")},set:function(e){this.setPropertyValue("pointerBaseWidth",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerLength",{get:function(){return this.getPropertyValue("pointerLength")},set:function(e){this.setPropertyValue("pointerLength",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerX",{get:function(){return this.getPropertyValue("pointerX")},set:function(e){this.setPropertyValue("pointerX",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerY",{get:function(){return this.getPropertyValue("pointerY")},set:function(e){this.setPropertyValue("pointerY",e,!0)},enumerable:!0,configurable:!0}),t}(Up),pd=function(e){function t(){var t=e.call(this)||this;return t.className="PointedRectangle",t.element=t.paper.add("path"),t.cornerRadius=6,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.cornerRadius,i=this.innerWidth,n=this.innerHeight;if(i>0&&n>0){var r,a,o=this.pointerX,s=this.pointerY,l=this.pointerBaseWidth/2,u=wl(i/2,n/2),c=gl(t,0,u),h=gl(t,0,u),p=gl(t,0,u),d=gl(t,0,u),f=void 0,m=void 0,v=void 0,y=void 0,g=(o-0)*(n-0)-(s-0)*(i-0),_=(o-0)*(0-n)-(s-n)*(i-0);if(g>0&&_>0)f="M"+c+",0 L"+((r=gl(o,c+l,i-l-h))-l)+",0 L"+o+","+(s=gl(s,-1/0,0))+" L"+(r+l)+",0 L"+(i-h)+",0";else f="M"+c+",0 L"+(i-h)+",0";if(g<0&&_<0)v=" L"+(i-p)+","+n+" L"+((r=gl(o,d+l,i-l-p))+l)+","+n+" L"+o+","+(s=gl(s,n,1/0))+" L"+(r-l)+","+n+" L"+d+","+n;else v=" L"+d+","+n;if(g<0&&_>0)y=" L0,"+(n-d)+" L0,"+((a=gl(s,c+l,n-d-l))+l)+" L"+(o=gl(o,-1/0,0))+","+s+" L0,"+(a-l)+" L0,"+c;else y=" L0,"+c;if(g>0&&_<0)m=" L"+i+","+h+" L"+i+","+((a=gl(s,h+l,n-l-p))-l)+" L"+(o=gl(o,i,1/0))+","+s+" L"+i+","+(a+l)+" L"+i+","+(n-p);else m=" L"+i+","+(n-p);var b=" a"+h+","+h+" 0 0 1 "+h+","+h,x=" a"+p+","+p+" 0 0 1 -"+p+","+p,w=" a"+d+","+d+" 0 0 1 -"+d+",-"+d,k=" a"+c+","+c+" 0 0 1 "+c+",-"+c;this.path=f+b+m+x+v+w+y+k}},Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this.getPropertyValue("cornerRadius")},set:function(e){this.setPropertyValue("cornerRadius",e,!0)},enumerable:!0,configurable:!0}),t}(hd);function dd(e){return" M"+vl(e.x,4)+","+vl(e.y,4)+" "}function fd(e){return" L"+vl(e.x,4)+","+vl(e.y,4)+" "}function md(e,t,i){return" C"+vl(t.x,4)+","+vl(t.y,4)+" "+vl(i.x,4)+","+vl(i.y,4)+" "+vl(e.x,4)+","+vl(e.y,4)}function vd(e,t,i,n){if(0==t)return"";ll(n)||(n=i);var r="",a=",",o=Math.ceil(Math.abs(t)/180),s=1;t<0&&(s=0);var l=0,u=0,c=-bl(e)*i,h=-_l(e)*n;if(t<.5&&i>3e3)return fd({x:f=vl(bl(d=e+t)*i,4),y:m=vl(_l(d)*n,4)});for(var p=0;p<o;p++){var d,f,m;r+=" a"+i+a+n+a+0+a+0+a+s+a+(f=vl(bl(d=e+t/o*(p+1))*i+c-l,4))+a+(m=vl(_l(d)*n+h-u,4)),l=f,u=m}return r}function yd(e,t,i,n,r,a){if(0==t)return"";var o=",";return" A"+t+o+i+o+(a=a||0)+o+ +(r=Boolean(r))+o+ +(n=Boolean(n))+o+vl(e.x,4)+o+vl(e.y,4)}function gd(e,t){var i=",",n=" L";return t?"M"+e.x+i+e.y+n+e.x+i+(e.y+e.height)+n+(e.x+e.width)+i+(e.y+e.height)+n+(e.x+e.width)+i+e.y+n+e.x+i+e.y:"M"+e.x+i+e.y+n+(e.x+e.width)+i+e.y+n+(e.x+e.width)+i+(e.y+e.height)+n+e.x+i+(e.y+e.height)+n+e.x+i+e.y}var _d=function(e){function t(){var t=e.call(this)||this;return t._distance=0,t.className="Polyline",t.element=t.paper.add("path"),t.shapeRendering="auto",t.fill=uc(),t.strokeOpacity=1,t.applyTheme(),t}return Us(t,e),t.prototype.makePath=function(){this._distance=0;var e=this.segments;if(e&&e.length>0){for(var t="",i=0,n=e.length;i<n;i++){var r=e[i];if(r.length>0){t+=dd(r[0]);for(var a=1;a<r.length;a++){var o=r[a];t+=fd(o),this._distance+=Pl(r[a-1],o)}}}this.path=t}this._realSegments=e},Object.defineProperty(t.prototype,"segments",{get:function(){return this.getPropertyValue("segments")},set:function(e){this.setPropertyValue("segments",e),this.makePath()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.positionToPoint=function(e){var t=0;e<0&&(e=Math.abs(e),t=180);var i=this._realSegments;if(i){for(var n=this.distance,r=0,a=0,o=0,s=void 0,l=void 0,u=0;u<i.length;u++){var c=i[u];if(c.length>1){for(var h=1;h<c.length;h++)if(a=r/n,o=(r+=Pl(s=c[h-1],l=c[h]))/n,a<=e&&o>e){u=i.length;break}}else 1==c.length&&(s=c[0],l=c[0],a=0,o=1)}if(s&&l){var p=El(s,l,(e-a)/(o-a));return{x:p.x,y:p.y,angle:t+Cl(s,l)}}}return{x:0,y:0,angle:0}},Object.defineProperty(t.prototype,"realSegments",{get:function(){return this._realSegments},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Polyline=_d;var bd=function(e){function t(){var t=e.call(this)||this;return t.className="Polyarc",t.controlPointDistance=.5,t.controlPointPosition=.5,t.applyTheme(),t}return Us(t,e),t.prototype.makePath=function(){this._distance=0;var e=this.segments;if(e&&e.length>0){var t="";this._realSegments=[];for(var i=0,n=e.length;i<n;i++){var r=e[i],a=[];if(this._realSegments.push(a),r.length>0){t+=dd(r[0]);for(var o=1;o<r.length;o++){var s=r[o-1],l=r[o],u=Pl(l,s),c=u*this.controlPointDistance,h=this.controlPointPosition,p=-Cl(s,l),d={x:s.x+(l.x-s.x)*h*.5-c*_l(p),y:s.y+(l.y-s.y)*h*.5-c*bl(p)},f={x:s.x+(l.x-s.x)*h*1.5-c*_l(p),y:s.y+(l.y-s.y)*h*1.5-c*bl(p)};t+=md(l,d,f);var m=Math.ceil(u),v=s;if(m>0)for(var y=0;y<=m;y++){var g=Ol(s,l,d,f,y/m);a.push(g),this._distance+=Pl(v,g),v=g}else a.push(s)}}}this.path=t}},Object.defineProperty(t.prototype,"controlPointPosition",{get:function(){return this.getPropertyValue("controlPointPosition")},set:function(e){this.setPropertyValue("controlPointPosition",e),this.makePath()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controlPointDistance",{get:function(){return this.getPropertyValue("controlPointDistance")},set:function(e){this.setPropertyValue("controlPointDistance",e),this.makePath()},enumerable:!0,configurable:!0}),t}(_d);Bu.registeredClasses.Polyarc=bd;var xd=function(e){function t(t){var i=e.call(this)||this;return i._bboxes=[],i.morphDuration=800,i.morphEasing=uh,i.morphToSingle=!0,i.scaleRatio=1,i.className="Morpher",i.morphable=t,i.applyTheme(),i}return Us(t,e),t.prototype.morphToPolygon=function(e,t,i){var n=this.morphable.currentPoints;if(n&&e){this.sortPoints(n),this.sortPoints(e),this._morphFromPointsReal=[],this._morphToPointsReal=[],nl(t)||(t=this.morphDuration),nl(i)||(i=this.morphEasing),this._morphFromPointsReal=this.normalizePoints(e,n),this._morphToPointsReal=this.normalizePoints(n,e),this.morphable.currentPoints=this._morphFromPointsReal;var r=new Th(this,{property:"morphProgress",from:0,to:1},t,i);return this._disposers.push(r),r.start(),r}},t.prototype.normalizePoints=function(e,t){for(var i=0,n=e.length;i<n;i++){var r=e[i][0],a=e[i][1],o=rl(Ml(r)),s=o.x+o.width,l=o.y+o.height;if(t[i]||(t[i]=[]),r&&!t[i][0]&&(t[i][0]=[{x:s,y:l},{x:s,y:l}]),t[i][0]){t[i][0]=this.addPoints(t[i][0],r.length);for(var u=1/0,c=0,h=0;h<t[i][0].length;h++){var p=Pl(t[i][0][h],r[0]);p<u&&(c=h,u=p)}var d=t[i][0].slice(0,c),f=t[i][0].slice(c);t[i][0]=f.concat(d)}a&&(t[i][1]||(t[i][1]=[{x:s,y:l},{x:s,y:l}]),t[i][1]=this.addPoints(t[i][1],a.length))}return t},t.prototype.sortPoints=function(e){e.sort((function(e,t){var i=rl(Ml(e[0])),n=rl(Ml(t[0]));return i.width*i.height>n.width*n.height?-1:1}));for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i][0];r&&t.push(rl(Ml(r)))}return Il(t)},t.prototype.morphToCircle=function(e,t,i){var n=this.morphable.points,r=this.sortPoints(n);this._morphFromPointsReal=[],this._morphToPointsReal=[],nl(t)||(t=this.morphDuration),nl(i)||(i=this.morphEasing);for(var a=0,o=n.length;a<o;a++){var s=n[a][0],l=n[a][1];if(this._morphFromPointsReal[a]=[],this._morphToPointsReal[a]=[],s){var u=s,c=s,h=rl(Ml(c));this.morphToSingle&&(h=rl(r));var p=h.x+h.width/2,d=h.y+h.height/2,f=e;ll(f)||(f=Math.min(h.width/2,h.height/2)),u=[];var m=Cl({x:p,y:d},s[0]),v=100;s.length>v&&(v=s.length);for(var y=360/((v=(c=this.addPoints(s,v)).length)-1),g=0;g<v;g++){var _=y*g+m,b={x:p+f*bl(_),y:d+f*_l(_)};u[g]=b}if(l&&l.length>0)for(var x=0,w=l.length;x<w;x++)u.push({x:p,y:d});this._morphFromPointsReal[a][0]=c,this._morphToPointsReal[a][0]=u}}this.morphable.currentPoints=this._morphFromPointsReal;var k=new Th(this,{property:"morphProgress",from:0,to:1},t,i);return this._disposers.push(k),k.start(),k},t.prototype.addPoints=function(e,t){for(var i=Math.round(t/e.length),n=[],r=0,a=e.length;r<a;r++){var o=e[r],s=void 0;s=r==e.length-1?e[0]:e[r+1],n.push(o);for(var l=1;l<i;l++){var u=l/i,c={x:o.x+(s.x-o.x)*u,y:o.y+(s.y-o.y)*u};n.push(c)}n.length+e.length-r==t&&(i=0)}if(n.length<t&&e.length>0){var h=e[e.length-1];for(l=n.length;l<t;l++)n.push({x:h.x,y:h.y})}return n},t.prototype.morphToRectangle=function(e,t,i,n){var r=this.morphable.points;this.sortPoints(r),this._morphFromPointsReal=[],this._morphToPointsReal=[],nl(i)||(i=this.morphDuration),nl(n)||(n=this.morphEasing);for(var a=0,o=r.length;a<o;a++){var s=r[a][0],l=r[a][1];if(this._morphFromPointsReal[a]=[],this._morphToPointsReal[a]=[],s){var u=s,c=s,h=this._bboxes[a];this.morphToSingle;var p=h.x,d=h.y,f=e,m=t;if(ll(f)||(f=h.width),ll(m)||(m=h.height),u=[{x:p,y:d},{x:p+f,y:d},{x:p+f,y:d+m},{x:p,y:d+m}],u=this.addPoints(u,s.length),s.length<4)for(var v=s.length;v<4;v++)u.push({x:s[v].x,y:s[v].y});if(l&&l.length>0)for(var y=h.x+h.width/2,g=h.y+h.height/2,_=0,b=l.length;_<b;_++)u.push({x:y,y:g});this._morphFromPointsReal[a][0]=c,this._morphToPointsReal[a][0]=u}}this.morphable.currentPoints=this._morphFromPointsReal;var x=new Th(this,{property:"morphProgress",from:0,to:1},i,n);return this._disposers.push(x),x.start(),x},Object.defineProperty(t.prototype,"morphProgress",{get:function(){return this._morphProgress},set:function(e){this._morphProgress=e;var t=[];if(null!=e){var i=this._morphFromPointsReal,n=this._morphToPointsReal;if(null!=i&&null!=n)for(var r=0,a=i.length;r<a;r++){var o=[];t.push(o);var s=i[r][0],l=i[r][1],u=n[r][0],c=n[r][1];if(s&&s.length>0&&u&&u.length>0){for(var h=[],p=0,d=s.length;p<d;p++){var f=s[p],m=u[p],v={x:f.x+(m.x*this.scaleRatio-f.x)*e,y:f.y+(m.y*this.scaleRatio-f.y)*e};h.push(v)}o[0]=h}if(l&&l.length>0&&c&&c.length>0){for(var y=[],g=0,_=l.length;g<_;g++){f=l[g],m=c[g],v={x:f.x+(m.x*this.scaleRatio-f.x)*e,y:f.y+(m.y*this.scaleRatio-f.y)*e};y.push(v)}o[1]=y}}}this.morphable.currentPoints=t},enumerable:!0,configurable:!0}),t.prototype.morphBack=function(e,t){this._morphToPointsReal=this._morphFromPointsReal,this._morphFromPointsReal=this.morphable.currentPoints,nl(e)||(e=this.morphDuration),nl(t)||(t=this.morphEasing);var i=new Th(this,{property:"morphProgress",from:0,to:1},e,t);return this._disposers.push(i),i.start(),i},Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations||(this._animations=[],this._disposers.push(new Sh(this._animations))),this._animations},enumerable:!0,configurable:!0}),t}(hc),wd=function(e){function t(){var t=e.call(this)||this;return t.className="Polygon",t.element=t.paper.add("path"),t.shapeRendering="auto",t._currentPoints=[],t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"points",{get:function(){var e=this.getPropertyValue("points"),t=this.path;if(t&&(!e||0==e.length)){for(var i=t.slice(1,t.length-1).split("ZM"),n=0;n<i.length;n++){var r=i[n];if(r.length>0){var a=r.split("M"),o=a[0],s=a[1];if(o&&o.length>0){var l=o.split("L");if(l.length>0){var u=[],c=[u];e.push(c);for(var h=0;h<l.length;h++){var p=l[h].split(",");u.push({x:+p[0],y:+p[1]})}if(s&&s.length>0){var d=s.split("L");if(d.length>0){var f=[];c.push(f);for(h=d.length-1;h>=0;h--){p=d[h].split(",");f.push({x:+p[0],y:+p[1]})}}}}}}}this.setPropertyValue("points",e),this._currentPoints=e}return e},set:function(e){this.setPropertyValue("points",e,!0),this._currentPoints=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPoints",{get:function(){return this._currentPoints&&0!=this._currentPoints.length||!this.path||(this._currentPoints=this.points),this._currentPoints},set:function(e){this._currentPoints!=e&&(this._currentPoints=e,this.draw())},enumerable:!0,configurable:!0}),t.prototype.draw=function(){var t,i,n,r,a="",o=this._currentPoints;if(o.length>0){for(var s=0,l=o.length;s<l;s++){var u=o[s][0],c=o[s][1];if(u&&u.length>0){a+=dd(p=u[0]);for(var h=0;h<u.length;h++)a+=fd(p=u[h]),(!ll(i)||i<p.x)&&(i=p.x),(!ll(t)||t>p.x)&&(t=p.x),(!ll(n)||n>p.y)&&(n=p.y),(!ll(r)||r<p.y)&&(r=p.y)}if(c&&c.length>0){var p;a+=dd(p=c[0]);for(var d=0,f=c.length;d<f;d++)a+=fd(p=c[d])}}a&&(a+=" Z"),this.bbox.x=t,this.bbox.y=n,this.bbox.width=i-t,this.bbox.height=r-n,e.prototype.setPath.call(this,a)}},t.prototype.setPath=function(t){return!!e.prototype.setPath.call(this,t)&&(this.points=[],this._bbox=this.group.getBBox(),!0)},t.prototype.measureElement=function(){},Object.defineProperty(t.prototype,"centerPoint",{get:function(){return{x:this.bbox.x+this.bbox.width/2,y:this.bbox.y+this.bbox.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"morpher",{get:function(){return this._morpher||(this._morpher=new xd(this),this._disposers.push(this._morpher)),this._morpher},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Polygon=wd;var kd=function(e){function t(){var t=e.call(this)||this;return t.className="Polyspline",t.tensionX=.5,t.tensionY=.5,t.applyTheme(),t}return Us(t,e),t.prototype.makePath=function(){this._distance=0;var e=this.segments,t=this.tensionX,i=this.tensionY;if(this.allPoints=[],e&&e.length>0){var n="";this._realSegments=[];for(var r=0,a=e.length;r<a;r++){var o=e[r],s=[];if(this._realSegments.push(s),o.length>0){var l=o[0],u=o[o.length-1],c=!1;vl(l.x,3)==vl(u.x)&&vl(l.y)==vl(u.y)&&(c=!0),n+=dd(o[0]);for(var h=0;h<o.length-1;h++){var p=o[h-1],d=o[h],f=o[h+1],m=o[h+2];0===h?p=o[h]:h==o.length-2&&(m=o[h+1]),m||(m=f),0===h?p=c?o[o.length-2]:o[r]:h==o.length-2&&(m=c?o[1]:o[h+1]);var v=Dl(p,d,f,0,t,i),y=Al(0,d,f,m,t,i);n+=md(f,v,y);var g=1.2*Math.ceil(Sl(d,f,v,y,20)),_=d;if(g>0)for(var b=0;b<=g;b++){var x=Ol(d,f,v,y,b/g);if(x.x!=_.x||x.y!=_.y){s.push(x);var w=vl(Cl(_,x),5);this._distance+=Pl(_,x),this.allPoints[Math.floor(this._distance)]={x:x.x,y:x.y,angle:w},_=x}}else s.push(p)}}var k=this.allPoints;if(k.length>1)for(var P=0;P<k.length;P++)if(!k[P])if(P>1)k[P]=k[P-1];else for(var S=1;S<k.length;S++)if(k[S]){k[P]=k[S];break}}this.path=n}},t.prototype.getClosestPointIndex=function(e){var t,i=this.allPoints,n=1/0;if(i.length>1)for(var r=1;r<i.length;r++){var a=Pl(e,i[r]);a<n&&(t=r,n=a)}return t},Object.defineProperty(t.prototype,"tensionX",{get:function(){return this.getPropertyValue("tensionX")},set:function(e){this.setPropertyValue("tensionX",e),this.makePath()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tensionY",{get:function(){return this.getPropertyValue("tensionY")},set:function(e){this.setPropertyValue("tensionY",e,!0),this.makePath()},enumerable:!0,configurable:!0}),t.prototype.positionToPoint=function(e,t){var i=0,n=this.allPoints,r=n.length;if(ll(e)||(e=0),r>1){if(t&&r>3){if(e<0){e<-.01&&(e=-.01);var a=n[0],o=n[1];return{x:s=a.x-(a.x-o.x)*r*e,y:l=a.y-(a.y-o.y)*r*e,angle:Cl(a,o)}}if(e>1){e>1.01&&(e=1.01);var s,l;a=n[n.length-2],o=n[n.length-3];return{x:s=a.x+(a.x-o.x)*r*(e-1),y:l=a.y+(a.y-o.y)*r*(e-1),angle:Cl(a,{x:s,y:l})}}if(1==e){var u=n[n.length-1];return{x:u.x,y:u.y,angle:u.angle}}}else e<0&&(e=Math.abs(e),i=180),e>=1&&(e=.9999999999999);var c;return{x:(c=n[Math.floor(e*r)]).x,y:c.y,angle:c.angle+i}}return 1==r?{x:(c=n[0]).x,y:c.y,angle:c.angle}:{x:0,y:0,angle:0}},t}(_d);Bu.registeredClasses.Polyspline=kd;var Pd=function(e){function t(){var t=e.call(this)||this;return t.className="Slice",t.setPropertyValue("cornerRadius",0),t.setPropertyValue("startAngle",0),t.setPercentProperty("innerRadius",0),t.setPercentProperty("radius",0),t.setPropertyValue("arc",0),t.setPropertyValue("shiftRadius",0),t.strokeOpacity=1,t.setPropertyValue("layout","none"),t.slice=t.createChild(Up),t.slice.isMeasured=!1,t._disposers.push(t.slice),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.radiusY;this.radius>0&&0==t&&(t=.01),this.slice.path=function(e,t,i,n,r,a,o){if(0==t)return"";if(ll(n)||(n=0),0==i&&n<=0)return"";if(i<n){var s=i;i=n,n=s,ll(r)&&(r=r/n*i)}360==(t=wl(t,360))&&(a=0,o=0);var l=e+t,u=_l(wl(t,45)/2),c=(r=ll(r)?r:i)/i*n,h=r/i*(a=a||0),p=r/i*(o=ll(o)?o:a);a=gl(a,0,(i-n)/2),h=gl(h,0,(r-c)/2),o=gl(o,0,(i-n)/2),p=gl(p,0,(r-c)/2),a=vl(gl(a,0,i*u),4),h=vl(gl(h,0,r*u),4),o=vl(gl(o,0,n*u),4),p=vl(gl(p,0,c*u),4);var d=Math.asin(a/i/2)*fl*2,f=Math.asin(h/r/2)*fl*2;n<o&&(n=o),c<p&&(c=p);var m=Math.asin(o/n/2)*fl*2,v=Math.asin(p/c/2)*fl*2;ll(m)||(m=0),ll(v)||(v=0);var y=e+t/2,g={x:vl(bl(y)*n,4),y:_l(y)*c},_={x:bl(e)*(n+o),y:_l(e)*(c+p)},b={x:bl(e)*(i-a),y:_l(e)*(r-h)},x={x:bl(l)*(i-a),y:_l(l)*(r-h)},w={x:bl(l)*(n+o),y:_l(l)*(c+p)},k={x:bl(e+d)*i,y:_l(e+f)*r},P={x:bl(l-m)*n,y:_l(l-v)*c};o+=o*_l(m/2),p+=p*_l(v/2),m>(l-e)/2&&(P=g);var S="";return 360==t?S=dd(b):(S=dd(_),S+=fd(b),S+=yd(k,a,h,!0)),S+=vd(e+d,t-2*d,i,r),ll(n)&&0!=n?(360==t&&0==a?S+=dd(w):(S+=yd(x,a,h,!0),S+=fd(w),S+=yd(P,o,p,!0)),S+=vd(l-m,-(t-2*m),n,c),(t<360||a>0)&&(S+=yd(_,o,p,!0)),S+=fd(_)):(S+=yd(x,a,h,!0),t<360&&(S+=fd(_))),S}(this.startAngle,this.arc,this.radius,this.pixelInnerRadius,t,this.cornerRadius,this.innerCornerRadius),this.slice.invalidate(),this.shiftRadius=this.shiftRadius,this.realFill instanceof bp&&this.updateGradient(this.realFill),this.realStroke instanceof bp&&this.updateGradient(this.realStroke)},t.prototype.updateGradient=function(e){e.element.attr({gradientUnits:"userSpaceOnUse"}),e.element.attr({r:this.radius}),e.cx=0,e.cy=0,e.element.attr({radius:this.radius})},Object.defineProperty(t.prototype,"bbox",{get:function(){return this.definedBBox?this.definedBBox:this.isMeasured?Il([Rl(this.startAngle,this.startAngle+this.arc,this.pixelInnerRadius),Rl(this.startAngle,this.startAngle+this.arc,this.radius)]):{x:0,y:0,width:0,height:0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startAngle",{get:function(){return this.getPropertyValue("startAngle")},set:function(e){this.setPropertyValue("startAngle",zl(e),!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"arc",{get:function(){return this.getPropertyValue("arc")},set:function(e){ll(e)||(e=0),this.setPropertyValue("arc",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){var e=this.getPropertyValue("radius");return ll(e)||(e=0),e},set:function(e){this.setPropertyValue("radius",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radiusY",{get:function(){var e=this.getPropertyValue("radiusY");return ll(e)||(e=this.radius),e},set:function(e){this.setPropertyValue("radiusY",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadius",{get:function(){return this.getPropertyValue("innerRadius")},set:function(e){this.setPercentProperty("innerRadius",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelInnerRadius",{get:function(){return Pc(this.innerRadius,this.radius)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this.getPropertyValue("cornerRadius")},set:function(e){this.setPropertyValue("cornerRadius",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerCornerRadius",{get:function(){return this.getPropertyValue("innerCornerRadius")},set:function(e){this.setPropertyValue("innerCornerRadius",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shiftRadius",{get:function(){return this.getPropertyValue("shiftRadius")},set:function(e){this.setPropertyValue("shiftRadius",e),e=this.getPropertyValue("shiftRadius"),this.dx=e*this.radius*this.ix,this.dy=e*this.radiusY*this.iy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ix",{get:function(){return bl(this.middleAngle)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iy",{get:function(){return _l(this.middleAngle)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"middleAngle",{get:function(){return this.startAngle+this.arc/2},enumerable:!0,configurable:!0}),t.prototype.getTooltipX=function(){var e=this.getPropertyValue("tooltipX");if(ll(e))return e;var t=.5;e instanceof Xs&&(t=e.value);var i=Pc(this.innerRadius,this.radius);return this.ix*(i+(this.radius-i)*t)},t.prototype.getTooltipY=function(){var e=this.getPropertyValue("tooltipY");if(ll(e))return e;var t=.5;e instanceof Xs&&(t=e.value);var i=Pc(this.innerRadius,this.radius);return this.iy*(i+(this.radius-i)*t)+this.slice.dy},t}(Wp);Bu.registeredClasses.Slice=Pd;var Sd=function(e){function t(){var t=e.call(this)||this;t.className="Preloader",t.width=Ks(100),t.height=Ks(100);var i=new Xh,n=t.createChild(Wp);n.shouldClone=!1;var r=n.createChild(Pd);r.shouldClone=!1,r.radius=53,r.arc=360,r.fill=i.getFor("fill"),r.fillOpacity=.8,r.innerRadius=42,r.isMeasured=!1,t.backgroundSlice=r;var a=n.createChild(Pd);a.shouldClone=!1,a.radius=50,a.innerRadius=45,a.fill=i.getFor("alternativeBackground"),a.fillOpacity=.2,a.isMeasured=!1,t.progressSlice=a;var o=n.createChild(rd);return o.shouldClone=!1,o.horizontalCenter="middle",o.verticalCenter="middle",o.isMeasured=!1,o.fill=i.getFor("text"),o.align="center",o.valign="middle",o.textAlign="middle",o.fillOpacity=.4,t.label=o,t.background.opacity=1,t.background.fill=i.getFor("background"),t.contentAlign="center",t.contentValign="middle",t.delay=300,t.states.create("hidden").properties.opacity=0,t.visible=!1,t.hide(0),t.__disabled=!0,t._disposers.push(t.backgroundSlice),t._disposers.push(t.progressSlice),t._disposers.push(t.label),t._disposers.push(n),t}return Us(t,e),Object.defineProperty(t.prototype,"progress",{get:function(){return this.getPropertyValue("progress")},set:function(e){var t=this;this.__disabled=!1,this.validateLayout(),this.setPropertyValue("progress",e),this.progressSlice.arc=360*e,this.label&&(this.label.text=Math.round(100*e)+"%"),e>=1?(this._started&&(this._started=void 0),Bu.events.once("enterframe",(function(){var e=t.hide();e&&!e.isFinished()?e.events.once("animationended",(function(){t.__disabled=!0})):t.__disabled=!0})),this.interactionsEnabled=!1,this.setPropertyValue("progress",0)):e>0&&(this.delay?this._started?this._started+this.delay<=(new Date).getTime()&&(this.__disabled=!1,this.show(),this.interactionsEnabled=!0):this._started=(new Date).getTime():(this.__disabled=!1,this.show(),this.interactionsEnabled=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this.getPropertyValue("delay")},set:function(e){this.setPropertyValue("delay",e)},enumerable:!0,configurable:!0}),t}(Wp);Bu.registeredClasses.Preloader=Sd;var Td=function(e){function t(){var t=e.call(this)||this;t.className="ResizeButton",t.orientation="horizontal",t.layout="absolute",t.horizontalCenter="middle",t.verticalCenter="middle",t.draggable=!0,t.padding(8,8,8,8),t.background.cornerRadius(20,20,20,20);var i=new Up;i.element=t.paper.add("path");var n=dd({x:-2,y:-6});return n+=fd({x:-2,y:6}),n+=dd({x:2,y:-6}),n+=fd({x:2,y:6}),i.path=n,i.pixelPerfect=!0,i.padding(0,4,0,4),i.stroke=(new Xh).getFor("alternativeText"),i.strokeOpacity=.7,t.icon=i,t.label.dispose(),t.label=void 0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"orientation",{set:function(e){var t=this.icon;t&&(t.rotation="horizontal"==e?0:-90)},enumerable:!0,configurable:!0}),t}(od);Bu.registeredClasses.ResizeButton=Td;var Ed=function(e){function t(){var t=e.call(this)||this;t.className="CloseButton",t.padding(8,8,8,8),t.showSystemTooltip=!0,t.width=30,t.height=30;var i=new Xh;t.cursorOverStyle=wp.pointer;var n=t.background;n.cornerRadius(20,20,20,20);var r=i.getFor("background");n.fill=r,n.stroke=i.getFor("primaryButton"),n.strokeOpacity=1,n.strokeWidth=1;var a=i.getFor("primaryButtonActive"),o=n.states.getKey("hover");o.properties.strokeWidth=3,o.properties.fill=r;var s=n.states.getKey("down");s.properties.stroke=a,s.properties.fill=r;var l=new Up;return l.element=t.paper.add("path"),l.stroke=n.stroke,t.icon=l,t.applyTheme(),t}return Us(t,e),t.prototype.validate=function(){e.prototype.validate.call(this);var t=this.pixelWidth/3,i=this.pixelHeight/3,n=dd({x:-t/2,y:-i/2});n+=fd({x:t/2,y:i/2}),n+=dd({x:t/2,y:-i/2}),n+=fd({x:-t/2,y:i/2}),this.icon.path=n,this.invalidateLayout()},t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Close"))},t}(od);Bu.registeredClasses.CloseButton=Ed;var Cd=function(e){function t(){var t=e.call(this)||this;t.className="SwitchButton",t.tooltipY=0,t.layout="horizontal",t.contentAlign="center",t.contentValign="middle",t.padding(8,16,8,16),t.setStateOnChildren=!0,t.states.create("active");var i=new Xh,n=new rd;n.fillOpacity=.3,n.states.create("active").properties.fillOpacity=1,n.isActive=!0,t.leftLabel=n;var r=new od,a=new sd;r.contentValign="none",r.padding(0,0,0,0),a.radius=10,r.icon=a,r.icon.valign="middle",r.label=void 0;var o=Ks(100);r.background.cornerRadius(o,o,o,o),r.width=3.5*a.radius,r.height=2.1*a.radius,r.marginLeft=8,r.marginRight=8,r.togglable=!0,a.dx=.7*-a.radius,a.fill=i.getFor("primaryButton"),a.states.create("hover").properties.fill=i.getFor("primaryButtonHover");var s=a.states.create("active");s.properties.fill=i.getFor("primaryButtonActive"),s.properties.dx=.7*a.radius,t.switchButton=r,t.events.on("toggled",(function(){t.leftLabel.isActive=!t.isActive,t.rightLabel.isActive=t.isActive}));var l=new rd;return l.fillOpacity=.3,l.states.create("active").properties.fillOpacity=1,t.rightLabel=l,t.role="button",t.focusable=!0,l.valign="middle",n.valign="middle",r.valign="middle",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"leftLabel",{get:function(){return this._leftLabel},set:function(e){this._leftLabel&&this.removeDispose(this._leftLabel),this._leftLabel=e,e&&(e.parent=this,e.interactionsEnabled=!1,e.shouldClone=!1,this._disposers.push(this._leftLabel))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightLabel",{get:function(){return this._rightLabel},set:function(e){this._rightLabel&&this.removeDispose(this._rightLabel),this._rightLabel=e,e&&(e.parent=this,e.interactionsEnabled=!1,e.shouldClone=!1,this._disposers.push(this._rightLabel))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"switch",{get:function(){return this._switchButton},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"switchButton",{get:function(){return this._switchButton},set:function(e){this._switchButton&&this.removeDispose(this._switchButton),this._switchButton=e,e&&(e.parent=this,e.shouldClone=!1,this._disposers.push(this._switchButton))},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),t.leftLabel&&this.leftLabel.copyFrom(t.leftLabel),t.rightLabel&&this.rightLabel.copyFrom(t.rightLabel),t.switchButton&&this.switchButton.copyFrom(t.switchButton)},t}(Wp);Bu.registeredClasses.SwitchButton=Cd;var Md=function(e){function t(){var t=e.call(this)||this;t._previousStart=0,t._previousEnd=1,t._prevStart=0,t._prevEnd=1,t._isBusy=!1,t._skipRangeEvents=!1,t.updateWhileMoving=!0,t.className="Scrollbar",t.minHeight=12,t.minWidth=12,t.animationDuration=0,t.animationEasing=uh,t.margin(10,10,10,10);var i=new Xh,n=t.background;return n.cornerRadius(10,10,10,10),n.fill=i.getFor("fill"),n.fillOpacity=.5,t.showSystemTooltip=!0,t.startGrip=new Td,t.endGrip=new Td,t.events.on("transformed",(function(){t.updateThumb()}),t,!1),t.start=0,t.end=1,t.role="scrollbar",t.thumb.role="slider",t.thumb.readerLive="polite",t.startGrip.role="slider",t.endGrip.role="slider",t.events.once("inited",(function(){t._previousStart=void 0,t.dispatchRangeChange()}),void 0,!1),t.hideGrips=!1,t.orientation="horizontal",t.setSVGAttribute({"aria-valuemin":"0"}),t.setSVGAttribute({"aria-valuemax":"100"}),t.applyTheme(),t}return Us(t,e),t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),"horizontal"===this.orientation?(nl(this.readerTitle)||(this.readerTitle=this.language.translate("Use TAB to select grip buttons or left and right arrows to change selection")),nl(this.thumb.readerDescription)||(this.thumb.readerDescription=this.language.translate("Use left and right arrows to move selection")),nl(this.startGrip.readerDescription)||(this.startGrip.readerDescription=this.language.translate("Use left and right arrows to move left selection")),nl(this.endGrip.readerDescription)||(this.endGrip.readerDescription=this.language.translate("Use left and right arrows to move right selection")),this.readerOrientation="horizontal"):(nl(this.readerTitle)||(this.readerTitle=this.language.translate("Use TAB select grip buttons or up and down arrows to change selection")),nl(this.thumb.readerDescription)||(this.thumb.readerDescription=this.language.translate("Use up and down arrows to move selection")),nl(this.startGrip.readerDescription)||(this.startGrip.readerDescription=this.language.translate("Use up and down arrows to move upper selection")),nl(this.endGrip.readerDescription)||(this.endGrip.readerDescription=this.language.translate("Use up and down arrows to move lower selection")),this.readerOrientation="vertical"),this.readerControls=this.baseSprite.uidAttr()},t.prototype.validateLayout=function(){this.updateSize(),e.prototype.validateLayout.call(this),this.updateExtremes()},t.prototype.processBackground=function(){e.prototype.processBackground.call(this);var t=this.background;t.clickable=!0,t.events.on("hit",this.handleBgHit,this,void 0)},t.prototype.handleBgHit=function(e){this.makeBusy();var t=e.spritePoint;t=qc(t,this.background,this);var i=this.thumb;if("horizontal"==this.orientation){var n=t.x-i.pixelWidth/2;n=gl(n,0,this.innerWidth-i.pixelWidth),this._thumbAnimation=i.animate({property:"x",to:n},this.animationDuration,this.animationEasing)}else{var r=t.y-i.pixelHeight/2;r=gl(r,0,this.innerHeight-i.pixelHeight),this._thumbAnimation=i.animate({property:"y",to:r},this.animationDuration,this.animationEasing)}this.animationDuration>0?this._thumbAnimation.events.on("animationended",this.makeUnbusy,this,!1):(this._thumb.validate(),this.makeUnbusy())},t.prototype.makeBusy=function(){this._isBusy=!0,this._skipRangeEvents=!1,this._unbusyTimeout&&this.removeDispose(this._unbusyTimeout),this._unbusyTimeout=void 0,this.stopAnimations()},t.prototype.stopAnimations=function(){this._thumbAnimation&&this._thumbAnimation.stop(!0),this._zoomAnimation&&this._zoomAnimation.stop(!0)},t.prototype.makeUnbusy=function(){this._unbusyTimeout=this.setTimeout(this.makeUnbusyReal.bind(this),1.1*this.animationDuration)},t.prototype.makeUnbusyReal=function(){this._usingGrip=void 0,this._isBusy=!1,this.updateWhileMoving||this.dispatchRangeChange()},t.prototype.dispatchRangeChange=function(){this._previousEnd==this.end&&this._previousStart==this.start||(this._previousStart=this.start,this._previousEnd=this.end,this.dispatch("rangechanged"))},t.prototype.updateThumb=function(e){if(void 0===e&&(e=!0),this.parent){var t=this.thumb,i=this.start,n=this.end,r=this.startGrip,a=this.endGrip;if("horizontal"==this.orientation){var o=this.innerWidth;t.width=o*(n-i),t.maxX=o-t.pixelWidth,t.x=i*o,r.moveTo({x:t.pixelX,y:0},void 0,void 0,!0),a.moveTo({x:t.pixelX+t.pixelWidth,y:0},void 0,void 0,!0),r.readerTitle=this.language.translate("From %1",void 0,this.adapter.apply("positionValue",{value:Math.round(100*i)+"%",position:i}).value),r.readerValueNow=""+Math.round(100*i),r.readerValueText=r.readerTitle,a.readerTitle=this.language.translate("To %1",void 0,this.adapter.apply("positionValue",{value:Math.round(100*n)+"%",position:n}).value),a.readerValueNow=""+Math.round(100*n),a.readerValueText=a.readerTitle}else{var s=this.innerHeight;t.height=s*(n-i),t.maxY=s-t.pixelHeight,t.y=(1-n)*s,r.moveTo({x:0,y:t.pixelY+t.pixelHeight},void 0,void 0,!0),a.moveTo({x:0,y:t.pixelY},void 0,void 0,!0),r.readerTitle=this.language.translate("To %1",void 0,this.adapter.apply("positionValue",{value:Math.round(100*(1-i))+"%",position:1-i}).value),r.readerValueNow=""+Math.round(100*i),r.readerValueText=r.readerTitle,a.readerTitle=this.language.translate("From %1",void 0,this.adapter.apply("positionValue",{value:Math.round(100*(1-n))+"%",position:1-n}).value),a.readerValueNow=""+Math.round(100*n),a.readerValueText=a.readerTitle}t.readerTitle=this.language.translate("From %1 to %2",void 0,this.adapter.apply("positionValue",{value:Math.round(100*i)+"%",position:i}).value,this.adapter.apply("positionValue",{value:Math.round(100*n)+"%",position:n}).value),t.readerValueNow=""+Math.round(100*i),t.readerValueText=t.readerTitle,this.readerValueNow=""+Math.round(100*i),this.readerValueText=t.readerTitle,!this._skipRangeEvents&&this.updateWhileMoving&&e&&this.dispatchRangeChange()}},t.prototype.updateExtremes=function(){var e=0,t=0,i=0,n=0;"horizontal"==this.orientation?(i=this.innerWidth,t=n=this.innerHeight/2):(n=this.innerHeight,e=i=this.innerWidth/2);var r=this.startGrip;r.minX=e,r.maxX=i,r.minY=t,r.maxY=n;var a=this.endGrip;a.minX=e,a.maxX=i,a.minY=t,a.maxY=n;var o=this.thumb;o.minX=e,o.maxX=i,o.minY=t,o.maxY=n},t.prototype.updateSize=function(){var e=this.orientation,t=this.startGrip;t&&(t.orientation=e),this.endGrip&&(this.endGrip.orientation=e);var i=this.thumb;i&&("horizontal"==e?(ll(this._pixelWidth)||this.width instanceof Xs||(this.width=Ks(100)),nl(this.percentHeight)&&(this.height=this.minHeight),i.height=this.innerHeight,i.verticalCenter="middle",i.horizontalCenter="left"):(ll(this._pixelHeight)||this.height instanceof Xs||(this.height=Ks(100)),nl(this.percentWidth)&&(this.width=this.minWidth),i.width=this.innerWidth,i.verticalCenter="top",i.horizontalCenter="middle"))},Object.defineProperty(t.prototype,"isBusy",{get:function(){return this._isBusy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return Math.min(this.getPosition(this._start),this.getPosition(this._end))},set:function(e){this._isBusy||(this.__start=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"__start",{get:function(){return this._start},set:function(e){this._start=this.getPosition(e),this.updateThumb()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return Math.max(this.getPosition(this._start),this.getPosition(this._end))},set:function(e){this._isBusy||(this.__end=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"__end",{get:function(){return this._end},set:function(e){this._end=this.getPosition(e),this.updateThumb()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return{start:this.start,end:this.end,priority:this._usingGrip}},enumerable:!0,configurable:!0}),t.prototype.skipRangeEvents=function(){this._isBusy||(this._skipRangeEvents=!0)},t.prototype.fixRange=function(e){e.start==vl(this._start,2)&&e.end==vl(this._end,2)||(this._start=e.start,this._end=e.end,this._skipRangeEvents=!0,this.updateThumb(),this._skipRangeEvents=!1,this.thumb.validate(),this.thumb.background.validate())},t.prototype.getPosition=function(e){return gl(vl(e,4),0,1)},Object.defineProperty(t.prototype,"orientation",{get:function(){return this.getPropertyValue("orientation")},set:function(e){this.setPropertyValue("orientation",e)&&("horizontal"===e?(this.startGrip.cursorOverStyle=wp.horizontalResize,this.endGrip.cursorOverStyle=wp.horizontalResize):(this.startGrip.cursorOverStyle=wp.verticalResize,this.endGrip.cursorOverStyle=wp.verticalResize),this.updateByOrientation(),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.updateByOrientation=function(){},Object.defineProperty(t.prototype,"startGrip",{get:function(){return this._startGrip},set:function(e){this._startGrip&&this.removeDispose(this._startGrip),this._startGrip=e,this.processGrip(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endGrip",{get:function(){return this._endGrip},set:function(e){this._endGrip&&this.removeDispose(this._endGrip),this._endGrip=e,this.processGrip(e)},enumerable:!0,configurable:!0}),t.prototype.processGrip=function(e){e.parent=this,e.isMeasured=!1,e.focusable=!0,e.shouldClone=!1,e.zIndex=100,e.events.on("drag",this.handleGripDrag,this,!1),e.events.on("dragstop",this.makeUnbusy,this,!1),e.events.on("down",this.makeBusy,this,!1),e.events.on("up",this.makeUnbusy,this,!1),this._disposers.push(e)},t.prototype.handleGripDrag=function(e){this.makeBusy(),e.target===this._startGrip?this._usingGrip="start":this._usingGrip="end","horizontal"==this.orientation?(this._start=this.startGrip.pixelX/this.innerWidth,this._end=this.endGrip.pixelX/this.innerWidth):(this._start=1-this.startGrip.pixelY/this.innerHeight,this._end=1-this.endGrip.pixelY/this.innerHeight),this.updateThumb()},Object.defineProperty(t.prototype,"thumb",{get:function(){if(!this._thumb){var e=new od;e.background.cornerRadius(10,10,10,10),e.padding(0,0,0,0),this.thumb=e}return this._thumb},set:function(e){var t=this;e&&(this._thumb&&this.removeDispose(this._thumb),this._thumb=e,e.parent=this,e.isMeasured=!1,e.inert=!0,e.draggable=!0,e.clickable=!0,e.hoverable=!0,e.focusable=!0,e.shouldClone=!1,e.zIndex=0,e.cursorOverStyle=wp.grab,e.cursorDownStyle=wp.grabbing,e.events.on("dragstart",this.makeBusy,this,!1),e.events.on("dragstop",this.makeUnbusy,this,!1),e.events.on("positionchanged",this.handleThumbPosition,this,!1),e.events.on("sizechanged",this.handleThumbPosition,this,!1),e.events.on("doublehit",this.handleDoubleClick,this,!1),this._disposers.push(ap().body.events.on("keyup",(function(e){ep.isKey(e.event,["space","enter"])&&t.thumb.isFocused&&(e.event.preventDefault(),t.handleDoubleClick())}))),this._disposers.push(this._thumb))},enumerable:!0,configurable:!0}),t.prototype.handleDoubleClick=function(){this.makeBusy();var e=0,t=1;0!=this.start||1!=this.end?(this._prevStart=this.start,this._prevEnd=this.end):(e=this._prevStart,t=this._prevEnd);var i=this.animate([{property:"__start",to:e},{property:"__end",to:t}],this.animationDuration,this.animationEasing);i&&!i.isFinished()?(i.events.on("animationended",this.makeUnbusy,this,!1),this._zoomAnimation=i):this.makeUnbusy()},t.prototype.handleThumbPosition=function(){var e=this.thumb;if("horizontal"==this.orientation){var t=this.innerWidth,i=e.innerWidth,n=e.pixelX;this._start=n/t,this._end=(n+i)/t,this.updateThumb()}else{var r=this.innerHeight,a=e.innerHeight,o=e.pixelY;this._start=1-(o+a)/r,this._end=1-o/r,this.updateThumb()}},t.prototype.createBackground=function(){return new ad},Object.defineProperty(t.prototype,"hideGrips",{get:function(){return this._hideGrips},set:function(e){var t=this;this._hideGrips=e,this._overDisposer&&this.removeDispose(this._overDisposer),this._outDisposer&&this.removeDispose(this._outDisposer),e?(this._overDisposer=this.events.on("over",(function(){t.startGrip.show(),t.endGrip.show()}),void 0,!1),this._outDisposer=this.events.on("out",(function(){t.startGrip.hide(),t.endGrip.hide()}),void 0,!1),this.startGrip.hide(),this.endGrip.hide()):(this.startGrip.show(),this.endGrip.show())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationDuration",{get:function(){return this.getPropertyValue("animationDuration")},set:function(e){this.setPropertyValue("animationDuration",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationEasing",{get:function(){return this.getPropertyValue("animationEasing")},set:function(e){this.setPropertyValue("animationEasing",e)},enumerable:!0,configurable:!0}),t.prototype.asFunction=function(t){return"animationEasing"==t||e.prototype.asIs.call(this,t)},t}(Wp);Bu.registeredClasses.Scrollbar=Md;var Id=function(e){function t(){var t=e.call(this)||this;return t.className="Slider",t.thumb.opacity=0,t.thumb.interactionsEnabled=!1,t.endGrip.opacity=0,t.endGrip.interactionsEnabled=!1,t.startGrip.events.on("drag",(function(){t.endGrip.x=t.startGrip.x,t.endGrip.y=t.startGrip.y})),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"__end",{get:function(){return this._start},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._start},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},set:function(e){this._isBusy||(this.__start=e)},enumerable:!0,configurable:!0}),t}(Md);Bu.registeredClasses.Slider=Id;var Od=function(e){function t(){var t=e.call(this)||this;t.className="TextLink",t.selectable=!0;var i=new Xh;return t.fill=i.getFor("primaryButton").brighten(.3),t.states.create("hover").properties.fill=i.getFor("primaryButtonHover").brighten(.3),t.states.create("down").properties.fill=i.getFor("primaryButtonDown").brighten(.3),t.cursorOverStyle=wp.pointer,t.applyTheme(),t}return Us(t,e),t}(rd);Bu.registeredClasses.TextLink=Od;var Dd=function(e){function t(){var t=e.call(this)||this;return t.properties={},t.isTemplate=!1,t._scale=1,t._nonScaling=!0,t.className="Filter",t.filterPrimitives=new Wu,t.properties.filterUnits="objectBoundingBox",t.filterPrimitives.events.on("inserted",(function(e){t._disposers.push(e.newValue)})),t.width=120,t.height=120,t.applyTheme(),t}return Us(t,e),t.prototype.appendPrimitives=function(e){Tu(this.filterPrimitives.iterator(),(function(t){e.add(t)}))},t.prototype.animate=function(e,t,i){return new Th(this,e,t,i).start()},Object.defineProperty(t.prototype,"width",{get:function(){return this.properties.width},set:function(e){this.properties.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.properties.height},set:function(e){this.properties.height=e},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){var i=this;e.prototype.copyFrom.call(this,t),gu(t.properties,(function(e,t){i[e]=t}))},Object.defineProperty(t.prototype,"paper",{get:function(){return this._paper?this._paper:yp()},set:function(e){this._paper!=e&&(this._paper=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations||(this._animations=[],this._disposers.push(new Sh(this._animations))),this._animations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e,this.updateScale()},enumerable:!0,configurable:!0}),t.prototype.updateScale=function(){},Object.defineProperty(t.prototype,"filterUnits",{get:function(){return this.properties.filterUnits},set:function(e){this.properties.filterUnits=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonScaling",{get:function(){return this._nonScaling},set:function(e){this._nonScaling=e,e||(this._scale=1),this.updateScale()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprite",{set:function(e){this.setSprite(e)},enumerable:!0,configurable:!0}),t.prototype.setSprite=function(e){this._sprite&&this._sprite!=e&&this._sprite.filters.removeValue(this),this._sprite=e},t}(hc),Ad=function(e){function t(){var t=e.call(this)||this;return t.className="DropShadowFilter",t.color=uc("#000"),t.feGaussianBlur=t.paper.add("feGaussianBlur"),t.feGaussianBlur.attr({result:"blurOut",in:"SourceGraphic"}),t.filterPrimitives.push(t.feGaussianBlur),t.feOffset=t.paper.add("feOffset"),t.feOffset.attr({result:"offsetBlur"}),t.filterPrimitives.push(t.feOffset),t.feFlood=t.paper.add("feFlood"),t.feFlood.attr({"flood-color":t.color}),t.filterPrimitives.push(t.feFlood),t.feComposite=t.paper.add("feComposite"),t.feComposite.attr({in2:"offsetBlur",operator:"in"}),t.filterPrimitives.push(t.feComposite),t.feMerge=t.paper.addGroup("feMerge"),t.feMerge.add(t.paper.add("feMergeNode")),t.feMerge.add(t.paper.add("feMergeNode").attr({in:"SourceGraphic"})),t.filterPrimitives.push(t.feMerge),t.width=200,t.height=200,t.blur=1.5,t.dx=3,t.dy=3,t.opacity=.5,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this.properties.color},set:function(e){this.properties.color=e,this.feFlood&&this.feFlood.attr({"flood-color":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this.properties.opacity},set:function(e){this.properties.opacity=e,this.feFlood.attr({"flood-opacity":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dx",{get:function(){return this.properties.dx},set:function(e){this.properties.dx=e,this.feOffset.attr({dx:e/this.scale})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dy",{get:function(){return this.properties.dy},set:function(e){this.properties.dy=e,this.feOffset.attr({dy:e/this.scale})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blur",{get:function(){return this.properties.blur},set:function(e){this.properties.blur=e,this.feGaussianBlur.attr({stdDeviation:e/this.scale})},enumerable:!0,configurable:!0}),t.prototype.updateScale=function(){this.dx=this.dx,this.dy=this.dy,this.blur=this.blur},t}(Dd);Bu.registeredClasses.DropShadowFilter=Ad;var Ld=function(e){function t(){var t=e.call(this)||this;t._boundingRect={x:-4e4,y:-4e4,width:8e4,height:8e4},t._pointTo={x:0,y:0},t.fitPointerToBounds=!1,t._verticalOrientation="up",t.fixDoc=!0,t.className="Tooltip",t.isMeasured=!1,t.getFillFromObject=!0,t.margin(5,5,5,5),t.defaultState.transitionDuration=1,t.hiddenState.transitionDuration=1;var i=t.background;i.interactionsEnabled=!1,i.fillOpacity=.9,i.strokeWidth=1,i.strokeOpacity=1,i.stroke=uc("#ffffff"),i.cornerRadius=3,i.pointerLength=6,i.pointerBaseWidth=10;var n=new Ad;n.dy=1,n.dx=1,n.opacity=.5,i.filters.push(n),t.autoTextColor=!0;var r=t.createChild(rd);return r.shouldClone=!1,t.label=r,r.padding(7,12,4,12),r.interactionsEnabled=!1,r.horizontalCenter="middle",r.fill=uc("#ffffff"),t._disposers.push(r),t.label.events.on("sizechanged",t.drawBackground,t),t.label.zIndex=1,t.pointerOrientation="vertical",t.animationDuration=0,t.animationEasing=uh,t.setPropertyValue("showInViewport",!1),t.role="tooltip",t.visible=!1,t.opacity=0,t.x=0,t.y=0,t.events.on("visibilitychanged",t.handleVisibility,t),t.applyTheme(),t}return Us(t,e),t.prototype.handleVisibility=function(){this.visible&&this.label.invalidate()},Object.defineProperty(t.prototype,"getStrokeFromObject",{get:function(){return this.getPropertyValue("getStrokeFromObject")},set:function(e){this.setPropertyValue("getStrokeFromObject",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoTextColor",{get:function(){return this.getPropertyValue("autoTextColor")},set:function(e){this.setPropertyValue("autoTextColor",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepTargetHover",{get:function(){return this.getPropertyValue("keepTargetHover")},set:function(e){var t=this;this.setPropertyValue("keepTargetHover",e,!0)&&e&&(this.hoverable=!0,this.background.interactionsEnabled=!0,this._disposers.push(this.events.on("over",(function(e){t.targetSprite&&t.targetSprite.hoverable&&(t.targetSprite.isHover=!0)}))),this._disposers.push(this.events.on("out",(function(e){t.targetSprite&&t.targetSprite.hoverable&&(t.targetSprite.isHover=!1)}))))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showInViewport",{get:function(){return this.getPropertyValue("showInViewport")},set:function(e){this.setPropertyValue("showInViewport",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getFillFromObject",{get:function(){return this.getPropertyValue("getFillFromObject")},set:function(e){this.setPropertyValue("getFillFromObject",e,!0)},enumerable:!0,configurable:!0}),t.prototype.createBackground=function(){return new pd},Object.defineProperty(t.prototype,"pointerOrientation",{get:function(){return this.getPropertyValue("pointerOrientation")},set:function(e){this.setPropertyValue("pointerOrientation",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationDuration",{get:function(){return this.getPropertyValue("animationDuration")},set:function(e){this.setPropertyValue("animationDuration",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationEasing",{get:function(){return this.getPropertyValue("animationEasing")},set:function(e){this.setPropertyValue("animationEasing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this.label.html},set:function(e){this.label.html!=e&&(this.label.html=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.label.text},set:function(e){this.label.text!=e&&(this.label.text=e,this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.label;t.invalid&&t.validate();var i,n,r=this._pointTo.x,a=this._pointTo.y,o=this._boundingRect,s=t.measuredWidth,l=t.measuredHeight,u=this.background.pointerLength;if(this.ignoreBounds&&(o=void 0),o&&this.fixDoc&&s>o.width){$c({x:o.x,y:o.y},this.parent);var c=$c({x:o.x+o.width,y:o.y+o.height},this.parent),h=document.body.offsetWidth;document.body.offsetHeight,c.x>h/2?o.x=o.width-s:o.width=o.x+s}var p=this.pointerOrientation;"horizontal"==p||"left"==p||"right"==p?(n=-l/2,i="horizontal"==p?o&&r>o.x+o.width/2?-s/2-u:s/2+u:"left"==p?s/2+u:-s/2-u):(o&&(i=gl(0,o.x-r+s/2,o.x-r+o.width-s/2)),"vertical"==p?o&&a>o.y+l+u?(n=-l-u,this._verticalOrientation="up"):(n=u,this._verticalOrientation="down"):"down"==p?(n=-l-u,this._verticalOrientation="up"):(n=u,this._verticalOrientation="down")),o&&(n=gl(n,o.y-a,o.y+o.height-l-a)),t.x=i,t.y=n,this.drawBackground()},t.prototype.updateBackground=function(){this.group.addToBack(this.background.group)},t.prototype.drawBackground=function(){var e=this.label,t=this.background,i=e.measuredWidth,n=e.measuredHeight,r=this._boundingRect,a=i,o=e.pixelX-i/2,s=n,l=e.pixelY,u=this._pointTo.x,c=this._pointTo.y,h=r.x-u,p=h+r.width,d=r.y-c,f=d+r.height;t.x=o,t.y=l,t.width=a,t.height=s,this.fitPointerToBounds?(t.pointerX=gl(-t.x,h-t.x,p-t.x),t.pointerY=gl(-t.y,d-t.y,f-t.y)):(t.pointerX=-t.x,t.pointerY=-t.y),t.validate()},t.prototype.delayedPointTo=function(e,t){var i=this;this._pointToDisposer&&this._pointToDisposer.dispose(),this._pointToDisposer=Bu.events.once("exitframe",(function(){i.pointTo(e,t)})),this.addDisposer(this._pointToDisposer)},t.prototype.pointTo=function(e,t){this._pointTo.x==e.x&&this._pointTo.y==e.y||(this._pointTo=e,this.invalidate(),!this.visible||t?(this.moveTo(this._pointTo),this._animation&&this._animation.kill()):0==this.pixelX&&0==this.pixelY?this.moveTo(this._pointTo):(this._animation&&this._animation.kill(),this._animation=new Th(this,[{property:"x",to:e.x,from:this.pixelX},{property:"y",to:e.y,from:this.pixelY}],this.animationDuration,this.animationEasing).start()))},t.prototype.setBounds=function(e){var t=this._boundingRect;t.x==e.x&&t.y==e.y&&t.width==e.width&&t.height==e.height||(this._boundingRect=e,this.invalidate())},Object.defineProperty(t.prototype,"boundingContainer",{set:function(e){this._boundingContainer=e,e.events.on("sizechanged",this.updateBounds,this),e.events.on("positionchanged",this.updateBounds,this)},enumerable:!0,configurable:!0}),t.prototype.updateBounds=function(){var e=this._boundingContainer,t=Xc({x:e.pixelX,y:e.pixelY,width:e.maxWidth,height:e.maxHeight},e);this.setBounds(t)},Object.defineProperty(t.prototype,"ignoreBounds",{get:function(){return this.getPropertyValue("ignoreBounds")},set:function(e){this.setPropertyValue("ignoreBounds",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalOrientation",{get:function(){return this._verticalOrientation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.label.copyFrom(t.label),t._boundingRect&&(this._boundingRect=t._boundingRect)},t.prototype.asFunction=function(t){return"animationEasing"==t||e.prototype.asIs.call(this,t)},t}(Wp);Bu.registeredClasses.Tooltip=Ld;var zd=function(e){function t(){var t=e.call(this)||this;return t.className="Trapezoid",t.element=t.paper.add("path"),t.topSide=Ks(100),t.bottomSide=Ks(100),t.leftSide=Ks(100),t.rightSide=Ks(100),t.isMeasured=!1,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.pixelWidth,i=this.pixelHeight,n=Pc(this.topSide,t),r=Pc(this.bottomSide,t),a=Pc(this.leftSide,i),o=Pc(this.rightSide,i),s=(t-n)/2,l=(i-a)/2,u=t-(t-n)/2,c=(i-o)/2,h=t-(t-r)/2,p=i-(i-o)/2,d=(t-r)/2,f=i-(i-a)/2,m="",v="",y="",g="";if(nl(this.horizontalNeck)){var _=this.horizontalNeck.value;m=fd({x:t*_,y:Math.max(l,c)}),y=fd({x:t*_,y:Math.min(p,f)})}if(nl(this.verticalNeck)){var b=this.verticalNeck.value;v=fd({x:Math.min(u,h),y:i*b}),g=fd({x:Math.max(s,d),y:i*b})}var x=dd({x:s,y:l})+m+fd({x:u,y:c})+v+fd({x:h,y:p})+y+fd({x:d,y:f})+g;this.path=x},Object.defineProperty(t.prototype,"topSide",{get:function(){return this.getPropertyValue("topSide")},set:function(e){this.setPercentProperty("topSide",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomSide",{get:function(){return this.getPropertyValue("bottomSide")},set:function(e){this.setPercentProperty("bottomSide",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftSide",{get:function(){return this.getPropertyValue("leftSide")},set:function(e){this.setPercentProperty("leftSide",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightSide",{get:function(){return this.getPropertyValue("rightSide")},set:function(e){this.setPercentProperty("rightSide",e,!0,!1,10,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalNeck",{get:function(){return this.getPropertyValue("horizontalNeck")},set:function(e){this.setPropertyValue("horizontalNeck",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalNeck",{get:function(){return this.getPropertyValue("verticalNeck")},set:function(e){this.setPropertyValue("verticalNeck",e,!0)},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Trapezoid=zd;var Rd=function(e){function t(){var t=e.call(this)||this;return t.className="Triangle",t.element=t.paper.add("path"),t.direction="top",t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t,i=this.pixelWidth,n=this.pixelHeight;switch(this.direction){case"right":t=dd({x:0,y:0})+fd({x:i,y:n/2})+fd({x:0,y:n})+" Z";break;case"left":t=dd({x:i,y:0})+fd({x:0,y:n/2})+fd({x:i,y:n})+" Z";break;case"bottom":t=dd({x:0,y:0})+fd({x:i,y:0})+fd({x:i/2,y:n})+" Z";break;case"top":t=dd({x:i/2,y:0})+fd({x:i,y:n})+fd({x:0,y:n})+" Z"}this.path=t},Object.defineProperty(t.prototype,"direction",{get:function(){return this.getPropertyValue("direction")},set:function(e){this.setPropertyValue("direction",e,!0)},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Triangle=Rd;var Fd=function(){function e(e,t){this._tensionX=e,this._tensionY=t}return e.prototype.smooth=function(e){for(var t=e.length-1;t>0;t--){var i=e[t],n=e[t-1];Math.abs(i.x-n.x)<.1&&Math.abs(i.y-n.y)<.1&&e.splice(t-1,1)}var r=this._tensionX,a=this._tensionY;if(e.length<3||r>=1&&a>=1)return function(e){var t=fd(e[0]),i={x:0,y:0},n=_h.minPolylineStep;ll(n)||(n=.5);for(var r=0,a=e.length;r<a;r++){var o=e[r];Pl(o,i)>n&&(t+=fd(o),i=o)}return t}(e);var o=e[0],s=e[e.length-1],l=!1;vl(o.x,3)==vl(s.x)&&vl(o.y)==vl(s.y)&&(l=!0);for(var u="",c=(t=0,e.length-1);t<c;t++){i=e[t-1],n=e[t];var h=e[t+1],p=e[t+2];0===t?i=l?e[e.length-2]:e[t]:t==e.length-2&&(p=l?e[1]:e[t+1]),u+=md(h,Dl(i,n,h,0,r,a),Al(0,n,h,p,r,a))}return u},e}();function jd(e,t,i,n,r,a){var o=e.x,s=e.y,l=t.x,u=t.y,c=Pl(e,t);a&&(i=c/Math.round(c/i));var h=Bu.getCache(Sc(["wavedLine",e.x,t.x,e.y,t.y,i,n]));if(!h){if(c>0){var p=Math.atan2(u-s,l-o),d=Math.cos(p),f=Math.sin(p),m=i*d,v=i*f;if(i<=1||n<=1)h=fd(t);else{var y=Math.round(2*c/i),g=[],_=1;l<o&&(_*=-1),u<s&&(_*=-1);for(var b=0;b<=y;b++){var x=o+b*m/2+(_*=-1)*n/2*f,w=s+b*v/2-_*n/2*d;g.push({x:x,y:w})}h=new Fd(r,r).smooth(g)}}else h="";Bu.setCache(Sc(["wavedLine",e.x,t.x,e.y,t.y,i,n]),h)}return h}var Bd=function(){function e(e,t){this._reversed=e,this._closed=t.closed}return e.prototype._curve=function(e,t,i,n,r,a){var o=(t-e)/3;return this._reversed?md({x:n,y:t},{x:i+o*r,y:e+o},{x:n-o*a,y:t-o}):md({x:t,y:n},{x:e+o,y:i+o*r},{x:t-o,y:n-o*a})},e.prototype.smooth=function(e){var t=this,i=NaN,n=NaN,r=NaN,a=NaN,o=NaN,s=0,l="";switch(Nl(e,(function(e){var u=e.x,c=e.y;if(t._reversed){var h=u;u=c,c=h}var p=NaN;if(u!==n||c!==a){switch(s){case 0:s=1,t._reversed?l+=fd({x:c,y:u}):l+=fd({x:u,y:c});break;case 1:s=2;break;case 2:s=3,l+=t._curve(i,n,r,a,Nd(i,n,r,a,p=Ud(i,n,r,a,u,c)),p);break;default:l+=t._curve(i,n,r,a,o,p=Ud(i,n,r,a,u,c))}i=n,n=u,r=a,a=c,o=p}})),s){case 2:this._reversed?l+=fd({x:a,y:n}):l+=fd({x:n,y:a});break;case 3:l+=this._curve(i,n,r,a,o,Nd(i,n,r,a,o))}return this._closed&&(l+=" Z"),l},e}();function Vd(e){return e<0?-1:1}function Nd(e,t,i,n,r){var a=t-e;return a?(3*(n-i)/a-r)/2:r}function Ud(e,t,i,n,r,a){var o=t-e,s=r-t,l=(n-i)/(o||s<0&&-0),u=(a-n)/(s||o<0&&-0),c=(l*s+u*o)/(o+s);return(Vd(l)+Vd(u))*Math.min(Math.abs(l),Math.abs(u),.5*Math.abs(c))||0}(function(e){function t(t){return e.call(this,!1,t)||this}Us(t,e)})(Bd),function(e){function t(t){return e.call(this,!0,t)||this}Us(t,e)}(Bd),function(){function e(e){this._closed=e.closed}e.prototype.smooth=function(e){var t=this,i=NaN,n=NaN,r=NaN,a=NaN,o=NaN,s=NaN,l=NaN,u=NaN,c=NaN,h=NaN,p=0,d="",f=function(e,t){d+=md({x:(i+4*n+e)/6,y:(s+4*l+t)/6},{x:(2*i+n)/3,y:(2*s+l)/3},{x:(i+2*n)/3,y:(s+2*l)/3})},m=function(e){var m=e.x,v=e.y;switch(p){case 0:p=1,t._closed?(r=m,u=v):d+=fd({x:m,y:v});break;case 1:p=2,t._closed&&(a=m,c=v);break;case 2:if(p=3,t._closed){o=m,h=v,d+=dd({x:(i+4*n+m)/6,y:(s+4*l+v)/6});break}d+=fd({x:(5*i+n)/6,y:(5*s+l)/6});default:f(m,v)}i=n,n=m,s=l,l=v};if(Nl(e,m),this._closed)switch(p){case 1:d+=dd({x:r,y:u}),d+=" Z";break;case 2:d+=dd({x:(r+2*a)/3,y:(u+2*c)/3}),d+=fd({x:(a+2*r)/3,y:(c+2*u)/3}),d+=" Z";break;case 3:m({x:r,y:u}),m({x:a,y:c}),m({x:o,y:h})}else{switch(p){case 3:f(n,l);case 2:d+=fd({x:n,y:l})}d+=" Z"}return d}}();var Gd=function(e){function t(){var t=e.call(this)||this;return t.className="WavedCircle",t.element=t.paper.add("path"),t.waveLength=16,t.waveHeight=4,t.fill=void 0,t.fillOpacity=0,t.tension=.8,t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){var e="",t=this.pixelRadius;t>0&&(e=dd((i=this.getPoints(t))[0])+new Fd(this.tension,this.tension).smooth(i));var i,n=this.pixelInnerRadius;n>0&&((i=this.getPoints(n)).reverse(),e+=dd(i[0])+new Fd(this.tension,this.tension).smooth(i));this.path=e},t.prototype.getPoints=function(e){for(var t=e*Math.PI*2,i=this.waveHeight/2,n=t/Math.round(t/this.waveLength),r=n/2,a=[],o=t/n,s=0;s<=o;s++){var l=s*n/t*360,u=(s*n+r)/t*360;a.push({x:(e-i)*bl(l),y:(e-i)*_l(l)}),a.push({x:(e+i)*bl(u),y:(e+i)*_l(u)})}return a.pop(),a},Object.defineProperty(t.prototype,"innerRadius",{get:function(){return this.getPropertyValue("innerRadius")},set:function(e){this.setPercentProperty("innerRadius",e,!0,!1,10,!1),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelInnerRadius",{get:function(){return Pc(this.innerRadius,wl(this.innerWidth/2,this.innerHeight/2))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waveLength",{get:function(){return this.getPropertyValue("waveLength")},set:function(e){this.setPropertyValue("waveLength",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waveHeight",{get:function(){return this.getPropertyValue("waveHeight")},set:function(e){this.setPropertyValue("waveHeight",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tension",{get:function(){return this.getPropertyValue("tension")},set:function(e){this.setPropertyValue("tension",e),this.invalidate()},enumerable:!0,configurable:!0}),t}(sd);Bu.registeredClasses.WavedCircle=Gd;var Wd=function(e){function t(){var t=e.call(this)||this;return t.className="WavedLine",t.element=t.paper.add("path"),t.waveLength=16,t.waveHeight=4,t.tension=.8,t.pixelPerfect=!1,t.fill=uc(),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){var e={x:this.x1,y:this.y1},t={x:this.x2,y:this.y2};this.path=dd(e)+jd(e,t,this.waveLength,this.waveHeight,this.tension,!0)},Object.defineProperty(t.prototype,"waveLength",{get:function(){return this.getPropertyValue("waveLength")},set:function(e){this.setPropertyValue("waveLength",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waveHeight",{get:function(){return this.getPropertyValue("waveHeight")},set:function(e){this.setPropertyValue("waveHeight",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tension",{get:function(){return this.getPropertyValue("tension")},set:function(e){this.setPropertyValue("tension",e),this.invalidate()},enumerable:!0,configurable:!0}),t}(cd),Hd=function(e){function t(){var t=e.call(this)||this;return t.className="WavedRectangle",t.element=t.paper.add("path"),t.waveLength=16,t.waveHeight=4,t.tension=.8,t.setPropertyValue("wavedLeft",!0),t.setPropertyValue("wavedRight",!0),t.setPropertyValue("wavedTop",!0),t.setPropertyValue("wavedBottom",!0),t.applyTheme(),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.pixelWidth,i=this.pixelHeight;if(t>0&&i>0){var n={x:0,y:0},r={x:t,y:0},a={x:t,y:i},o={x:0,y:i},s=Math.min(t,this.waveLength),l=Math.min(i,this.waveHeight),u=Math.min(i,this.waveLength),c=Math.min(t,this.waveHeight),h="",p="",d="",f="";this.wavedTop&&(h=jd(n,r,s,l,this.tension,!0)),this.wavedRight&&(p=jd(r,a,u,c,this.tension,!0)),this.wavedBottom&&(d=jd(a,o,s,l,this.tension,!0)),this.wavedLeft&&(f=jd(o,n,u,c,this.tension,!0)),this.path=dd(n)+h+fd(r)+p+fd(a)+d+fd(o)+f+"z"}},Object.defineProperty(t.prototype,"waveLength",{get:function(){return this.getPropertyValue("waveLength")},set:function(e){this.setPropertyValue("waveLength",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waveHeight",{get:function(){return this.getPropertyValue("waveHeight")},set:function(e){this.setPropertyValue("waveHeight",e),this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.setWavedSides=function(e,t,i,n){this.wavedTop=e,this.wavedRight=t,this.wavedBottom=i,this.wavedLeft=n},Object.defineProperty(t.prototype,"tension",{get:function(){return this.getPropertyValue("tension")},set:function(e){this.setPropertyValue("tension",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wavedRight",{get:function(){return this.getPropertyValue("wavedRight")},set:function(e){this.setPropertyValue("wavedRight",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wavedLeft",{get:function(){return this.getPropertyValue("wavedLeft")},set:function(e){this.setPropertyValue("wavedLeft",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wavedTop",{get:function(){return this.getPropertyValue("wavedTop")},set:function(e){this.setPropertyValue("wavedTop",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wavedBottom",{get:function(){return this.getPropertyValue("wavedBottom")},set:function(e){this.setPropertyValue("wavedBottom",e,!0)},enumerable:!0,configurable:!0}),t}(Gp),Zd=function(e){function t(){var t=e.call(this)||this;t.className="ZoomOutButton",t.padding(9,9,9,9),t.showSystemTooltip=!0;var i=new Xh,n=t.background;n.cornerRadius(20,20,20,20),n.fill=i.getFor("primaryButton"),n.stroke=i.getFor("primaryButtonStroke"),n.strokeOpacity=0,n.states.getKey("hover").properties.fill=i.getFor("primaryButtonHover"),n.states.getKey("down").properties.fill=i.getFor("primaryButtonActive");var r=new Up;r.element=t.paper.add("path");var a=dd({x:0,y:0});return a+=fd({x:11,y:0}),r.path=a,r.pixelPerfect=!0,r.padding(8,3,8,3),r.stroke=i.getFor("primaryButtonText"),t.icon=r,t.applyTheme(),t}return Us(t,e),t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Zoom Out"))},t}(od);Bu.registeredClasses.ZoomOutButton=Zd;var qd=function(e){function t(){var t=e.call(this)||this;t.className="PlayButton",t.padding(12,12,12,12),t.showSystemTooltip=!0;var i=new Xh,n=t.background;n.cornerRadius(25,25,25,25),n.fill=i.getFor("primaryButton"),n.stroke=i.getFor("primaryButtonStroke"),n.strokeOpacity=0,n.states.getKey("hover").properties.fill=i.getFor("primaryButtonHover"),n.states.getKey("down").properties.fill=i.getFor("primaryButtonActive");var r=new Rd;r.direction="right",r.width=9,r.height=11,r.marginLeft=1,r.marginRight=1,r.horizontalCenter="middle",r.verticalCenter="middle",r.stroke=i.getFor("primaryButtonText"),r.fill=r.stroke,t.icon=r;var a=new ad;a.width=11,a.height=11,a.horizontalCenter="middle",a.verticalCenter="middle",a.cornerRadius(0,0,0,0),a.stroke=i.getFor("primaryButtonText"),a.fill=r.stroke,t.togglable=!0;var o=t.states.create("active");return o.transitionDuration=0,o.properties.icon=a,t.defaultState.transitionDuration=0,t.applyTheme(),t}return Us(t,e),t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Play"))},t}(od);Bu.registeredClasses.PlayButton=qd;var Xd=function(e){function t(){var t=e.call(this)||this;return t.className="ColorModifier",t.applyTheme(),t}return Us(t,e),t.prototype.modify=function(e){return e},t}(hc);Bu.registeredClasses.ColorModifier=Xd;var Kd=function(e){function t(){var t=e.call(this)||this;return t.lightnesses=[],t.brightnesses=[],t.opacities=[],t.offsets=[],t.className="GradientModifier",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"lightnesses",{get:function(){return this._lightnesses},set:function(e){this._lightnesses=e,this._brightnesses=[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"brightnesses",{get:function(){return this._brightnesses},set:function(e){this._brightnesses=e,this._lightnesses=[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacities",{get:function(){return this._opacities},set:function(e){this._opacities=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return this._offsets},set:function(e){this._offsets=e},enumerable:!0,configurable:!0}),t.prototype.modify=function(e){this.gradient.clear();var t=0;this.opacities&&(t=xl(t,this.opacities.length)),this.lightnesses&&(t=xl(t,this.lightnesses.length)),this.brightnesses&&(t=xl(t,this.brightnesses.length));for(var i,n,r=1,a=0;a<t;a++){var o=e;this.opacities&&ll(this.opacities[a])&&(r=this.opacities[a]),this.lightnesses&&ll(this.lightnesses[a])&&(i=this.lightnesses[a],n=void 0),this.brightnesses&&ll(this.brightnesses[a])&&(n=this.brightnesses[a],i=void 0),ll(n)?o=e.brighten(this.brightnesses[a]):ll(i)&&(o=e.lighten(this.lightnesses[a]));var s=this.offsets[a];this.gradient.addColor(o,r,s)}return this.gradient},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this._offsets=t.offsets,this._brightnesses=t.brightnesses,this._lightnesses=t.lightnesses,this._opacities=t.opacities},t}(Xd);Bu.registeredClasses.GradientModifier=Kd;var Yd=function(e){function t(){var t=e.call(this)||this;return t.className="LinearGradientModifier",t.gradient=new _p,t.applyTheme(),t}return Us(t,e),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.gradient=t.gradient.clone()},t}(Kd);Bu.registeredClasses.LinearGradientModifier=Yd;!function(e){function t(){var t=e.call(this)||this;return t.className="Cone",t.angle=30,t.radius=Ks(100),t.topRadius=Ks(100),t.top=t.createChild(ld),t.top.shouldClone=!1,t.bottom=t.createChild(ld),t.bottom.shouldClone=!1,t.body=t.createChild(Up),t.body.shouldClone=!1,t.body.setElement(t.paper.add("path")),t.layout="none",t.bodyFillModifier=new Yd,t.bodyFillModifier.lightnesses=[0,-.25,0],t.body.fillModifier=t.bodyFillModifier,t.applyTheme(),t}Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),xu(this,this.top,Np),xu(this,this.bottom,Np),xu(this,this.body,Np);var t,i,n,r=this.innerWidth,a=this.innerHeight,o=this.bottom,s=this.top,l=this.angle;"horizontal"==this.orientation?(t=a/2,o.y=a/2,s.y=a/2,s.x=r,i=(90-l)/90,n=0,this.bodyFillModifier.gradient.rotation=90):(i=0,n=(90-l)/90,t=r/2,o.y=a,o.x=r/2,s.x=r/2,this.bodyFillModifier.gradient.rotation=0);var u,c=this.radius.value*t,h=this.topRadius.value*t;o.radius=c-c*i,o.radiusY=c-c*n,s.radius=h-h*i,s.radiusY=h-h*n,u="horizontal"==this.orientation?dd({x:0,y:a/2-o.radiusY})+vd(-90,-180,o.radius,o.radiusY)+fd({x:r,y:a/2+s.radiusY})+vd(90,180,s.radius,s.radiusY)+" Z":dd({x:r/2-s.radius,y:0})+vd(180,-180,s.radius,s.radiusY)+fd({x:r/2+o.radius,y:a})+vd(0,180,o.radius,o.radiusY)+" Z",this.body.path=u},Object.defineProperty(t.prototype,"angle",{get:function(){return this.getPropertyValue("angle")},set:function(e){this.setPropertyValue("angle",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.getPropertyValue("radius")},set:function(e){this.setPropertyValue("radius",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRadius",{get:function(){return this.getPropertyValue("topRadius")},set:function(e){this.setPropertyValue("topRadius",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this.getPropertyValue("orientation")},set:function(e){this.setPropertyValue("orientation",e,!0)},enumerable:!0,configurable:!0})}(Wp);var $d=function(e){function t(){var t=e.call(this)||this;return t.className="LightenFilter",t.feColorMatrix=t.paper.add("feColorMatrix"),t.feColorMatrix.attr({type:"matrix"}),t.filterPrimitives.push(t.feColorMatrix),t.lightness=0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"lightness",{get:function(){return this.properties.lightness},set:function(e){this.properties.lightness=e;var t=e+1;this.feColorMatrix.attr({values:t+" 0 0 0 0 0 "+t+" 0 0 0 0 0 "+t+" 0 0 0 0 0 1 0"})},enumerable:!0,configurable:!0}),t}(Dd);Bu.registeredClasses.LightenFilter=$d;(function(e){function t(){var t=e.call(this)||this;t.angle=30,t.depth=30,t.className="Rectangle3D",t.layout="none";var i=t.createChild(Up);i.shouldClone=!1,i.setElement(t.paper.add("path")),i.isMeasured=!1,t.sideBack=i,t._disposers.push(t.sideBack);var n=t.createChild(Up);n.shouldClone=!1,n.setElement(t.paper.add("path")),n.isMeasured=!1,t.sideBottom=n,t._disposers.push(t.sideBottom);var r=t.createChild(Up);r.shouldClone=!1,r.setElement(t.paper.add("path")),r.isMeasured=!1,t.sideLeft=r,t._disposers.push(t.sideLeft);var a=t.createChild(Up);a.shouldClone=!1,a.setElement(t.paper.add("path")),a.isMeasured=!1,t.sideRight=a,t._disposers.push(t.sideRight);var o=t.createChild(Up);o.shouldClone=!1,o.setElement(t.paper.add("path")),o.isMeasured=!1,t.sideTop=o,t._disposers.push(t.sideTop);var s=t.createChild(Up);return s.shouldClone=!1,s.setElement(t.paper.add("path")),s.isMeasured=!1,t.sideFront=s,t._disposers.push(t.sideFront),t.applyTheme(),t}Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this);var t=this.innerWidth,i=this.innerHeight,n=this.depth,r=this.angle,a=_l(r),o=bl(r),s={x:0,y:0},l={x:t,y:0},u={x:t,y:i},c={x:0,y:i},h={x:n*o,y:-n*a},p={x:n*o+t,y:-n*a},d={x:n*o+t,y:-n*a+i},f={x:n*o,y:-n*a+i};this.sideFront.path=dd(s)+fd(l)+fd(u)+fd(c)+" Z",this.sideBack.path=dd(h)+fd(p)+fd(d)+fd(f)+" Z",this.sideLeft.path=dd(s)+fd(h)+fd(f)+fd(c)+" Z",this.sideRight.path=dd(l)+fd(p)+fd(d)+fd(u)+" Z",this.sideBottom.path=dd(c)+fd(f)+fd(d)+fd(u)+" Z",this.sideTop.path=dd(s)+fd(h)+fd(p)+fd(l)+" Z"},Object.defineProperty(t.prototype,"depth",{get:function(){return this.getPropertyValue("depth")},set:function(e){this.setPropertyValue("depth",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.getPropertyValue("angle")},set:function(e){this.setPropertyValue("angle",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setFill=function(t){var i;if(e.prototype.setFill.call(this,t),ul(t)&&!("r"in t)||(t=cc(t)),t instanceof lc)i=t.hex;else if(t instanceof _p||t instanceof bp)i=t.stops.getIndex(0).color.hex;else{var n=new $d;n.lightness=-.2,this.sideBack.filters.push(n);var r=n.clone();r.lightness=-.4,this.sideLeft.filters.push(r);var a=n.clone();a.lightness=-.2,this.sideRight.filters.push(a);var o=n.clone();o.lightness=-.1,this.sideTop.filters.push(o);var s=n.clone();s.lightness=-.5,this.sideBottom.filters.push(s)}i&&(this.sideBack.fill=uc(i).lighten(-.2),this.sideLeft.fill=uc(i).lighten(-.4),this.sideRight.fill=uc(i).lighten(-.2),this.sideTop.fill=uc(i).lighten(-.1),this.sideBottom.fill=uc(i).lighten(-.5))},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.sideBack.copyFrom(t.sideBack),this.sideLeft.copyFrom(t.sideLeft),this.sideRight.copyFrom(t.sideRight),this.sideTop.copyFrom(t.sideTop),this.sideBottom.copyFrom(t.sideBottom)}})(Wp),function(e){function t(){var t=e.call(this)||this;t.className="Slice3D",t.layout="none";var i=t.createChild(Up);t.edge=i,i.shouldClone=!1,i.isMeasured=!1,i.toBack(),t.angle=30,t.depth=20;var n=t.createChild(Up);t.sideA=n,n.shouldClone=!1,n.isMeasured=!1;var r=t.createChild(Up);return t.sideB=r,r.shouldClone=!1,r.isMeasured=!1,t.applyTheme(),t}Us(t,e),t.prototype.setFill=function(t){var i;if(e.prototype.setFill.call(this,t),t instanceof lc)i=t.hex;else if(t instanceof _p||t instanceof bp)i=t.stops.getIndex(0).color.hex;else{var n=new $d;n.lightness=-.25,this.edge.filters.push(n),this.sideA.filters.push(n.clone()),this.sideB.filters.push(n.clone())}if(i){var r=uc(i).lighten(-.25);this.edge.fill=r,this.sideA.fill=r,this.sideB.fill=r,this.edge.stroke=r,this.sideA.stroke=r,this.sideB.stroke=r}},t.prototype.draw=function(){if(this.cornerRadius=0,this.innerCornerRadius=0,e.prototype.draw.call(this),0!==this.arc&&this.radius>0&&this.depth>0){this.sideB.show(0),this.sideA.show(0),this.edge.show(0);for(var t=this.startAngle,i=this.arc,n=this.pixelInnerRadius||0,r=this.radiusY||0,a=this.radius,o=t+i,s=r/a*n,l={x:bl(t)*n,y:_l(t)*s},u={x:bl(t)*a,y:_l(t)*r},c={x:bl(o)*a,y:_l(o)*r},h={x:bl(o)*n,y:_l(o)*s},p=this.depth,d={x:l.x,y:l.y-p},f={x:u.x,y:u.y-p},m={x:c.x,y:c.y-p},v={x:h.x,y:h.y-p},y="",g=Math.ceil(i/5),_=i/g,b=t,x=f,w=0;w<g;w++)if((b+=_)>0&&b<180){y+=dd(x);var k={x:bl(b)*a,y:_l(b)*r-p};y+=fd({x:x.x,y:x.y+p}),y+=yd({x:k.x,y:k.y+p},a,r,!0),y+=fd(k),y+=yd(x,a,r),y+="z",x=k}else{y+=dd(x),y+=yd(k={x:bl(b)*a,y:_l(b)*r-p},a,r,!0),y+=fd({x:k.x,y:k.y+p}),y+=yd({x:x.x,y:x.y+p},a,r),y+=fd(x),y+="z",x=k}x=d,b=t;for(w=0;w<g;w++)if((b+=_)>0&&b<180){y+=dd(x);k={x:bl(b)*n,y:_l(b)*s-p};y+=fd({x:x.x,y:x.y+p}),y+=yd({x:k.x,y:k.y+p},n,s,!0),y+=fd(k),y+=yd(x,n,s),y+="z",x=k}else{y+=dd(x),y+=yd(k={x:bl(b)*n,y:_l(b)*s-p},n,s,!0),y+=fd({x:k.x,y:k.y+p}),y+=yd({x:x.x,y:x.y+p},n,s),y+=fd(x),y+="z",x=k}this.edge.path=y,this.sideA.path=dd(l)+fd(u)+fd(f)+fd(d)+" Z",this.sideB.path=dd(c)+fd(h)+fd(v)+fd(m)+" Z",this.startAngle<90?this.sideA.toBack():this.sideA.toFront(),this.startAngle+this.arc>90?this.sideB.toBack():this.sideB.toFront(),this.slice.dy=-p}else this.sideA.hide(0),this.sideB.hide(0),this.edge.hide(0)},Object.defineProperty(t.prototype,"depth",{get:function(){return this.getPropertyValue("depth")},set:function(e){this.setPropertyValue("depth",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){var e=this.getPropertyValue("angle");return ll(e)||(e=0),e},set:function(e){this.setPropertyValue("angle",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radiusY",{get:function(){var e=this.getPropertyValue("radiusY");return ll(e)||(e=this.radius-this.radius*this.angle/90),e},set:function(e){this.setPropertyValue("radiusY",e,!0)},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.edge.copyFrom(t.edge),this.sideA.copyFrom(t.sideA),this.sideB.copyFrom(t.sideB)}}(Pd);var Jd=function(e){function t(){var t=e.call(this)||this;return t.className="RadialGradientModifier",t.gradient=new bp,t.applyTheme(),t}return Us(t,e),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.gradient=t.gradient.clone()},t}(Kd);Bu.registeredClasses.RadialGradientModifier=Jd;var Qd=function(e){function t(){var t=e.call(this)||this;return t.properties.gap=0,t._line=t.paper.add("path"),t.addElement(t._line),t}return Us(t,e),t.prototype.draw=function(){if(e.prototype.draw.call(this),Math.round(this.rotation/90)!=this.rotation/90&&(this.properties.shapeRendering="auto"),this._line){var t=this.width,i=this.height,n="";if(this.gap)for(var r=this.gap+this.strokeWidth,a=this.height/r,o=-a/2;o<1.5*a;o++)Math.round(this.rotation/90)!=this.rotation/90?(n+=dd({x:-t,y:(o+.5)*r})+fd({x:2*t,y:(o+.5)*r}),this.properties.rotationX=this.width/2,this.properties.rotationY=this.height/2):n+=dd({x:-t,y:o*r})+fd({x:2*t,y:o*r});else Math.round(this.rotation/90)!=this.rotation/90?(n=dd({x:-t,y:i/2})+fd({x:2*t,y:i/2}),this.properties.rotationX=this.width/2,this.properties.rotationY=this.height/2):n=dd({x:0,y:0})+fd({x:t,y:0});this._line.attr({d:n})}},Object.defineProperty(t.prototype,"gap",{get:function(){return this.properties.gap},set:function(e){this.properties.gap=e,this.draw()},enumerable:!0,configurable:!0}),t}(gp);Bu.registeredClasses.LinePattern=Qd;var ef=function(e){function t(){var t=e.call(this)||this;return t.properties.radius=2,t._circle=t.paper.add("circle"),t.addElement(t._circle),t.shapeRendering="auto",t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),this._circle&&this._circle.attr({r:this.radius,cx:this.width/2,cy:this.height/2})},Object.defineProperty(t.prototype,"radius",{get:function(){return this.properties.radius},set:function(e){this.properties.radius=e,this.draw()},enumerable:!0,configurable:!0}),t}(gp);Bu.registeredClasses.CirclePattern=ef;var tf=function(e){function t(){var t=e.call(this)||this;return t.rectHeight=1,t.rectWidth=1,t._rect=t.paper.add("rect"),t.addElement(t._rect),t}return Us(t,e),t.prototype.draw=function(){e.prototype.draw.call(this),this.properties.rotationX=this.width/2,this.properties.rotationY=this.height/2,this._rect&&this._rect.attr({width:this.rectWidth,height:this.rectHeight,x:(this.width-this.rectWidth)/2,y:(this.height-this.rectHeight)/2})},Object.defineProperty(t.prototype,"rectWidth",{get:function(){return this.properties.rectWidth},set:function(e){this.properties.rectWidth=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rectHeight",{get:function(){return this.properties.rectHeight},set:function(e){this.properties.rectHeight=e,this.draw()},enumerable:!0,configurable:!0}),t}(gp);Bu.registeredClasses.RectPattern=tf;var nf=function(e){function t(){var t=e.call(this)||this;return t.className="ColorizeFilter",t.feColorMatrix=t.paper.add("feColorMatrix"),t.feColorMatrix.attr({type:"matrix"}),t.filterPrimitives.push(t.feColorMatrix),t.intensity=1,t.applyTheme(),t}return Us(t,e),t.prototype.applyFilter=function(){var e,t,i,n=this.intensity,r=1-n,a=this.color;a&&a.rgb?(e=a.rgb.r/255*n,t=a.rgb.g/255*n,i=a.rgb.b/255*n):(e=0,t=0,i=0),this.feColorMatrix.attr({values:r+" 0 0 0 "+e+" 0 "+r+" 0 0 "+t+" 0 0 "+r+" 0 "+i+" 0 0 0 1 0"})},Object.defineProperty(t.prototype,"color",{get:function(){return this.properties.color},set:function(e){this.properties.color=e,this.applyFilter()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"intensity",{get:function(){return this.properties.intensity},set:function(e){this.properties.intensity=e,this.applyFilter()},enumerable:!0,configurable:!0}),t}(Dd);Bu.registeredClasses.ColorizeFilter=nf;var rf=function(e){function t(){var t=e.call(this)||this;return t.className="DesaturateFilter",t.feColorMatrix=t.paper.add("feColorMatrix"),t.feColorMatrix.attr({type:"saturate"}),t.filterPrimitives.push(t.feColorMatrix),t.width=120,t.height=120,t.saturation=0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"saturation",{get:function(){return this.properties.saturation},set:function(e){this.properties.saturation=e,this.feColorMatrix.attr({values:e.toString()})},enumerable:!0,configurable:!0}),t}(Dd);Bu.registeredClasses.DesaturateFilter=rf;var af=function(e){function t(){var t=e.call(this)||this;return t.className="BlurFilter",t.feGaussianBlur=t.paper.add("feGaussianBlur"),t.feGaussianBlur.attr({result:"blurOut",in:"SourceGraphic"}),t.filterPrimitives.push(t.feGaussianBlur),t.width=200,t.height=200,t.blur=1.5,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"blur",{get:function(){return this.properties.blur},set:function(e){this.properties.blur=e,this.feGaussianBlur.attr({stdDeviation:e/this.scale})},enumerable:!0,configurable:!0}),t}(Dd);Bu.registeredClasses.BlurFilter=af;var of=function(e){function t(){var t=e.call(this)||this;return t.className="FocusFilter",t.feFlood=t.paper.add("feFlood"),t.feFlood.attr({"flood-color":(new Xh).getFor("primaryButtonHover"),result:"base"}),t.filterPrimitives.push(t.feFlood),t.feMorphology=t.paper.add("feMorphology"),t.feMorphology.attr({result:"bigger",in:"SourceGraphic",operator:"dilate",radius:"2"}),t.filterPrimitives.push(t.feMorphology),t.feColorMatrix=t.paper.add("feColorMatrix"),t.feColorMatrix.attr({result:"mask",in:"bigger",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0"}),t.filterPrimitives.push(t.feColorMatrix),t.feComposite=t.paper.add("feComposite"),t.feComposite.attr({result:"drop",in:"base",in2:"mask",operator:"in"}),t.filterPrimitives.push(t.feComposite),t.feBlend=t.paper.add("feBlend"),t.feBlend.attr({in:"SourceGraphic",in2:"drop",mode:"normal"}),t.filterPrimitives.push(t.feBlend),t.width=130,t.height=130,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"stroke",{get:function(){return this.properties.stroke},set:function(e){this.properties.stroke=e,this.feFlood.attr({"flood-color":e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return this.properties.strokeWidth},set:function(e){this.properties.strokeWidth=e,this.feMorphology.attr({radius:e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this.properties.opacity},set:function(e){this.properties.opacity=e,this.feColorMatrix.attr({values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "+e+" 0"})},enumerable:!0,configurable:!0}),t.prototype.setSprite=function(t){this._sprite&&this._sprite!=t&&this._sprite.group.removeStyle("outline"),t.group.addStyle({outline:"none"}),e.prototype.setSprite.call(this,t)},t}(Dd),sf=function(e){function t(){var t=e.call(this)||this;return t._list=[],t._currentStep=0,t._startIndex=0,t._currentPass=0,t.baseColor=new lc({r:103,g:183,b:220}),t.stepOptions={},t.passOptions={brighten:-.2},t.step=1,t.minColors=20,t.minLightness=.2,t.maxLightness=.9,t.shuffle=!1,t.wrap=!0,t.reuse=!1,t.saturation=1,t.className="ColorSet",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"list",{get:function(){return this._list||this.generate(this.minColors),this._list},set:function(e){this._list=e,this.reset()},enumerable:!0,configurable:!0}),t.prototype.getReusableColor=function(e){if(0==this._list.length)return this.generate(1),this.list[0];var t=e-Math.floor(e/this._list.length)*this.list.length;return this.list[t]},t.prototype.next=function(){var e;return this.list.length<=this._currentStep?this.reuse?e=this.getReusableColor(this._currentStep):(this.generate(xl(this.minColors,this._currentStep+1)),e=this.list[this._currentStep]):e=this.list[this._currentStep],this._currentStep+=this.step,e.saturate(this.saturation)},t.prototype.getIndex=function(e){var t;return this.list.length<=e?this.reuse?t=this.getReusableColor(e):(this.generate(this.minColors),t=this.getIndex(e)):t=this.list[e],t.saturate(this.saturation)},t.prototype.reset=function(){this._currentStep=this._startIndex},Object.defineProperty(t.prototype,"currentStep",{get:function(){return this._currentStep},set:function(e){this._currentStep=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startIndex",{get:function(){return this._startIndex},set:function(e){this._startIndex=e,this.reset()},enumerable:!0,configurable:!0}),t.prototype.generate=function(e){var t=sc(rl(this.currentColor.rgb)),i=nl(this.stepOptions.hue)?this.stepOptions.hue:1/e,n={brighten:0,lighten:0,hue:t.h,lightness:t.l,saturation:t.s},r=[],a=0==this.list.length?0:1;if(this.reuse)for(var o=a;o<=e;o++)r.push(sc(rl(this._list[o].rgb)).h);else for(o=a;o<=e;o++){var s=t.h+i*o;this.wrap&&s>1&&(s-=1),r.push(s)}this.shuffle&&r.sort((function(e,t){return Math.random()-.5}));for(o=0;o<e;o++){this.reuse?t=sc(rl(this._list[o].rgb)):t.h=r.shift(),this.applyStepOptions(t,n,o,this._currentPass);var l=uc(oc(t)),u=(this.stepOptions.brighten||0)*o+(this.passOptions.brighten||0)*this._currentPass;0!=u&&(u=this.wrap?Wc(u,this.minLightness,this.maxLightness):Gc(u,this.minLightness,this.maxLightness),l=l.brighten(u));var c=(this.stepOptions.lighten||0)*o+(this.passOptions.lighten||0)*this._currentPass;0!=c&&(c=this.wrap?Wc(c,this.minLightness,this.maxLightness):Gc(c,this.minLightness,this.maxLightness),l=l.lighten(c)),this._list.push(l)}this._currentPass++},Object.defineProperty(t.prototype,"currentColor",{get:function(){return 0==this._list.length?this.baseColor.saturate(this.saturation):this._list[this._list.length-1].saturate(this.saturation)},enumerable:!0,configurable:!0}),t.prototype.applyStepOptions=function(e,t,i,n){e.l=t.lightness+(this.stepOptions.lightness||0)*i+(this.passOptions.lightness||0)*n,this.wrap?(e.l>1?e.l=e.l-Math.floor(e.l):e.l<0&&(e.l=-(e.l-Math.floor(e.l))),e.l=Wc(e.l,this.minLightness,this.maxLightness)):(e.l>1?e.l=1:e.l<0&&(e.l=0),e.l=Gc(e.l,this.minLightness,this.maxLightness))},t.prototype.processConfig=function(t){if(t){if(nl(t.list)&&cl(t.list))for(var i=0,n=t.list.length;i<n;i++)t.list[i]instanceof lc||(t.list[i]=uc(t.list[i]));!nl(t.baseColor)||t.baseColor instanceof lc||(t.baseColor=uc(t.baseColor))}e.prototype.processConfig.call(this,t)},t}(hc);Bu.registeredClasses.ColorSet=sf;var lf=function(e){function t(){var t=e.call(this)||this;t._list=[],t._currentStep=0,t._startIndex=0,t._currentPass=0,t.baseColor=new lc({r:103,g:183,b:220}),t.className="PatternSet";var i=new Xh;return t.list=[t.getLinePattern(1e3,45,1,6),t.getRectPattern(10,0,4),t.getLinePattern(1e3,-45,1,6),t.getCirclePattern(11,2,!0),t.getLinePattern(6,90,1),t.getRectPattern(12,45,6,!0),t.getLinePattern(6,0,1),t.getRectPattern(7,0,4),t.getLinePattern(1e3,45,2,3,"4,2"),t.getCirclePattern(9,3,!1),t.getLinePattern(1e3,-45,2,3,"4,2"),t.getRectPattern(10,45,Math.sqrt(50)),t.getLinePattern(1e3,-45,2,1),t.getRectPattern(10,0,9),t.getLinePattern(1e3,45,2,1),t.getLinePattern(1e3,0,3,1),t.getRectPattern(10,45,10),t.getLinePattern(1e3,90,3,1)],t.baseColor=i.getFor("stroke"),t.applyTheme(),t}return Us(t,e),t.prototype.getLinePattern=function(e,t,i,n,r){var a=new Qd;return a.width=e,a.height=e,a.stroke=this.baseColor,a.gap=n,a.strokeDasharray=r,a.strokeWidth=i,a.rotation=t,a},t.prototype.getRectPattern=function(e,t,i,n){var r=new tf;return r.width=e,r.height=e,r.rectWidth=i,r.rectHeight=i,n?(r.stroke=this.baseColor,r.strokeWidth=1,r.fillOpacity=0):(r.fill=this.baseColor,r.strokeWidth=0),0!=t&&(r.shapeRendering="auto"),r.rotation=t,r},t.prototype.getCirclePattern=function(e,t,i){var n=new ef;return n.width=e,n.height=e,n.shapeRendering="auto",n.radius=t,i?(n.stroke=this.baseColor,n.strokeWidth=1,n.fillOpacity=0):(n.fill=this.baseColor,n.strokeWidth=0),n},Object.defineProperty(t.prototype,"list",{get:function(){return this._list},set:function(e){this._list=e,this.reset()},enumerable:!0,configurable:!0}),t.prototype.next=function(){var e=this.getIndex(this.currentStep);return this._currentStep++,e},t.prototype.getIndex=function(e){for(;this.list.length<=e;)this.generatePatterns();return this.list[e].clone()},t.prototype.generatePatterns=function(){var e=this.list.length/(this._currentPass+1);this._currentPass++;for(var t=0;t<e;t++)this.list.push(this.list[t].clone())},t.prototype.reset=function(){this._currentStep=this._startIndex},Object.defineProperty(t.prototype,"currentStep",{get:function(){return this._currentStep},set:function(e){this._currentStep=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startIndex",{get:function(){return this._startIndex},set:function(e){this._startIndex=e,this.reset()},enumerable:!0,configurable:!0}),t.prototype.processConfig=function(t){e.prototype.processConfig.call(this,t)},t}(hc);Bu.registeredClasses.PatternSet=lf;!function(){function e(){this._disposed=!1,this._disposers=[]}e.prototype.init=function(){},e.prototype.isDisposed=function(){return this._disposed},e.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;var e=this._disposers;for(this._disposers=null;0!==e.length;){e.shift().dispose()}}}}();var uf=function(e){function t(){var t=e.call(this)||this;t.className="AmChartsLogo",t.valign="bottom";var i=.3;t.opacity=.3,t.defaultState.properties.opacity=.4,t.url="https://www.amcharts.com/",t.urlTarget="_blank",t.showSystemTooltip=!0,t.readerTitle="Chart created using amCharts library",t.width=66,t.height=21,t.background.opacity=0;var n=uc("#474758");"#ffffff"==(new Xh).getFor("background").alternative.hex&&(n=uc("#ffffff"));var r=new _p;r.addColor(n),r.addColor(n,1,.75),r.addColor(uc("#3cabff"),1,.755),r.rotation=-10;var a=r,o=t.createChild(kd);o.shouldClone=!1,o.isMeasured=!1,o.segments=[[{x:15,y:15},{x:27,y:15},{x:36,y:6},{x:40.5,y:10.5},{x:45,y:6},{x:54,y:15},{x:60,y:15}]],o.strokeWidth=6*i,o.tensionX=.8,o.tensionY=1,o.stroke=uc("#3cabff");var s=t.createChild(kd);s.shouldClone=!1,s.isMeasured=!1,s.segments=[[{x:6,y:15},{x:15,y:15},{x:27,y:12*i},{x:39.9,y:15},{x:51,y:15},{x:60,y:15}]],s.strokeWidth=6*i,s.tensionX=.75,s.tensionY=1,s.stroke=a,t._disposers.push(s);var l=new rf;t.filters.push(l);var u=new rf;u.saturation=1;var c=t.states.create("hover");return c.properties.opacity=1,c.filters.push(u),t.applyTheme(),t}return Us(t,e),t}(Wp);function cf(e,t){var i,n=Oh(e),r=!1;if(n||((n=document.createElement("div")).style.width="200px",n.style.height="200px",n.style.top="0",n.style.left="0",n.style.visibility="hidden",n.style.position="absolute",document.body.appendChild(n),r=!0),n){n.innerHTML="";var a=new fp(n),o=new mp(a.SVGContainer,"svg-"+(dp.length-1)),s=new Wp;s.htmlContainer=n,s.svgContainer=a,s.width=Ks(100),s.height=Ks(100),s.background.fillOpacity=0,s.paper=o,o.append(s.group),r&&(i=function(){s.moveHtmlContainer(e)},"loading"!==document.readyState?i():document.addEventListener("readystatechange",(function e(){"loading"!==document.readyState&&(document.removeEventListener("readystatechange",e),i())}))),s.relativeWidth=1,s.relativeHeight=1,a.container=s;var l=s.createChild(t);l.topParent=s;var u=l.uid;Bu.invalidSprites[u]=[],Bu.invalidDatas[u]=[],Bu.invalidPositions[u]=[],Bu.invalidLayouts[u]=[],s.baseId=u,l.isBaseSprite=!0,l.focusFilter=new of,Bu.baseSprites.push(l),Bu.baseSpritesByUid[u]=l,l.maskRectangle={x:0,y:0,width:Math.max(a.width||0,0),height:Math.max(a.height||0,0)},s.events.on("maxsizechanged",(function(e){0!=e.previousWidth&&0!=e.previousHeight||s.deepInvalidate(),l.maskRectangle&&(l.maskRectangle={x:0,y:0,width:Math.max(a.width||0,0),height:Math.max(a.height||0,0)})}));var c=null;!function e(){l.isDisposed()?c=null:null==Bh(l.dom)?(_h.autoDispose?(s.htmlContainer=void 0,a.htmlElement=void 0,l.dispose()):lp("Chart was not disposed",l.uid),c=null):c=window.setTimeout(e,1e3)}(),l.addDisposer(new eu((function(){null!==c&&clearTimeout(c),Gl(Bu.baseSprites,l),Bu.baseSpritesByUid[l.uid]=void 0}))),l.addDisposer(s);var h=s.createChild(Wp);h.topParent=s,h.width=Ks(100),h.height=Ks(100),h.isMeasured=!1,s.tooltipContainer=h,l.tooltip=new Ld,l.tooltip.hide(0),l.tooltip.setBounds({x:0,y:0,width:h.maxWidth,height:h.maxHeight}),h.events.on("maxsizechanged",(function(){rl(l.tooltip).setBounds({x:0,y:0,width:h.maxWidth,height:h.maxHeight})}),void 0,!1);var p=new Sd;if(p.events.on("inited",(function(){p.__disabled=!0}),void 0,!1),s.preloader=p,l instanceof Wp&&!l.hasLicense()){var d=h.createChild(uf);h.events.on("maxsizechanged",(function(e){h.maxWidth<=100||h.maxHeight<=50?d.hide():(d.isHidden||d.isHiding)&&d.show()}),void 0,!1),l.logo=d,d.align="left",d.valign="bottom"}if(l.numberFormatter,s.isStandaloneInstance=!0,_h.onlyShowOnViewport)if(Hh(n,_h.viewportTarget))_h.queue&&hf(l);else{l.__disabled=!0,l.tooltipContainer.__disabled=!0;var f=[Ih(window,"DOMContentLoaded",(function(){df(l)})),Ih(window,"load",(function(){df(l)})),Ih(window,"resize",(function(){df(l)})),Ih(window,"scroll",(function(){df(l)}))];if(_h.viewportTarget)for(var m=cl(_h.viewportTarget)?_h.viewportTarget:_h.viewportTarget?[_h.viewportTarget]:[],v=0;v<m.length;v++){var y=m[v];f.push(Ih(y,"resize",(function(){df(l)}))),f.push(Ih(y,"scroll",(function(){df(l)})))}var g=new tu(f);l.addDisposer(g),l.vpDisposer=g}else _h.queue&&hf(l);return l}throw Zp.log("html container not found"),new Error("html container not found")}function hf(e){-1==Bu.queue.indexOf(e)&&(e.__disabled=!0,e.tooltipContainer.__disabled=!0,e.events.disableType("appeared"),0==Bu.queue.length&&(Bu.events.once("exitframe",(function(){ff(e)})),Zp.requestFrame()),e.addDisposer(new eu((function(){pf(e)}))),Bu.queue.push(e))}function pf(e){var t=Bu.queue.indexOf(e);if(t>=0){Bu.queue.splice(Bu.queue.indexOf(e),1);var i=Bu.queue[t];i&&ff(i)}}function df(e){e.__disabled&&Hh(e.htmlContainer,_h.viewportTarget)&&(e.vpDisposer&&e.vpDisposer.dispose(),hf(e))}function ff(e){e&&e.tooltipContainer&&(e.__disabled=!1,e.tooltipContainer.__disabled=!1,e.events.enableType("appeared"),e.dispatch("removedfromqueue"),e.showOnInit&&e.events.on("appeared",(function(){pf(e)})),e.vpDisposer&&e.vpDisposer.dispose(),e instanceof Wp&&e.invalidateLabels(),e.tooltipContainer&&e.tooltipContainer.invalidateLayout(),e instanceof nd?(e.invalidateData(),e.reinit(),e.events.once("datavalidated",(function(){e.showOnInit?e.appear():pf(e)}))):(e.reinit(),e.events.once("inited",(function(){pf(e)})),e.showOnInit&&e.appear()))}var mf=function(e){function t(){var t=e.call(this)||this;return t.childrenCreated=!1,t.className="LegendDataItem",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"label",{get:function(){var e=this;if(!this._label){var t=this.component.labels.create();this._label=t,this.addSprite(t),this._disposers.push(t),t.parent=this.itemContainer,this._disposers.push(new eu((function(){nl(e.component)&&e.component.labels.removeValue(t)})))}return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.properties.color},set:function(e){this.setProperty("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueLabel",{get:function(){var e=this;if(!this._valueLabel){var t=this.component.valueLabels.create();this._valueLabel=t,this.addSprite(t),this._disposers.push(t),t.parent=this.itemContainer,this._disposers.push(new eu((function(){nl(e.component)&&e.component.valueLabels.removeValue(t)})))}return this._valueLabel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemContainer",{get:function(){var e=this;if(!this._itemContainer){var t=this.component,i=t.itemContainers.create();i.parent=t,this._itemContainer=i,this.addSprite(i),this._disposers.push(i),i.togglable&&i.events.on("toggled",(function(e){t.toggleDataItem(e.target.dataItem)}),void 0,!1),i.focusable&&(i.events.on("hit",(function(e){t.focusedItem=void 0}),void 0,!1),i.events.on("focus",(function(e){t.focusedItem=e.target.dataItem}),void 0,!1),i.events.on("blur",(function(e){t.focusedItem=void 0}),void 0,!1)),this._disposers.push(new eu((function(){nl(e.component)&&e.component.itemContainers.removeValue(i)}))),this.dataContext.uidAttr&&(i.readerControls=this.dataContext.uidAttr(),i.readerLabelledBy=this.dataContext.uidAttr());var n=this.dataContext;if((n instanceof id||n instanceof Up)&&!n.isDisposed()){var r=function(e){i.readerChecked=e.visible,i.events.disableType("toggled"),i.isActive=!e.visible,i.events.enableType("toggled")};n.addDisposer(new eu((function(){e.component&&e.component.dataItems.remove(e)}))),n instanceof Up?(i.addDisposer(n.events.on("visibilitychanged",r,void 0,!1)),i.addDisposer(n.events.on("hidden",(function(e){i.readerChecked=!1,i.events.disableType("toggled"),i.isActive=!0,i.events.enableType("toggled")}),void 0,!1)),i.addDisposer(n.events.on("shown",(function(e){i.readerChecked=!0,i.events.disableType("toggled"),i.isActive=!1,i.events.enableType("toggled")}),void 0,!1))):i.addDisposer(n.events.on("visibilitychanged",r,void 0,!1))}}return this._itemContainer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marker",{get:function(){var e=this;if(!this._marker){var t=this.component.markers.create();this._marker=t,t.parent=this.itemContainer,this.addSprite(t),this._disposers.push(t),this._disposers.push(new eu((function(){nl(e.component)&&e.component.markers.removeValue(t)})))}return this._marker},enumerable:!0,configurable:!0}),t}(id),vf=function(){this.createMarker=!0},yf=function(e){function t(){var t=e.call(this)||this;t.className="Legend",t.layout="grid",t.setPropertyValue("useDefaultMarker",!1),t.setPropertyValue("scrollable",!1),t.setPropertyValue("contentAlign","center");var i=new Wp;i.applyOnClones=!0,i.padding(8,0,8,0),i.margin(0,10,0,10),i.layout="horizontal",i.clickable=!0,i.focusable=!0,i.role="switch",i.togglable=!0,i.cursorOverStyle=wp.pointer,i.background.fillOpacity=0,t.itemContainers=new Hu(i),t._disposers.push(new Uu(t.itemContainers)),t._disposers.push(t.itemContainers.template),t._disposers.push(ap().body.events.on("keyup",(function(e){if(ep.isKey(e.event,"enter")&&t.focusedItem){var i=t.focusedItem,n=i.itemContainer;n.togglable?t.toggleDataItem(i):n.clickable&&n.events.isEnabled("hit")&&(n.dispatchImmediately("hit",{event:e}),t.focusedItem=i)}}),t));var n=new Xh,r=new Wp;r.width=23,r.height=23,r.interactionsEnabled=!1,r.applyOnClones=!0,r.setStateOnChildren=!0,r.background.fillOpacity=0,r.background.strokeOpacity=0,r.propertyFields.fill="fill",r.valign="middle";var a=n.getFor("disabledBackground");r.events.on("childadded",(function(e){var t=e.newValue.states.create("active");t.properties.stroke=a,t.properties.fill=a})),t.markers=new Hu(r),t._disposers.push(new Uu(t.markers)),t._disposers.push(t.markers.template);var o=r.createChild(ad);o.width=Ks(100),o.height=Ks(100),o.applyOnClones=!0,o.propertyFields.fill="fill",o.strokeOpacity=0;var s=new rd;s.text="{name}",s.margin(0,5,0,5),s.valign="middle",s.applyOnClones=!0,s.states.create("active").properties.fill=n.getFor("disabledBackground"),t.labels=new Hu(s),t._disposers.push(new Uu(t.labels)),t._disposers.push(t.labels.template),s.interactionsEnabled=!1,s.truncate=!0,s.fullWords=!1;var l=new rd;return l.margin(0,5,0,0),l.valign="middle",l.width=50,l.align="right",l.textAlign="end",l.applyOnClones=!0,l.states.create("active").properties.fill=n.getFor("disabledBackground"),l.interactionsEnabled=!1,t.valueLabels=new Hu(l),t._disposers.push(new Uu(t.valueLabels)),t._disposers.push(t.valueLabels.template),t.position="bottom",i.states.create("active"),i.setStateOnChildren=!0,t.role="group",t.events.on("layoutvalidated",t.handleScrollbar,t,!1),t.applyTheme(),t}return Us(t,e),t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Legend"))},t.prototype.createDataItem=function(){return new mf},t.prototype.validateDataElements=function(){this.scrollbar&&(this.scrollbar.start=0,this.scrollbar.end=1),e.prototype.validateDataElements.call(this)},t.prototype.validateDataElement=function(t){e.prototype.validateDataElement.call(this,t);var i=t.itemContainer,n=t.marker;t.label;var r=t.valueLabel;i.readerChecked=t.dataContext.visible,t.dataContext.legendDataItem=t;var a=t.label.maxWidth;t.label.width instanceof Xs||(t.label.width=void 0),a>0&&(t.label.maxWidth=a),"right"==r.align&&(r.width=void 0);var o=t.dataContext.legendSettings,s=t.dataContext;!s.createLegendMarker||this.useDefaultMarker&&s instanceof Up?this.markers.template.propertyFields.fill=void 0:t.childrenCreated||(s.createLegendMarker(n),t.childrenCreated=!0),s.updateLegendValue&&s.updateLegendValue(),s.component&&s.component.updateLegendValue&&s.component.updateLegendValue(s),r.invalid&&r.validate(),""==r.text||void 0==r.text?r.__disabled=!0:r.__disabled=!1,!o||void 0==o.itemValueText&&void 0==o.valueText||(r.__disabled=!1);var l=t.dataContext.visible;void 0===l&&(l=!0),l=Qs(l),t.dataContext.visible=l,i.events.disableType("toggled"),i.isActive=!l,i.isActive?i.setState("active",0):i.setState("default",0),i.events.enableType("toggled")},t.prototype.afterDraw=function(){var t=this,i=this.getPropertyValue("maxWidth"),n=0;this.labels.each((function(e){e.invalid&&(e.maxWidth=void 0,e.validate()),e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight>n&&(n=e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight)}));var r=0;this.valueLabels.each((function(e){e.invalid&&e.validate(),e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight>r&&(r=e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight)}));var a=0;this.markers.each((function(e){e.invalid&&e.validate(),e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight>a&&(a=e.measuredWidth+e.pixelMarginLeft+e.pixelMarginRight)}));var o,s=this.itemContainers.template,l=s.pixelMarginRight+s.pixelMarginLeft,u=n+r+a;ll(i)?((i-=l)>u&&(i=u),o=i-a-r):o=n,this.labels.each((function(e){("right"==t.valueLabels.template.align||e.measuredWidth>o)&&(e.width instanceof Xs||(e.width=Math.min(e.maxWidth,o-e.pixelMarginLeft-e.pixelMarginRight),e.maxWidth=e.width))})),"right"==this.valueLabels.template.align&&this.valueLabels.each((function(e){e.width=r-e.pixelMarginRight-e.pixelMarginLeft})),e.prototype.afterDraw.call(this)},t.prototype.handleScrollbar=function(){var e=this.scrollbar;this.scrollable&&e&&(e.height=this.measuredHeight,e.x=this.measuredWidth-e.pixelWidth-e.pixelMarginLeft,this.contentHeight>this.measuredHeight?(e.visible=!0,e.thumb.height=e.height*this.measuredHeight/this.contentHeight,this.paddingRight=e.pixelWidth+e.pixelMarginLeft+ +e.pixelMarginRight):e.visible=!1,this.updateMasks())},Object.defineProperty(t.prototype,"position",{get:function(){return this.getPropertyValue("position")},set:function(e){this.setPropertyValue("position",e)&&("left"==e||"right"==e?(this.margin(10,5,10,10),this.valign="middle",this.contentAlign="none",this.valueLabels.template.align="right",ll(this.maxColumns)||(this.maxColumns=1),this.width=void 0,this.maxWidth=220):(this.maxColumns=void 0,this.width=Ks(100),this.valueLabels.template.align="left"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useDefaultMarker",{get:function(){return this.getPropertyValue("useDefaultMarker")},set:function(e){this.setPropertyValue("useDefaultMarker",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollable",{get:function(){return this.getPropertyValue("scrollable")},set:function(e){if(this.setPropertyValue("scrollable",e,!0))if(e){var t=this.createChild(Md);this.scrollbar=t,t.isMeasured=!1,t.orientation="vertical",t.endGrip.__disabled=!0,t.startGrip.__disabled=!0,t.visible=!1,t.marginLeft=5,this._mouseWheelDisposer=this.events.on("wheel",this.handleWheel,this,!1),this._disposers.push(this._mouseWheelDisposer),this._disposers.push(t.events.on("rangechanged",this.updateMasks,this,!1))}else this._mouseWheelDisposer&&(this._mouseWheelDisposer.dispose(),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=void 0))},enumerable:!0,configurable:!0}),t.prototype.handleWheel=function(e){var t=e.shift.y,i=this.scrollbar;if(i){var n=t/1e3*this.measuredHeight/this.contentHeight,r=i.end-i.start;t>0?(i.start=xl(0,i.start-n),i.end=i.start+r):(i.end=wl(1,i.end-n),i.start=i.end-r)}},t.prototype.updateMasks=function(){var e=this;this.scrollbar&&this.itemContainers.each((function(t){t.dy=-e.scrollbar.thumb.pixelY*e.contentHeight/e.measuredHeight,t.maskRectangle={x:0,y:-t.dy,width:e.measuredWidth,height:e.measuredHeight}}))},t.prototype.toggleDataItem=function(e){var t=e.dataContext;!t.visible||t.isHiding||t instanceof Up&&t.isHidden?(e.color=e.colorOrig,t.appeared=!0,e.itemContainer.isActive=!1,!0===t.hidden&&(t.hidden=!1),t.show?t.show():t.visible=!0,this.svgContainer.readerAlert(this.language.translate("%1 shown",this.language.locale,e.label.readerTitle))):(e.itemContainer.isActive=!0,t.appeared=!0,t.hide?t.hide():t.visible=!1,this.svgContainer.readerAlert(this.language.translate("%1 hidden",this.language.locale,e.label.readerTitle)),e.color=(new Xh).getFor("disabledBackground"))},Object.defineProperty(t.prototype,"preloader",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.handleDataItemPropertyChange=function(e,t){e.valueLabel.invalidate(),e.label.invalidate()},t}(nd);Bu.registeredClasses.Legend=yf,ed.push({relevant:td.widthXS,state:function(e,t){if(e instanceof yf&&("left"==e.position||"right"==e.position)){var i=e.states.create(t);return i.properties.position="bottom",i}return null}}),ed.push({relevant:td.heightXS,state:function(e,t){if(e instanceof yf&&("top"==e.position||"bottom"==e.position)){var i=e.states.create(t);return i.properties.position="right",i}return null}}),ed.push({relevant:td.isXS,state:function(e,t){if(e instanceof yf){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var gf=function(e){function t(){var t=e.call(this)||this;t._axis=new iu,t.dataItems=new Wu,t.className="AxisBreak",t.breakSize=.01,t.marginLeft=-5,t.marginRight=-5,t.marginTop=-5,t.marginBottom=-5;var i=new Xh,n=new Wd;n.fill=i.getFor("background"),n.stroke=uc(),n.fillOpacity=.9,n.zIndex=0,t._fillShape=n;var r=new Wd;r.fill=uc(),r.stroke=i.getFor("grid"),r.strokeOpacity=.3,r.zIndex=1,t._startLine=r;var a=new Wd;return a.fill=uc(),a.stroke=uc("#000000"),a.strokeOpacity=.3,a.zIndex=2,t._endLine=a,t._disposers.push(t._axis),t.applyTheme(),t}return Us(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._fillShape&&this._fillShape.dispose(),this._startLine&&this._startLine.dispose(),this._endLine&&this._endLine.dispose()},Object.defineProperty(t.prototype,"startLine",{get:function(){return this._startLine},set:function(e){this._startLine&&this._startLine.dispose(),this._startLine=e,this.addBreakSprite(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endLine",{get:function(){return this._endLine},set:function(e){this._endLine&&this._endLine.dispose(),this._endLine=e,this.addBreakSprite(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillShape",{get:function(){return this._fillShape},set:function(e){this._fillShape&&this._fillShape.dispose(),this._fillShape=e,this.addBreakSprite(e)},enumerable:!0,configurable:!0}),t.prototype.addBreakSprite=function(e){e.parent=this,e.isMeasured=!1,this._disposers.push(e)},Object.defineProperty(t.prototype,"axis",{get:function(){return this._axis.get()},set:function(e){if(this._axis.get()!==e){this._axis.set(e,e.renderer.gridContainer.events.on("transformed",this.invalidate,this,!1)),e.renderer.createBreakSprites(this);var t=e.axisBreaks.template;this.startLine.copyFrom(t.startLine),this.endLine.copyFrom(t.endLine),this.fillShape.copyFrom(t.fillShape)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"breakSize",{get:function(){return this.getPropertyValue("breakSize")},set:function(e){this.setPropertyValue("breakSize",e)&&this.axis&&(this.axis.invalidate(),this.axis.invalidateSeries())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPoint",{get:function(){var e=this.axis.renderer;if(e)return e.positionToPoint(this.startPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPoint",{get:function(){var e=this.axis.renderer;if(e)return e.positionToPoint(this.endPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPosition",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPosition",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.draw=function(){(e.prototype.draw.call(this),this.axis)&&this.axis.renderer.updateBreakElement(this)},Object.defineProperty(t.prototype,"startValue",{get:function(){return this.getPropertyValue("startValue")},set:function(e){this.setPropertyValue("startValue",e)&&this.axis&&(this.axis.invalidate(),this.axis.invalidateSeries())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endValue",{get:function(){return this.getPropertyValue("endValue")},set:function(e){this.setPropertyValue("endValue",e)&&this.axis&&(this.axis.invalidate(),this.axis.invalidateSeries())},enumerable:!0,configurable:!0}),t}(Wp);Bu.registeredClasses.AxisBreak=gf;var _f,bf=function(e){function t(){var t=e.call(this)||this;return t.className="AxisDataItem",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"grid",{get:function(){if(!this._grid){var e=this.component;if(e){var t,i=void 0;if(this.isRange){if((i=e.axisRanges.template.grid).disabled)return;t=i.clone()}else{if((i=e.renderer.grid.template).disabled)return;t=e.renderer.grid.create(),this._disposers.push(new eu((function(){e.renderer.grid.removeValue(t)})))}this.grid=t,t.shouldClone=!1,this._disposers.push(t),t.axis=this.component}}return this._grid},set:function(e){this._grid&&this._grid!=e&&(Gl(this.sprites,this._grid),this._grid.dataItem=void 0),e&&(e.dataItem&&e.dataItem!=this&&(Gl(e.dataItem.sprites,e),e.dataItem.grid=void 0),this.addSprite(e)),this._grid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tick",{get:function(){if(!this._tick){var e=this.component;if(e){var t,i=void 0;if(this.isRange){if((i=e.axisRanges.template.tick).disabled)return;t=i.clone()}else{if((i=e.renderer.ticks.template).disabled)return;t=e.renderer.ticks.create(),this._disposers.push(new eu((function(){e.renderer.ticks.removeValue(t)})))}this.tick=t,t.axis=this.component,t.shouldClone=!1,this._disposers.push(t)}}return this._tick},set:function(e){this._tick&&this._tick!=e&&(Gl(this.sprites,this._tick),this._tick.dataItem=void 0),e&&(e.dataItem&&e.dataItem!=this&&(Gl(e.dataItem.sprites,e),e.dataItem.tick=void 0),this.addSprite(e)),this._tick=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){if(!this._label){var e=this.component;if(e){var t,i=void 0;if(this.isRange){if((i=e.axisRanges.template.label).disabled)return;t=i.clone()}else{if((i=e.renderer.labels.template).disabled)return;t=e.renderer.labels.create(),this._disposers.push(new eu((function(){e.renderer.labels.removeValue(t)})))}this._disposers.push(t),this.label=t,t.shouldClone=!1,t.axis=this.component,t.virtualParent=e}}return this._label},set:function(e){this._label&&this._label!=e&&(Gl(this.sprites,this._label),this._label.dataItem=void 0),e&&(e.dataItem&&e.dataItem!=this&&(Gl(e.dataItem.sprites,e),e.dataItem.label=void 0),this.addSprite(e)),this._label=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisFill",{get:function(){if(!this._axisFill){var e=this.component;if(e){var t,i=void 0;if(this.isRange){if(i=e.axisRanges.template.axisFill,!this.isTemplate&&i.disabled)return;t=i.clone()}else{if((i=e.renderer.axisFills.template).disabled)return;t=e.renderer.axisFills.create(),this._disposers.push(new eu((function(){e.renderer.axisFills.removeValue(t)})))}this.axisFill=t,t.shouldClone=!1,this._disposers.push(t)}}return this._axisFill},set:function(e){this._axisFill&&this._axisFill!=e&&(Gl(this.sprites,this._axisFill),this._axisFill.dataItem=void 0),e&&(e.dataItem&&e.dataItem!=this&&(Gl(e.dataItem.sprites,e),e.dataItem.axisFill=void 0),e.axis=this.component,this.addSprite(e)),this._axisFill=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._label&&(this._label.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contents",{get:function(){if(!this._contents){var e=new Wp;this.addSprite(e),e.isMeasured=!1,this._contents=e;var t=this.component;if(t){var i=t.renderer.createFill(this.component);i.disabled=!1,i.axis=t,this.addSprite(i),this._mask=i,e.mask=i}}return this._contents},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisBreak",{get:function(){return this._axisBreak},set:function(e){this._axisBreak&&this._axisBreak.dataItems.removeValue(this),e&&e.dataItems.push(this),this._axisBreak=e},enumerable:!0,configurable:!0}),t.prototype.validate=function(){this.component&&this.component.validateDataElement(this)},t.prototype.appendChildren=function(){this.component&&this.component.appendDataItem(this)},t.prototype.hasProperty=function(t){return"component"==t||e.prototype.hasProperty.call(this,t)},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.text=t.text,t.bullet&&(this.bullet=t.bullet.clone()),this.minPosition=t.minPosition,this.maxPosition=t.maxPosition},t.prototype.setVisibility=function(t,i){e.prototype.setVisibility.call(this,t,i),this._contents&&(this._contents.visible=t)},Object.defineProperty(t.prototype,"bullet",{get:function(){return this._bullet},set:function(e){this._bullet&&this._bullet!=e&&(Gl(this.sprites,this._bullet),this._bullet.dataItem=void 0),this._bullet=e,e&&this.addSprite(e)},enumerable:!0,configurable:!0}),t}(id);!function(e){e[e.Start=0]="Start",e[e.Middle=.5]="Middle",e[e.End=1]="End"}(_f||(_f={}));var xf=function(e){function t(){var i=e.call(this)||this;if(i._gridCount=10,i._series=new Wu,i.autoDispose=!0,i._axisItemCount=0,i.constructor===t)throw new Error("'Axis' cannot be instantiated directly. Please use a specific axis type.");i.hideTooltipWhileZooming=!0,i.minWidth=1e-4,i.minHeight=1e-4,i.className="Axis",i.shouldClone=!1,i.setPropertyValue("cursorTooltipEnabled",!0),i.toggleZoomOutButton=!0,i.zoomable=!0;var n=new Xh;i.title=new rd,i.title.shouldClone=!1,i._disposers.push(i.title),i.setPropertyValue("startLocation",0),i.setPropertyValue("endLocation",1),i._dataItemsIterator=new Ou(i.dataItems,(function(){return i.dataItems.create()})),i._dataItemsIterator.createNewItems=!0;var r=new Ld;i._disposers.push(r),r.label.padding(5,10,5,10),r.background.pointerLength=5,r.fitPointerToBounds=!0,r.background.filters.clear(),r.virtualParent=i;var a=r.background;return a.cornerRadius=0,a.fill=n.getFor("alternativeBackground"),a.stroke=a.fill,a.strokeWidth=1,a.fillOpacity=1,r.label.fill=n.getFor("alternativeText"),i.tooltip=r,i.readerHidden=!0,i.events.on("rangechangestarted",(function(){i.series.each((function(e){e.hideTooltipWhileZooming&&(e.tooltip.hide(),e.tooltip.preventShow=!0)})),i.hideTooltipWhileZooming&&(i.tooltip.hide(),i.tooltip.preventShow=!0)}),void 0,!1),i.events.on("rangechangeended",(function(){i.series.each((function(e){e.hideTooltipWhileZooming&&(e.tooltip.hide(),e.tooltip.preventShow=!1)})),i.hideTooltipWhileZooming&&(i.tooltip.hide(),i.tooltip.preventShow=!1)}),void 0,!1),i.applyTheme(),i}return Us(t,e),t.prototype.fillRule=function(e,t){ll(t)||(t=e.index),t/2==Math.round(t/2)?(e.axisFill.__disabled=!0,e.axisFill.opacity=0):(e.axisFill.opacity=1,e.axisFill.__disabled=!1)},t.prototype.createDataItem=function(){return new bf},t.prototype.invalidateLayout=function(){e.prototype.invalidateLayout.call(this),Tu(this.series.iterator(),(function(e){e.invalidateLayout()}))},t.prototype.invalidateSeries=function(){Tu(this.series.iterator(),(function(e){e.invalidate()}))},t.prototype.validateDataElements=function(){this._axisItemCount=0,this.ghostLabel&&(this.renderer.updateLabelElement(this.ghostLabel,this.start,this.end),this.ghostLabel.validate())},t.prototype.updateGridCount=function(){if(this.renderer){var e=this.axisLength/this.renderer.minGridDistance;e!=this._gridCount&&(this._gridCount=e,this.clearCache())}},t.prototype.validateLayout=function(){this.axisFullLength=this.axisLength/(this.end-this.start),e.prototype.validateLayout.call(this),this.updateGridCount();var t=this.renderer;t&&(t.updateAxisLine(),t.updateTooltip(),t.updateBaseGridElement()),this._prevLength!=this.axisLength&&(this.dispatchImmediately("lengthchanged"),this._prevLength=this.axisLength)},t.prototype.initRenderer=function(){},t.prototype.appendDataItem=function(e){var t=this.renderer,i=e.tick;i&&(i.above?i.parent=t.bulletsContainer:i.parent=t.gridContainer),e.label&&(e.label.parent=t);var n=e.axisFill;n&&(n.above?n.parent=t.bulletsContainer:n.parent=t.gridContainer);var r=e.grid;r&&(r.above?r.parent=t.bulletsContainer:r.parent=t.gridContainer),e.bullet&&(e.bullet.parent=t.bulletsContainer)},t.prototype.validate=function(){e.prototype.validate.call(this),this.validateLayout(),this.renderer.updateGridContainer()},t.prototype.validateAxisRanges=function(){var e=this;Tu(this.axisRanges.iterator(),(function(t){e.appendDataItem(t),e.validateDataElement(t),t.grid&&t.grid.validate(),t.tick&&t.tick.validate(),t.axisFill&&t.axisFill.validate(),t.label&&t.label.validate()}))},t.prototype.validateBreaks=function(){this._axisBreaks&&Tu(this._axisBreaks.iterator(),(function(e){e.invalidate()}))},t.prototype.processBreak=function(e){var t=e.newValue;t.parent=this.renderer.breakContainer,t.axis=this},t.prototype.registerSeries=function(e){var t=this;return this.series.moveValue(e),new tu([new eu((function(){t.series.removeValue(e)})),this.events.on("lengthchanged",e.invalidate,e,!1),this.events.on("lengthchanged",e.createMask,e,!1),this.events.on("startchanged",e.invalidate,e,!1),this.events.on("endchanged",e.invalidate,e,!1)])},Object.defineProperty(t.prototype,"renderer",{get:function(){return this._renderer},set:function(e){if(e!=this._renderer){this._renderer=e,e.chart=this.chart,e.axis=this,e.parent=this,this.title.parent=this,this.initRenderer(),this._disposers.push(e.gridContainer.events.on("maxsizechanged",this.invalidate,this,!1));var t=this.renderer.labels.create();this._disposers.push(t),t.dataItem=this.dataItems.template.clone(),t.text="L",t.parent=this.renderer,t.shouldClone=!1,t.fillOpacity=0,t.opacity=0,t.strokeOpacity=0,t.interactionsEnabled=!1,t.validate(),this.ghostLabel=t,this.events.on("beforedatavalidated",(function(){t.text="L"}),void 0,!1)}},enumerable:!0,configurable:!0}),t.prototype.positionToAngle=function(e){return this.renderer.positionToAngle(e)},t.prototype.pointToPosition=function(e){return this.renderer.pointToPosition(e)},t.prototype.positionToCoordinate=function(e){return this.renderer.positionToCoordinate(e)},t.prototype.getAnyRangePath=function(e,t){return this.renderer.getPositionRangePath(e,t)},t.prototype.anyToPosition=function(e){return 0},t.prototype.anyToPoint=function(e){return{x:0,y:0,angle:0}},t.prototype.getPositionRangePath=function(e,t){return this.renderer?this.renderer.getPositionRangePath(e,t):""},Object.defineProperty(t.prototype,"axisLength",{get:function(){return this.renderer?this.renderer.axisLength:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursorTooltipEnabled",{get:function(){return this.getPropertyValue("cursorTooltipEnabled")},set:function(e){this.setPropertyValue("cursorTooltipEnabled",e)&&(e&&this.renderer?this.renderer.updateTooltip():this.tooltip&&this.tooltip.hide(0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toggleZoomOutButton",{get:function(){return this.getPropertyValue("toggleZoomOutButton")},set:function(e){this.setPropertyValue("toggleZoomOutButton",e)},enumerable:!0,configurable:!0}),t.prototype.hideTooltip=function(t){e.prototype.hideTooltip.call(this,t),this._tooltipPosition=void 0},t.prototype.showTooltipAtPosition=function(e,t){var i=this._tooltip;if(!i||this.dataItems.length<=0)this._tooltipPosition=void 0;else{if(t||(e=this.toAxisPosition(e)),!ll(e)||e<this.start||e>this.end)return i.hide(0),void(this._tooltipPosition=void 0);var n=this.renderer;i.parent||(i.parent=this.tooltipContainer);var r=n.tooltipLocation,a=this.getCellStartPosition(e),o=this.getCellEndPosition(e);if("fixed"==this.tooltipPosition&&(e=a+(o-a)*r),e=gl(e,this.start,this.end),this._tooltipPosition!=e){this._tooltipPosition=e;var s=n.tooltipLocation2,l=n.positionToPoint(a,s),u=n.positionToPoint(o,s);this.currentItemStartPoint=l,this.currentItemEndPoint=u,n.fullWidthTooltip&&(i.width=u.x-l.x,i.height=u.y-l.y);var c=Zc(n.positionToPoint(e,s),this.renderer.line);i.text=this.getTooltipText(e),i.text&&(i.delayedPointTo(c),i.show())}this.cursorTooltipEnabled&&!this.tooltip.disabled||i.hide(0)}},t.prototype.toAxisPosition=function(e){if(void 0!=(e=this.renderer.toAxisPosition(e)))return e*=this.end-this.start,e=this.renderer.inversed?this.end-e:this.start+e},t.prototype.toGlobalPosition=function(e){return this.renderer.inversed?e=this.end-e:e-=this.start,e/(this.end-this.start)},t.prototype.getTooltipText=function(e){},t.prototype.updateTooltip=function(e,t){var i=this._tooltip;i&&(i.fixDoc=!1,i.pointerOrientation=e,i.setBounds(Xc(t,this.renderer.line)))},t.prototype.roundPosition=function(e,t,i){return e},t.prototype.getCellStartPosition=function(e){return e},t.prototype.getCellEndPosition=function(e){return e},Object.defineProperty(t.prototype,"axisRanges",{get:function(){if(!this._axisRanges){var e=this.createDataItem();e.isRange=!0,e.axisFill=this.renderer.axisFills.template.clone(),e.grid=this.renderer.grid.template.clone(),e.tick=this.renderer.ticks.template.clone(),e.label=this.renderer.labels.template.clone(),e.isTemplate=!0,e.component=this,e.axisFill.disabled=!1,e.tick.disabled=!1,e.grid.disabled=!1,e.label.disabled=!1,this._axisRanges=new Hu(e),this._axisRanges.events.on("inserted",this.processAxisRange,this,!1),this._disposers.push(new Uu(this._axisRanges)),this._disposers.push(this._axisRanges.template)}return this._axisRanges},enumerable:!0,configurable:!0}),t.prototype.processAxisRange=function(e){var t=e.newValue;t.component=this,t.isRange=!0},Object.defineProperty(t.prototype,"axisBreaks",{get:function(){return this._axisBreaks||(this._axisBreaks=new Ku(this.createAxisBreak(),(function(e,t){return Yu(e.adjustedStartValue,t.adjustedStartValue)})),this._axisBreaks.events.on("inserted",this.processBreak,this,!1),this._disposers.push(new Uu(this._axisBreaks)),this._disposers.push(this._axisBreaks.template)),this._axisBreaks},enumerable:!0,configurable:!0}),t.prototype.createAxisBreak=function(){return new gf},Object.defineProperty(t.prototype,"series",{get:function(){return this._series||(this._series=new Wu),this._series},enumerable:!0,configurable:!0}),t.prototype.processSeriesDataItems=function(){},t.prototype.processSeriesDataItem=function(e,t){},t.prototype.postProcessSeriesDataItems=function(e){},t.prototype.postProcessSeriesDataItem=function(e){},t.prototype.updateAxisBySeries=function(){},t.prototype.hideUnusedDataItems=function(){var e=this,t=this._dataItemsIterator;t.createNewItems=!1,Tu(t.iterator(),(function(t){e.validateDataElement(t),t.__disabled=!0})),t.clear(),t.createNewItems=!0},t.prototype.getSeriesDataItem=function(e,t,i){},t.prototype.getAngle=function(e,t,i,n,r){},t.prototype.getX=function(e,t,i,n,r){},t.prototype.getPositionX=function(e,t,i,n,r){},t.prototype.getY=function(e,t,i,n,r){},t.prototype.getPositionY=function(e,t,i,n,r){},Object.defineProperty(t.prototype,"basePoint",{get:function(){return{x:0,y:0}},enumerable:!0,configurable:!0}),t.prototype.dataChangeUpdate=function(){},t.prototype.seriesDataChangeUpdate=function(e){},t.prototype.adjustDifference=function(e,t){var i=t-e;if(ll(i))return this._axisBreaks&&Su(this._axisBreaks.iterator(),(function(n){var r=n.adjustedStartValue,a=n.adjustedEndValue;if(ll(r)&&ll(a)){if(r>t)return!1;if(a>=e&&ll(r)&&ll(a)){var o=n.breakSize,s=function(e,t){var i=rl(e.start),n=rl(t.start),r=rl(e.end),a=rl(t.end),o=Math.max(i,n),s=Math.min(r,a);return s<o?void 0:{start:o,end:s}}({start:r,end:a},{start:e,end:t});s&&(i-=(s.end-s.start)*(1-o))}return!0}})),i},t.prototype.isInBreak=function(e){if(this._axisBreaks)return Mu(this._axisBreaks.iterator(),(function(t){return e>=t.adjustedStartValue&&e<=t.adjustedEndValue}))},t.prototype.fixAxisBreaks=function(){var e=this;if(this._axisBreaks){var t=this._axisBreaks;if(t.length>0){Nl(Pu(t.iterator()),(function(t){var i=wl(t.startValue,t.endValue),n=xl(t.startValue,t.endValue);t.adjustedStartValue=i,t.adjustedEndValue=n,e._axisBreaks.update(t)}));var i=t.first,n=Math.min(i.startValue,i.endValue);Tu(t.iterator(),(function(e){var t=e.adjustedStartValue,i=e.adjustedEndValue;t<n&&(t=n,i<n&&(i=n)),e.adjustedStartValue=t,e.adjustedEndValue=i}))}}},Object.defineProperty(t.prototype,"startIndex",{get:function(){return 0},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endIndex",{get:function(){return this.dataItems.length},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.getPositionLabel=function(e){return Math.round(100*e)+"%x"},Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart=e},enumerable:!0,configurable:!0}),t.prototype.createSeriesRange=function(e){var t=this.axisRanges.create();return t.component=this,t.axisFill=this.renderer.axisFills.template.clone(),t.axisFill.disabled=!1,t.axisFill.fillOpacity=0,t.grid=this.renderer.grid.template.clone(),t.grid.disabled=!0,t.tick=this.renderer.ticks.template.clone(),t.tick.disabled=!0,t.label=this.renderer.labels.template.clone(),t.label.disabled=!0,t.addDisposer(new eu((function(){e.axisRanges.removeValue(t)}))),e.axisRanges.push(t),t},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.renderer?this.renderer.copyFrom(t.renderer):t.renderer&&(this.renderer=t.renderer.clone(),this._disposers.push(this.renderer)),t.title&&(this.title?this.title.copyFrom(t.title):(this.title=t.title.clone(),this.title.parent=this),this._disposers.push(this.title))},t.prototype.resetIterators=function(){this._dataItemsIterator.reset()},t.prototype.processConfig=function(t){if(t&&nl(t.axisRanges)&&cl(t.axisRanges))for(var i=0,n=t.axisRanges.length;i<n;i++){var r=t.axisRanges[i];nl(r.series)&&sl(r.series)&&this.map.hasKey(r.series)&&(t.axisRanges[i]=this.createSeriesRange(this.map.getKey(r.series)),delete r.series,t.axisRanges[i].config=r)}e.prototype.processConfig.call(this,t)},t.prototype.configOrder=function(t,i){return t==i?0:"title"==t?1:"title"==i||"component"==t?-1:"component"==i?1:e.prototype.configOrder.call(this,t,i)},Object.defineProperty(t.prototype,"startLocation",{get:function(){return this.getPropertyValue("startLocation")},set:function(e){this.setPropertyValue("startLocation",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endLocation",{get:function(){return this.getPropertyValue("endLocation")},set:function(e){this.setPropertyValue("endLocation",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.renderer&&(this.renderer.gridContainer.disabled=t),i},Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(e){this._title&&this._title!=e&&this._title.dispose(),e&&(this._title=e,e.parent=this,e.shouldClone=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideTooltipWhileZooming",{get:function(){return this.getPropertyValue("hideTooltipWhileZooming")},set:function(e){this.setPropertyValue("hideTooltipWhileZooming",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomable",{get:function(){return this.getPropertyValue("zoomable")},set:function(e){this.setPropertyValue("zoomable",e)},enumerable:!0,configurable:!0}),t}(nd);Bu.registeredClasses.Axis=xf,Bu.registeredClasses.AxisDataItem=bf,ed.push({relevant:td.maybeXS,state:function(e,t){if(e instanceof xf&&e.tooltip){var i=e.states.create(t);return i.properties.cursorTooltipEnabled=!1,i}return null}});var wf=function(e){function t(){var t=e.call(this)||this;t.className="AxisLine",t.element=t.paper.add("path");var i=new Xh;return t.stroke=i.getFor("grid"),t.strokeOpacity=.15,t.pixelPerfect=!0,t.fill=uc(),t.applyTheme(),t.interactionsEnabled=!1,t}return Us(t,e),t}(Up);Bu.registeredClasses.AxisLine=wf;var kf=function(e){function t(t){var i=e.call(this)||this;i.axis=t,i.element=i.paper.add("path"),i.className="AxisFill",i.isMeasured=!1,i.location=0,i.above=!1;var n=new Xh;return i.fill=n.getFor("alternativeBackground"),i.fillOpacity=0,i.applyTheme(),i}return Us(t,e),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.axis&&this.axis.invalidateDataItems(),i},t.prototype.draw=function(){e.prototype.draw.call(this),this.__disabled||this.disabled||this.axis&&ll(this.startPosition)&&ll(this.endPosition)&&(this.fillPath=this.axis.getPositionRangePath(this.startPosition,this.endPosition),this.path=this.fillPath,this.isMeasured&&this.measure())},Object.defineProperty(t.prototype,"startPosition",{get:function(){return this.getPropertyValue("startPosition")},set:function(e){this.setPropertyValue("startPosition",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPosition",{get:function(){return this.getPropertyValue("endPosition")},set:function(e){this.setPropertyValue("endPosition",e),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this.getPropertyValue("location")},set:function(e){this.setPropertyValue("location",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setPath=function(e){return!!this.setPropertyValue("path",e)&&(this.element.attr({d:e}),!0)},Object.defineProperty(t.prototype,"above",{get:function(){return this.getPropertyValue("above")},set:function(e){this.setPropertyValue("above",e,!0)},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.AxisFill=kf;var Pf=function(e){function t(){var t=e.call(this)||this;t.className="Grid",t.element=t.paper.add("path"),t.location=.5,t.isMeasured=!1,t.above=!1;var i=new Xh;return t.stroke=i.getFor("grid"),t.pixelPerfect=!0,t.strokeOpacity=.15,t.fill=uc(),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return this.getPropertyValue("location")},set:function(e){this.setPropertyValue("location",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"above",{get:function(){return this.getPropertyValue("above")},set:function(e){this.setPropertyValue("above",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.axis&&this.axis.invalidateDataItems(),i},t}(Up);Bu.registeredClasses.Grid=Pf,ed.push({relevant:td.maybeXS,state:function(e,t){if(e instanceof Pf){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var Sf=function(e){function t(){var t=e.call(this)||this;return t.className="AxisLabel",t.isMeasured=!1,t.padding(10,10,10,10),t.location=.5,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return this.getPropertyValue("location")},set:function(e){this.setPropertyValue("location",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inside",{get:function(){return this.getPropertyValue("inside")},set:function(e){this.setPropertyValue("inside",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.axis&&this.axis.invalidateDataItems(),i},t}(rd);Bu.registeredClasses.AxisLabel=Sf;var Tf=function(e){function t(){var t=e.call(this)||this;t.className="Tick";var i=new Xh;return t.fillOpacity=0,t.length=6,t.strokeOpacity=.2,t.stroke=i.getFor("grid"),t.isMeasured=!1,t.nonScalingStroke=!0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.disabled?0:this.getPropertyValue("length")},set:function(e){this.setPropertyValue("length",e,!0)},enumerable:!0,configurable:!0}),t}(Up);Bu.registeredClasses.Tick=Tf;var Ef=function(e){function t(){var t=e.call(this)||this;return t.className="AxisTick",t.element=t.paper.add("path"),t.location=.5,t.above=!1,t.isMeasured=!1,t.pixelPerfect=!0,t.strokeOpacity=0,t.length=5,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return this.getPropertyValue("location")},set:function(e){this.setPropertyValue("location",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inside",{get:function(){return this.getPropertyValue("inside")},set:function(e){this.setPropertyValue("inside",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"above",{get:function(){return this.getPropertyValue("above")},set:function(e){this.setPropertyValue("above",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.axis&&this.axis.invalidateDataItems(),i},t}(Tf);Bu.registeredClasses.AxisTick=Ef;var Cf=function(e){function t(){var t=e.call(this)||this;t._chart=new iu,t.className="AxisRenderer",t.minGridDistance=50,t.inside=!1,t.inversed=!1,t.tooltipLocation=.5,t.fullWidthTooltip=!1,t.cellStartLocation=0,t.cellEndLocation=1,t.minLabelPosition=0,t.maxLabelPosition=1,t.shouldClone=!1;var i=t.createChild(Wp);i.shouldClone=!1,i.layout="none",i.virtualParent=t,i.width=Ks(100),i.height=Ks(100),t.gridContainer=i,i.events.on("maxsizechanged",(function(){t.inited&&t.invalidateAxisItems()}),t,!1);var n=t.createChild(Wp);n.shouldClone=!1,n.isMeasured=!1,n.layout="none",n.width=Ks(100),n.height=Ks(100),t.breakContainer=n;var r=t.createChild(Wp);r.shouldClone=!1,r.isMeasured=!1,r.layout="none",r.width=Ks(100),r.height=Ks(100),t.bulletsContainer=r,t.line=t.createChild(wf),t.line.shouldClone=!1,t.line.strokeOpacity=0;var a=t.createChild(Pf);a.shouldClone=!1,t.baseGrid=a;var o=t._disposers;return o.push(a),o.push(t.line),o.push(i),o.push(n),o.push(r),o.push(t._chart),t.ticks.template.disabled=!0,t.axisFills.template.disabled=!0,t.axisFills.template.interactionsEnabled=!1,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"axis",{get:function(){return this._axis},set:function(e){this.setAxis(e)},enumerable:!0,configurable:!0}),t.prototype.setAxis=function(e){this._axis=e,this.baseGrid.parent=e,this.line.parent=e,this.gridContainer.bind("opacity",e)},t.prototype.processRenderer=function(){this.events.on("sizechanged",this.updateTooltip,this,!1),this.events.on("positionchanged",this.updateTooltip,this,!1),this.labels.template.inside=this.inside,this.ticks.template.inside=this.inside},t.prototype.updateTooltip=function(){},Object.defineProperty(t.prototype,"axisLength",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.positionItem=function(e,t){e&&e.moveTo(t)},t.prototype.positionToPoint=function(e,t){return{x:0,y:0}},t.prototype.positionToAngle=function(e){return 0},t.prototype.positionToCoordinate=function(e){var t=this.axis,i=t.axisFullLength;return t.renderer.inversed?(t.end-e)*i:(e-t.start)*i},t.prototype.updateGridContainer=function(){},t.prototype.getHeight=function(){var e=this.gridContainer;return e.parent?e.parent.pixelHeight:this.gridContainer.pixelHeight||0},t.prototype.getWidth=function(){var e=this.gridContainer;return e.parent?e.parent.pixelWidth:this.gridContainer.pixelWidth||0},t.prototype.coordinateToPosition=function(e,t){var i=this.axis,n=i.axisFullLength;return vl(i.renderer.inversed?i.end-e/n:e/n+i.start,5)},t.prototype.pointToPosition=function(e){return 0},t.prototype.getPositionRangePath=function(e,t){return""},t.prototype.invalidateAxisItems=function(){var e=this.axis;e&&e.invalidateDataItems()},t.prototype.updateGridElement=function(e,t,i){},t.prototype.updateTickElement=function(e,t,i){},t.prototype.updateBullet=function(e,t,i){},t.prototype.updateLabelElement=function(e,t,i,n){},t.prototype.updateFillElement=function(e,t,i){e.startPosition=t,e.endPosition=i},t.prototype.updateAxisLine=function(){},t.prototype.updateBaseGridElement=function(){},t.prototype.updateBreakElement=function(e){this.positionItem(e.startLine,e.startPoint),this.toggleVisibility(e.startLine,e.startPosition,0,1),this.positionItem(e.endLine,e.endPoint),this.toggleVisibility(e.endLine,e.endPosition,0,1)},Object.defineProperty(t.prototype,"minGridDistance",{get:function(){return this.getPropertyValue("minGridDistance")},set:function(e){this.setPropertyValue("minGridDistance",e)&&this.axis&&this.axis.invalidateDataItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart.get()},set:function(e){this._chart.set(e,null)},enumerable:!0,configurable:!0}),t.prototype.toggleVisibility=function(e,t,i,n){var r=this.axis,a=e.dataItem;a&&a instanceof bf&&(ll(a.minPosition)&&(i=a.minPosition),ll(a.maxPosition)&&(n=a.maxPosition));var o=r.start+(r.end-r.start)*(i-1e-4),s=r.start+(r.end-r.start)*(n+1e-4);e.disabled||(e.__disabled=t<o||t>s)},t.prototype.createBreakSprites=function(e){},Object.defineProperty(t.prototype,"axisFills",{get:function(){if(!this._axisFills){var e=this.createFill(this.axis);this._axisFills=new Hu(e),e.applyOnClones=!0,e.events.on("enabled",this.invalidateAxisItems,this,!1),this._disposers.push(new Uu(this._axisFills)),this._disposers.push(this._axisFills.template)}return this._axisFills},enumerable:!0,configurable:!0}),t.prototype.createFill=function(e){return new kf(e)},Object.defineProperty(t.prototype,"grid",{get:function(){if(!this._grid){var e=this.createGrid();this._grid=new Hu(e),e.applyOnClones=!0,e.events.on("enabled",this.invalidateAxisItems,this,!1),this._disposers.push(new Uu(this._grid)),this._disposers.push(this._grid.template)}return this._grid},enumerable:!0,configurable:!0}),t.prototype.createGrid=function(){return new Pf},Object.defineProperty(t.prototype,"ticks",{get:function(){if(!this._ticks){var e=this.createTick();e.applyOnClones=!0,e.isMeasured=!1,e.events.on("enabled",this.invalidateAxisItems,this,!1),this._ticks=new Hu(e),this._disposers.push(new Uu(this._ticks)),this._disposers.push(this._ticks.template)}return this._ticks},enumerable:!0,configurable:!0}),t.prototype.createTick=function(){return new Ef},Object.defineProperty(t.prototype,"labels",{get:function(){if(!this._labels){var e=this.createLabel();this._labels=new Hu(e),e.applyOnClones=!0,e.events.on("enabled",this.invalidateAxisItems,this,!1),this._disposers.push(new Uu(this._labels)),this._disposers.push(this._labels.template)}return this._labels},enumerable:!0,configurable:!0}),t.prototype.createLabel=function(){return new Sf},Object.defineProperty(t.prototype,"inside",{get:function(){return this.getPropertyValue("inside")},set:function(e){this.setPropertyValue("inside",e)&&this.axis&&this.axis.invalidate(),e?(this.width=0,this.height=0):(this.width=void 0,this.height=void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opposite",{get:function(){return this.getPropertyValue("opposite")},set:function(e){this.setPropertyValue("opposite",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullWidthTooltip",{get:function(){return this.getPropertyValue("fullWidthTooltip")},set:function(e){this.setPropertyValue("fullWidthTooltip",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipLocation",{get:function(){return this.getPropertyValue("tooltipLocation")},set:function(e){this.setPropertyValue("tooltipLocation",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipLocation2",{get:function(){return this.getPropertyValue("tooltipLocation2")},set:function(e){this.setPropertyValue("tooltipLocation2",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellStartLocation",{get:function(){return this.getPropertyValue("cellStartLocation")},set:function(e){this.setPropertyValue("cellStartLocation",e)&&this.axis&&this.axis.invalidateSeries()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellEndLocation",{get:function(){return this.getPropertyValue("cellEndLocation")},set:function(e){this.setPropertyValue("cellEndLocation",e)&&this.axis&&this.axis.invalidateSeries()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inversed",{get:function(){return this.getPropertyValue("inversed")},set:function(e){this.setPropertyValue("inversed",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minLabelPosition",{get:function(){return this.getPropertyValue("minLabelPosition")},set:function(e){this.setPropertyValue("minLabelPosition",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLabelPosition",{get:function(){return this.getPropertyValue("maxLabelPosition")},set:function(e){this.setPropertyValue("maxLabelPosition",e,!0)},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.grid.template.copyFrom(t.grid.template),this.ticks.template.copyFrom(t.ticks.template),this.labels.template.copyFrom(t.labels.template),this.axisFills.template.copyFrom(t.axisFills.template),this.line.copyFrom(t.line),this.baseGrid.copyFrom(t.baseGrid)},t.prototype.toAxisPosition=function(e){return e},t.prototype.setVisibility=function(t){e.prototype.setVisibility.call(this,t),this.bulletsContainer.visible=t},t}(Wp);Bu.registeredClasses.AxisRenderer=Cf;var Mf=function(e){function t(){var t=e.call(this)||this;return t.className="AxisBullet",t.location=.5,t.isMeasured=!1,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return this.getPropertyValue("location")},set:function(e){this.setPropertyValue("location",e,!0)},enumerable:!0,configurable:!0}),t.prototype.setDisabled=function(t){var i=e.prototype.setDisabled.call(this,t);return this.axis&&this.axis.invalidateDataItems(),i},t}(Wp);Bu.registeredClasses.AxisBullet=Mf;var If=function(e){function t(){var t=e.call(this)||this;return t.className="AxisRendererY",t.minGridDistance=40,t.opposite=!1,t.height=Ks(100),t.labels.template.verticalCenter="middle",t.applyTheme(),t}return Us(t,e),t.prototype.setAxis=function(t){e.prototype.setAxis.call(this,t),t.layout="horizontal"},t.prototype.updateGridContainer=function(){var e=this.axis;if(e){var t=this.gridContainer;t.y=e.pixelY,t.height=e.axisLength}},t.prototype.toAxisPosition=function(e){var t=this.axis;if(t){var i=1-e,n=t.relativePositionSprite,r=t.pixelY;if(n?r=qc({x:0,y:this.pixelY},this.parent,n).y:n=t.parent,n)return 1-(i-r/n.innerHeight)/(t.axisLength/n.innerHeight)}return e},t.prototype.processRenderer=function(){e.prototype.processRenderer.call(this);var t=this.axis;if(t){var i=t.title;i.valign="middle",t.height instanceof Xs||(t.height=Ks(100)),this.opposite?(i.rotation=90,this.line.toBack(),i.toFront()):(i.rotation=-90,i.toBack(),this.line.toFront())}},t.prototype.updateTooltip=function(){if(this.axis){var e=2e3,t=0,i=e,n=this.axisLength;this.opposite?this.inside&&(t=-2e3,i=e):this.inside||(t=-2e3,i=e),this.axis.updateTooltip("horizontal",{x:t,y:0,width:i,height:n})}},Object.defineProperty(t.prototype,"axisLength",{get:function(){var e=this.axis;return e.measuredHeight-e.pixelPaddingTop-e.pixelPaddingBottom||0},enumerable:!0,configurable:!0}),t.prototype.positionToPoint=function(e,t){return{x:0,y:this.positionToCoordinate(e)}},t.prototype.pointToPosition=function(e){return this.coordinateToPosition(e.y,e.x)},t.prototype.coordinateToPosition=function(e,t){var i=this.axis,n=i.axisFullLength;return vl(i.renderer.inversed?1-i.start-e/n:e/n+(1-i.end),5)},t.prototype.getPositionRangePath=function(e,t){var i=gl(this.positionToCoordinate(e),0,this.axisLength),n=gl(this.positionToCoordinate(t),0,this.axisLength),r=Math.abs(n-i),a=this.getWidth();return gd({x:0,y:Math.min(i,n),width:a,height:r},!0)},t.prototype.updateGridElement=function(e,t,i){t+=(i-t)*e.location;var n=this.positionToPoint(t);e.path=dd({x:0,y:0})+fd({x:this.getWidth(),y:0}),this.positionItem(e,n),this.toggleVisibility(e,t,0,1)},t.prototype.updateTickElement=function(e,t,i){t+=(i-t)*e.location;var n=this.positionToPoint(t),r=e.length;try{this.axis.title.measuredWidth}catch(a){}n.x=qc({x:this.line.pixelX,y:0},this.line.parent,this.gridContainer).x,this.opposite?r*=e.inside?-1:1:r*=e.inside?1:-1,e.path=dd({x:0,y:0})+fd({x:r,y:0}),this.positionItem(e,n),this.toggleVisibility(e,t,0,1)},t.prototype.updateAxisLine=function(){this.line.path=dd({x:0,y:0})+fd({x:0,y:this.axisLength})},t.prototype.updateBaseGridElement=function(){e.prototype.updateBaseGridElement.call(this);var t=this.axis,i=this.getWidth(),n=this.axisLength,r=t.basePoint.y,a=this.baseGrid;if(r<-.2||r>n+.2)a.hide(0);else{var o=qc({x:0,y:0},this.gridContainer,a.parent).x;a.path=dd({x:0,y:0})+fd({x:i,y:0}),a.moveTo({x:o,y:r}),a.show(0)}},t.prototype.updateLabelElement=function(e,t,i,n){nl(n)||(n=e.location),t+=(i-t)*n,e.isMeasured=!e.inside;var r,a=this.positionToPoint(t),o=0,s=this.gridContainer.maxWidth;this.opposite?(e.inside?(r="right","left"==e.align&&(o=-s,r="left"),"center"==e.align&&(o=-s/2,r="middle")):r="left",a.x=0+o):(e.inside?(r="left","right"==e.align&&(o=s,r="right"),"center"==e.align&&(o=s/2,r="middle")):r="right",a.x=this.measuredWidth+o),0==e.rotation&&(e.horizontalCenter=r),this.positionItem(e,a),this.toggleVisibility(e,t,this.minLabelPosition,this.maxLabelPosition)},t.prototype.updateBreakElement=function(t){e.prototype.updateBreakElement.call(this,t);var i=t.startLine,n=t.endLine,r=t.fillShape,a=t.startPoint,o=t.endPoint,s=t.pixelMarginLeft,l=this.getWidth()-t.pixelMarginLeft-t.pixelMarginRight;a.y=gl(a.y,-1,this.axisLength+1),o.y=gl(o.y,-1,this.axisLength+1),a.y==o.y&&(a.y<0||a.y>this.axisLength)?t.fillShape.__disabled=!0:t.fillShape.__disabled=!1;var u=Math.abs(l-s);i.x=s,i.height=0,i.width=u,n.x=s,n.height=0,n.width=u,r.width=u,r.height=Math.abs(o.y-a.y),r.x=s,r.y=o.y},t.prototype.createBreakSprites=function(e){e.startLine=new Wd,e.endLine=new Wd;var t=new Hd;t.setWavedSides(!0,!1,!0,!1),e.fillShape=t},t.prototype.positionToCoordinate=function(e){var t=this.axis,i=t.axisFullLength;return t.renderer.inversed?(e-t.start)*i:(t.end-e)*i},t.prototype.updateBullet=function(e,t,i){var n=.5;e instanceof Mf&&(n=e.location),t+=(i-t)*n;var r=this.positionToPoint(t);r.x=qc({x:this.line.pixelX,y:0},this.line.parent,this.gridContainer).x,this.positionItem(e,r),this.toggleVisibility(e,t,0,1)},t}(Cf);Bu.registeredClasses.AxisRendererY=If,ed.push({relevant:td.widthS,state:function(e,t){if(e instanceof If){var i=e.states.create(t);return i.properties.inside=!0,i.properties.maxLabelPosition=.9,i.properties.minLabelPosition=.1,i}return null}}),ed.push({relevant:td.widthXS,state:function(e,t){if(e instanceof If){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var Of=function(e){function t(){var t=e.call(this)||this;return t.className="ValueAxisBreak",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"startPosition",{get:function(){if(this.axis)return this.axis.valueToPosition(this.adjustedStartValue)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPosition",{get:function(){if(this.axis)return this.axis.valueToPosition(this.adjustedEndValue)},enumerable:!0,configurable:!0}),t}(gf);Bu.registeredClasses.ValueAxisBreak=Of;var Df=function(e){function t(){var t=e.call(this)||this;return t.className="ValueAxisDataItem",t.values.value={},t.values.endValue={},t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.values.value.value},set:function(e){this.setValue("value",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endValue",{get:function(){return this.values.endValue.value},set:function(e){this.setValue("endValue",e)},enumerable:!0,configurable:!0}),t}(bf),Af=function(e){function t(){var t=e.call(this)||this;return t._stepDecimalPlaces=0,t._prevStepDecimalPlaces=0,t._adjustLabelPrecision=!0,t._baseValue=0,t._adjustedStart=0,t._adjustedEnd=1,t._extremesChanged=!1,t._deltaMinMax=1,t._dsc=!1,t.calculateTotals=!1,t.className="ValueAxis",t.axisFieldName="value",t.setPropertyValue("maxZoomFactor",1e3),t.setPropertyValue("extraMin",0),t.setPropertyValue("extraMax",0),t.setPropertyValue("strictMinMax",!1),t.setPropertyValue("maxPrecision",Number.MAX_VALUE),t.setPropertyValue("adjustLabelPrecision",!0),t.setPropertyValue("extraTooltipPrecision",0),t.keepSelection=!1,t.includeRangesInMinMax=!1,t.applyTheme(),t}return Us(t,e),t.prototype.fillRule=function(e){var t=e.value,i=e.component;e.axisFill.disabled||(vl(t/i.step/2,5)==Math.round(t/i.step/2)?e.axisFill.__disabled=!0:e.axisFill.__disabled=!1)},t.prototype.createDataItem=function(){return new Df},t.prototype.createAxisBreak=function(){return new Of},t.prototype.dataChangeUpdate=function(){this.clearCache(),this.keepSelection?(0!=this._start&&this.dispatchImmediately("startchanged"),1!=this._end&&this.dispatchImmediately("endchanged"),0==this._start&&1==this._end||this.dispatchImmediately("startendchanged")):0==this._start&&1==this._end||(this._start=0,this._end=1,this.dispatchImmediately("startendchanged")),this._maxZoomed=this._maxDefined,this._minZoomed=this._minDefined,this._maxAdjusted=this._maxDefined,this._minAdjusted=this._minDefined},t.prototype.processSeriesDataItems=function(){if(this.calculateTotals){var e=this.series.getIndex(0),t=e.startIndex;if(e.dataItems.length>0){t>0&&t--;var i=e.endIndex;i<e.dataItems.length&&i++;for(var n=function(e){var t={},i={};r.series.each((function(n){if(!n.excludeFromTotal){var r=n.dataItems.getIndex(e);r&&gu(r.values,(function(e){var n=r.values[e].workingValue;ll(n)&&(ll(t[e])?t[e]+=Math.abs(n):t[e]=Math.abs(n),ll(i[e])?i[e]+=n:i[e]=n)}))}})),r.series.each((function(n){if(!n.excludeFromTotal){var r=n.dataItems.getIndex(e);r&&gu(r.values,(function(e){var n=r.values[e].workingValue;ll(n)&&(r.setCalculatedValue(e,t[e],"total"),r.setCalculatedValue(e,100*n/t[e],"totalPercent"),r.setCalculatedValue(e,i[e],"sum"))}))}}))},r=this,a=t;a<i;++a)n(a)}}},t.prototype.validate=function(){this.axisLength<=0||(e.prototype.validate.call(this),this.getMinMax(),ll(this._minAdjusted)||this.dataItems.each((function(e){e.value=null})),this.fixAxisBreaks(),this.calculateZoom(),this.validateAxisElements(),this.validateAxisRanges(),this.validateBreaks(),this.hideUnusedDataItems(),this.renderer.invalidateLayout())},t.prototype.calculateZoom=function(){if(ll(this.min)&&ll(this.max)){var e=this.positionToValue(this.start),t=this.positionToValue(this.end),i=this.adjustDifference(e,t),n=this.adjustMinMax(e,t,i,this._gridCount,!0),r=function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(n.step);this._stepDecimalPlaces=r,e=vl(e,r),t=vl(t,r);var a=(n=this.adjustMinMax(e,t,i,this._gridCount,!0)).step;if(this.syncWithAxis){var o=this.getCache(e+"-"+t);ll(o)&&(a=o)}else e=n.min,t=n.max;(this._minZoomed!=e||this._maxZoomed!=t||this._step!=a||this._dsc)&&(this._dsc=!1,this._minZoomed=e,this._maxZoomed=t,this._step=a,this.dispatchImmediately("selectionextremeschanged"))}},t.prototype.fixSmallStep=function(e){return 1+e==1?(e*=2,this.fixSmallStep(e)):e},t.prototype.validateAxisElements=function(){var e=this;if(ll(this.max)&&ll(this.min)){var t=this.minZoomed-2*this._step;if(this.logarithmic)Math.log(this.max)*Math.LOG10E-Math.log(this.min)*Math.LOG10E>1?t=Math.pow(10,Math.log(this.min)*Math.LOG10E):0==(t=Math.floor(this.minZoomed/this._step)*this._step)&&(t=this.minZoomed);else t=Math.floor(t/this._step)*this._step;var i=this._maxZoomed+this._step;this.resetIterators();var n=this._dataItemsIterator;if(0==this._step)return;this._step=this.fixSmallStep(this._step);var r=0,a=this._prevStepDecimalPlaces!=this._stepDecimalPlaces;for(this._prevStepDecimalPlaces=this._stepDecimalPlaces;t<=i;){if(!this.isInBreak(t)){var o=n.find((function(e){return e.value===t}));o.__disabled&&(o.__disabled=!1),this.appendDataItem(o),o.axisBreak=void 0,(o.value!=t||a)&&(o.value=t,o.text=this.formatLabel(t),o.label&&o.label.invalid&&o.label.validate(),o.value>=this.min&&o.value<=this.max&&o.label&&("Y"==this.axisLetter&&o.label.measuredWidth>this.ghostLabel.measuredWidth||"X"==this.axisLetter&&o.label.measuredHeight>this.ghostLabel.measuredHeight)&&(this.ghostLabel.text=o.label.currentText,this.ghostLabel.validate())),this.validateDataElement(o)}r++;var s=t;if(this.logarithmic)Math.log(this.max)*Math.LOG10E-Math.log(this.min)*Math.LOG10E>1?t=Math.pow(10,Math.log(this.min)*Math.LOG10E+r):t+=this._step;else t+=this._step;var l=Math.pow(10,Math.floor(Math.log(Math.abs(this._step))*Math.LOG10E));if(l<1){var u=Math.round(Math.abs(Math.log(Math.abs(l))*Math.LOG10E))+2;if(u=Math.min(13,u),s==(t=vl(t,u))){t=i;break}}}var c=this._axisBreaks;if(c){var h=this.renderer;Tu(c.iterator(),(function(t){if(t.breakSize>0&&Pl(t.startPoint,t.endPoint)>h.minGridDistance)for(var i=t.adjustedMin;i<=t.adjustedMax;){if(i>=t.adjustedStartValue&&i<=t.adjustedEndValue){var r=n.find((function(e){return e.value===i}));r.__disabled&&(r.__disabled=!1),e.appendDataItem(r),r.axisBreak=t,r.value!=i&&(r.value=i,r.text=e.formatLabel(i),r.label&&r.label.invalid&&r.label.validate()),e.validateDataElement(r)}i+=t.adjustedStep}}))}}},t.prototype.validateDataElement=function(t){e.prototype.validateDataElement.call(this,t),t.itemIndex=this._axisItemCount,this._axisItemCount++;var i=this.renderer,n=t.value,r=t.endValue,a=this.valueToPosition(n);t.position=a;var o=a,s=this.valueToPosition(n+this._step);ll(r)&&(s=o=this.valueToPosition(r)),t.point=i.positionToPoint(a);var l=t.tick;l&&!l.disabled&&i.updateTickElement(l,a,o);var u=t.grid;u&&!u.disabled&&i.updateGridElement(u,a,o);var c=t.label;c&&!c.disabled&&i.updateLabelElement(c,a,o);var h=t.axisFill;h&&!h.disabled&&(i.updateFillElement(h,a,s),t.isRange||this.fillRule(t)),t.bullet&&i.updateBullet(t.bullet,a,o);var p=t.mask;p&&i.updateFillElement(p,a,s)},t.prototype.formatLabel=function(e){return this.adjustLabelPrecision&&0!=e?this.numberFormatter.format(e,void 0,this._stepDecimalPlaces):this.numberFormatter.format(e)},Object.defineProperty(t.prototype,"basePoint",{get:function(){var e=this.baseValue,t=this.valueToPosition(e);return this.renderer.positionToPoint(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseValue",{get:function(){var e=this._baseValue;return this.logarithmic&&(e=this.min),this._adapterO?this._adapterO.apply("baseValue",e):e},set:function(e){this._baseValue=e,this.invalidateLayout(),this.invalidateSeries()},enumerable:!0,configurable:!0}),t.prototype.anyToPosition=function(e){return this.valueToPosition(e)},t.prototype.valueToPoint=function(e){var t=this.valueToPosition(e),i=this.renderer.positionToPoint(t),n=this.renderer.positionToAngle(t);return{x:i.x,y:i.y,angle:n}},t.prototype.anyToPoint=function(e){return this.valueToPoint(e)},t.prototype.valueToPosition=function(e){if(ll(e)){var t=this.min,i=this.max;if(ll(t)&&ll(i)){var n=this._difference,r=this._axisBreaks;r&&r.length>0&&Su(r.iterator(),(function(n){var r=n.adjustedStartValue,a=n.adjustedEndValue;if(ll(r)&&ll(a)){if(e<r)return!1;if(kl({start:r,end:a},{start:t,end:i})){r=Math.max(r,t),a=Math.min(a,i);var o=n.breakSize;e>a?t+=(a-r)*(1-o):e<r||(e=r+(e-r)*o)}}return!0}));var a=void 0;if(this.logarithmic){var o=this.treatZeroAs;ll(o)&&e<=o&&(e=o),a=(Math.log(e)*Math.LOG10E-Math.log(this.min)*Math.LOG10E)/(Math.log(this.max)*Math.LOG10E-Math.log(this.min)*Math.LOG10E)}else a=(e-t)/n;return a}}return 0},t.prototype.invalidateLabels=function(){e.prototype.invalidateLabels.call(this),this.dataItems&&(this.dataItems.each((function(e){e.value=void 0})),this.invalidate())},t.prototype.positionToValue=function(e){var t=this.min,i=this.max;if(ll(t)&&ll(i)){var n=i-t,r=null,a=this._axisBreaks;return a&&a.length>0&&Su(a.iterator(),(function(a){var o=a.startPosition,s=a.endPosition,l=a.adjustedStartValue,u=a.adjustedEndValue;if(ll(l)&&ll(u)){if(l>i)return!1;if(kl({start:l,end:u},{start:t,end:i})){l=xl(l,t),u=wl(u,i);var c=a.breakSize;if(n-=(u-l)*(1-c),e>s)t+=(u-l)*(1-c);else if(!(e<o))return r=l+(e-o)/(s-o)*(u-l),!1}return!0}})),ll(r)||(r=this.logarithmic?Math.pow(Math.E,(e*(Math.log(this.max)*Math.LOG10E-Math.log(this.min)*Math.LOG10E)+Math.log(this.min)*Math.LOG10E)/Math.LOG10E):e*n+t),r}},t.prototype.xToValue=function(e){return this.positionToValue(this.pointToPosition({x:e,y:0}))},t.prototype.yToValue=function(e){return this.positionToValue(this.pointToPosition({x:0,y:e}))},t.prototype.pointToPosition=function(e){return this.renderer instanceof If?1-this.renderer.pointToPosition(e):this.renderer.pointToPosition(e)},t.prototype.animateMinMax=function(e,t){return this.animate([{property:"_minAdjusted",from:this._minAdjusted,to:e},{property:"_maxAdjusted",from:this._maxAdjusted,to:t}],this.rangeChangeDuration,this.rangeChangeEasing)},t.prototype.getMinMax=function(){var e=this;this.updateGridCount();var t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(ll(this._minDefined)&&ll(this._maxDefined)||(this.series.each((function(n){if(!n.ignoreMinMax){var r=n.min(e);ll(r)&&r<t&&(t=r);var a=n.max(e);ll(a)&&a>i&&(i=a)}})),this.includeRangesInMinMax&&this.axisRanges.each((function(e){if(!e.ignoreMinMax){var n=wl(e.value,e.endValue),r=xl(e.value,e.endValue);(n<t||!ll(t))&&(t=n),(r>i||!ll(i))&&(i=r)}}))),this.logarithmic){var n=this.treatZeroAs;ll(n)&&t<=0&&(t=n),t<=0&&this.raiseCriticalError(new Error("Logarithmic value axis can not have values <= 0."),!0)}if(0==t&&0==i&&(i=.9,t=-.9),ll(this._minDefined)&&(t=this._minDefined),ll(this._maxDefined)&&(i=this._maxDefined),this._adapterO&&(t=this._adapterO.apply("min",t)),this._adapterO&&(i=this._adapterO.apply("max",i)),ll(t)&&ll(i)){this._minReal=t,this._maxReal=i,t==Number.POSITIVE_INFINITY&&(t=void 0),i==Number.NEGATIVE_INFINITY&&(i=void 0);var r=this.adjustDifference(t,i);if(t=this.fixMin(t),(i=this.fixMax(i))-t<=1/Math.pow(10,15)){if(i-t!=0)this._deltaMinMax=(i-t)/2;else{var a=Math.log(Math.abs(i))*Math.LOG10E,o=Math.pow(10,Math.floor(a));o/=10,this._deltaMinMax=o}t-=this._deltaMinMax,i+=this._deltaMinMax}t-=(i-t)*this.extraMin,i+=(i-t)*this.extraMax;var s=this.strictMinMax;ll(this._maxDefined)&&(s=!0);var l=this.adjustMinMax(t,i,r,this._gridCount,s);if(t=l.min,r=(i=l.max)-t,l=this.adjustMinMax(t,i,i-t,this._gridCount,!0),t=l.min,i=l.max,this.strictMinMax&&(t=ll(this._minDefined)?this._minDefined:this._minReal,(i=ll(this._maxDefined)?this._maxDefined:this._maxReal)-t<=1e-8&&(t-=this._deltaMinMax,i+=this._deltaMinMax),t-=(i-t)*this.extraMin,i+=(i-t)*this.extraMax),this._adapterO&&(t=this._adapterO.apply("min",t)),this._adapterO&&(i=this._adapterO.apply("max",i)),this._step=l.step,ll(t)||ll(i)||(this.start=0,this.end=1,this.renderer.labels.each((function(e){e.dataItem.text=""}))),(this._minAdjusted!=t||this._maxAdjusted!=i)&&ll(t)&&ll(i)){var u=this._minMaxAnimation;if(this._extremesChanged&&ll(this._minAdjusted)&&ll(this._maxAdjusted)&&this.inited){if(u&&!u.isFinished()&&this._finalMax==i&&this._finalMin==t)return;this._finalMin=t,this._finalMax=i,(u=this.animateMinMax(t,i))&&!u.isFinished()?(u.events.on("animationprogress",this.validateDataItems,this),u.events.on("animationended",(function(){e.series.each((function(e){e.validate()})),e.validateDataItems(),e.handleSelectionExtremesChange()})),this._minMaxAnimation=u):this.series.each((function(e){e.invalidate()})),this.validateDataItems(),this.dispatchImmediately("extremeschanged"),this.handleSelectionExtremesChange()}else{if(u&&!u.isFinished()&&this._finalMax==i&&this._finalMin==t)return;this._minAdjusted=t,this._maxAdjusted=i,this._finalMin=t,this._finalMax=i,this.invalidateDataItems(),this.dispatchImmediately("extremeschanged")}}this._extremesChanged=!1,this._difference=this.adjustDifference(t,i)}},t.prototype.fixMin=function(e){return e},t.prototype.fixMax=function(e){return e},t.prototype.adjustMinMax=function(e,t,i,n,r){n<=1&&(n=1),n=Math.round(n);var a=e,o=t;0===i&&(i=Math.abs(t));var s=Math.log(Math.abs(i))*Math.LOG10E,l=Math.pow(10,Math.floor(s)),u=l/=10;r&&(u=0),this.logarithmic?(e<=0&&(e=this.baseValue),e==1/0&&(e=1),t==-1/0&&(t=10),this.strictMinMax?(this._minDefined>0&&(e=this._minDefined),this._maxDefined):(e=Math.pow(10,Math.floor(Math.log(Math.abs(e))*Math.LOG10E)),t=Math.pow(10,Math.ceil(Math.log(Math.abs(t))*Math.LOG10E)))):(r?(e=Math.floor(e/l)*l,t=Math.ceil(t/l)*l):(e=Math.ceil(e/l)*l-u,t=Math.floor(t/l)*l+u),e<0&&a>=0&&(e=0),t>0&&o<=0&&(t=0)),s=Math.log(Math.abs(i))*Math.LOG10E,l=Math.pow(10,Math.floor(s)),l/=10;var c=Math.ceil(i/n/l)*l,h=Math.pow(10,Math.floor(Math.log(Math.abs(c))*Math.LOG10E)),p=Math.ceil(c/h);p>5?p=10:p<=5&&p>2&&(p=5),c=Math.ceil(c/(h*p))*h*p,this.maxPrecision<Number.MAX_VALUE&&c!=yl(c,this.maxPrecision)&&(c=yl(c,this.maxPrecision));var d=0;if(h<1&&(c=vl(c,d=Math.round(Math.abs(Math.log(Math.abs(h))*Math.LOG10E))+1)),!this.logarithmic){var f=Math.floor(e/c);e=vl(c*f,d);var m=void 0;(m=r?Math.floor(t/c):Math.ceil(t/c))==f&&m++,(t=vl(c*m,d))<o&&(t+=c),e>a&&(e-=c)}return{min:e,max:t,step:c}},Object.defineProperty(t.prototype,"min",{get:function(){var e=this._minAdjusted;return ll(e)||(e=this._minDefined),e},set:function(e){this._minDefined!=e&&(this._minDefined=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minDefined",{get:function(){return this._minDefined},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDefined",{get:function(){return this._maxDefined},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraMin",{get:function(){return this.getPropertyValue("extraMin")},set:function(e){this.setPropertyValue("extraMin",e)&&this.invalidateDataItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraMax",{get:function(){return this.getPropertyValue("extraMax")},set:function(e){this.setPropertyValue("extraMax",e)&&this.invalidateDataItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){var e=this._maxAdjusted;return ll(e)||(e=this._maxDefined),e},set:function(e){this._maxDefined!=e&&(this._maxDefined=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adjustLabelPrecision",{get:function(){return this.getPropertyValue("adjustLabelPrecision")},set:function(e){this.setPropertyValue("adjustLabelPrecision",e)&&this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.registerSeries=function(t){return new tu([e.prototype.registerSeries.call(this,t),t.events.on("extremeschanged",this.handleExtremesChange,this,!1),t.events.on("selectionextremeschanged",this.handleSelectionExtremesChange,this,!1),this.events.on("extremeschanged",t.invalidate,t,!1)])},t.prototype.handleSelectionExtremesChange=function(){var e,t,i=this,n=!0;if(Tu(this.series.iterator(),(function(r){if(!r.ignoreMinMax&&!r.isHidden&&!r.outOfRange){r.visible&&!r.isHiding&&(n=!1);var a=r.selectionMin(i),o=r.selectionMax(i);ll(a)&&(!ll(e)||a<e)&&(e=a),ll(o)&&(!ll(t)||o>t)&&(t=o)}})),this.includeRangesInMinMax&&this.axisRanges.each((function(i){if(!i.ignoreMinMax){var n=wl(i.value,i.endValue),r=xl(i.value,i.endValue);n<e&&(e=n),r>t&&(t=r)}})),ll(this._minDefined)?e=this.strictMinMax?this._minDefined:this.min:this.strictMinMax&&(e=this._minReal),ll(this._maxDefined)?t=this.strictMinMax?this._maxDefined:this.max:this.strictMinMax&&(t=this._maxReal),e==t){e-=this._deltaMinMax,t+=this._deltaMinMax;var r=this.adjustMinMax(e,t,0,this._gridCount,this.strictMinMax);e=r.min,t=r.max}var a=this.adjustDifference(e,t),o=this.adjustMinMax(e,t,a,this._gridCount);e=o.min,t=o.max,e-=(t-e)*this.extraMin,t+=(t-e)*this.extraMax,e=gl(e,this.min,this.max),t=gl(t,this.min,this.max),a=this.adjustDifference(e,t),o=this.adjustMinMax(e,t,a,this._gridCount,!0),e=o.min,t=o.max,this.strictMinMax&&(e=xl(e,this._minDefined),t=wl(t,this._maxDefined));var s=o.step;this.syncWithAxis&&(o=this.syncAxes(e,t,s),e=o.min,t=o.max,this.invalidate()),s=o.step,this._difference=this.adjustDifference(this.min,this.max);var l=this.valueToPosition(e),u=this.valueToPosition(t);n&&!this.syncWithAxis&&(l=0,u=1);var c=0;this.syncWithAxis?(c=5,this.setCache(e+"-"+t,s)):(this._step==s&&this._minZoomed==e&&this._maxZoomed==t||(this._dsc=!0),this._step=s,this._minZoomed=e,this._maxZoomed=t),this.keepSelection||this.zoom({start:l,end:u},!1,!1,c)},Object.defineProperty(t.prototype,"strictMinMax",{get:function(){return this.getPropertyValue("strictMinMax")},set:function(e){this.setPropertyValue("strictMinMax",e)&&this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logarithmic",{get:function(){return this.getPropertyValue("logarithmic")},set:function(e){this.setPropertyValue("logarithmic",e)&&(this.invalidate(),this.series.each((function(e){e.invalidateDataItems()})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepSelection",{get:function(){return this.getPropertyValue("keepSelection")},set:function(e){this.setPropertyValue("keepSelection",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"includeRangesInMinMax",{get:function(){return this.getPropertyValue("includeRangesInMinMax")},set:function(e){this.setPropertyValue("includeRangesInMinMax",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPrecision",{get:function(){return this.getPropertyValue("maxPrecision")},set:function(e){this.setPropertyValue("maxPrecision",e)&&this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraTooltipPrecision",{get:function(){return this.getPropertyValue("extraTooltipPrecision")},set:function(e){this.setPropertyValue("extraTooltipPrecision",e)&&this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.handleExtremesChange=function(){var e=this;if(this._extremesChanged=!0,this.getMinMax(),this.ghostLabel){this.dataItems.each((function(t){t.label&&t.label.pixelWidth>0&&(e.ghostLabel.text=t.label.currentText)}))}},t.prototype.getX=function(e,t,i,n,r){return this.renderer.positionToPoint(this.getPositionX(e,t,i,n,r)).x},t.prototype.getPositionX=function(e,t,i,n,r){var a=e.getWorkingValue(t);nl(n)||(n="valueX");var o=e.getValue(n,"stack");ll(a)||(a=this.baseValue,this.logarithmic&&o>0&&(a=0));var s=this.valueToPosition(a+o);return r&&(s=gl(s,r.start,r.end)),s},t.prototype.getY=function(e,t,i,n,r){return this.renderer.positionToPoint(this.getPositionY(e,t,i,n,r)).y},t.prototype.getPositionY=function(e,t,i,n,r){var a=e.getWorkingValue(t);nl(n)||(n="valueY");var o=e.getValue(n,"stack");ll(a)||(a=this.baseValue,this.logarithmic&&o>0&&(a=0));var s=this.valueToPosition(a+o);return r&&(s=gl(s,r.start,r.end)),s},t.prototype.getAngle=function(e,t,i,n,r){var a=e.getWorkingValue(t),o=e.getValue(n,"stack");ll(a)||(a=this.baseValue);var s=this.valueToPosition(a+o);return r&&(s=gl(s,r.start,r.end)),this.positionToAngle(s)},t.prototype.getAnyRangePath=function(e,t,i){var n=this.valueToPosition(e),r=this.valueToPosition(t);return this.getPositionRangePath(n,r)},t.prototype.getTooltipText=function(e){var t=vl(this.positionToValue(e),this._stepDecimalPlaces+this.extraTooltipPrecision),i=this.tooltip.numberFormatter.format(t);return this._adapterO?this._adapterO.apply("getTooltipText",i):i},t.prototype.zoomToValues=function(e,t,i,n){var r=(e-this.min)/(this.max-this.min),a=(t-this.min)/(this.max-this.min);this.zoom({start:r,end:a},i,n)},Object.defineProperty(t.prototype,"minZoomed",{get:function(){return this.syncWithAxis?this._minZoomed:xl(this.min,this._minZoomed)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxZoomed",{get:function(){return this.syncWithAxis?this._maxZoomed:wl(this.max,this._maxZoomed)},enumerable:!0,configurable:!0}),t.prototype.fixAxisBreaks=function(){var t=this;e.prototype.fixAxisBreaks.call(this);var i=this._axisBreaks;i&&i.length>0&&i.each((function(e){var i=e.adjustedStartValue,n=e.adjustedEndValue,r=n-i,a=Math.ceil(r*e.breakSize)*t._gridCount/(t.max-t.min),o=t.adjustMinMax(i,n,r,a,!0);e.adjustedStep=o.step,e.adjustedMin=o.min,e.adjustedMax=o.max})),this._difference=this.adjustDifference(this.min,this.max)},t.prototype.getPositionLabel=function(e){var t=this.positionToValue(e);return this.numberFormatter.format(t)},t.prototype.showTooltipAt=function(e){this.showTooltipAtPosition(this.valueToPosition(e))},t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.min=t.min,this.max=t.max,this.calculateTotals=t.calculateTotals,this._baseValue=t.baseValue},Object.defineProperty(t.prototype,"syncWithAxis",{get:function(){return this.getPropertyValue("syncWithAxis")},set:function(e){var t=this;this.setPropertyValue("syncWithAxis",e,!0)&&e&&(this._disposers.push(e.events.on("extremeschanged",this.handleSelectionExtremesChange,this,!1)),this._disposers.push(e.events.on("selectionextremeschanged",this.handleSelectionExtremesChange,this,!1)),this._disposers.push(e.events.on("startendchanged",this.handleSelectionExtremesChange,this,!1)),this.events.on("shown",this.handleSelectionExtremesChange,this,!1),this.events.on("maxsizechanged",(function(){t.clearCache(),t._disposers.push(Bu.events.once("exitframe",(function(){t.handleSelectionExtremesChange()})))}),this,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"treatZeroAs",{get:function(){return this.getPropertyValue("treatZeroAs")},set:function(e){this.setPropertyValue("treatZeroAs",e,!0)},enumerable:!0,configurable:!0}),t.prototype.syncAxes=function(e,t,i){var n=this.syncWithAxis;if(n){ll(e)||(e=this.min),ll(t)||(t=this.max),ll(i)||(i=this._step);var r=Math.round((n.maxZoomed-n.minZoomed)/n.step),a=Math.round((t-e)/i);if(ll(r)&&ll(a))for(var o=!1,s=0,l=.01*(t-e),u=e,c=t,h=i;1!=o;)if(o=this.checkSync(u,c,h,r),++s>1e3&&(o=!0),o)e=u,t=c,i=h;else{s/3==Math.round(s/3)?(u=e-l*s,e>=0&&u<0&&(u=0)):(c=t+l*s)<=0&&c>0&&(c=0);var p=this.adjustMinMax(u,c,c-u,this._gridCount,!0);u=p.min,c=p.max,h=p.step}}return{min:e,max:t,step:i}},t.prototype.checkSync=function(e,t,i,n){for(var r=(t-e)/i,a=1;a<n;a++)if(vl(r/a,1)==n||r*a==n)return!0;return!1},t.prototype.processConfig=function(t){t&&nl(t.syncWithAxis)&&sl(t.syncWithAxis)&&(this.map.hasKey(t.syncWithAxis)?t.syncWithAxis=this.map.getKey(t.syncWithAxis):(this.processingErrors.push('[ValueAxis] No axis with id "'+t.syncWithAxis+'" found for `syncWithAxis`'),delete t.xAxis)),e.prototype.processConfig.call(this,t)},t}(xf);Bu.registeredClasses.ValueAxis=Af,Bu.registeredClasses.ValueAxisDataItem=Df;var Lf=function(e){function t(){var t=e.call(this)||this;return t.className="AxisRendererX",t.minGridDistance=120,t.opposite=!1,t.rotation=0,t.width=Ks(100),t.labels.template.horizontalCenter="middle",t.applyTheme(),t}return Us(t,e),t.prototype.setAxis=function(t){e.prototype.setAxis.call(this,t),t.layout="vertical"},t.prototype.updateGridContainer=function(){var e=this.axis;if(e){var t=this.gridContainer;t.x=e.pixelX,t.width=e.axisLength}},t.prototype.processRenderer=function(){e.prototype.processRenderer.call(this);var t=this.axis;if(t){t.width instanceof Xs||(t.width=Ks(100)),this.line;var i=t.title;i.rotation=0,i.align="center",this.opposite?(this.line.toFront(),i.toBack()):(i.toFront(),this.toBack(),this.line.toBack())}},t.prototype.updateTooltip=function(){if(this.axis){var e=1e3,t=this.line.pixelX,i=this.line.pixelY,n=this.axisLength,r=e;this.opposite?this.inside||(i=-1e3,r=e):this.inside&&(i=-1e3,r=e),this.axis.updateTooltip("vertical",{x:t,y:i,width:n,height:r})}},t.prototype.updateLabelElement=function(e,t,i,n){nl(n)||(n=e.location),t+=(i-t)*n;var r=this.positionToPoint(t);e.isMeasured=!e.inside;var a,o=0,s=this.gridContainer.maxHeight;this.opposite?(e.inside?(a="top","bottom"==e.valign&&(o=s,a="bottom"),"middle"==e.valign&&(o=s/2,a="middle")):a="bottom",r.y=o):(e.inside?(a="bottom","top"==e.valign&&(o=-s,a="top"),"middle"==e.valign&&(o=-s/2,a="middle")):a="top",r.y+=o),0==e.rotation&&(e.verticalCenter=a),this.positionItem(e,r),this.toggleVisibility(e,t,this.minLabelPosition,this.maxLabelPosition)},Object.defineProperty(t.prototype,"axisLength",{get:function(){var e=this.axis;return e.measuredWidth-e.pixelPaddingRight-e.pixelPaddingLeft||0},enumerable:!0,configurable:!0}),t.prototype.positionToPoint=function(e,t){return{x:this.positionToCoordinate(e),y:0}},t.prototype.pointToPosition=function(e){return this.coordinateToPosition(e.x,e.y)},t.prototype.getPositionRangePath=function(e,t){var i=gl(this.positionToCoordinate(e),0,this.axisLength),n=gl(this.positionToCoordinate(t),0,this.axisLength),r=Math.abs(n-i),a=this.getHeight();return gd({x:Math.min(i,n),y:0,width:r,height:a},!0)},t.prototype.updateBreakElement=function(t){e.prototype.updateBreakElement.call(this,t);var i=t.startLine,n=t.endLine,r=t.fillShape,a=t.startPoint,o=t.endPoint,s=t.pixelMarginLeft,l=this.getHeight()-t.pixelMarginTop-t.pixelMarginBottom;a.x=gl(a.x,-1,this.axisLength+1),o.x=gl(o.x,-1,this.axisLength+1),a.x==o.x&&(a.x<0||a.x>this.axisLength)?t.fillShape.__disabled=!0:t.fillShape.__disabled=!1,i.y=s,i.width=0,i.height=l,n.y=s,n.width=0,n.height=l,r.height=l,r.width=Math.abs(o.x-a.x),r.y=s,r.x=a.x},t.prototype.updateGridElement=function(e,t,i){t+=(i-t)*e.location;var n=this.positionToPoint(t);e.path=dd({x:0,y:0})+fd({x:0,y:this.getHeight()}),this.positionItem(e,n),this.toggleVisibility(e,t,0,1)},t.prototype.updateTickElement=function(e,t,i){t+=(i-t)*e.location;var n=this.positionToPoint(t),r=e.length;n.y=qc({x:0,y:this.line.pixelY},this.line.parent,this.gridContainer).y,this.opposite?r*=e.inside?1:-1:r*=e.inside?-1:1,e.path=dd({x:0,y:0})+fd({x:0,y:r}),this.positionItem(e,n),this.toggleVisibility(e,t,0,1)},t.prototype.updateAxisLine=function(){this.line.path=dd({x:0,y:0})+fd({x:this.axisLength,y:0})},t.prototype.updateBaseGridElement=function(){e.prototype.updateBaseGridElement.call(this);var t=this.axis,i=this.getHeight(),n=this.axisLength,r=this.baseGrid,a=t.basePoint.x;if(a<-.2||a>n+.2)r.hide(0);else{var o=qc({x:0,y:0},this.gridContainer,r.parent).y;r.path=dd({x:0,y:0})+fd({x:0,y:i}),r.moveTo({x:a,y:o}),r.show(0)}},t.prototype.createBreakSprites=function(e){e.startLine=new Wd,e.endLine=new Wd;var t=new Hd;t.setWavedSides(!1,!0,!1,!0),e.fillShape=t},t.prototype.toAxisPosition=function(e){var t=e,i=this.axis;if(i){var n=i.relativePositionSprite,r=i.pixelX;if(n?r=qc({x:this.pixelX,y:0},this.parent,n).x:n=i.parent,n)return(t-r/n.innerWidth)/(i.axisLength/n.innerWidth)}return e},t.prototype.updateBullet=function(e,t,i){var n=.5;e instanceof Mf&&(n=e.location),t+=(i-t)*n;var r=this.positionToPoint(t);r.y=qc({x:0,y:this.line.pixelY},this.line.parent,this.gridContainer).y,this.positionItem(e,r),this.toggleVisibility(e,t,0,1)},t}(Cf);Bu.registeredClasses.AxisRendererX=Lf,ed.push({relevant:td.heightXS,state:function(e,t){if(e instanceof Lf){var i=e.states.create(t);return i.properties.inside=!0,i.properties.maxLabelPosition=.9,i.properties.minLabelPosition=.1,i}return null}}),ed.push({relevant:td.heightXXS,state:function(e,t){if(e instanceof Lf){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var zf=function(e){function t(){var t=e.call(this)||this;t.className="HeatLegend",t.markerContainer=t.createChild(Wp),t.markerContainer.shouldClone=!1,t.markerCount=1;var i=new ad;return i.minHeight=20,i.minWidth=20,i.interactionsEnabled=!1,i.fillOpacity=1,i.cornerRadius(0,0,0,0),t.markerContainer.minHeight=20,t.markerContainer.minWidth=20,t.orientation="horizontal",t.markers=new Hu(i),t._disposers.push(new Uu(t.markers)),t._disposers.push(t.markers.template),t.applyTheme(),t}return Us(t,e),t.prototype.getMinFromRules=function(e){var t,i=this.series;if(i)return Su(i.heatRules.iterator(),(function(i){return i.property!=e||(t=i.min,!1)})),t},t.prototype.getMaxFromRules=function(e){var t,i=this.series;if(i)return Tu(i.heatRules.iterator(),(function(i){return i.property!=e||(t=i.max,!1)})),t},t.prototype.validate=function(){e.prototype.validate.call(this),this.valueAxis.renderer.inversed=this.reverseOrder;var t=this.series,i=this.minColor,n=this.maxColor;if(nl(i)||(i=cc(this.getMinFromRules("fill"))),nl(n)||(n=cc(this.getMaxFromRules("fill"))),t){var r=t.fill;!nl(i)&&r instanceof lc&&(i=r),!nl(n)&&r instanceof lc&&(n=r)}nl(n)||(n=cc(this.getMaxFromRules("fill")));var a=el(this.getMinFromRules("fillOpacity"));ll(a)||(a=1);var o=el(this.getMaxFromRules("fillOpacity"));ll(o)||(o=1);var s=el(this.getMinFromRules("strokeOpacity"));ll(s)||(s=1);var l=el(this.getMaxFromRules("strokeOpacity"));ll(l)||(l=1);for(var u=cc(this.getMinFromRules("stroke")),c=cc(this.getMaxFromRules("stroke")),h=0;h<this.markerCount;h++){var p=this.markers.getIndex(h);if(p||((p=this.markers.create()).parent=this.markerContainer,p.height=Ks(100),p.width=Ks(100)),1==this.markerCount){var d=new _p;if(this.reverseOrder?(d.addColor(n,o),d.addColor(i,a)):(d.addColor(i,a),d.addColor(n,o)),"vertical"==this.orientation&&(d.rotation=-90),p.fill=d,nl(u)&&nl(c)){var f=new _p;this.reverseOrder?(f.addColor(c,l),f.addColor(u,s)):(f.addColor(u,s),f.addColor(c,l)),"vertical"==this.orientation&&(f.rotation=-90),p.stroke=f}}else{var m=h;this.reverseOrder&&(m=this.markerCount-h-1);var v=new lc(rc(i.rgb,n.rgb,m/this.markerCount));p.fill=v;var y=a+(o-a)*m/this.markerCount;if(p.fillOpacity=y,nl(u)&&nl(c)){var g=new lc(rc(u.rgb,c.rgb,m/this.markerCount));p.stroke=g;var _=s+(l-s)*m/this.markerCount;p.strokeOpacity=_}}}var b=this.valueAxis.renderer;this.markerCount>1&&("horizontal"==this.orientation?b.minGridDistance=this.measuredWidth/this.markerCount:b.minGridDistance=this.measuredHeight/this.markerCount),this.valueAxis.invalidate();h=this.markerCount;for(var x=this.markers.length;h<x;h++)this.markers.getIndex(h).parent=void 0},Object.defineProperty(t.prototype,"minColor",{get:function(){return this.getPropertyValue("minColor")},set:function(e){e instanceof lc||(e=cc(e)),this.setColorProperty("minColor",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxColor",{get:function(){return this.getPropertyValue("maxColor")},set:function(e){e instanceof lc||(e=cc(e)),this.setColorProperty("maxColor",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"markerCount",{get:function(){return this.getPropertyValue("markerCount")},set:function(e){this.setPropertyValue("markerCount",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minValue",{get:function(){return this.getPropertyValue("minValue")},set:function(e){this.setPropertyValue("minValue",e),this.valueAxis.min=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.getPropertyValue("maxValue")},set:function(e){this.setPropertyValue("maxValue",e),this.valueAxis.max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this.getPropertyValue("orientation")},set:function(e){this.setPropertyValue("orientation",e,!0);var t=this.markerContainer,i=this.valueAxis;"horizontal"==e?(nl(this.width)||(this.width=200),this.height=void 0,i.width=Ks(100),i.height=void 0,i.tooltip.pointerOrientation="vertical",this.layout="vertical",t.width=Ks(100),t.height=void 0,i.renderer instanceof Lf||(i.renderer=new Lf)):(nl(this.height)||(this.height=200),this.width=void 0,this.layout="horizontal",t.width=void 0,t.height=Ks(100),i.height=Ks(100),i.width=void 0,i.tooltip.pointerOrientation="horizontal",i.renderer instanceof If||(i.renderer=new If),i.renderer.inside=!0,i.renderer.labels.template.inside=!0,this.markerContainer.reverseOrder=!0);var n=i.renderer;n.grid.template.disabled=!0,n.axisFills.template.disabled=!0,n.baseGrid.disabled=!0,n.labels.template.padding(2,3,2,3),n.minHeight=void 0,n.minWidth=void 0,this.markerContainer.layout=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueAxis",{get:function(){return this._valueAxis||(this.valueAxis=this.createChild(Af),this.valueAxis.shouldClone=!1),this._valueAxis},set:function(e){this._valueAxis=e,e.parent=this,e.strictMinMax=!0,this.orientation=this.orientation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"series",{get:function(){return this._series},set:function(e){var t=this;this._series=e;var i="value";try{var n=e.heatRules.getIndex(0).dataField;n&&(i=n)}catch(r){}this.updateMinMax(e.dataItem.values[i].low,e.dataItem.values[i].high),e.dataItem.events.on("calculatedvaluechanged",(function(n){t.updateMinMax(e.dataItem.values[i].low,e.dataItem.values[i].high)}),void 0,!1),e.heatRules.events.on("inserted",this.invalidate,this,!1),e.heatRules.events.on("removed",this.invalidate,this,!1)},enumerable:!0,configurable:!0}),t.prototype.updateMinMax=function(e,t){var i=this.valueAxis;ll(this.minValue)||(i.min=e,i.invalidate()),ll(this.maxValue)||(i.max=t,i.invalidate())},t.prototype.processConfig=function(t){if(t&&nl(t.series)&&sl(t.series)&&sl(t.series))if(this.map.hasKey(t.series))t.series=this.map.getKey(t.series);else{var i=t.series,n=this.map.events.on("insertKey",(function(e){e.key==i&&(this.series=e.newValue,n.dispose())}),this);this._disposers.push(n),delete t.series}e.prototype.processConfig.call(this,t)},t}(Wp);Bu.registeredClasses.HeatLegend=zf;var Rf=function(e){function t(){var t=e.call(this)||this;t.className="Grip";var i=new Xh;t.layout="absolute",t.padding(10,10,10,10),t.margin(3,3,3,3),t.background.fillOpacity=.3,t.background.cornerRadius(10,10,10,10);var n=new Up;n.element=t.paper.add("path");var r=dd({x:-6,y:0});return r+=fd({x:6,y:0}),r+=dd({x:-8,y:-6}),r+=fd({x:0,y:-12}),r+=fd({x:8,y:-6}),r+=dd({x:-8,y:6}),r+=fd({x:0,y:12}),r+=fd({x:8,y:6}),n.path=r,n.strokeWidth=2,n.fillOpacity=0,n.pixelPerfect=!0,n.padding(0,4,0,4),n.stroke=i.getFor("text"),n.strokeOpacity=.7,n.align="center",n.valign="middle",t.icon=n,t.label.dispose(),t.label=void 0,t.position="right",t.autoHideDelay=3e3,t.events.on("shown",(function(e){t._autoHideTimeout&&t._autoHideTimeout.dispose(),t.autoHideDelay&&(t._autoHideTimeout=t.setTimeout((function(){t.hide()}),t.autoHideDelay))})),t.events.on("down",(function(e){t._autoHideTimeout&&t._autoHideTimeout.dispose()})),t.events.on("out",(function(e){t.autoHideDelay&&(t._autoHideTimeout=t.setTimeout((function(){t.hide()}),t.autoHideDelay))})),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"position",{get:function(){return this.getPropertyValue("position")},set:function(e){if(this.setPropertyValue("position",e))switch(e){case"left":this.align="left",this.valign="middle",this.horizontalCenter="left",this.verticalCenter="middle",this.icon.rotation=0,this.width=void 0,this.height=Ks(30);break;case"right":this.align="right",this.valign="middle",this.horizontalCenter="right",this.verticalCenter="middle",this.icon.rotation=0,this.width=void 0,this.height=Ks(30);break;case"top":this.align="center",this.valign="top",this.horizontalCenter="middle",this.verticalCenter="top",this.icon.rotation=90,this.width=Ks(30),this.height=void 0;break;case"bottom":this.align="center",this.valign="bottom",this.horizontalCenter="middle",this.verticalCenter="bottom",this.icon.rotation=90,this.width=Ks(30),this.height=void 0;break;default:this.align="center",this.valign="middle",this.horizontalCenter="middle",this.verticalCenter="middle",this.icon.rotation=90,this.width=Ks(30),this.height=void 0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoHideDelay",{get:function(){return this.getPropertyValue("autoHideDelay")},set:function(e){this.setPropertyValue("autoHideDelay",e)},enumerable:!0,configurable:!0}),t}(od);Bu.registeredClasses.Grip=Rf;var Ff=function(e){function t(){var t=e.call(this)||this;return t.className="ChartDataItem",t.applyTheme(),t}return Us(t,e),t}(id),jf=function(e){function t(){var i=e.call(this)||this;if(i._legend=new iu,i.constructor===t)throw new Error("'Chart' cannot be instantiated directly. Please use a specific chart type.");i.className="Chart";var n=new rd;i.titles=new Hu(n),i._disposers.push(new Uu(i.titles)),i._disposers.push(n),i.width=Ks(100),i.height=Ks(100),i.layout="vertical";var r=i.createChild(Wp);r.shouldClone=!1,r.layout="vertical",r.width=Ks(100),r.height=Ks(100),i.chartAndLegendContainer=r;var a=r.createChild(Wp);return a.shouldClone=!1,a.width=Ks(100),a.height=Ks(100),i.chartContainer=a,i.showOnInit=!0,i._disposers.push(i._legend),i.titles.events.on("inserted",(function(e){i.processTitle(e),i.updateReaderTitleReferences()}),i,!1),i.titles.events.on("removed",(function(e){i.updateReaderTitleReferences()}),i,!1),i.role="region",i.defaultState.transitionDuration=1,i.applyTheme(),i}return Us(t,e),t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Chart"))},t.prototype.draw=function(){this.fixLayout(),e.prototype.draw.call(this)},t.prototype.fixLayout=function(){var e=this.legend;if(e){var t=this.chartAndLegendContainer,i=this.chartContainer;switch(i.x=void 0,i.y=void 0,"absolute"!=e.position&&(e.x=void 0,e.y=void 0),e.position){case"left":t.layout="horizontal",e.toBack();break;case"right":t.layout="horizontal",e.toFront();break;case"top":t.layout="vertical",e.toBack();break;case"bottom":t.layout="vertical",e.toFront();break;case"absolute":e.isMeasured=!1}}},t.prototype.feedLegend=function(){},t.prototype.processTitle=function(e){var t=e.newValue;return t.parent=this,t.toBack(),t.shouldClone=!1,t.align="center",t.uidAttr(),t},t.prototype.updateReaderTitleReferences=function(){if(this.titles.length){var e=[];Tu(this.titles.iterator(),(function(t){e.push(t.uid)})),this.setSVGAttribute({"aria-labelledby":e.join(" ")})}else this.removeSVGAttribute("aria-labelledby")},Object.defineProperty(t.prototype,"legend",{get:function(){return this._legend.get()},set:function(e){this.setLegend(e)},enumerable:!0,configurable:!0}),t.prototype.setLegend=function(e){var t=this;this._legend.get()!==e&&(e?(e.parent=this.chartAndLegendContainer,this._legend.set(e,e.events.on("propertychanged",(function(e){"position"==e.property&&t.fixLayout()}),void 0,!1)),e.addDisposer(new eu((function(){t.legend=void 0})))):this._legend.reset(),this.feedLegend())},t.prototype.dispose=function(){this.legend&&this.legend.dispose(),e.prototype.dispose.call(this)},t.prototype.processConfig=function(t){t&&nl(t.legend)&&!nl(t.legend.type)&&(t.legend.type="Legend"),e.prototype.processConfig.call(this,t)},t.prototype.copyFrom=function(t){this.titles.copyFrom(t.titles),this.chartContainer.copyFrom(t.chartContainer),t.legend&&(this.legend=t.legend.clone(),this.legend.removeChildren()),e.prototype.copyFrom.call(this,t)},Object.defineProperty(t.prototype,"dragGrip",{get:function(){var e=this;if(!this._dragGrip){var t=this.tooltipContainer.createChild(Rf);t.align="right",t.valign="middle",t.hide(0),t.events.on("down",(function(t){t.touch&&(e.interactionsEnabled=!1)})),t.events.on("up",(function(t){e.interactionsEnabled=!0})),this.events.on("down",(function(e){e.touch&&t.show()})),this._dragGrip=t}return this._dragGrip},set:function(e){this._dragGrip=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusable",{get:function(){return this.parent.focusable},set:function(e){this.parent.focusable=e},enumerable:!0,configurable:!0}),t}(nd);Bu.registeredClasses.Chart=jf,ed.push({relevant:td.widthXS,state:function(e,t){if(e instanceof jf){var i=e.states.create(t);return e.pixelPaddingLeft>10&&(i.properties.paddingLeft=10),e.pixelPaddingRight>10&&(i.properties.paddingRight=10),i}return null}}),ed.push({relevant:td.heightXS,state:function(e,t){if(e instanceof jf){var i=e.states.create(t);return e.pixelPaddingTop>10&&(i.properties.paddingTop=10),e.pixelPaddingBottom>10&&(i.properties.paddingBottom=10),i}return null}}),ed.push({relevant:td.widthXXS,state:function(e,t){if(e instanceof jf){var i=e.states.create(t);return i.properties.paddingLeft=0,i.properties.paddingRight=0,i}return null}}),ed.push({relevant:td.heightXXS,state:function(e,t){if(e instanceof jf){var i=e.states.create(t);return i.properties.paddingTop=0,i.properties.paddingBottom=0,i}return null}});var Bf=function(e){function t(){var t=e.call(this)||this;return t.className="Bullet",t.isMeasured=!1,t.tooltipX=0,t.tooltipY=0,t.layout="none",t.applyOnClones=!0,t.copyToLegendMarker=!0,t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"locationX",{get:function(){return this.getPropertyValue("locationX")},set:function(e){if(this.setPropertyValue("locationX",e)){var t=this.dataItem;t&&t.component&&t.component.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"locationY",{get:function(){return this.getPropertyValue("locationY")},set:function(e){if(this.setPropertyValue("locationY",e)){var t=this.dataItem;t&&t.component&&t.component.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xField",{get:function(){return this.getPropertyValue("xField")},set:function(e){this.setPropertyValue("xField",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yField",{get:function(){return this.getPropertyValue("yField")},set:function(e){this.setPropertyValue("yField",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDynamic",{get:function(){return this.getPropertyValue("isDynamic")},set:function(e){this.setPropertyValue("isDynamic",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copyToLegendMarker",{get:function(){return this.getPropertyValue("copyToLegendMarker")},set:function(e){this.setPropertyValue("copyToLegendMarker",e)},enumerable:!0,configurable:!0}),t}(Wp);Bu.registeredClasses.Bullet=Bf,ed.push({relevant:td.isXS,state:function(e,t){if(e instanceof Bf){var i=e.states.create(t);return i.properties.disabled=!0,i}return null}});var Vf=function(e){function t(){var t=e.call(this)||this;return t.className="SeriesDataItem",t.values.value={},t.values.value={},t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"bullets",{get:function(){return this._bullets||(this._bullets=new Lu,this._disposers.push(new Au(this._bullets))),this._bullets},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.bullets.clear(),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.values.value.value},set:function(e){this.setValue("value",e)},enumerable:!0,configurable:!0}),t}(id),Nf=function(e){function t(){var i=e.call(this)||this;if(i._ignoreMinMax=!1,i._showBullets=!0,i.legendSettings=new vf,i._tmin=new Lu,i._tmax=new Lu,i._smin=new Lu,i._smax=new Lu,i.dataItemsByAxis=new Lu,i.skipFocusThreshold=20,i._itemReaderTextChanged=!1,i.calculatePercent=!1,i.usePercentHack=!0,i.autoDispose=!0,i.simplifiedProcessing=!1,i.constructor===t)throw new Error("'Series' cannot be instantiated directly. Please use a specific series type.");i.className="Series",i.isMeasured=!1,i.layout="none",i.shouldClone=!1,i.setPropertyValue("hidden",!1),i.axisRanges=new Wu,i.axisRanges.events.on("inserted",i.processAxisRange,i,!1),i.minBulletDistance=0,i.mainContainer=i.createChild(Wp),i.mainContainer.shouldClone=!1,i.mainContainer.mask=i.createChild(Up),i._disposers.push(i.mainContainer);var n=i.mainContainer.createChild(Wp);return i._shouldBeReady.push(n),n.shouldClone=!1,n.layout="none",n.virtualParent=i,i._disposers.push(n),i.bulletsContainer=n,i.tooltip=new Ld,i.tooltip.virtualParent=i,i._disposers.push(i.tooltip),i.hiddenState.transitionEasing=lh,i.dataItem=i.createDataItem(),i._disposers.push(i.dataItem),i.dataItem.component=i,i.role="group",i.applyTheme(),i}return Us(t,e),t.prototype.applyTheme=function(){e.prototype.applyTheme.call(this),_h.autoSetClassName&&this.bulletsContainer&&(this.bulletsContainer.className=this.className+"-bullets",this.bulletsContainer.setClassName())},t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Series"))},t.prototype.createDataItem=function(){return new Vf},Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart=e},enumerable:!0,configurable:!0}),t.prototype.positionBullet=function(e){},t.prototype.processBullet=function(e){var t=this,i=e.newValue;i.isTemplate=!0,this.events.once("datavalidated",(function(e){t.itemsFocusable()&&(i.focusable=!0)})),this.invalidate()},t.prototype.removeBullet=function(e){var t=e.oldValue;this.dataItems.each((function(e){var i=e.bullets.getKey(t.uid);i&&i.dispose()})),this.invalidate()},t.prototype.validateDataItems=function(){e.prototype.validateDataItems.call(this),this.processValues(!1)},t.prototype.getFirstValue=function(e,t){for(var i=t;i>=0;i--){var n=this.dataItems.getIndex(i).getActualWorkingValue(e);if(ll(n))return n}return null},t.prototype.getAbsoluteFirstValue=function(e){for(var t=0;t<this.dataItems.length;t++){var i=this.dataItems.getIndex(t).values[e].value;if(ll(i))return i}return null},t.prototype.rangeChangeUpdate=function(){e.prototype.rangeChangeUpdate.call(this),this.processValues(!0)},t.prototype.processValues=function(e){var t=this;if(!this.simplifiedProcessing){var i=this.dataItems,n={},r={},a={},o={},s={},l={},u={},c={},h={},p={},d=xl(0,this.startIndex);d=wl(d,this.dataItems.length);var f=wl(this.endIndex,this.dataItems.length);if(ll(d)||(d=0),ll(f)||(f=this.dataItems.length),d>0){var m=i.getIndex(d-1);gu(m.values,(function(e,t){var i=m.getActualWorkingValue(e);ll(i)&&(c[e]=i)}))}for(var v=function(e){var f=i.getIndex(e);gu(f.values,(function(e,i){var m=f.getActualWorkingValue(e);if(ll(m)){ll(n[e])||(n[e]=0),n[e]++,ll(r[e])||(r[e]=0),r[e]+=m,ll(a[e])||(a[e]=0),a[e]+=Math.abs(m),ll(l[e])||(l[e]=m),u[e]=m,ll(o[e])?o[e]>m&&(o[e]=m):o[e]=m,ll(s[e])?s[e]<m&&(s[e]=m):s[e]=m,ll(h[e])||(h[e]=t.getFirstValue(e,d)),ll(p[e])||(p[e]=t.getAbsoluteFirstValue(e)),f.setCalculatedValue(e,m-h[e],"change"),f.setCalculatedValue(e,(m-h[e])/h[e]*100,"changePercent"),f.setCalculatedValue(e,m-p[e],"startChange"),f.setCalculatedValue(e,(m-p[e])/p[e]*100,"startChangePercent");var v=c[e];ll(v)||(v=m),f.setCalculatedValue(e,m-v,"previousChange"),f.setCalculatedValue(e,(m-v)/v*100,"previousChangePercent"),c[e]=m}}))},y=d;y<f;y++)v(y);if(this.calculatePercent){var g=function(e){var n=i.getIndex(e);gu(n.values,(function(e){var i=a[e],r=n.getActualWorkingValue(e);if(ll(r))if(i>0){t.usePercentHack&&r==i&&(i=n.values[e].value);var o=r/i*100;n.setCalculatedValue(e,o,"percent")}else n.setCalculatedValue(e,0,"percent")}))};for(y=d;y<f;y++)g(y)}if(d>0){var _=i.getIndex(d-1);gu(_.values,(function(e){var t=_.values[e].value;_.setCalculatedValue(e,t-l[e],"change"),_.setCalculatedValue(e,(t-l[e])/l[e]*100,"changePercent")}))}var b=this.dataItem;gu(b.values,(function(e){b.setCalculatedValue(e,r[e],"sum"),b.setCalculatedValue(e,a[e],"absoluteSum"),b.setCalculatedValue(e,r[e]/n[e],"average"),b.setCalculatedValue(e,l[e],"open"),b.setCalculatedValue(e,u[e],"close"),b.setCalculatedValue(e,o[e],"low"),b.setCalculatedValue(e,s[e],"high"),b.setCalculatedValue(e,n[e],"count")}))}},t.prototype.validate=function(){window.MSInputMethodContext&&document.documentMode&&this.filters.clear(),Tu(this.axisRanges.iterator(),(function(e){e.validate()})),e.prototype.validate.call(this);var t=this.bulletsContainer;if(t.fill=this.fill,t.stroke=this.stroke,t.x=this.pixelX,t.y=this.pixelY,this.bulletsContainer.children.length>0)if(this._showBullets){for(var i=0;i<this.startIndex;i++){(n=this.dataItems.getIndex(i))&&n.bullets.each((function(e,t){t.__disabled=!0}))}for(i=this.dataItems.length-1;i>this.endIndex;i--){var n;(n=this.dataItems.getIndex(i))&&n.bullets.each((function(e,t){t.__disabled=!0}))}}else this.bulletsContainer.children.each((function(e){e.__disabled=!0}));this.updateTooltipBounds()},t.prototype.updateTooltipBounds=function(){if(this.topParent){var e={x:0,y:0,width:this.topParent.maxWidth,height:this.topParent.maxHeight};this.tooltip.setBounds(e)}},t.prototype.shouldCreateBullet=function(e,t){return!0},t.prototype.validateDataElement=function(t){var i=this;e.prototype.validateDataElement.call(this,t),this._showBullets?(this.isHidden||(this.bulletsContainer.visible=!0),this.bullets.each((function(e){var n=t.bullets.getKey(e.uid);if(i.shouldCreateBullet(t,e)){if(!n){var r=e.propertyFields.disabled,a=t.dataContext;r&&a&&!1===a[r]?(e.applyOnClones=!1,e.disabled=!1,n=e.clone(),e.disabled=!0,e.applyOnClones=!0):n=e.clone(),n.shouldClone=!1,t.addSprite(n),i.visible&&!i.isHiding||n.hide(0)}var o=n.dataItem;if(o!=t){o&&o.bullets.setKey(e.uid,void 0);var s=i.itemReaderText;n instanceof Bf&&(s||(s="{"+n.xField+"}: {"+n.yField+"}"),n.isDynamic&&(t.events.on("workingvaluechanged",n.deepInvalidate,n,!1),i.dataItem.events.on("workingvaluechanged",n.deepInvalidate,n,!1)),n.deepInvalidate()),n.focusable&&(n.events.on("focus",(function(e){n.readerTitle=i.populateString(s,n.dataItem)}),void 0,!1),n.events.on("blur",(function(e){n.readerTitle=""}),void 0,!1)),n.hoverable&&(n.events.on("over",(function(e){n.readerTitle=i.populateString(s,n.dataItem)}),void 0,!1),n.events.on("out",(function(e){n.readerTitle=""}),void 0,!1))}n.parent=i.bulletsContainer,t.bullets.setKey(e.uid,n),n.maxWidth=t.itemWidth,n.maxHeight=t.itemHeight,n.__disabled=!1,i.positionBullet(n)}else n&&(n.__disabled=!0)}))):this.bulletsContainer.visible=!1},t.prototype.handleDataItemWorkingValueChange=function(e,t){this.dataRangeInvalid||this.invalidateProcessedData()},Object.defineProperty(t.prototype,"ignoreMinMax",{get:function(){return this._ignoreMinMax},set:function(e){this._ignoreMinMax=e,this.invalidateDataItems()},enumerable:!0,configurable:!0}),t.prototype.createMask=function(){},t.prototype.processAxisRange=function(e){this.rangesContainer||(this.rangesContainer=this.createChild(Wp),this.rangesContainer.shouldClone=!1,this.rangesContainer.isMeasured=!1);var t=e.newValue;t&&(t.contents.parent=this.rangesContainer,t.isRange=!0,t.events.on("valuechanged",this.invalidateDataItems,this,!1))},t.prototype.getAxisField=function(e){},t.prototype.showTooltipAtPosition=function(e,t){},Object.defineProperty(t.prototype,"minBulletDistance",{get:function(){return this.getPropertyValue("minBulletDistance")},set:function(e){this.setPropertyValue("minBulletDistance",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bullets",{get:function(){return this._bullets||(this._bullets=new Hu(new Bf),this._bullets.template.virtualParent=this,this._bullets.events.on("inserted",this.processBullet,this,!1),this._bullets.events.on("removed",this.removeBullet,this,!1),this._disposers.push(new Uu(this._bullets)),this._disposers.push(this._bullets.template)),this._bullets},enumerable:!0,configurable:!0}),t.prototype.createLegendMarker=function(e){},Object.defineProperty(t.prototype,"hiddenInLegend",{get:function(){return this.getPropertyValue("hiddenInLegend")},set:function(e){this.setPropertyValue("hiddenInLegend",e)&&this.chart&&this.chart.feedLegend()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.getPropertyValue("name")},set:function(e){this.setPropertyValue("name",e);var t=this.legendDataItem;t&&(t.component.invalidate(),t.component.invalidateRawData()),this.readerTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemReaderText",{get:function(){var e=this._itemReaderText;return e||(this.tooltipText?e=zc(this.tooltipText):this.tooltipHTML&&(e=zc(this.tooltipHTML))),this._adapterO?this._adapterO.apply("itemReaderText",e):e},set:function(e){this._itemReaderText=e,this._itemReaderTextChanged=!0},enumerable:!0,configurable:!0}),t.prototype.itemsFocusable=function(){return!(this.dataItems.length>=this.skipFocusThreshold)},Object.defineProperty(t.prototype,"legendDataItem",{get:function(){return this._legendDataItem},set:function(e){this._legendDataItem=e,this._legendDataItem.itemContainer.deepInvalidate()},enumerable:!0,configurable:!0}),t.prototype.updateLegendValue=function(e,t){if(this.legendDataItem){var i=this.legendSettings,n=this.legendDataItem,r=n.label,a=n.valueLabel;e&&!e.isDisposed()||t?(a&&(i.itemValueText&&(a.text=i.itemValueText),a.dataItem=e),r&&(i.itemLabelText&&(r.text=i.itemLabelText),r.dataItem=e)):(r&&((i.labelText||void 0!=i.itemLabelText)&&(r.text=i.labelText),r.dataItem=this.dataItem),a&&((i.valueText||void 0!=i.itemValueText)&&(a.text=i.valueText),a.dataItem=this.dataItem))}},t.prototype.copyFrom=function(t){this.bullets.copyFrom(t.bullets),this.bulletsContainer.copyFrom(t.bulletsContainer),this.calculatePercent=t.calculatePercent,this.usePercentHack=t.usePercentHack,this.simplifiedProcessing=t.simplifiedProcessing,e.prototype.copyFrom.call(this,t)},t.prototype.raiseCriticalError=function(e){this._chart&&this._chart.modal&&(this._chart.modal.content=this._chart.adapter.apply("criticalError",e).message,this._chart.modal.closable=!1,_h.suppressErrors||this._chart.modal.open(),this._chart.disabled=!0),_h.verbose&&console.log(e)},t.prototype.applyFilters=function(){var t=this;e.prototype.applyFilters.call(this),this.bulletsContainer.filters.clear(),Tu(this.filters.iterator(),(function(e){t.bulletsContainer.filters.push(e.clone())}))},Object.defineProperty(t.prototype,"heatRules",{get:function(){var e=this;return this._heatRules||(this._heatRules=new Wu,this._heatRules.events.on("inserted",(function(t){var i=t.newValue,n=i.target;if(n){var r=i.dataField;nl(r)||(r="value");var a=e.dataItem,o=i.property,s=el(i.minValue),l=el(i.maxValue);ll(s)||ll(l)||e.dataItem.events.on("calculatedvaluechanged",(function(t){t.property==r&&Tu(e.dataItems.iterator(),(function(e){var t=!1;Nl(e.sprites,(function(e){if(e.clonedFrom==n){var i=e;i[o]=i[o],t=!0}})),t||Nl(e.sprites,(function(e){e instanceof Wp&&Tu(e.children.iterator(),(function(e){if(e.className==n.className){var t=e;t[o]=t[o]}else e instanceof Wp&&e.deepInvalidate()}))}))}))})),e.dataItems.template.events.on("workingvaluechanged",(function(e){if(e.property==r){var t=e.target,i=!1;Nl(t.sprites,(function(e){if(e.clonedFrom==n){var t=e;t[o]=t[o],i=!0}})),i||Nl(t.sprites,(function(e){e instanceof Wp&&Tu(e.children.iterator(),(function(e){if(e.className==n.className){var t=e;t[o]=t[o]}else e instanceof Wp&&e.deepInvalidate()}))}))}})),n.adapter.add(o,(function(e,t,n){var o=el(i.minValue),s=el(i.maxValue),l=i.min,u=i.max;if(t instanceof Up){var c=t.propertyFields[n];if(c&&t.dataItem){var h=t.dataItem.dataContext;if(h&&nl(h[c]))return e}}var p=t.dataItem;if((ll(o)||(o=a.values[r].low),ll(s)||(s=a.values[r].high),p)&&p.values[r]){var d=p.getActualWorkingValue(r);if(nl(l)&&nl(u)&&ll(o)&&ll(s)&&ll(d)){var f=void 0;if(f=i.logarithmic?(Math.log(d)*Math.LOG10E-Math.log(o)*Math.LOG10E)/(Math.log(s)*Math.LOG10E-Math.log(o)*Math.LOG10E):(d-o)/(s-o),!ll(d)||ll(f)&&Math.abs(f)!=1/0||(f=.5),ll(l))return l+(u-l)*f;if(l instanceof lc)return new lc(rc(l.rgb,u.rgb,f))}}return e}))}}))),this._heatRules},enumerable:!0,configurable:!0}),t.prototype.processConfig=function(t){var i;if(t){if(nl(t.bullets)&&cl(t.bullets))for(var n=0,r=t.bullets.length;n<r;n++){var a=t.bullets[n];nl(a.type)||(a.type="Bullet")}nl(t.heatRules)&&cl(t.heatRules)&&(i=t.heatRules,delete t.heatRules)}if(e.prototype.processConfig.call(this,t),i){for(n=0,r=i.length;n<r;n++){var o=i[n],s=this;if(nl(o.target)&&sl(o.target))if(this.map.hasKey(o.target))s=this.map.getKey(o.target);else for(var l=o.target.split("."),u=0;u<l.length;u++)if(s instanceof Wu){var c=s.getIndex(el(l[u]));s=c||s[l[u]]}else{var h=l[u].match(/^(.*)\[([0-9]+)\]/);s=h?s[h[1]]instanceof Wu?s[h[1]].getIndex(el(h[2])):s[h[1]][el(h[2])]:s[l[u]]}o.target=s,nl(o.min)&&(o.min=this.maybeColorOrPercent(o.min)),nl(o.max)&&(o.max=this.maybeColorOrPercent(o.max))}e.prototype.processConfig.call(this,{heatRules:i})}},t.prototype.configOrder=function(t,i){return t==i?0:"heatRules"==t?1:"heatRules"==i?-1:e.prototype.configOrder.call(this,t,i)},t.prototype.setVisibility=function(t){e.prototype.setVisibility.call(this,t),this.bulletsContainer.visible=t},t}(nd);Bu.registeredClasses.Series=Nf,Bu.registeredClasses.SeriesDataItem=Vf;var Uf=function(e){function t(){var t=e.call(this)||this;return t.className="SerialChartDataItem",t.applyTheme(),t}return Us(t,e),t}(Ff),Gf=function(e){function t(){var t=e.call(this)||this;t.className="SerialChart",t.colors=new sf,t._usesData=!1;var i=t.chartContainer.createChild(Wp);i.shouldClone=!1,i.width=Ks(100),i.height=Ks(100),i.isMeasured=!1,i.layout="none",i.zIndex=2,t.seriesContainer=i;var n=t.chartContainer.createChild(Wp);return n.shouldClone=!1,n.width=Ks(100),n.height=Ks(100),n.isMeasured=!1,n.zIndex=3,n.layout="none",t.bulletsContainer=n,t.applyTheme(),t}return Us(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.colors&&this.colors.dispose(),this.patterns&&this.patterns.dispose()},t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Serial chart"))},Object.defineProperty(t.prototype,"series",{get:function(){return this._series||(this._series=new Hu(this.createSeries()),this._series.events.on("inserted",this.handleSeriesAdded,this,!1),this._series.events.on("removed",this.handleSeriesRemoved,this,!1),this._disposers.push(new Uu(this._series,!1)),this._disposers.push(this._series.template)),this._series},enumerable:!0,configurable:!0}),t.prototype.handleSeriesRemoved=function(e){var t=e.oldValue;this.dataUsers.removeValue(t),this.dataUsers.each((function(e){e.invalidateDataItems()})),t.autoDispose?t.dispose():(t.parent=void 0,t.bulletsContainer.parent=void 0);var i=this.legend;if(i){for(var n=this.legend.dataItems,r=n.length-1;r>=0;r--){var a=n.getIndex(r);a&&a.dataContext==t&&i.dataItems.remove(a)}for(r=i.data.length-1;r>=0;r--){var o=i.data[r];o&&o==t&&Gl(i.data,o)}}},t.prototype.handleSeriesAdded=function(e){var t=this,i=e.newValue;i.isDisposed()||(i.chart=this,i.parent=this.seriesContainer,i.bulletsContainer.parent=this.bulletsContainer,this._dataUsers.moveValue(i),i.addDisposer(new eu((function(){t.dataUsers.removeValue(i)}))),this.handleSeriesAdded2(i),this.handleLegendSeriesAdded(i))},t.prototype.handleLegendSeriesAdded=function(e){e.hiddenInLegend||this.legend&&this.legend.addData(e)},t.prototype.handleSeriesAdded2=function(e){var t=this;this.dataInvalid||this._disposers.push(Bu.events.once("exitframe",(function(){e.data&&0!=e.data.length||(e.data=t.data,e.showOnInit&&(e.reinit(),e.setPropertyValue("showOnInit",!1),e.showOnInit=!0),e.isDisposed()||e.events.once("datavalidated",(function(){e.data==t.data&&(e._data=[])})))})))},t.prototype.feedLegend=function(){var e=this.legend;if(e){var t=[];Tu(this.series.iterator(),(function(e){e.hiddenInLegend||t.push(e)})),e.dataFields.name="name",e.data=t}},t.prototype.createSeries=function(){return new Nf},Object.defineProperty(t.prototype,"colors",{get:function(){return this.getPropertyValue("colors")},set:function(e){this.setPropertyValue("colors",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"patterns",{get:function(){return this.getPropertyValue("patterns")},set:function(e){this.setPropertyValue("patterns",e,!0)},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.series.copyFrom(t.series)},t.prototype.appear=function(){e.prototype.appear.call(this),this.series.each((function(e){e.showOnInit&&e.inited&&e.appear()}))},t}(jf);Bu.registeredClasses.SerialChart=Gf;var Wf=function(){function e(){(0,kt.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,Pt.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,i=0,n=0;n<this._n&&n<32;n++){var r=t[n],a=e+r,o=Math.abs(e)<Math.abs(r)?e-(a-r):r-(a-e);o&&(t[i++]=o),e=a}return t[i]=e,this._n=i+1,this}},{key:"valueOf",value:function(){var e,t,i,n=this._partials,r=this._n,a=0;if(r>0){for(a=n[--r];r>0&&(e=a,!(i=(t=n[--r])-((a=e+t)-e))););r>0&&(i<0&&n[r-1]<0||i>0&&n[r-1]>0)&&(t=2*i)==(e=a+t)-a&&(a=e)}return a}}]),e}();var Hf=1e-6,Zf=Math.PI,qf=Zf/2,Xf=Zf/4,Kf=2*Zf,Yf=180/Zf,$f=Zf/180,Jf=Math.abs,Qf=Math.atan,em=Math.atan2,tm=Math.cos,im=Math.ceil,nm=Math.exp,rm=(Math.floor,Math.hypot,Math.log),am=(Math.pow,Math.sin),om=Math.sign||function(e){return e>0?1:e<0?-1:0},sm=Math.sqrt,lm=Math.tan;function um(e){return e>1?qf:e<-1?-qf:Math.asin(e)}function cm(e){return(e=am(e/2))*e}function hm(){}function pm(e,t){e&&fm.hasOwnProperty(e.type)&&fm[e.type](e,t)}var dm={Feature:function(e,t){pm(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,r=i.length;++n<r;)pm(i[n].geometry,t)}},fm={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){mm(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)mm(i[n],t,0)},Polygon:function(e,t){vm(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)vm(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,r=i.length;++n<r;)pm(i[n],t)}};function mm(e,t,i){var n,r=-1,a=e.length-i;for(t.lineStart();++r<a;)n=e[r],t.point(n[0],n[1],n[2]);t.lineEnd()}function vm(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)mm(e[i],t,1);t.polygonEnd()}function ym(e,t){e&&dm.hasOwnProperty(e.type)?dm[e.type](e,t):pm(e,t)}var gm,_m,bm,xm,wm,km,Pm,Sm,Tm,Em,Cm,Mm,Im,Om,Dm,Am,Lm=new Wf,zm=new Wf,Rm={point:hm,lineStart:hm,lineEnd:hm,polygonStart:function(){Lm=new Wf,Rm.lineStart=Fm,Rm.lineEnd=jm},polygonEnd:function(){var e=+Lm;zm.add(e<0?Kf+e:e),this.lineStart=this.lineEnd=this.point=hm},sphere:function(){zm.add(Kf)}};function Fm(){Rm.point=Bm}function jm(){Vm(gm,_m)}function Bm(e,t){Rm.point=Vm,gm=e,_m=t,bm=e*=$f,xm=tm(t=(t*=$f)/2+Xf),wm=am(t)}function Vm(e,t){var i=(e*=$f)-bm,n=i>=0?1:-1,r=n*i,a=tm(t=(t*=$f)/2+Xf),o=am(t),s=wm*o,l=xm*a+s*tm(r),u=s*n*am(r);Lm.add(em(u,l)),bm=e,xm=a,wm=o}function Nm(e){return zm=new Wf,ym(e,Rm),2*zm}function Um(e){return[em(e[1],e[0]),um(e[2])]}function Gm(e){var t=e[0],i=e[1],n=tm(i);return[n*tm(t),n*am(t),am(i)]}function Wm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Hm(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Zm(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Xm(e){var t=sm(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Km={point:Ym,lineStart:Jm,lineEnd:Qm,polygonStart:function(){Km.point=ev,Km.lineStart=tv,Km.lineEnd=iv,Om=new Wf,Rm.polygonStart()},polygonEnd:function(){Rm.polygonEnd(),Km.point=Ym,Km.lineStart=Jm,Km.lineEnd=Qm,Lm<0?(km=-(Sm=180),Pm=-(Tm=90)):Om>Hf?Tm=90:Om<-Hf&&(Pm=-90),Am[0]=km,Am[1]=Sm},sphere:function(){km=-(Sm=180),Pm=-(Tm=90)}};function Ym(e,t){Dm.push(Am=[km=e,Sm=e]),t<Pm&&(Pm=t),t>Tm&&(Tm=t)}function $m(e,t){var i=Gm([e*$f,t*$f]);if(Im){var n=Hm(Im,i),r=Hm([n[1],-n[0],0],n);Xm(r),r=Um(r);var a,o=e-Em,s=o>0?1:-1,l=r[0]*Yf*s,u=Jf(o)>180;u^(s*Em<l&&l<s*e)?(a=r[1]*Yf)>Tm&&(Tm=a):u^(s*Em<(l=(l+360)%360-180)&&l<s*e)?(a=-r[1]*Yf)<Pm&&(Pm=a):(t<Pm&&(Pm=t),t>Tm&&(Tm=t)),u?e<Em?nv(km,e)>nv(km,Sm)&&(Sm=e):nv(e,Sm)>nv(km,Sm)&&(km=e):Sm>=km?(e<km&&(km=e),e>Sm&&(Sm=e)):e>Em?nv(km,e)>nv(km,Sm)&&(Sm=e):nv(e,Sm)>nv(km,Sm)&&(km=e)}else Dm.push(Am=[km=e,Sm=e]);t<Pm&&(Pm=t),t>Tm&&(Tm=t),Im=i,Em=e}function Jm(){Km.point=$m}function Qm(){Am[0]=km,Am[1]=Sm,Km.point=Ym,Im=null}function ev(e,t){if(Im){var i=e-Em;Om.add(Jf(i)>180?i+(i>0?360:-360):i)}else Cm=e,Mm=t;Rm.point(e,t),$m(e,t)}function tv(){Rm.lineStart()}function iv(){ev(Cm,Mm),Rm.lineEnd(),Jf(Om)>Hf&&(km=-(Sm=180)),Am[0]=km,Am[1]=Sm,Im=null}function nv(e,t){return(t-=e)<0?t+360:t}function rv(e,t){return e[0]-t[0]}function av(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ov(e){var t,i,n,r,a,o,s;if(Tm=Sm=-(km=Pm=1/0),Dm=[],ym(e,Km),i=Dm.length){for(Dm.sort(rv),t=1,a=[n=Dm[0]];t<i;++t)av(n,(r=Dm[t])[0])||av(n,r[1])?(nv(n[0],r[1])>nv(n[0],n[1])&&(n[1]=r[1]),nv(r[0],n[1])>nv(n[0],n[1])&&(n[0]=r[0])):a.push(n=r);for(o=-1/0,t=0,n=a[i=a.length-1];t<=i;n=r,++t)r=a[t],(s=nv(n[1],r[0]))>o&&(o=s,km=r[0],Sm=n[1])}return Dm=Am=null,km===1/0||Pm===1/0?[[NaN,NaN],[NaN,NaN]]:[[km,Pm],[Sm,Tm]]}var sv=function(e){function t(){var t=e.call(this)||this;return t.className="MapSeriesDataItem",t.values.value={},t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.values.value.value},set:function(e){this.setValue("value",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomLevel",{get:function(){return this.properties.zoomLevel},set:function(e){this.setProperty("zoomLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomGeoPoint",{get:function(){return this.properties.zoomGeoPoint},set:function(e){this.setProperty("zoomGeoPoint",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"east",{get:function(){return this._east},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"west",{get:function(){return this._west},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"south",{get:function(){return this._south},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"north",{get:function(){return this._north},enumerable:!0,configurable:!0}),t.prototype.updateExtremes=function(){var e=this.getFeature().geometry;if(e){var t=ov(e),i=t[0][0],n=t[0][1],r=t[1][1],a=t[1][0],o=!1;r!=this.north&&(this._north=vl(r,6),o=!0),n!=this.south&&(this._south=vl(n,6),o=!0),a!=this.east&&(this._east=vl(a,6),o=!0),i!=this.west&&(this._west=vl(i,6),o=!0),this._east<this._west&&(this._east=180,this._west=-180),o&&this.component.invalidateDataItems()}},t.prototype.getFeature=function(){return{}},t}(Vf),lv=function(e){function t(){var t=e.call(this)||this;return t.className="MapSeries",t.isMeasured=!1,t.nonScalingStroke=!0,t.dataFields.value="value",t.ignoreBounds=!1,t.tooltip&&(t.tooltip.showInViewport=!0),t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new sv},t.prototype.checkInclude=function(e,t,i){if(e){if(0==e.length)return!1;if(-1==e.indexOf(i))return!1}return!(t&&t.length>0&&-1!=t.indexOf(i))},Object.defineProperty(t.prototype,"useGeodata",{get:function(){return this.getPropertyValue("useGeodata")},set:function(e){this.setPropertyValue("useGeodata",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"include",{get:function(){return this.getPropertyValue("include")},set:function(e){this.setPropertyValue("include",e)&&this.processIncExc()},enumerable:!0,configurable:!0}),t.prototype.processIncExc=function(){this.invalidateData()},Object.defineProperty(t.prototype,"ignoreBounds",{get:function(){return this.getPropertyValue("ignoreBounds")},set:function(e){this.setPropertyValue("ignoreBounds",e)&&this.chart&&this.chart.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exclude",{get:function(){return this.getPropertyValue("exclude")},set:function(e){this.setPropertyValue("exclude",e)&&this.processIncExc()},enumerable:!0,configurable:!0}),t.prototype.handleObjectAdded=function(e){var t=e.newValue;t.parent=this,t.series=this,t.strokeWidth=t.strokeWidth},Object.defineProperty(t.prototype,"geodata",{get:function(){return this._geodata},set:function(e){if(e!=this._geodata){this._geodata=e,this.reverseGeodata&&this.chart.processReverseGeodata(this._geodata);for(var t=this.data.length-1;t>=0;t--)1==this.data[t].madeFromGeoData&&this.data.splice(t,1);this.disposeData(),this.invalidateData()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reverseGeodata",{get:function(){return this.getPropertyValue("reverseGeodata")},set:function(e){this.setPropertyValue("reverseGeodata",e)&&this._geodata&&this.chart.processReverseGeodata(this._geodata)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geodataSource",{get:function(){return this._dataSources.geodata||this.getDataSource("geodata"),this._dataSources.geodata},set:function(e){var t=this;this._dataSources.geodata&&this.removeDispose(this._dataSources.geodata),this._dataSources.geodata=e,this._dataSources.geodata.component=this,this.events.on("inited",(function(){t.loadData("geodata")}),void 0,!1),this.setDataSourceEvents(e,"geodata")},enumerable:!0,configurable:!0}),t.prototype.getFeatures=function(){},t.prototype.validateDataItems=function(){e.prototype.validateDataItems.call(this),this.updateExtremes()},t.prototype.updateExtremes=function(){var e,t,i,n;this.dataItems.each((function(r){(r.north>e||!ll(e))&&(e=r.north),(r.south<t||!ll(t))&&(t=r.south),(r.west<n||!ll(n))&&(n=r.west),(r.east>i||!ll(i))&&(i=r.east)})),this._mapObjects&&this._mapObjects.each((function(r){(r.north>e||!ll(e))&&(e=r.north),(r.south<t||!ll(t))&&(t=r.south),(r.west<n||!ll(n))&&(n=r.west),(r.east>i||!ll(i))&&(i=r.east)})),this.north==e&&this.east==i&&this.south==t&&this.west==n||(this._north=e,this._east=i,this._west=n,this._south=t,this.dispatch("geoBoundsChanged"),this.ignoreBounds||this.chart.updateExtremes())},Object.defineProperty(t.prototype,"north",{get:function(){return ll(this._northDefined)?this._northDefined:this._north},set:function(e){this._northDefined=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"south",{get:function(){return ll(this._southDefined)?this._southDefined:this._south},set:function(e){this._southDefined=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"west",{get:function(){return ll(this._westDefined)?this._westDefined:this._west},set:function(e){this._westDefined=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"east",{get:function(){return ll(this._eastDefined)?this._eastDefined:this._east},set:function(e){this._eastDefined=e},enumerable:!0,configurable:!0}),t.prototype.processConfig=function(t){if(nl(t.geodata)&&sl(t.geodata)){var i=t.geodata;if(nl(window["am4geodata_"+t.geodata]))t.geodata=window["am4geodata_"+t.geodata];else try{t.geodata=JSON.parse(t.geodata)}catch(n){throw Error("MapChart error: Geodata `"+i+"` is not loaded or is incorrect.")}}e.prototype.processConfig.call(this,t)},t.prototype.asIs=function(t){return"geodata"==t||e.prototype.asIs.call(this,t)},t.prototype.updateTooltipBounds=function(){this.tooltip&&this.topParent&&this.tooltip.setBounds({x:10,y:10,width:this.topParent.maxWidth-20,height:this.topParent.maxHeight-20})},t}(Nf);Bu.registeredClasses.MapSeries=lv,Bu.registeredClasses.MapSeriesDataItem=sv;var uv=function(e){function t(){var t=e.call(this)||this;return t.className="MapObject",t.isMeasured=!1,t.layout="none",t.clickable=!0,t.applyTheme(),t}return Us(t,e),t.prototype.validate=function(){this.series&&this.series.itemReaderText&&(this.readerTitle=this.series.itemReaderText),e.prototype.validate.call(this)},t.prototype.updateExtremes=function(){var e=this.getFeature();if(e){var t=e.geometry;if(t){var i=ov(t),n=i[0][0],r=i[0][1],a=i[1][1],o=i[1][0],s=!1;a!=this.north&&(this._north=vl(a,8),s=!0),r!=this.south&&(this._south=vl(r),s=!0),o!=this.east&&(this._east=vl(o),s=!0),n!=this.west&&(this._west=vl(n),s=!0),s&&(this.dispatch("geoBoundsChanged"),this.series&&this.series.invalidateDataItems())}}},t.prototype.getFeature=function(){return{}},Object.defineProperty(t.prototype,"east",{get:function(){return ll(this._east)?this._east:this.dataItem?this.dataItem.east:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"west",{get:function(){return ll(this._west)?this._west:this.dataItem?this.dataItem.west:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"south",{get:function(){return ll(this._south)?this._south:this.dataItem?this.dataItem.south:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"north",{get:function(){return ll(this._north)?this._north:this.dataItem?this.dataItem.north:void 0},enumerable:!0,configurable:!0}),t.prototype.showTooltip=function(t){var i=e.prototype.showTooltip.call(this,t);return i&&"always"==this.showTooltipOn&&!this.series.chart.events.has("mappositionchanged",this.handleTooltipMove,this)&&this.addDisposer(this.series.chart.events.on("mappositionchanged",this.handleTooltipMove,this)),i},t.prototype.handleTooltipMove=function(e){this.tooltip.isHidden||this.showTooltip()},t.prototype.setDataItem=function(t){e.prototype.setDataItem.call(this,t),this.applyAccessibility()},t}(Wp);Bu.registeredClasses.MapObject=uv;var cv=function(e){function t(){var t=e.call(this)||this;return t.className="MapImage",t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"latitude",{get:function(){var e=this.getPropertyValue("latitude");return!ll(e)&&this.dataItem&&this.dataItem.geoPoint&&(e=this.dataItem.geoPoint.latitude),e},set:function(e){this.setPropertyValue("latitude",e,!1,!0),this.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){var e=this.getPropertyValue("longitude");return!ll(e)&&this.dataItem&&this.dataItem.geoPoint&&(e=this.dataItem.geoPoint.longitude),e},set:function(e){this.setPropertyValue("longitude",e,!1,!0),this.updateExtremes()},enumerable:!0,configurable:!0}),t.prototype.validatePosition=function(){if(ll(this.latitude)&&ll(this.longitude)){var t=this.series.chart.projection.d3Projection([this.longitude,this.latitude]),i=this.series.chart.projection.d3Path({type:"Point",coordinates:[this.longitude,this.latitude]});this.__disabled=!i,this.moveTo({x:t[0],y:t[1]})}e.prototype.validatePosition.call(this)},t.prototype.getFeature=function(){return{type:"Feature",geometry:{type:"Point",coordinates:[this.longitude,this.latitude]}}},t}(uv);Bu.registeredClasses.MapImage=cv;var hv=i(1423),pv=i.n(hv);function dv(e){return Vl(e,(function(e){return fv(e)}))}function fv(e){return Vl(e,(function(e){return vv(e)}))}function mv(e){return Vl(e,yv)}function vv(e){return{longitude:e[0],latitude:e[1]}}function yv(e){return[e.longitude,e.latitude]}function gv(e){return Vl(e,(function(e){return Vl(e,yv)}))}function _v(e){return Vl(e,(function(e){var t=e[0],i=e[1],n=[];return t&&n.push(mv(t)),i&&n.push(mv(i)),n}))}var bv=function(e){function t(){var t=e.call(this)||this;t.className="MapPolygon",t.polygon=t.createChild(wd),t.polygon.shouldClone=!1,t.polygon.applyOnClones=!0,t.setPropertyValue("precision",.5);var i=new Xh;return t.fill=i.getFor("secondaryButton"),t.stroke=i.getFor("secondaryButtonStroke"),t.strokeOpacity=1,t.tooltipPosition="pointer",t.nonScalingStroke=!0,t.applyTheme(),t}return Us(t,e),t.prototype.getFeature=function(){if(this.multiPolygon&&this.multiPolygon.length>0)return{type:"Feature",geometry:{type:"MultiPolygon",coordinates:this.multiPolygon}}},Object.defineProperty(t.prototype,"multiGeoPolygon",{get:function(){var e=this.getPropertyValue("multiGeoPolygon");return!e&&this.dataItem&&(e=this.dataItem.multiGeoPolygon),e},set:function(e){this.setPropertyValue("multiGeoPolygon",e,!0),this.multiPolygon=_v(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiPolygon",{get:function(){var e=this.getPropertyValue("multiPolygon");return!e&&this.dataItem&&(e=this.dataItem.multiPolygon),e},set:function(e){this.setPropertyValue("multiPolygon",e)&&(this.updateExtremes(),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.validate=function(){if(this.series){var t=this.series.chart.projection,i=t.d3Path;if(this.multiPolygon){if(this.series){var n={type:"MultiPolygon",coordinates:this.multiPolygon};t.d3Projection.precision(this.precision),this.polygon.path=i(n)}if(this.series.calculateVisualCenter){var r=0,a=this.multiPolygon[0];if(this.multiPolygon.length>1)for(var o=0;o<this.multiPolygon.length;o++){var s=this.multiPolygon[o],l=Nm({type:"Polygon",coordinates:s});l>r&&(a=s,r=l)}var u=pv()(a);this._visualLongitude=u[0],this._visualLatitude=u[1]}else this._visualLongitude=this.longitude,this._visualLatitude=this.latitude}}e.prototype.validate.call(this)},t.prototype.measureElement=function(){},Object.defineProperty(t.prototype,"latitude",{get:function(){return this.north+(this.south-this.north)/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.east+(this.west-this.east)/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualLatitude",{get:function(){var e=this.getPropertyValue("visualLatitude");return ll(e)?e:this._adapterO?this._adapterO.apply("visualLatitude",this._visualLatitude):this._visualLatitude},set:function(e){this.setPropertyValue("visualLatitude",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualLongitude",{get:function(){var e=this.getPropertyValue("visualLongitude");return ll(e)?e:this._adapterO?this._adapterO.apply("visualLongitude",this._visualLongitude):this._visualLongitude},set:function(e){this.setPropertyValue("visualLongitude",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelWidth",{get:function(){return this.polygon.pixelWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelHeight",{get:function(){return this.polygon.pixelHeight},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.polygon.copyFrom(t.polygon)},t.prototype.updateExtremes=function(){e.prototype.updateExtremes.call(this)},Object.defineProperty(t.prototype,"boxArea",{get:function(){return(this.north-this.south)*(this.east-this.west)},enumerable:!0,configurable:!0}),t.prototype.getTooltipX=function(){return this.series.chart.projection.convert({longitude:this.visualLongitude,latitude:this.visualLatitude}).x},t.prototype.getTooltipY=function(){return this.series.chart.projection.convert({longitude:this.visualLongitude,latitude:this.visualLatitude}).y},Object.defineProperty(t.prototype,"precision",{get:function(){return this.getPropertyValue("precision")},set:function(e){this.setPropertyValue("precision",e,!0)},enumerable:!0,configurable:!0}),t}(uv);Bu.registeredClasses.MapPolygon=bv;var xv=function(e){function t(){var t=e.call(this)||this;return t.className="MapPolygonSeriesDataItem",t.applyTheme(),t}return Us(t,e),t.prototype.getFeature=function(){if(this.multiPolygon&&this.multiPolygon.length>0)return{type:"Feature",geometry:{type:"MultiPolygon",coordinates:this.multiPolygon}}},Object.defineProperty(t.prototype,"mapPolygon",{get:function(){var e=this;if(!this._mapPolygon){var t=this.component.mapPolygons.create();this._mapPolygon=t,this.addSprite(t),this._disposers.push(new eu((function(){e.component&&e.component.mapPolygons.removeValue(t)}))),this.mapObject=t}return this._mapPolygon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"polygon",{get:function(){return this._polygon},set:function(e){this._polygon=e,this.multiPolygon=[e]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiPolygon",{get:function(){return this._multiPolygon},set:function(e){this._multiPolygon=e,this.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geoPolygon",{get:function(){return this._geoPolygon},set:function(e){this._geoPolygon=e,this.multiGeoPolygon=[e]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiGeoPolygon",{get:function(){return this._multiGeoPolygon},set:function(e){this._multiGeoPolygon=e,this.multiPolygon=_v(e)},enumerable:!0,configurable:!0}),t}(sv),wv=function(e){function t(){var t=e.call(this)||this;return t.calculateVisualCenter=!1,t.className="MapPolygonSeries",t.dataFields.multiPolygon="multiPolygon",t.dataFields.polygon="polygon",t.dataFields.geoPolygon="geoPolygon",t.dataFields.multiGeoPolygon="multiGeoPolygon",t.setPropertyValue("sortPolygonsBy","area"),t.setPropertyValue("sortPolygonsReversed",!1),t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new xv},t.prototype.processIncExc=function(){this.mapPolygons.clear(),e.prototype.processIncExc.call(this)},t.prototype.validateData=function(){if(this.useGeodata||this.geodata){var t=this._dataSources.geodata?void 0:this.chart.geodata;if(this.geodata&&(t=this.geodata),t){var i=void 0;if("FeatureCollection"==t.type?i=t.features:"Feature"==t.type?i=[t]:-1!=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(t.type)?i=[{geometry:t}]:console.log("nothing found in geoJSON"),i)for(var n=function(e,t){var n=i[e],a=n.geometry;if(a){var o=a.type,s=n.id;if(r.chart.geodataNames&&r.chart.geodataNames[s]&&(n.properties.name=r.chart.geodataNames[s]),"Polygon"==o||"MultiPolygon"==o){if(!r.checkInclude(r.include,r.exclude,s))return"continue";var l=a.coordinates;l&&"Polygon"==o&&(l=[l]);var u=Jl(r.data,(function(e,t){return e.id==s}));u?u.multiPolygon||(u.multiPolygon=l):(u={multiPolygon:l,id:s,madeFromGeoData:!0},r.data.push(u)),wc(n.properties,u)}}},r=this,a=0,o=i.length;a<o;a++)n(a)}}e.prototype.validateData.call(this)},t.prototype.validate=function(){if(e.prototype.validate.call(this),this.dataItems.each((function(e){e.mapPolygon})),"none"!=this.sortPolygonsBy){var t=this.sortPolygonsBy,i=this.sortPolygonsReversed;this.mapPolygons.sort((function(e,n){var r="",a="",o=-1,s=1;switch(t){case"area":r=e.boxArea,a=n.boxArea,o=-1,s=1;break;case"name":r=e.dataItem.dataContext.name||"",a=n.dataItem.dataContext.name||"",o=1,s=-1;break;case"id":r=e.dataItem.dataContext.id||"",a=n.dataItem.dataContext.id||"",o=1,s=-1;break;case"latitude":r=i?e.south:e.north,a=i?n.south:n.north,o=-1,s=1;break;case"longitude":r=i?e.east:e.west,a=i?n.east:n.west,o=1,s=-1}return r<a?i?s:o:r>a?i?o:s:0})),this.mapPolygons.each((function(e,t){e.validate(),e.zIndex||e.propertyFields.zIndex||(e.zIndex=1e6-t)}))}},Object.defineProperty(t.prototype,"mapPolygons",{get:function(){if(!this._mapPolygons){var e=new bv,t=new Hu(e);this._disposers.push(new Uu(t)),this._disposers.push(t.template),t.template.focusable=!0,t.events.on("inserted",this.handleObjectAdded,this,!1),this._mapPolygons=t,this._mapObjects=t}return this._mapPolygons},enumerable:!0,configurable:!0}),t.prototype.getPolygonById=function(e){return Mu(this.mapPolygons.iterator(),(function(t){return t.dataItem.dataContext.id==e}))},t.prototype.copyFrom=function(t){this.mapPolygons.template.copyFrom(t.mapPolygons.template),e.prototype.copyFrom.call(this,t)},t.prototype.getFeatures=function(){var e=this,t=[];return this.dataItems.each((function(e){var i=e.getFeature();i&&t.push(i)})),this.mapPolygons.each((function(i){if(-1==e.dataItems.indexOf(i._dataItem)){var n=i.getFeature();n&&t.push(n)}})),t},Object.defineProperty(t.prototype,"sortPolygonsBy",{get:function(){return this.getPropertyValue("sortPolygonsBy")},set:function(e){this.setPropertyValue("sortPolygonsBy",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sortPolygonsReversed",{get:function(){return this.getPropertyValue("sortPolygonsReversed")},set:function(e){this.setPropertyValue("sortPolygonsReversed",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),t}(lv);function kv(){var e,t=[];return{point:function(t,i,n){e.push([t,i,n])},lineStart:function(){t.push(e=[])},lineEnd:hm,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var i=t;return t=[],e=null,i}}}function Pv(e,t){return Jf(e[0]-t[0])<Hf&&Jf(e[1]-t[1])<Hf}function Sv(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Tv(e,t,i,n,r){var a,o,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,i,n=e[0],o=e[t];if(Pv(n,o)){if(!n[2]&&!o[2]){for(r.lineStart(),a=0;a<t;++a)r.point((n=e[a])[0],n[1]);return void r.lineEnd()}o[0]+=2e-6}s.push(i=new Sv(n,e,null,!0)),l.push(i.o=new Sv(n,null,i,!1)),s.push(i=new Sv(o,e,null,!1)),l.push(i.o=new Sv(o,null,i,!0))}})),s.length){for(l.sort(t),Ev(s),Ev(l),a=0,o=l.length;a<o;++a)l[a].e=i=!i;for(var u,c,h=s[0];;){for(var p=h,d=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(a=0,o=u.length;a<o;++a)r.point((c=u[a])[0],c[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(d)for(u=p.p.z,a=u.length-1;a>=0;--a)r.point((c=u[a])[0],c[1]);else n(p.x,p.p.x,-1,r);p=p.p}u=(p=p.o).z,d=!d}while(!p.v);r.lineEnd()}}}function Ev(e){if(t=e.length){for(var t,i,n=0,r=e[0];++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Cv(e){return Jf(e[0])<=Zf?e[0]:om(e[0])*((Jf(e[0])+Zf)%Kf-Zf)}Bu.registeredClasses.MapPolygonSeries=wv,Bu.registeredClasses.MapPolygonSeriesDataItem=xv;var Mv=i(181);function Iv(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=(0,Mv.Z)(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}var Ov=za().mark(Dv);function Dv(e){var t,i,n;return za().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=Iv(e),r.prev=1,t.s();case 3:if((i=t.n()).done){r.next=8;break}return n=i.value,r.delegateYield(n,"t0",6);case 6:r.next=3;break;case 8:r.next=13;break;case 10:r.prev=10,r.t1=r.catch(1),t.e(r.t1);case 13:return r.prev=13,t.f(),r.finish(13);case 16:case"end":return r.stop()}}),Ov,null,[[1,10,13,16]])}function Av(e){return Array.from(Dv(e))}function Lv(e,t,i,n){return function(r){var a,o,s,l=t(r),u=kv(),c=t(u),h=!1,p={point:d,lineStart:m,lineEnd:v,polygonStart:function(){p.point=y,p.lineStart=g,p.lineEnd=_,o=[],a=[]},polygonEnd:function(){p.point=d,p.lineStart=m,p.lineEnd=v,o=Av(o);var e=function(e,t){var i=Cv(t),n=t[1],r=am(n),a=[am(i),-tm(i),0],o=0,s=0,l=new Wf;1===r?n=qf+Hf:-1===r&&(n=-qf-Hf);for(var u=0,c=e.length;u<c;++u)if(p=(h=e[u]).length)for(var h,p,d=h[p-1],f=Cv(d),m=d[1]/2+Xf,v=am(m),y=tm(m),g=0;g<p;++g,f=b,v=w,y=k,d=_){var _=h[g],b=Cv(_),x=_[1]/2+Xf,w=am(x),k=tm(x),P=b-f,S=P>=0?1:-1,T=S*P,E=T>Zf,C=v*w;if(l.add(em(C*S*am(T),y*k+C*tm(T))),o+=E?P+S*Kf:P,E^f>=i^b>=i){var M=Hm(Gm(d),Gm(_));Xm(M);var I=Hm(a,M);Xm(I);var O=(E^P>=0?-1:1)*um(I[2]);(n>O||n===O&&(M[0]||M[1]))&&(s+=E^P>=0?1:-1)}}return(o<-Hf||o<Hf&&l<-1e-12)^1&s}(a,n);o.length?(h||(r.polygonStart(),h=!0),Tv(o,Rv,e,i,r)):e&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=a=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(t,i){e(t,i)&&r.point(t,i)}function f(e,t){l.point(e,t)}function m(){p.point=f,l.lineStart()}function v(){p.point=d,l.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function g(){c.lineStart(),s=[]}function _(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,i,n,l=c.clean(),p=u.result(),d=p.length;if(s.pop(),a.push(s),s=null,d)if(1&l){if((t=(i=p[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),e=0;e<t;++e)r.point((n=i[e])[0],n[1]);r.lineEnd()}}else d>1&&2&l&&p.push(p.pop().concat(p.shift())),o.push(p.filter(zv))}return p}}function zv(e){return e.length>1}function Rv(e,t){return((e=e.x)[0]<0?e[1]-qf-Hf:qf-e[1])-((t=t.x)[0]<0?t[1]-qf-Hf:qf-t[1])}var Fv=Lv((function(){return!0}),(function(e){var t,i=NaN,n=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?Zf:-Zf,l=Jf(a-i);Jf(l-Zf)<Hf?(e.point(i,n=(n+o)/2>0?qf:-qf),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),t=0):r!==s&&l>=Zf&&(Jf(i-r)<Hf&&(i-=r*Hf),Jf(a-s)<Hf&&(a-=s*Hf),n=function(e,t,i,n){var r,a,o=am(e-i);return Jf(o)>Hf?Qf((am(t)*(a=tm(n))*am(i)-am(n)*(r=tm(t))*am(e))/(r*a*o)):(t+n)/2}(i,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),t=0),e.point(i=a,n=o),r=s},lineEnd:function(){e.lineEnd(),i=n=NaN},clean:function(){return 2-t}}}),(function(e,t,i,n){var r;if(null==e)r=i*qf,n.point(-Zf,r),n.point(0,r),n.point(Zf,r),n.point(Zf,0),n.point(Zf,-r),n.point(0,-r),n.point(-Zf,-r),n.point(-Zf,0),n.point(-Zf,r);else if(Jf(e[0]-t[0])>Hf){var a=e[0]<t[0]?Zf:-Zf;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(t[0],t[1])}),[-Zf,-qf]);function jv(e,t,i,n,r,a){if(i){var o=tm(t),s=am(t),l=n*i;null==r?(r=t+n*Kf,a=t-l/2):(r=Bv(o,r),a=Bv(o,a),(n>0?r<a:r>a)&&(r+=n*Kf));for(var u,c=r;n>0?c>a:c<a;c-=l)u=Um([o,-s*tm(c),-s*am(c)]),e.point(u[0],u[1])}}function Bv(e,t){(t=Gm(t))[0]-=e,Xm(t);var i,n=(i=-t[1])>1?0:i<-1?Zf:Math.acos(i);return((-t[2]<0?-n:n)+Kf-Hf)%Kf}function Vv(e){var t=tm(e),i=6*$f,n=t>0,r=Jf(t)>Hf;function a(e,i){return tm(e)*tm(i)>t}function o(e,i,n){var r=[1,0,0],a=Hm(Gm(e),Gm(i)),o=Wm(a,a),s=a[0],l=o-s*s;if(!l)return!n&&e;var u=t*o/l,c=-t*s/l,h=Hm(r,a),p=qm(r,u);Zm(p,qm(a,c));var d=h,f=Wm(p,d),m=Wm(d,d),v=f*f-m*(Wm(p,p)-1);if(!(v<0)){var y=sm(v),g=qm(d,(-f-y)/m);if(Zm(g,p),g=Um(g),!n)return g;var _,b=e[0],x=i[0],w=e[1],k=i[1];x<b&&(_=b,b=x,x=_);var P=x-b,S=Jf(P-Zf)<Hf;if(!S&&k<w&&(_=w,w=k,k=_),S||P<Hf?S?w+k>0^g[1]<(Jf(g[0]-b)<Hf?w:k):w<=g[1]&&g[1]<=k:P>Zf^(b<=g[0]&&g[0]<=x)){var T=qm(d,(-f+y)/m);return Zm(T,p),[g,Um(T)]}}}function s(t,i){var r=n?e:Zf-e,a=0;return t<-r?a|=1:t>r&&(a|=2),i<-r?a|=4:i>r&&(a|=8),a}return Lv(a,(function(e){var t,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,p){var d,f=[h,p],m=a(h,p),v=n?m?0:s(h,p):m?s(h+(h<0?Zf:-Zf),p):0;if(!t&&(u=l=m)&&e.lineStart(),m!==l&&(!(d=o(t,f))||Pv(t,d)||Pv(f,d))&&(f[2]=1),m!==l)c=0,m?(e.lineStart(),d=o(f,t),e.point(d[0],d[1])):(d=o(t,f),e.point(d[0],d[1],2),e.lineEnd()),t=d;else if(r&&t&&n^m){var y;v&i||!(y=o(f,t,!0))||(c=0,n?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!m||t&&Pv(t,f)||e.point(f[0],f[1]),t=f,l=m,i=v},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}}),(function(t,n,r,a){jv(a,e,i,r,t,n)}),n?[0,-e]:[-Zf,e-Zf])}var Nv=1e9,Uv=-Nv;function Gv(e,t,i,n){function r(r,a){return e<=r&&r<=i&&t<=a&&a<=n}function a(r,a,s,u){var c=0,h=0;if(null==r||(c=o(r,s))!==(h=o(a,s))||l(r,a)<0^s>0)do{u.point(0===c||3===c?e:i,c>1?n:t)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(n,r){return Jf(n[0]-e)<Hf?r>0?0:3:Jf(n[0]-i)<Hf?r>0?2:1:Jf(n[1]-t)<Hf?r>0?1:0:r>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var i=o(e,1),n=o(t,1);return i!==n?i-n:0===i?t[1]-e[1]:1===i?e[0]-t[0]:2===i?e[1]-t[1]:t[0]-e[0]}return function(o){var l,u,c,h,p,d,f,m,v,y,g,_=o,b=kv(),x={point:w,lineStart:function(){x.point=k,u&&u.push(c=[]);y=!0,v=!1,f=m=NaN},lineEnd:function(){l&&(k(h,p),d&&v&&b.rejoin(),l.push(b.result()));x.point=w,v&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],g=!0},polygonEnd:function(){var t=function(){for(var t=0,i=0,r=u.length;i<r;++i)for(var a,o,s=u[i],l=1,c=s.length,h=s[0],p=h[0],d=h[1];l<c;++l)a=p,o=d,p=(h=s[l])[0],d=h[1],o<=n?d>n&&(p-a)*(n-o)>(d-o)*(e-a)&&++t:d<=n&&(p-a)*(n-o)<(d-o)*(e-a)&&--t;return t}(),i=g&&t,r=(l=Av(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),r&&Tv(l,s,t,a,o),o.polygonEnd());_=o,l=u=c=null}};function w(e,t){r(e,t)&&_.point(e,t)}function k(a,o){var s=r(a,o);if(u&&c.push([a,o]),y)h=a,p=o,d=s,y=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&v)_.point(a,o);else{var l=[f=Math.max(Uv,Math.min(Nv,f)),m=Math.max(Uv,Math.min(Nv,m))],b=[a=Math.max(Uv,Math.min(Nv,a)),o=Math.max(Uv,Math.min(Nv,o))];!function(e,t,i,n,r,a){var o,s=e[0],l=e[1],u=0,c=1,h=t[0]-s,p=t[1]-l;if(o=i-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>u&&(u=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<c&&(c=o)}if(o=n-l,p||!(o>0)){if(o/=p,p<0){if(o<u)return;o<c&&(c=o)}else if(p>0){if(o>c)return;o>u&&(u=o)}if(o=a-l,p||!(o<0)){if(o/=p,p<0){if(o>c)return;o>u&&(u=o)}else if(p>0){if(o<u)return;o<c&&(c=o)}return u>0&&(e[0]=s+u*h,e[1]=l+u*p),c<1&&(t[0]=s+c*h,t[1]=l+c*p),!0}}}}}(l,b,e,t,i,n)?s&&(_.lineStart(),_.point(a,o),g=!1):(v||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),g=!1)}f=a,m=o,v=s}return x}}function Wv(e,t){function i(i,n){return i=e(i,n),t(i[0],i[1])}return e.invert&&t.invert&&(i.invert=function(i,n){return(i=t.invert(i,n))&&e.invert(i[0],i[1])}),i}var Hv=function(e){return e};function Zv(e,t){return[Jf(e)>Zf?e+Math.round(-e/Kf)*Kf:e,t]}function qv(e,t,i){return(e%=Kf)?t||i?Wv(Kv(e),Yv(t,i)):Kv(e):t||i?Yv(t,i):Zv}function Xv(e){return function(t,i){return[(t+=e)>Zf?t-Kf:t<-Zf?t+Kf:t,i]}}function Kv(e){var t=Xv(e);return t.invert=Xv(-e),t}function Yv(e,t){var i=tm(e),n=am(e),r=tm(t),a=am(t);function o(e,t){var o=tm(t),s=tm(e)*o,l=am(e)*o,u=am(t),c=u*i+s*n;return[em(l*r-c*a,s*i-u*n),um(c*r+l*a)]}return o.invert=function(e,t){var o=tm(t),s=tm(e)*o,l=am(e)*o,u=am(t),c=u*r-l*a;return[em(l*r+u*a,s*i+c*n),um(c*i-s*n)]},o}function $v(e){return function(t){var i=new Jv;for(var n in e)i[n]=e[n];return i.stream=t,i}}function Jv(){}Zv.invert=Zv,Jv.prototype={constructor:Jv,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Qv=1/0,ey=Qv,ty=-Qv,iy=ty,ny={point:function(e,t){e<Qv&&(Qv=e);e>ty&&(ty=e);t<ey&&(ey=t);t>iy&&(iy=t)},lineStart:hm,lineEnd:hm,polygonStart:hm,polygonEnd:hm,result:function(){var e=[[Qv,ey],[ty,iy]];return ty=iy=-(ey=Qv=1/0),e}};var ry=ny;function ay(e,t,i){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=n&&e.clipExtent(null),ym(i,e.stream(ry)),t(ry.result()),null!=n&&e.clipExtent(n),e}function oy(e,t,i){return ay(e,(function(i){var n=t[1][0]-t[0][0],r=t[1][1]-t[0][1],a=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+t[0][0]+(n-a*(i[1][0]+i[0][0]))/2,s=+t[0][1]+(r-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([o,s])}),i)}function sy(e,t,i){return oy(e,[[0,0],t],i)}function ly(e,t,i){return ay(e,(function(i){var n=+t,r=n/(i[1][0]-i[0][0]),a=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];e.scale(150*r).translate([a,o])}),i)}function uy(e,t,i){return ay(e,(function(i){var n=+t,r=n/(i[1][1]-i[0][1]),a=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;e.scale(150*r).translate([a,o])}),i)}var cy=tm(30*$f);function hy(e,t){return+t?function(e,t){function i(n,r,a,o,s,l,u,c,h,p,d,f,m,v){var y=u-n,g=c-r,_=y*y+g*g;if(_>4*t&&m--){var b=o+p,x=s+d,w=l+f,k=sm(b*b+x*x+w*w),P=um(w/=k),S=Jf(Jf(w)-1)<Hf||Jf(a-h)<Hf?(a+h)/2:em(x,b),T=e(S,P),E=T[0],C=T[1],M=E-n,I=C-r,O=g*M-y*I;(O*O/_>t||Jf((y*M+g*I)/_-.5)>.3||o*p+s*d+l*f<cy)&&(i(n,r,a,o,s,l,E,C,S,b/=k,x/=k,w,m,v),v.point(E,C),i(E,C,S,b,x,w,u,c,h,p,d,f,m,v))}}return function(t){var n,r,a,o,s,l,u,c,h,p,d,f,m={point:v,lineStart:y,lineEnd:_,polygonStart:function(){t.polygonStart(),m.lineStart=b},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function v(i,n){i=e(i,n),t.point(i[0],i[1])}function y(){c=NaN,m.point=g,t.lineStart()}function g(n,r){var a=Gm([n,r]),o=e(n,r);i(c,h,u,p,d,f,c=o[0],h=o[1],u=n,p=a[0],d=a[1],f=a[2],16,t),t.point(c,h)}function _(){m.point=v,t.lineEnd()}function b(){y(),m.point=x,m.lineEnd=w}function x(e,t){g(n=e,t),r=c,a=h,o=p,s=d,l=f,m.point=g}function w(){i(c,h,u,p,d,f,r,a,n,o,s,l,16,t),m.lineEnd=_,_()}return m}}(e,t):function(e){return $v({point:function(t,i){t=e(t,i),this.stream.point(t[0],t[1])}})}(e)}var py=$v({point:function(e,t){this.stream.point(e*$f,t*$f)}});function dy(e,t,i,n,r,a){if(!a)return function(e,t,i,n,r){function a(a,o){return[t+e*(a*=n),i-e*(o*=r)]}return a.invert=function(a,o){return[(a-t)/e*n,(i-o)/e*r]},a}(e,t,i,n,r);var o=tm(a),s=am(a),l=o*e,u=s*e,c=o/e,h=s/e,p=(s*i-o*t)/e,d=(s*t+o*i)/e;function f(e,a){return[l*(e*=n)-u*(a*=r)+t,i-u*e-l*a]}return f.invert=function(e,t){return[n*(c*e-h*t+p),r*(d-h*e-c*t)]},f}function fy(e){return my((function(){return e}))()}function my(e){var t,i,n,r,a,o,s,l,u,c,h=150,p=480,d=250,f=0,m=0,v=0,y=0,g=0,_=0,b=1,x=1,w=null,k=Fv,P=null,S=Hv,T=.5;function E(e){return l(e[0]*$f,e[1]*$f)}function C(e){return(e=l.invert(e[0],e[1]))&&[e[0]*Yf,e[1]*Yf]}function M(){var e=dy(h,0,0,b,x,_).apply(null,t(f,m)),n=dy(h,p-e[0],d-e[1],b,x,_);return i=qv(v,y,g),s=Wv(t,n),l=Wv(i,s),o=hy(s,T),I()}function I(){return u=c=null,E}return E.stream=function(e){return u&&c===e?u:u=py(function(e){return $v({point:function(t,i){var n=e(t,i);return this.stream.point(n[0],n[1])}})}(i)(k(o(S(c=e)))))},E.preclip=function(e){return arguments.length?(k=e,w=void 0,I()):k},E.postclip=function(e){return arguments.length?(S=e,P=n=r=a=null,I()):S},E.clipAngle=function(e){return arguments.length?(k=+e?Vv(w=e*$f):(w=null,Fv),I()):w*Yf},E.clipExtent=function(e){return arguments.length?(S=null==e?(P=n=r=a=null,Hv):Gv(P=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),I()):null==P?null:[[P,n],[r,a]]},E.scale=function(e){return arguments.length?(h=+e,M()):h},E.translate=function(e){return arguments.length?(p=+e[0],d=+e[1],M()):[p,d]},E.center=function(e){return arguments.length?(f=e[0]%360*$f,m=e[1]%360*$f,M()):[f*Yf,m*Yf]},E.rotate=function(e){return arguments.length?(v=e[0]%360*$f,y=e[1]%360*$f,g=e.length>2?e[2]%360*$f:0,M()):[v*Yf,y*Yf,g*Yf]},E.angle=function(e){return arguments.length?(_=e%360*$f,M()):_*Yf},E.reflectX=function(e){return arguments.length?(b=e?-1:1,M()):b<0},E.reflectY=function(e){return arguments.length?(x=e?-1:1,M()):x<0},E.precision=function(e){return arguments.length?(o=hy(s,T=e*e),I()):sm(T)},E.fitExtent=function(e,t){return oy(E,e,t)},E.fitSize=function(e,t){return sy(E,e,t)},E.fitWidth=function(e,t){return ly(E,e,t)},E.fitHeight=function(e,t){return uy(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&C,M()}}function vy(e,t){return[e,t]}vy.invert=vy;var yy,gy,_y,by,xy=new Wf,wy=new Wf,ky={point:hm,lineStart:hm,lineEnd:hm,polygonStart:function(){ky.lineStart=Py,ky.lineEnd=Ey},polygonEnd:function(){ky.lineStart=ky.lineEnd=ky.point=hm,xy.add(Jf(wy)),wy=new Wf},result:function(){var e=xy/2;return xy=new Wf,e}};function Py(){ky.point=Sy}function Sy(e,t){ky.point=Ty,yy=_y=e,gy=by=t}function Ty(e,t){wy.add(by*e-_y*t),_y=e,by=t}function Ey(){Ty(yy,gy)}var Cy,My,Iy,Oy,Dy=ky,Ay=0,Ly=0,zy=0,Ry=0,Fy=0,jy=0,By=0,Vy=0,Ny=0,Uy={point:Gy,lineStart:Wy,lineEnd:qy,polygonStart:function(){Uy.lineStart=Xy,Uy.lineEnd=Ky},polygonEnd:function(){Uy.point=Gy,Uy.lineStart=Wy,Uy.lineEnd=qy},result:function(){var e=Ny?[By/Ny,Vy/Ny]:jy?[Ry/jy,Fy/jy]:zy?[Ay/zy,Ly/zy]:[NaN,NaN];return Ay=Ly=zy=Ry=Fy=jy=By=Vy=Ny=0,e}};function Gy(e,t){Ay+=e,Ly+=t,++zy}function Wy(){Uy.point=Hy}function Hy(e,t){Uy.point=Zy,Gy(Iy=e,Oy=t)}function Zy(e,t){var i=e-Iy,n=t-Oy,r=sm(i*i+n*n);Ry+=r*(Iy+e)/2,Fy+=r*(Oy+t)/2,jy+=r,Gy(Iy=e,Oy=t)}function qy(){Uy.point=Gy}function Xy(){Uy.point=Yy}function Ky(){$y(Cy,My)}function Yy(e,t){Uy.point=$y,Gy(Cy=Iy=e,My=Oy=t)}function $y(e,t){var i=e-Iy,n=t-Oy,r=sm(i*i+n*n);Ry+=r*(Iy+e)/2,Fy+=r*(Oy+t)/2,jy+=r,By+=(r=Oy*e-Iy*t)*(Iy+e),Vy+=r*(Oy+t),Ny+=3*r,Gy(Iy=e,Oy=t)}var Jy=Uy;function Qy(e){this._context=e}Qy.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Kf)}},result:hm};var eg,tg,ig,ng,rg,ag=new Wf,og={point:hm,lineStart:function(){og.point=sg},lineEnd:function(){eg&&lg(tg,ig),og.point=hm},polygonStart:function(){eg=!0},polygonEnd:function(){eg=null},result:function(){var e=+ag;return ag=new Wf,e}};function sg(e,t){og.point=lg,tg=ng=e,ig=rg=t}function lg(e,t){ng-=e,rg-=t,ag.add(sm(ng*ng+rg*rg)),ng=e,rg=t}var ug,cg,hg,pg,dg=og;function fg(){this._string=[]}function mg(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}fg.prototype={_radius:4.5,_circle:mg(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=mg(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var vg={sphere:hm,point:hm,lineStart:function(){vg.point=gg,vg.lineEnd=yg},lineEnd:hm,polygonStart:hm,polygonEnd:hm};function yg(){vg.point=vg.lineEnd=hm}function gg(e,t){cg=e*=$f,hg=am(t*=$f),pg=tm(t),vg.point=_g}function _g(e,t){e*=$f;var i=am(t*=$f),n=tm(t),r=Jf(e-cg),a=tm(r),o=n*am(r),s=pg*i-hg*n*a,l=hg*i+pg*n*a;ug.add(em(sm(o*o+s*s),l)),cg=e,hg=i,pg=n}var bg=[null,null],xg={type:"LineString",coordinates:bg};function wg(e,t){return bg[0]=e,bg[1]=t,function(e){return ug=new Wf,ym(e,vg),+ug}(xg)}var kg=function(){function e(){this.d3Projection=fy(vy).scale(152.63)}return Object.defineProperty(e.prototype,"d3Projection",{get:function(){return this._d3Projection},set:function(e){this._d3Projection=e,e.precision(.1),this._d3Path=function(e,t){var i,n,r=4.5;function a(e){return e&&("function"===typeof r&&n.pointRadius(+r.apply(this,arguments)),ym(e,i(n))),n.result()}return a.area=function(e){return ym(e,i(Dy)),Dy.result()},a.measure=function(e){return ym(e,i(dg)),dg.result()},a.bounds=function(e){return ym(e,i(ry)),ry.result()},a.centroid=function(e){return ym(e,i(Jy)),Jy.result()},a.projection=function(t){return arguments.length?(i=null==t?(e=null,Hv):(e=t).stream,a):e},a.context=function(e){return arguments.length?(n=null==e?(t=null,new fg):new Qy(t=e),"function"!==typeof r&&n.pointRadius(r),a):t},a.pointRadius=function(e){return arguments.length?(r="function"===typeof e?e:(n.pointRadius(+e),+e),a):r},a.projection(e).context(t)}().projection(e),this.chart&&this.chart.invalidateProjection()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"d3Path",{get:function(){return this._d3Path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.d3Projection.scale()/100},enumerable:!0,configurable:!0}),e.prototype.convert=function(e){var t=this.d3Projection([e.longitude,e.latitude]);if(t)return{x:t[0],y:t[1]}},e.prototype.invert=function(e){var t=this.d3Projection.invert([e.x,e.y]);if(t)return{longitude:t[0],latitude:t[1]}},e.prototype.project=function(e,t){return this.convert({longitude:e*fl,latitude:t*fl})},e.prototype.unproject=function(e,t){return this.invert({x:e,y:t})},e.prototype.rotate=function(e,t,i,n){var r=t*dl,a=i*dl;n*=dl;var o=e.longitude*dl+r,s=e.latitude*dl,l=Math.cos(a),u=Math.sin(a),c=Math.cos(n),h=Math.sin(n),p=Math.cos(s),d=Math.cos(o)*p,f=Math.sin(o)*p,m=Math.sin(s),v=m*l+d*u;return{longitude:fl*Math.atan2(f*c-v*h,d*l-m*u),latitude:fl*Math.asin(v*c+f*h)}},e.prototype.unrotate=function(e,t,i,n){var r=t*dl,a=i*dl;n*=dl;var o=e.longitude*dl-r,s=e.latitude*dl,l=Math.cos(a),u=Math.sin(a),c=Math.cos(n),h=Math.sin(n),p=Math.cos(s),d=Math.cos(o)*p,f=Math.sin(o)*p,m=Math.sin(s),v=m*c-f*h;return{longitude:fl*Math.atan2(f*c+m*h,d*l+v*u),latitude:fl*Math.asin(v*l-d*u)}},e.prototype.intermediatePoint=function(e,t,i){var n=function(e,t){var i=e[0]*$f,n=e[1]*$f,r=t[0]*$f,a=t[1]*$f,o=tm(n),s=am(n),l=tm(a),u=am(a),c=o*tm(i),h=o*am(i),p=l*tm(r),d=l*am(r),f=2*um(sm(cm(a-n)+o*l*cm(r-i))),m=am(f),v=f?function(e){var t=am(e*=f)/m,i=am(f-e)/m,n=i*c+t*p,r=i*h+t*d,a=i*s+t*u;return[em(r,n)*Yf,em(a,sm(n*n+r*r))*Yf]}:function(){return[i*Yf,n*Yf]};return v.distance=f,v}([e.longitude,e.latitude],[t.longitude,t.latitude])(i);return{longitude:n[0],latitude:n[1]}},e.prototype.multiDistance=function(e){for(var t=0,i=0;i<e.length;i++){var n=e[i];if(n.length>1)for(var r=1;r<n.length;r++){var a=n[r-1],o=n[r];t+=this.distance(a,o)}}return t},e.prototype.distance=function(e,t){return wg([e.longitude,e.latitude],[t.longitude,t.latitude])},e.prototype.positionToPoint=function(e,t){if(e){var i=this.positionToGeoPoint(e,t),n=this.positionToGeoPoint(e,t-.01),r=this.positionToGeoPoint(e,t+.01);if(n&&r){var a=this.convert(i),o=this.convert(n),s=this.convert(r);return{x:a.x,y:a.y,angle:Cl(o,s)}}}return{x:0,y:0,angle:0}},e.prototype.positionToGeoPoint=function(e,t){if(e){for(var i=this.multiDistance(e),n=0,r=0,a=0,o=void 0,s=void 0,l=0;l<e.length;l++){var u=e[l];if(u.length>1){for(var c=1;c<u.length;c++)if(o=u[c-1],s=u[c],r=n/i,a=(n+=this.distance(o,s))/i,r<=t&&a>t){l=e.length;break}}else 1==u.length&&(o=u[0],s=u[0],r=0,a=1)}if(o&&s){var h=(t-r)/(a-r);return this.intermediatePoint(o,s,h)}}return{longitude:0,latitude:0}},e}();Bu.registeredClasses.Projection=kg;var Pg=function(e){function t(){var t=e.call(this)||this;t._chart=new iu,t.className="SmallMap",t.align="left",t.valign="bottom",t.percentHeight=20,t.percentWidth=20,t.margin(5,5,5,5);var i=new Xh;t.background.fillOpacity=.9,t.background.fill=i.getFor("background"),t.events.on("hit",t.moveToPosition,t,!1),t.events.on("maxsizechanged",t.updateMapSize,t,!1),t.seriesContainer=t.createChild(Wp),t.seriesContainer.shouldClone=!1;var n=t.createChild(Gp);return n.shouldClone=!1,n.stroke=i.getFor("alternativeBackground"),n.strokeWidth=1,n.strokeOpacity=.5,n.fill=uc(),n.verticalCenter="middle",n.horizontalCenter="middle",n.isMeasured=!1,n.visible=!1,t.rectangle=n,t._disposers.push(t._chart),t.applyTheme(),t}return Us(t,e),Object.defineProperty(t.prototype,"series",{get:function(){return this._series||(this._series=new Wu,this._series.events.on("inserted",this.handleSeriesAdded,this,!1),this._series.events.on("removed",this.handleSeriesRemoved,this,!1)),this._series},enumerable:!0,configurable:!0}),t.prototype.handleSeriesAdded=function(e){var t=e.newValue;if(this.chart.series.contains(t)){var i=t.clone();this._series.removeValue(t),this._series.push(i),t=i,this.chart.dataUsers.push(i)}t.chart=this.chart,t.parent=this.seriesContainer,t.interactionsEnabled=!1,t.events.on("inited",this.updateMapSize,this,!1),t.hidden=!1},t.prototype.handleSeriesRemoved=function(e){this.invalidate()},t.prototype.moveToPosition=function(e){var t=qc(e.spritePoint,this,this.seriesContainer),i=this.chart.seriesPointToGeo(t);this.chart.zoomToGeoPoint(i,this.chart.zoomLevel,!0)},Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart.get()},set:function(e){this.chart!=e&&this._chart.set(e,new tu([e.events.on("mappositionchanged",this.updateRectangle,this,!1),e.events.on("scaleratiochanged",this.updateMapSize,this,!1)]))},enumerable:!0,configurable:!0}),t.prototype.updateRectangle=function(){var e=this.chart,t=e.zoomLevel,i=this.rectangle;i.width=this.pixelWidth/t,i.height=this.pixelHeight/t;var n=Math.min(this.percentWidth,this.percentHeight)/100,r=e.seriesContainer;i.x=Math.ceil(-r.pixelX*n/t)+this.seriesContainer.pixelX,i.y=Math.ceil(-r.pixelY*n/t)+this.seriesContainer.pixelY,i.validate()},t.prototype.updateMapSize=function(){if(this.chart){var e=this.chart.scaleRatio*Math.min(this.percentWidth,this.percentHeight)/100;this.seriesContainer.scale=e;var t={width:0,height:0,x:0,y:0};try{t=this.seriesContainer.group.node.getBBox()}catch(i){}t.width>0&&(this.rectangle.visible=!0),this.seriesContainer.x=this.pixelWidth/2-t.x*e-t.width/2*e,this.seriesContainer.y=this.pixelHeight/2-t.y*e-t.height/2*e,this.updateRectangle(),this.afterDraw()}},t.prototype.afterDraw=function(){e.prototype.afterDraw.call(this),this.rectangle.maskRectangle={x:-1,y:-1,width:Math.ceil(this.pixelWidth+2),height:Math.ceil(this.pixelHeight+2)}},t.prototype.processConfig=function(t){if(t&&nl(t.series)&&cl(t.series))for(var i=0,n=t.series.length;i<n;i++){var r=t.series[i];nl(r)&&sl(r)&&this.map.hasKey(r)&&(t.series[i]=this.map.getKey(r))}e.prototype.processConfig.call(this,t)},t}(Wp);function Sg(e){return Nl(e,(function(e){Nl(e,(function(e){!function(e){var t=Tg(e.longitude),i=Math.asin(Math.sin(e.latitude*dl))*fl,n=Tg(e.latitude);Math.abs(n)>90&&(t=Tg(t+180)),e.longitude=t,e.latitude=i}(e)}))})),e}function Tg(e){return(e%=360)>180&&(e-=360),e<-180&&(e+=360),e}Bu.registeredClasses.SmallMap=Pg;var Eg=function(e){function t(){var t=e.call(this)||this;return t.adjustRotation=!0,t.className="MapLineObject",t.isMeasured=!1,t.layout="none",t.applyTheme(),t}return Us(t,e),t.prototype.validatePosition=function(){var t=this.mapLine;if(t){var i=t.positionToPoint(this.position);if(this.x=i.x,this.y=i.y,this.adjustRotation&&(this.rotation=i.angle),this.mapLine.dataItem){var n=this.mapLine.dataItem.component;this.scale=1/n.scale}if(t.shortestDistance){var r=this.mapLine.series.chart.projection,a=r.positionToGeoPoint(t.multiGeoLine,this.position),o=r.d3Path({type:"Point",coordinates:[a.longitude,a.latitude]});this.__disabled=!o}}e.prototype.validatePosition.call(this)},Object.defineProperty(t.prototype,"position",{get:function(){return this.getPropertyValue("position")},set:function(e){this.setPropertyValue("position",e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adjustRotation",{get:function(){return this.getPropertyValue("adjustRotation")},set:function(e){this.setPropertyValue("adjustRotation",e,!1,!0)},enumerable:!0,configurable:!0}),t}(Wp);Bu.registeredClasses.MapLineObject=Eg;var Cg=function(e){function t(){var t=e.call(this)||this;return t.className="MapImageSeriesDataItem",t.applyTheme(),t}return Us(t,e),t.prototype.getFeature=function(){return{type:"Feature",geometry:{type:"Point",coordinates:this.point}}},Object.defineProperty(t.prototype,"mapImage",{get:function(){var e=this;if(!this._mapImage){var t=this.component.mapImages.create();this.addSprite(t),this._mapImage=t,this._disposers.push(t),this._disposers.push(new eu((function(){e.component&&e.component.mapImages.removeValue(t)}))),this.mapObject=t}return this._mapImage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"point",{get:function(){return this._point},set:function(e){this._point=e,this._geoPoint=vv(e),this.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiPoint",{get:function(){return[this._point]},set:function(e){this._point=e[0],this._geoPoint=vv(this._point),this.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geoPoint",{get:function(){return this._geoPoint},set:function(e){this._geoPoint=e,this.point=[e.longitude,e.latitude]},enumerable:!0,configurable:!0}),t}(sv),Mg=function(e){function t(){var t=e.call(this)||this;return t.className="MapImageSeries",t.dataFields.multiPoint="multiPoint",t.dataFields.point="point",t.dataFields.geoPoint="geoPoint",t.dataFields.multiGeoPoint="multiGeoPoint",t.ignoreBounds=!0,t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new Cg},t.prototype.validateData=function(){var t=this;if(this.data.length>0&&0==this._parseDataFrom&&this.mapImages.clear(),this.useGeodata&&(this.useGeodata||this.geodata)){var i=this.chart.geodata,n=void 0;if("FeatureCollection"==i.type?n=i.features:"Feature"==i.type?n=[i]:-1!=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(i.type)?n=[{geometry:i}]:console.log("nothing found in geoJSON"),n)for(var r=function(e,t){var i=n[e],r=i.geometry;if(r){var o=r.type,s=i.id;if("Point"==o||"MultiPoint"==o){if(!a.checkInclude(a.include,a.exclude,s))return"continue";var l=r.coordinates;"Point"==o&&(l=[l]);var u=Jl(a.data,(function(e,t){return e.id==s}));u?u.multiPoint||(u.multiPoint=l):(u={multiPoint:l,id:s,madeFromGeoData:!0},a.data.push(u)),wc(i.properties,u)}}},a=this,o=0,s=n.length;o<s;o++)r(o)}e.prototype.validateData.call(this),Tu(this.dataItems.iterator(),(function(e){var i=e.mapImage;i.isDisposed()||(t.mapImages.moveValue(i),ll(i.latitude)&&ll(i.latitude)&&(e.geoPoint={latitude:i.latitude,longitude:i.longitude}))}))},Object.defineProperty(t.prototype,"mapImages",{get:function(){if(!this._mapImages){var e=new cv,t=new Hu(e);this._disposers.push(new Uu(t)),this._disposers.push(t.template),t.template.focusable=!0,t.events.on("inserted",this.handleObjectAdded,this,!1),this._mapImages=t,this._mapObjects=t}return this._mapImages},enumerable:!0,configurable:!0}),t.prototype.validateDataElement=function(t){e.prototype.validateDataElement.call(this,t),t.mapImage.invalidate()},t.prototype.validate=function(){e.prototype.validate.call(this),Tu(this.mapImages.iterator(),(function(e){e.validatePosition()}))},t.prototype.copyFrom=function(t){this.mapImages.template.copyFrom(t.mapImages.template),e.prototype.copyFrom.call(this,t)},t.prototype.getFeatures=function(){var e=this,t=[];return this.dataItems.each((function(e){var i=e.getFeature();i&&t.push(i)})),this.mapImages.each((function(i){if(-1==e.dataItems.indexOf(i._dataItem)){var n=i.getFeature();n&&t.push(n)}})),t},t.prototype.getImageById=function(e){return Mu(this.mapImages.iterator(),(function(t){var i=t.dataItem.dataContext;if(t.id==e||i&&i.id==e)return!0}))},t}(lv);Bu.registeredClasses.MapImageSeries=Mg,Bu.registeredClasses.MapImageSeriesDataItem=Cg;var Ig=function(e){function t(){var t=e.call(this)||this;t._imageListeners={},t.className="MapLine",t.createLine(),t.line.stroke=uc(),t.line.parent=t,t.strokeOpacity=1,t.setPropertyValue("precision",.1);var i=new Xh;return t.stroke=i.getFor("grid"),t.shortestDistance=!0,t.applyTheme(),t}return Us(t,e),t.prototype.createLine=function(){this.line=new _d},t.prototype.positionToPoint=function(e){return this.shortestDistance?this.series.chart.projection.positionToPoint(this.multiGeoLine,e):this.line?this.line.positionToPoint(e):{x:0,y:0,angle:0}},Object.defineProperty(t.prototype,"multiGeoLine",{get:function(){var e=this.getPropertyValue("multiGeoLine");return!e&&this.dataItem&&this.dataItem.multiGeoLine&&(e=this.dataItem.multiGeoLine),e},set:function(e){if(e&&e.length>0){this.setPropertyValue("multiGeoLine",Sg(e),!0);var t=gv(e);this.setPropertyValue("multiLine",t),this.updateExtremes()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiLine",{get:function(){var e=this.getPropertyValue("multiLine");return!e&&this.dataItem&&this.dataItem.multiLine&&(e=this.dataItem.multiLine),e},set:function(e){this.setPropertyValue("multiLine",e),this.multiGeoLine=dv(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imagesToConnect",{get:function(){return this.getPropertyValue("imagesToConnect")},set:function(e){var t=this;if(this.setPropertyValue("imagesToConnect",e,!0),this.handleImagesToConnect(),this.series){var i=this.series.chart;i&&i.series.each((function(e){e instanceof Mg&&(e.isReady()||t._disposers.push(e.events.on("ready",t.handleImagesToConnect,t,!1)))}))}},enumerable:!0,configurable:!0}),t.prototype.handleImagesToConnect=function(){var e,t,i=this;if(this.imagesToConnect){var n=[],r=[n],a=function(e){if(sl(e)){var t=o.series.chart;t&&t.series.each((function(t){if(t instanceof Mg){var i=t.getImageById(e);i&&(e=i)}}))}if(e instanceof cv&&(n.push({longitude:e.longitude,latitude:e.latitude}),!o._imageListeners[e.uid])){var r=e.events.on("propertychanged",(function(e){"longitude"!=e.property&&"latitude"!=e.property||(i.handleImagesToConnect(),i.invalidate())}),o,!1);o._imageListeners[e.uid]=r,o._disposers.push(r)}},o=this;try{for(var s=Hs(this.imagesToConnect),l=s.next();!l.done;l=s.next()){a(l.value)}}catch(u){e={error:u}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this.multiGeoLine=r}},t.prototype.validate=function(){var t=this.series.chart;if(this.multiLine){if(this.shortestDistance)t.projection.d3Projection.precision(this.precision),this.line.path=t.projection.d3Path(this.getFeature());else{for(var i=[],n=0,r=this.multiLine.length;n<r;n++){for(var a=this.multiLine[n],o=[],s=0,l=a.length;s<l;s++){var u=a[s],c=this.series.chart.projection.convert({longitude:u[0],latitude:u[1]});o.push(c)}i.push(o)}this.line.segments=i}this._arrow&&this._arrow.validatePosition(),Tu(this.lineObjects.iterator(),(function(e){e.validatePosition()})),this.handleGlobalScale()}else this.imagesToConnect&&this.handleImagesToConnect();e.prototype.validate.call(this)},t.prototype.getFeature=function(){if(this.multiLine&&this.multiLine.length>0&&this.multiLine[0]&&this.multiLine[0].length>0)return{type:"Feature",geometry:{type:"MultiLineString",coordinates:this.multiLine}}},t.prototype.measureElement=function(){},Object.defineProperty(t.prototype,"shortestDistance",{get:function(){return this.getPropertyValue("shortestDistance")},set:function(e){this.setPropertyValue("shortestDistance",e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineObjects",{get:function(){return this._lineObjects||(this._lineObjects=new Hu(new Eg),this._lineObjects.events.on("inserted",this.handleLineObjectAdded,this,!1),this._disposers.push(new Uu(this._lineObjects)),this._disposers.push(this._lineObjects.template)),this._lineObjects},enumerable:!0,configurable:!0}),t.prototype.handleLineObjectAdded=function(e){var t=e.newValue;t.mapLine=this,t.shouldClone=!1,t.parent=this},Object.defineProperty(t.prototype,"arrow",{get:function(){if(!this._arrow){var e=this.createChild(Eg);e.shouldClone=!1,e.width=8,e.height=10,e.mapLine=this,e.position=.5;var t=e.createChild(Rd);t.fillOpacity=1,t.width=Ks(100),t.height=Ks(100),t.rotation=90,t.horizontalCenter="middle",t.verticalCenter="middle",this._arrow=e}return this._arrow},set:function(e){this._arrow=e,e.mapLine=this,e.parent=this},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.line.copyFrom(t.line),this.lineObjects.copyFrom(t.lineObjects),t._arrow&&(this.arrow=t.arrow.clone())},Object.defineProperty(t.prototype,"latitude",{get:function(){return this.north+(this.south-this.north)/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.east+(this.west-this.east)/2},enumerable:!0,configurable:!0}),t.prototype.getTooltipX=function(){var e=this.getPropertyValue("tooltipX");return e instanceof Xs||(e=Ks(50)),e instanceof Xs?this.positionToPoint(e.value).x:0},t.prototype.getTooltipY=function(){var e=this.getPropertyValue("tooltipY");return e instanceof Xs||(e=Ks(50)),e instanceof Xs?this.positionToPoint(e.value).y:0},Object.defineProperty(t.prototype,"precision",{get:function(){return this.getPropertyValue("precision")},set:function(e){this.setPropertyValue("precision",e,!0)},enumerable:!0,configurable:!0}),t}(uv);Bu.registeredClasses.MapLine=Ig;var Og=function(e){function t(){var t=e.call(this)||this;return t.className="MapLineSeriesDataItem",t.applyTheme(),t}return Us(t,e),t.prototype.getFeature=function(){if(this.multiLine&&this.multiLine.length>0)return{type:"Feature",geometry:{type:"MultiLineString",coordinates:this.multiLine}}},Object.defineProperty(t.prototype,"mapLine",{get:function(){var e=this;if(!this._mapLine){var t=this.component.mapLines.create();this._mapLine=t,this.addSprite(t),this._disposers.push(t),this._disposers.push(new eu((function(){e.component&&e.component.mapLines.removeValue(t)}))),this.mapObject=t}return this._mapLine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._line},set:function(e){this._line=e,this.multiLine=[e]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiLine",{get:function(){return this._multiLine},set:function(e){this._multiLine=e,this._multiGeoLine=dv(e),this.updateExtremes()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geoLine",{get:function(){return this._geoLine},set:function(e){this._geoLine=e,this.multiLine=gv([e])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiGeoLine",{get:function(){return this._multiGeoLine},set:function(e){this._multiGeoLine=e,this.multiLine=gv(e)},enumerable:!0,configurable:!0}),t}(sv),Dg=function(e){function t(){var t=e.call(this)||this;return t.className="MapLineSeries",t.dataFields.multiLine="multiLine",t.dataFields.line="line",t.dataFields.geoLine="geoLine",t.dataFields.multiGeoLine="multiGeoLine",t.ignoreBounds=!0,t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new Og},t.prototype.validateData=function(){if(this.useGeodata||this.geodata){var t=this.chart.geodata;if(t){var i=void 0;if("FeatureCollection"==t.type?i=t.features:"Feature"==t.type?i=[t]:-1!=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(t.type)?i=[{geometry:t}]:console.log("nothing found in geoJSON"),i)for(var n=function(e,t){var n=i[e],a=n.geometry;if(a){var o=a.type,s=n.id;if("LineString"==o||"MultiLineString"==o){if(!r.checkInclude(r.include,r.exclude,s))return"continue";var l=a.coordinates,u=Jl(r.data,(function(e,t){return e.id==s}));"LineString"==o&&(l=[l]),u?u.multiLine||(u.multiLine=l):(u={multiLine:l,id:s,madeFromGeoData:!0},r.data.push(u)),wc(n.properties,u)}}},r=this,a=0,o=i.length;a<o;a++)n(a)}}e.prototype.validateData.call(this)},Object.defineProperty(t.prototype,"mapLines",{get:function(){if(!this._mapLines){var e=this.createLine(),t=new Hu(e);this._disposers.push(new Uu(t)),this._disposers.push(t.template),t.events.on("inserted",this.handleObjectAdded,this,!1),this._mapLines=t,this._mapObjects=t}return this._mapLines},enumerable:!0,configurable:!0}),t.prototype.createLine=function(){return new Ig},t.prototype.validate=function(){this.dataItems.each((function(e){e.mapLine})),e.prototype.validate.call(this),this.mapLines.each((function(e){e.validate()}))},t.prototype.copyFrom=function(t){this.mapLines.template.copyFrom(t.mapLines.template),e.prototype.copyFrom.call(this,t)},t.prototype.getFeatures=function(){var e=this,t=[];return this.dataItems.each((function(e){var i=e.getFeature();i&&t.push(i)})),this.mapLines.each((function(i){if(-1==e.dataItems.indexOf(i._dataItem)){var n=i.getFeature();n&&t.push(n)}})),t},t.prototype.getLineById=function(e){return Mu(this.mapLines.iterator(),(function(t){return t.dataItem.dataContext.id==e}))},t}(lv);Bu.registeredClasses.MapLineSeries=Dg,Bu.registeredClasses.MapLineSeriesDataItem=Og;var Ag=function(e){function t(){var t=e.call(this)||this;return t.className="Graticule",t.applyTheme(),t.shortestDistance=!0,t}return Us(t,e),t}(Ig);function Lg(e,t,i){e=+e,t=+t,i=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+i;for(var n=-1,r=0|Math.max(0,Math.ceil((t-e)/i)),a=new Array(r);++n<r;)a[n]=e+n*i;return a}function zg(e,t,i){var n=Lg(e,t-Hf,i).concat(t);return function(e){return n.map((function(t){return[e,t]}))}}function Rg(e,t,i){var n=Lg(e,t-Hf,i).concat(t);return function(e){return n.map((function(t){return[t,e]}))}}function Fg(){var e,t,i,n,r,a,o,s,l,u,c,h,p=10,d=p,f=90,m=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:g()}}function g(){return Lg(im(n/f)*f,i,f).map(c).concat(Lg(im(s/m)*m,o,m).map(h)).concat(Lg(im(t/p)*p,e,p).filter((function(e){return Jf(e%f)>Hf})).map(l)).concat(Lg(im(a/d)*d,r,d).filter((function(e){return Jf(e%m)>Hf})).map(u))}return y.lines=function(){return g().map((function(e){return{type:"LineString",coordinates:e}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(n).concat(h(o).slice(1),c(i).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(n=+e[0][0],i=+e[1][0],s=+e[0][1],o=+e[1][1],n>i&&(e=n,n=i,i=e),s>o&&(e=s,s=o,o=e),y.precision(v)):[[n,s],[i,o]]},y.extentMinor=function(i){return arguments.length?(t=+i[0][0],e=+i[1][0],a=+i[0][1],r=+i[1][1],t>e&&(i=t,t=e,e=i),a>r&&(i=a,a=r,r=i),y.precision(v)):[[t,a],[e,r]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(f=+e[0],m=+e[1],y):[f,m]},y.stepMinor=function(e){return arguments.length?(p=+e[0],d=+e[1],y):[p,d]},y.precision=function(p){return arguments.length?(v=+p,l=zg(a,r,90),u=Rg(t,e,v),c=zg(s,o,90),h=Rg(n,i,v),y):v},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}Bu.registeredClasses.Graticule=Ag;var jg=function(e){function t(){var t=e.call(this)||this;return t.className="GraticuleSeriesDataItem",t.applyTheme(),t}return Us(t,e),t}(Og),Bg=function(e){function t(){var t=e.call(this)||this;return t.className="GraticuleSeries",t.longitudeStep=10,t.latitudeStep=10,t.north=90,t.south=-90,t.east=-180,t.west=180,t.fitExtent=!0,t.singleSprite=!0,t.events.disableType("geoBoundsChanged"),t.mapLines.template.line.strokeOpacity=.08,t.ignoreBounds=!1,t.hiddenInLegend=!0,t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new jg},t.prototype.validateData=function(){var t=this;e.prototype.validateData.call(this),this.mapLines.clear();var i=Fg();if(i){i.stepMinor([this.longitudeStep,this.latitudeStep]),i.stepMajor([360,360]);var n=this.chart;if(this.fitExtent?i.extent([[n.east,n.north],[n.west,n.south]]):i.extent([[this.east,this.north],[this.west,this.south]]),this.singleSprite)this.mapLines.create().multiLine=i().coordinates;else Nl(i.lines(),(function(e){t.mapLines.create().multiLine=[e.coordinates]}))}},t.prototype.createLine=function(){return new Ag},Object.defineProperty(t.prototype,"latitudeStep",{get:function(){return this.getPropertyValue("latitudeStep")},set:function(e){this.setPropertyValue("latitudeStep",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitudeStep",{get:function(){return this.getPropertyValue("longitudeStep")},set:function(e){this.setPropertyValue("longitudeStep",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitExtent",{get:function(){return this.getPropertyValue("fitExtent")},set:function(e){this.setPropertyValue("fitExtent",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"singleSprite",{get:function(){return this.getPropertyValue("singleSprite")},set:function(e){this.setPropertyValue("singleSprite",e)&&this.invalidateData()},enumerable:!0,configurable:!0}),t}(Dg);Bu.registeredClasses.GraticuleSeries=Bg,Bu.registeredClasses.GraticuleSeriesDataItem=jg;!function(e){function t(){var t=e.call(this)||this;return t.className="MapChartDataItem",t.applyTheme(),t}Us(t,e)}(Uf);var Vg=function(e){function t(){var t=e.call(this)||this;t.scaleRatio=1,t.zoomDuration=1e3,t.zoomEasing=uh,t.minZoomLevel=1,t.maxZoomLevel=32,t._prevZoomGeoPoint={latitude:0,longitude:0},t.className="MapChart",t.projection=new kg,t.setPropertyValue("deltaLatitude",0),t.setPropertyValue("deltaLongitude",0),t.setPropertyValue("deltaGamma",0),t.maxPanOut=.7,t.homeZoomLevel=1,t.zoomStep=2,t.layout="absolute",t.centerMapOnZoomOut=!0,t.padding(0,0,0,0),t.backgroundSeries,t.minWidth=10,t.minHeight=10,t.events.once("inited",t.handleAllInited,t,!1);var i=t.seriesContainer;i.visible=!1,i.inert=!0,i.resizable=!0,i.events.on("transformed",t.handleMapTransform,t,!1),i.events.on("doublehit",t.handleDoubleHit,t,!1),i.events.on("dragged",t.handleDrag,t,!1),i.zIndex=0,i.dragWhileResize=!0,i.adapter.add("scale",(function(e,i){return gl(e,t.minZoomLevel,t.maxZoomLevel)})),t.events.on("maxsizechanged",(function(e){0!=e.previousWidth&&0!=e.previousHeight||(t.updateExtremes(),t.updateCenterGeoPoint())}),void 0,!1);var n=t.chartContainer;n.parent=t,n.zIndex=-1,t._disposers.push(t.events.on("maxsizechanged",(function(){if(t.inited){t._mapAnimation&&t._mapAnimation.stop();var e=!0;t.series.each((function(t){t.updateTooltipBounds(),t.inited&&!t.dataInvalid||(e=!1)})),e&&t.updateScaleRatio(),t.zoomToGeoPoint(t._zoomGeoPointReal,t.zoomLevel,!0,0)}}),void 0,!1));var r=n.background;r.fillOpacity=0,r.events.on("down",(function(e){t.seriesContainer.dragStart(e.target.interactions.downPointers.getIndex(0))}),t),r.events.on("up",(function(e){t.seriesContainer.dragStop()}),t),r.events.on("doublehit",t.handleDoubleHit,t),r.focusable=!0,n.events.on("down",t.handleMapDown,t,!1),t.addDisposer(i.events.on("down",(function(){var e=t.seriesContainer.interactions.inertias.getKey("move");e&&e.done()}))),t.background.fillOpacity=0,t._disposers.push(ap().body.events.on("keyup",(function(e){if(t.topParent.hasFocused){var i=ep.getEventKey(e.event);if(!t._zoomControl||!t._zoomControl.thumb.isFocused)switch(i){case"up":t.pan({x:0,y:.1});break;case"down":t.pan({x:0,y:-.1});break;case"left":t.pan({x:.1,y:0});break;case"right":t.pan({x:-.1,y:0})}}}),t)),t.mouseWheelBehavior="zoom";var a=ap();t._disposers.push(a.body.events.on("down",t.handlePanDown,t)),t._disposers.push(a.body.events.on("up",t.handlePanUp,t));var o=t.seriesContainer.createChild(sd);return o.radius=10,o.inert=!0,o.isMeasured=!1,o.events.on("transformed",t.handlePanMove,t,!1),o.interactionsEnabled=!1,o.opacity=0,o.x=0,o.y=0,t.panSprite=o,t.panBehavior="move",t.applyTheme(),t}return Us(t,e),t.prototype.handlePanDown=function(e){var t=Kc(e.pointer.point,this.htmlContainer);t.x>0&&t.y>0&&t.x<this.svgContainer.width&&t.y<this.svgContainer.height&&(this._downPointOrig=Yc(e.pointer.point,this.seriesContainer),this.panSprite.moveTo(this._downPointOrig),this.panSprite.dragStart(e.pointer),this._downDeltaLongitude=this.deltaLongitude,this._downDeltaLatitude=this.deltaLatitude)},t.prototype.handlePanUp=function(e){this._downPointOrig&&this.panSprite.dragStop(e.pointer,!0),this._downPointOrig=void 0},t.prototype.handlePanMove=function(){if(!this.seriesContainer.isResized){if(ap().areTransformed([this.panSprite.interactions,this.seriesContainer.interactions]))return;var e=this.projection.d3Projection,t=this.panBehavior;if("move"!=t&&"none"!=t&&this._downPointOrig&&e.rotate){var i=e.rotate(),n=i[0],r=i[1],a=i[2];e.rotate([0,0,0]);var o=this.projection.invert(this._downPointOrig),s={x:this.panSprite.pixelX,y:this.panSprite.pixelY},l=void 0;s&&(l=this.projection.invert(s)),e.rotate([n,r,a]),l&&("rotateLat"!=t&&"rotateLongLat"!=t||(this.deltaLatitude=this._downDeltaLatitude+l.latitude-o.latitude),"rotateLong"!=t&&"rotateLongLat"!=t||(this.deltaLongitude=this._downDeltaLongitude+l.longitude-o.longitude))}}},t.prototype.handleAllInited=function(){var e=this,t=!0;if(this.seriesContainer.visible=!0,this.series.each((function(e){e.inited&&!e.dataInvalid||(t=!1)})),t)this.updateCenterGeoPoint(),this.updateScaleRatio(),this.goHome(0);else{var i=Bu.events.once("exitframe",(function(){e.removeDispose(i),e.handleAllInited()}),this,!1);this.addDisposer(i)}},t.prototype.updateZoomGeoPoint=function(){var e=Hc({x:this.innerWidth/2+this.pixelPaddingLeft,y:this.innerHeight/2+this.pixelPaddingTop},this.series.getIndex(0)),t=this.projection.invert(e);this._zoomGeoPointReal=t},t.prototype.updateCenterGeoPoint=function(){var e,t,i,n;if(this.backgroundSeries){var r=this.backgroundSeries.getFeatures();if(r.length>0){var a=this.projection.d3Path.bounds(r[0].geometry);e=a[0][0],i=a[0][1],t=a[1][0],n=a[1][1]}}else this.series.each((function(r){var a=r.group.node.getBBox();(e>a.x||!ll(e))&&(e=a.x),(t<a.x+a.width||!ll(t))&&(t=a.x+a.width),(i>a.y||!ll(i))&&(i=a.y),(n<a.y+a.height||!ll(n))&&(n=a.y+a.height)}));this.seriesMaxLeft=e,this.seriesMaxRight=t,this.seriesMaxTop=i,this.seriesMaxBottom=n,this.seriesWidth=t-e,this.seriesHeight=n-i,this.seriesWidth>0&&this.seriesHeight>0?(this.chartContainer.visible=!0,this._centerGeoPoint=this.projection.invert({x:e+(t-e)/2,y:i+(n-i)/2}),this._zoomGeoPointReal&&ll(this._zoomGeoPointReal.latitude)||(this._zoomGeoPointReal=this._centerGeoPoint)):this.chartContainer.visible=!1},t.prototype.handleDrag=function(){var e=this.zoomLevel*this.scaleRatio,t=this.seriesWidth*e,i=this.seriesHeight*e,n=this.seriesContainer,r=this.seriesMaxLeft*e,a=this.seriesMaxRight*e,o=this.seriesMaxTop*e,s=this.seriesMaxBottom*e,l=n.pixelX,u=n.pixelY,c=this.maxPanOut,h=Math.min(this.maxWidth*(1-c)-t-r,-r);l<h&&(l=h);var p=Math.max(this.maxWidth*c-r,this.maxWidth-a);l>p&&(l=p);var d=Math.min(this.maxHeight*(1-c)-i-o,-o);u<d&&(u=d);var f=Math.max(this.maxHeight*c-o,this.maxHeight-s);u>f&&(u=f),n.moveTo({x:l,y:u},void 0,void 0,!0),this._zoomGeoPointReal=this.zoomGeoPoint},t.prototype.applyInternalDefaults=function(){e.prototype.applyInternalDefaults.call(this),nl(this.readerTitle)||(this.readerTitle=this.language.translate("Map")),nl(this.background.readerTitle)||(this.background.readerTitle=this.language.translate("Use plus and minus keys on your keyboard to zoom in and out"))},t.prototype.handleMapDown=function(){this._mapAnimation&&this._mapAnimation.stop()},t.prototype.handleDoubleHit=function(e){var t=Kc(e.point,this.htmlContainer,this.svgContainer.cssScale),i=this.svgPointToGeo(t);this.zoomIn(i)},t.prototype.handleWheel=function(e){var t=this.seriesContainer.interactions.inertias.getKey("move");t&&t.done();var i=Kc(e.point,this.htmlContainer,this.svgContainer.cssScale),n=this.svgPointToGeo(i);e.shift.y<0?this.zoomIn(n,void 0,this.interactions.mouseOptions.sensitivity):this.zoomOut(n,void 0,this.interactions.mouseOptions.sensitivity)},Object.defineProperty(t.prototype,"mouseWheelBehavior",{get:function(){return this.getPropertyValue("mouseWheelBehavior")},set:function(e){this.setPropertyValue("mouseWheelBehavior",e)&&("none"!=e?(this._mouseWheelDisposer=this.chartContainer.events.on("wheel",this.handleWheel,this,!1),this._disposers.push(this._mouseWheelDisposer)):(this._mouseWheelDisposer&&this._mouseWheelDisposer.dispose(),this.chartContainer.wheelable=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panBehavior",{get:function(){return this.getPropertyValue("panBehavior")},set:function(e){if(this.setPropertyValue("panBehavior",e)){var t=this.seriesContainer;if(this.panSprite.draggable=!1,t.draggable=!1,"move"===e)t.draggable=!0;else this.panSprite.draggable=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerMapOnZoomOut",{get:function(){return this.getPropertyValue("centerMapOnZoomOut")},set:function(e){this.setPropertyValue("centerMapOnZoomOut",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"projection",{get:function(){return this.getPropertyValue("projection")},set:function(e){var t=this;this.setPropertyValue("projection",e)&&(this.invalidateProjection(),e.chart=this,this._backgroundSeries&&this._backgroundSeries.invalidate(),this.inited&&this.updateExtremes(),this.series.each((function(e){e.events.once("validated",(function(){t.updateCenterGeoPoint(),t.updateScaleRatio(),t.goHome(0)}))})))},enumerable:!0,configurable:!0}),t.prototype.validateDataItems=function(){e.prototype.validateDataItems.call(this),this.updateExtremes()},t.prototype.updateExtremes=function(){var e,t,i,n;this.series.each((function(r){r.ignoreBounds||r instanceof Bg&&r.fitExtent||((r.north>t||!ll(t))&&(t=r.north),(r.south<n||!ll(n))&&(n=r.south),(r.west<i||!ll(i))&&(i=r.west),(r.east>e||!ll(e))&&(e=r.east))}));var r=[],a=!1;this.series.each((function(e){e instanceof Bg&&!e.fitExtent&&(r=e.getFeatures(),a=!0)})),a||this.series.each((function(e){e.ignoreBounds||e instanceof Bg&&e.fitExtent||(r=r.concat(e.getFeatures()))}));var o=xl(50,this.innerWidth),s=xl(50,this.innerHeight),l=this.projection.d3Projection;if(r.length>0&&l&&(this.east!=e||this.west!=i||this.north!=t||this.south!=n)){if(this.east=e,this.west=i,this.north=t,this.south=n,l.rotate){var u=l.rotate(),c=u[0],h=u[1],p=u[2];this.deltaLongitude=c,this.deltaLatitude=h,this.deltaGamma=p}var d={type:"FeatureCollection",features:r},f=l.scale();if(l.fitSize([o,s],d),l.scale()!=f&&this.invalidateDataUsers(),this.series.each((function(e){e instanceof Bg&&e.invalidateData()})),this._backgroundSeries){var m=this._backgroundSeries.mapPolygons.getIndex(0);m&&(m.multiPolygon=function(e,t,i,n){var r=[];-180==n&&(n=-179.9999),-90==i&&(i=-89.9999),90==e&&(e=89.9999),180==t&&(t=179.9999);for(var a=Math.min(90,(t-n)/Math.ceil((t-n)/90)),o=(e-i)/Math.ceil((e-i)/90),s=n;s<t;s+=a){var l=[];r.push([l]),s+a>t&&(a=t-s);for(var u=s;u<=s+a;u+=5)l.push([u,e]);for(var c=e;c>=i;c-=o)l.push([s+a,c]);for(u=s+a;u>=s;u-=5)l.push([u,i]);for(c=i;c<=e;c+=o)l.push([s,c])}return r}(this.north,this.east,this.south,this.west))}this._fitWidth=o,this._fitHeight=s}this._zoomGeoPointReal&&ll(this._zoomGeoPointReal.latitude)||this.goHome(0)},t.prototype.updateScaleRatio=function(){var e;this.updateCenterGeoPoint();var t=this.innerWidth/this.seriesWidth,i=this.innerHeight/this.seriesHeight;(Ys(e=wl(t,i))||e==1/0)&&(e=1),e!=this.scaleRatio&&(this.scaleRatio=e,Tu(this.series.iterator(),(function(t){t.scale=e,t.updateTooltipBounds()})),this.backgroundSeries.scale=e,this.dispatch("scaleratiochanged"))},t.prototype.svgPointToGeo=function(e){var t=this.series.getIndex(0);if(t){var i=Hc(e,t);return this.seriesPointToGeo(i)}},t.prototype.geoPointToSVG=function(e){var t=this.series.getIndex(0);if(t)return Zc(this.geoPointToSeries(e),t)},t.prototype.seriesPointToGeo=function(e){return this.projection.invert(e)},t.prototype.geoPointToSeries=function(e){return this.projection.convert(e)},Object.defineProperty(t.prototype,"geodata",{get:function(){return this._geodata},set:function(e){e!=this._geodata&&(this._geodata=e,this.reverseGeodata&&this.processReverseGeodata(this._geodata),this.invalidateData(),this.dataUsers.each((function(e){for(var t=e.data.length-1;t>=0;t--)1==e.data[t].madeFromGeoData&&e.data.splice(t,1);e.disposeData(),e.invalidateData()})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reverseGeodata",{get:function(){return this.getPropertyValue("reverseGeodata")},set:function(e){this.setPropertyValue("reverseGeodata",e)&&this._geodata&&this.processReverseGeodata(this._geodata)},enumerable:!0,configurable:!0}),t.prototype.processReverseGeodata=function(e){for(var t=0;t<e.features.length;t++)for(var i=e.features[t],n=0;n<i.geometry.coordinates.length;n++)if("MultiPolygon"==i.geometry.type)for(var r=0;r<i.geometry.coordinates[n].length;r++)i.geometry.coordinates[n][r].reverse();else i.geometry.coordinates[n].reverse()},t.prototype.zoomToGeoPoint=function(e,t,i,n,r){var a=this;if(!e){var o=!1;if(this.series.each((function(e){e.dataItems.length>0&&(o=!0)})),!o)return;e=this.zoomGeoPoint}if(e&&ll(e.longitude)&&ll(e.latitude)){this._zoomGeoPointReal=e,t=gl(t,this.minZoomLevel,this.maxZoomLevel);var s=this.projection.convert(e);if(s){var l=Hc(this.geoPointToSVG(e),this);i&&(l={x:this.innerWidth/2,y:this.innerHeight/2}),ll(n)||(n=this.zoomDuration);var u=l.x-s.x*t*this.scaleRatio,c=l.y-s.y*t*this.scaleRatio;return!r&&t<this.zoomLevel&&this.centerMapOnZoomOut&&t<1.5&&(u=this.innerWidth/2-(this.seriesMaxLeft+(this.seriesMaxRight-this.seriesMaxLeft)/2)*t*this.scaleRatio,c=this.innerHeight/2-(this.seriesMaxTop+(this.seriesMaxBottom-this.seriesMaxTop)/2)*t*this.scaleRatio),this._mapAnimation=this.seriesContainer.animate([{property:"scale",to:t},{property:"x",from:this.seriesContainer.pixelX,to:u},{property:"y",from:this.seriesContainer.pixelY,to:c}],n,this.zoomEasing),this._disposers.push(this._mapAnimation.events.on("animationended",(function(){a._zoomGeoPointReal=a.zoomGeoPoint}))),this.seriesContainer.validatePosition(),this._mapAnimation}}},t.prototype.zoomToMapObject=function(e,t,i,n){void 0==i&&(i=!0);var r=this.seriesContainer.interactions.inertias.getKey("move");if(r&&r.done(),e instanceof cv)return Ys(t)&&(t=5),this.zoomToGeoPoint({latitude:e.latitude,longitude:e.longitude},t,i,n,!0);var a=e.dataItem;if(a&&ll(a.zoomLevel)&&(t=a.zoomLevel),e instanceof bv){var o=e.dataItem,s=e.polygon.bbox;0!=s.width&&0!=s.height||(s=e.polygon.group.getBBox()),ll(t)||(t=Math.min(this.seriesWidth/s.width,this.seriesHeight/s.height));var l=void 0;if(o&&nl(o.zoomGeoPoint))l=o.zoomGeoPoint;else{var u=qc({x:s.x+s.width/2,y:s.y+s.height/2},e.polygon,e.series);l=this.seriesPointToGeo(u)}return this.zoomToGeoPoint(l,t,!0,n,!0)}},t.prototype.zoomToRectangle=function(e,t,i,n,r,a,o){Ys(r)&&(r=1);var s=wl(n,t),l=xl(n,t);n=s,t=l;var u=zl(180-this.deltaLongitude);u>180&&(u-=360);var c=n+(t-n)/2,h=n-t;n<u&&t>u&&(c+=180,h=zl(t-n-360));var p=r*Math.min((this.south-this.north)/(i-e),Math.abs((this.west-this.east)/h));return this.zoomToGeoPoint({latitude:e+(i-e)/2,longitude:c},p,a,o,!0)},t.prototype.zoomIn=function(e,t,i){void 0===i&&(i=1);var n=1+(this.zoomStep-1)*i;return n<1&&(n=1),this.zoomToGeoPoint(e,this.zoomLevel*n,!1,t)},t.prototype.zoomOut=function(e,t,i){void 0===i&&(i=1);var n=1+(this.zoomStep-1)*i;return n<1&&(n=1),this.zoomToGeoPoint(e,this.zoomLevel/n,!1,t)},t.prototype.pan=function(e,t){var i=this.geoPointToSVG(this.zoomGeoPoint);i.x+=this.pixelWidth*e.x,i.y+=this.pixelHeight*e.y,this.zoomToGeoPoint(this.svgPointToGeo(i),this.zoomLevel,!0,t,!0)},Object.defineProperty(t.prototype,"zoomGeoPoint",{get:function(){var e=Zc({x:this.pixelWidth/2,y:this.pixelHeight/2},this);return this.svgPointToGeo(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomLevel",{get:function(){return this.seriesContainer.scale},set:function(e){this.seriesContainer.scale=e},enumerable:!0,configurable:!0}),t.prototype.handleMapTransform=function(){this.zoomLevel!=this._prevZoomLevel&&(this.dispatch("zoomlevelchanged"),this._prevZoomLevel=this.zoomLevel,this.svgContainer.readerAlert(this.language.translate("Zoom level changed to %1",this.language.locale,Js(this.zoomLevel)))),!this.zoomGeoPoint||this._prevZoomGeoPoint.latitude==this.zoomGeoPoint.latitude&&this._prevZoomGeoPoint.longitude==this.zoomGeoPoint.longitude||this.dispatch("mappositionchanged")},Object.defineProperty(t.prototype,"smallMap",{get:function(){if(!this._smallMap){var e=new Pg;this.smallMap=e}return this._smallMap},set:function(e){this._smallMap&&this.removeDispose(this._smallMap),this._smallMap=e,this._smallMap.chart=this,e.parent=this.chartContainer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomControl",{get:function(){return this._zoomControl},set:function(e){this._zoomControl&&this.removeDispose(this._zoomControl),this._zoomControl=e,e.chart=this,e.parent=this.chartContainer,e.plusButton.exportable=!1,e.minusButton.exportable=!1},enumerable:!0,configurable:!0}),t.prototype.createSeries=function(){return new lv},Object.defineProperty(t.prototype,"deltaLongitude",{get:function(){return this.getPropertyValue("deltaLongitude")},set:function(e){e=vl(e,3),this.setPropertyValue("deltaLongitude",Tg(e))&&(this.rotateMap(),this.updateZoomGeoPoint())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaLatitude",{get:function(){return this.getPropertyValue("deltaLatitude")},set:function(e){e=vl(e,3),this.setPropertyValue("deltaLatitude",e)&&(this.rotateMap(),this.updateZoomGeoPoint())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaGamma",{get:function(){return this.getPropertyValue("deltaGamma")},set:function(e){e=vl(e,3),this.setPropertyValue("deltaGamma",e)&&(this.rotateMap(),this.updateZoomGeoPoint())},enumerable:!0,configurable:!0}),t.prototype.rotateMap=function(){this.projection.d3Projection&&this.projection.d3Projection.rotate&&(this.projection.d3Projection.rotate([this.deltaLongitude,this.deltaLatitude,this.deltaGamma]),this.invalidateProjection())},Object.defineProperty(t.prototype,"maxPanOut",{get:function(){return this.getPropertyValue("maxPanOut")},set:function(e){this.setPropertyValue("maxPanOut",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"homeGeoPoint",{get:function(){return this.getPropertyValue("homeGeoPoint")},set:function(e){this.setPropertyValue("homeGeoPoint",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"homeZoomLevel",{get:function(){return this.getPropertyValue("homeZoomLevel")},set:function(e){this.setPropertyValue("homeZoomLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomStep",{get:function(){return this.getPropertyValue("zoomStep")},set:function(e){this.setPropertyValue("zoomStep",e)},enumerable:!0,configurable:!0}),t.prototype.invalidateProjection=function(){this.east=void 0,this.invalidateDataUsers(),this.updateCenterGeoPoint()},Object.defineProperty(t.prototype,"geodataSource",{get:function(){var e=this;this._dataSources.geodata||this.getDataSource("geodata").events.on("parseended",(function(){e.events.once("datavalidated",(function(){e.goHome(0)}))}));return this._dataSources.geodata},set:function(e){var t=this;this._dataSources.geodata&&this.removeDispose(this._dataSources.geodata),this._dataSources.geodata=e,this._dataSources.geodata.component=this,this.events.on("inited",(function(){t.loadData("geodata")}),this,!1),this.setDataSourceEvents(e,"geodata")},enumerable:!0,configurable:!0}),t.prototype.processConfig=function(t){if(nl(t.geodata)&&sl(t.geodata)){var i=t.geodata;if(nl(window["am4geodata_"+t.geodata]))t.geodata=window["am4geodata_"+t.geodata];else try{t.geodata=JSON.parse(t.geodata)}catch(n){this.raiseCriticalError(Error("MapChart error: Geodata `"+i+"` is not loaded or is incorrect."),!0)}}nl(t.projection)&&sl(t.projection)&&(t.projection=this.createClassInstance(t.projection)),nl(t.smallMap)&&!nl(t.smallMap.type)&&(t.smallMap.type="SmallMap"),nl(t.zoomControl)&&!nl(t.zoomControl.type)&&(t.zoomControl.type="ZoomControl"),e.prototype.processConfig.call(this,t)},t.prototype.handleSeriesAdded=function(t){e.prototype.handleSeriesAdded.call(this,t);var i=t.newValue;i.scale=this.scaleRatio,i.events.on("validated",this.updateCenterGeoPoint,this,!1)},t.prototype.configOrder=function(t,i){return t==i?0:"smallMap"==t?1:"smallMap"==i?-1:"series"==t?1:"series"==i?-1:e.prototype.configOrder.call(this,t,i)},t.prototype.asIs=function(t){return"projection"==t||"geodata"==t||e.prototype.asIs.call(this,t)},Object.defineProperty(t.prototype,"centerGeoPoint",{get:function(){return this._centerGeoPoint},enumerable:!0,configurable:!0}),t.prototype.goHome=function(e){var t=this.homeGeoPoint;t||(t=this.centerGeoPoint),t&&this.zoomToGeoPoint(t,this.homeZoomLevel,!0,e,!0)},t.prototype.setPaper=function(t){return this.svgContainer&&(this.svgContainer.hideOverflow=!0),e.prototype.setPaper.call(this,t)},Object.defineProperty(t.prototype,"backgroundSeries",{get:function(){var e=this;if(!this._backgroundSeries){var t=new wv;t.parent=this.seriesContainer,t.chart=this,t.hiddenInLegend=!0,t.mapPolygons.template.focusable=!1,t.addDisposer(new eu((function(){e._backgroundSeries=void 0}))),this._disposers.push(t);var i=(new Xh).getFor("background"),n=t.mapPolygons.template.polygon;n.stroke=i,n.fill=i,n.fillOpacity=0,n.strokeOpacity=0,t.mapPolygons.create(),this._backgroundSeries=t}return this._backgroundSeries},enumerable:!0,configurable:!0}),t.prototype.setLegend=function(t){e.prototype.setLegend.call(this,t),t&&(t.parent=this)},t.prototype.setTapToActivate=function(t){e.prototype.setTapToActivate.call(this,t),this.seriesContainer.interactions.isTouchProtected=!0,this.panSprite.interactions.isTouchProtected=!0},t.prototype.handleTapToActivate=function(){e.prototype.handleTapToActivate.call(this),this.seriesContainer.interactions.isTouchProtected=!1,this.panSprite.interactions.isTouchProtected=!1},t.prototype.handleTapToActivateDeactivation=function(){e.prototype.handleTapToActivateDeactivation.call(this),this.seriesContainer.interactions.isTouchProtected=!0,this.panSprite.interactions.isTouchProtected=!0},t.prototype.asFunction=function(t){return"zoomEasing"==t||e.prototype.asIs.call(this,t)},t.prototype.hasLicense=function(){if(_h.commercialLicense)return!0;if(!e.prototype.hasLicense.call(this))return!1;for(var t=0;t<_h.licenses.length;t++)if(_h.licenses[t].match(/^MP.{5,}/i))return!0;return!1},t}(Gf);Bu.registeredClasses.MapChart=Vg;var Ng=function(e){function t(){var t=e.call(this)||this;return t.className="MapSpline",t.applyTheme(),t}return Us(t,e),t.prototype.createLine=function(){this.line=new kd,this.line.tensionX=.8,this.line.tensionY=.8},Object.defineProperty(t.prototype,"shortestDistance",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),t}(Ig);Bu.registeredClasses.MapSpline=Ng;var Ug=function(e){function t(){var t=e.call(this)||this;return t.className="MapArc",t.applyTheme(),t}return Us(t,e),t.prototype.createLine=function(){this.line=new bd},Object.defineProperty(t.prototype,"shortestDistance",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),t}(Ig);Bu.registeredClasses.MapArc=Ug;var Gg=function(e){function t(){var t=e.call(this)||this;return t.className="MapSplineSeriesDataItem",t.applyTheme(),t}return Us(t,e),t}(Og),Wg=function(e){function t(){var t=e.call(this)||this;return t.className="MapSplineSeries",t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new Gg},t.prototype.createLine=function(){return new Ng},t}(Dg);Bu.registeredClasses.MapSplineSeries=Wg,Bu.registeredClasses.MapSplineSeriesDataItem=Gg;var Hg=function(e){function t(){var t=e.call(this)||this;return t.className="MapArcSeriesDataItem",t.applyTheme(),t}return Us(t,e),t}(Og),Zg=function(e){function t(){var t=e.call(this)||this;return t.className="MapArcSeries",t.applyTheme(),t}return Us(t,e),t.prototype.createDataItem=function(){return new Hg},t.prototype.createLine=function(){return new Ug},t}(Dg);Bu.registeredClasses.MapArcSeries=Zg,Bu.registeredClasses.MapArcSeriesDataItem=Hg;var qg=function(e){function t(){var t=e.call(this)||this;t._chart=new iu,t.className="ZoomControl",t.align="right",t.valign="bottom",t.layout="vertical",t.padding(5,5,5,5);var i=new Xh,n=t.createChild(od);n.shouldClone=!1,n.label.text="+",t.plusButton=n;var r=t.createChild(Wp);r.shouldClone=!1,r.background.fill=i.getFor("alternativeBackground"),r.background.fillOpacity=.05,r.background.events.on("hit",t.handleBackgroundClick,t,!1),r.events.on("sizechanged",t.updateThumbSize,t,!1),t.slider=r;var a=r.createChild(od);a.shouldClone=!1,a.padding(0,0,0,0),a.draggable=!0,a.events.on("drag",t.handleThumbDrag,t,!1),t.thumb=a;var o=t.createChild(od);return o.shouldClone=!1,o.label.text="-",t.minusButton=o,t.thumb.role="slider",t.thumb.readerLive="polite",t.thumb.readerTitle=t.language.translate("Use arrow keys to zoom in and out"),t.minusButton.readerTitle=t.language.translate("Press ENTER to zoom in"),t.plusButton.readerTitle=t.language.translate("Press ENTER to zoom out"),t.applyTheme(),t.events.on("propertychanged",(function(e){"layout"==e.property&&t.fixLayout()}),void 0,!1),t._disposers.push(t._chart),t.fixLayout(),t}return Us(t,e),t.prototype.fixLayout=function(){var e=this.plusButton,t=this.minusButton,i=this.thumb,n=this.slider;e.x=void 0,e.y=void 0,t.x=void 0,t.y=void 0,i.x=void 0,i.y=void 0,n.x=void 0,n.y=void 0,e.padding(6,10,6,10),t.padding(6,10,6,10),t.label.align="center",t.label.valign="middle",e.label.align="center",e.label.valign="middle","vertical"==this.layout?(this.width=40,this.height=void 0,t.width=Ks(100),t.height=void 0,i.width=Ks(100),i.height=void 0,e.width=Ks(100),e.height=void 0,n.width=Ks(100),t.marginTop=1,e.marginBottom=2,n.height=0,t.toFront(),e.toBack(),i.minX=0,i.maxX=0,i.minY=0):"horizontal"==this.layout&&(this.height=40,this.width=void 0,t.height=Ks(100),t.width=void 0,e.height=Ks(100),e.width=void 0,i.height=Ks(100),i.width=void 0,i.minX=0,i.minY=0,i.maxY=0,n.height=Ks(100),n.width=0,t.toBack(),e.toFront())},t.prototype.handleBackgroundClick=function(e){var t=e.target,i=e.spritePoint.y,n=this.chart,r=Math.log(n.maxZoomLevel)/Math.LN2,a=Math.log(n.minZoomLevel)/Math.LN2,o=(t.pixelHeight-i)/t.pixelHeight*(a+(r-a)),s=Math.pow(2,o);n.zoomToGeoPoint(n.zoomGeoPoint,s)},Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart.get()},set:function(e){var t=this;this._chart.set(e,new tu([e.events.on("maxsizechanged",this.updateThumbSize,this,!1),e.events.on("zoomlevelchanged",this.updateThumb,this,!1),this.minusButton.events.on("hit",(function(){e.zoomOut(e.zoomGeoPoint)}),e,!1),ap().body.events.on("keyup",(function(i){t.topParent.hasFocused&&(ep.isKey(i.event,"plus")?e.zoomIn():ep.isKey(i.event,"minus")&&e.zoomOut())}),e),this.plusButton.events.on("hit",(function(){e.zoomIn(e.zoomGeoPoint)}),e,!1)]))},enumerable:!0,configurable:!0}),t.prototype.updateThumbSize=function(){if(this.chart){var e=this.slider,t=this.thumb;"vertical"==this.layout?(t.minHeight=Math.min(this.slider.pixelHeight,20),t.height=e.pixelHeight/this.stepCount,t.maxY=e.pixelHeight-t.pixelHeight,t.pixelHeight<=1?t.visible=!1:t.visible=!0):(t.minWidth=Math.min(this.slider.pixelWidth,20),t.width=e.pixelWidth/this.stepCount,t.maxX=e.pixelWidth-t.pixelWidth,t.pixelWidth<=1?t.visible=!1:t.visible=!0)}},t.prototype.updateThumb=function(){var e=this.slider,t=this.chart,i=this.thumb;if(!i.isDown){var n=(Math.log(t.zoomLevel)-Math.log(this.chart.minZoomLevel))/Math.LN2;"vertical"==this.layout?i.y=e.pixelHeight-(e.pixelHeight-i.pixelHeight)*n/this.stepCount-i.pixelHeight:i.x=e.pixelWidth*n/this.stepCount}},t.prototype.handleThumbDrag=function(){var e,t=this.slider,i=this.chart,n=this.thumb;e=Math.log(this.chart.minZoomLevel)/Math.LN2+(e="vertical"==this.layout?this.stepCount*(t.pixelHeight-n.pixelY-n.pixelHeight)/(t.pixelHeight-n.pixelHeight):this.stepCount*n.pixelX/t.pixelWidth);var r=Math.pow(2,e);i.zoomToGeoPoint(void 0,r,!1,0)},Object.defineProperty(t.prototype,"stepCount",{get:function(){return Math.log(this.chart.maxZoomLevel)/Math.LN2-Math.log(this.chart.minZoomLevel)/Math.LN2},enumerable:!0,configurable:!0}),t.prototype.createBackground=function(){return new ad},t}(Wp);function Xg(e,t){return[e,rm(lm((qf+t)/2))]}function Kg(){return function(e){var t,i,n,r=fy(e),a=r.center,o=r.scale,s=r.translate,l=r.clipExtent,u=null;function c(){var a=Zf*o(),s=r(function(e){function t(t){return(t=e(t[0]*$f,t[1]*$f))[0]*=Yf,t[1]*=Yf,t}return e=qv(e[0]*$f,e[1]*$f,e.length>2?e[2]*$f:0),t.invert=function(t){return(t=e.invert(t[0]*$f,t[1]*$f))[0]*=Yf,t[1]*=Yf,t},t}(r.rotate()).invert([0,0]));return l(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:e===Xg?[[Math.max(s[0]-a,u),t],[Math.min(s[0]+a,i),n]]:[[u,Math.max(s[1]-a,t)],[i,Math.min(s[1]+a,n)]])}return r.scale=function(e){return arguments.length?(o(e),c()):o()},r.translate=function(e){return arguments.length?(s(e),c()):s()},r.center=function(e){return arguments.length?(a(e),c()):a()},r.clipExtent=function(e){return arguments.length?(null==e?u=t=i=n=null:(u=+e[0][0],t=+e[0][1],i=+e[1][0],n=+e[1][1]),c()):null==u?null:[[u,t],[i,n]]},c()}(Xg).scale(961/Kf)}Bu.registeredClasses.ZoomControl=qg,Xg.invert=function(e,t){return[e,2*Qf(nm(t))-qf]};var Yg=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=Kg(),t}return Us(t,e),t}(kg);function $g(){}function Jg(){var e,t=[];return{point:function(t,i,n){e.push([t,i,n])},lineStart:function(){t.push(e=[])},lineEnd:$g,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var i=t;return t=[],e=null,i}}}Bu.registeredClasses.Mercator=Yg;var Qg=1e-6,e_=Math.PI,t_=e_/2,i_=e_/4,n_=2*e_,r_=180/e_,a_=e_/180,o_=Math.abs,s_=Math.atan,l_=Math.atan2,u_=Math.cos,c_=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),h_=Math.sign||function(e){return e>0?1:e<0?-1:0},p_=Math.sqrt;Math.tan;function d_(e){return e>1?t_:e<-1?-t_:Math.asin(e)}function f_(e,t){return o_(e[0]-t[0])<Qg&&o_(e[1]-t[1])<Qg}function m_(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function v_(e,t,i,n,r){var a,o,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,i,n=e[0],o=e[t];if(f_(n,o)){if(!n[2]&&!o[2]){for(r.lineStart(),a=0;a<t;++a)r.point((n=e[a])[0],n[1]);return void r.lineEnd()}o[0]+=2e-6}s.push(i=new m_(n,e,null,!0)),l.push(i.o=new m_(n,null,i,!1)),s.push(i=new m_(o,e,null,!1)),l.push(i.o=new m_(o,null,i,!0))}})),s.length){for(l.sort(t),y_(s),y_(l),a=0,o=l.length;a<o;++a)l[a].e=i=!i;for(var u,c,h=s[0];;){for(var p=h,d=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(a=0,o=u.length;a<o;++a)r.point((c=u[a])[0],c[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(d)for(u=p.p.z,a=u.length-1;a>=0;--a)r.point((c=u[a])[0],c[1]);else n(p.x,p.p.x,-1,r);p=p.p}u=(p=p.o).z,d=!d}while(!p.v);r.lineEnd()}}}function y_(e){if(t=e.length){for(var t,i,n=0,r=e[0];++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}var g_=function(){function e(){(0,kt.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,Pt.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,i=0,n=0;n<this._n&&n<32;n++){var r=t[n],a=e+r,o=Math.abs(e)<Math.abs(r)?e-(a-r):r-(a-e);o&&(t[i++]=o),e=a}return t[i]=e,this._n=i+1,this}},{key:"valueOf",value:function(){var e,t,i,n=this._partials,r=this._n,a=0;if(r>0){for(a=n[--r];r>0&&(e=a,!(i=(t=n[--r])-((a=e+t)-e))););r>0&&(i<0&&n[r-1]<0||i>0&&n[r-1]>0)&&(t=2*i)==(e=a+t)-a&&(a=e)}return a}}]),e}();function __(e){return[l_(e[1],e[0]),d_(e[2])]}function b_(e){var t=e[0],i=e[1],n=u_(i);return[n*u_(t),n*c_(t),c_(i)]}function x_(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function w_(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function k_(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function P_(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function S_(e){var t=p_(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function T_(e){return o_(e[0])<=e_?e[0]:h_(e[0])*((o_(e[0])+e_)%n_-e_)}var E_=za().mark(C_);function C_(e){var t,i,n;return za().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=Iv(e),r.prev=1,t.s();case 3:if((i=t.n()).done){r.next=8;break}return n=i.value,r.delegateYield(n,"t0",6);case 6:r.next=3;break;case 8:r.next=13;break;case 10:r.prev=10,r.t1=r.catch(1),t.e(r.t1);case 13:return r.prev=13,t.f(),r.finish(13);case 16:case"end":return r.stop()}}),E_,null,[[1,10,13,16]])}function M_(e){return Array.from(C_(e))}function I_(e,t,i,n){return function(r){var a,o,s,l=t(r),u=Jg(),c=t(u),h=!1,p={point:d,lineStart:m,lineEnd:v,polygonStart:function(){p.point=y,p.lineStart=g,p.lineEnd=_,o=[],a=[]},polygonEnd:function(){p.point=d,p.lineStart=m,p.lineEnd=v,o=M_(o);var e=function(e,t){var i=T_(t),n=t[1],r=c_(n),a=[c_(i),-u_(i),0],o=0,s=0,l=new g_;1===r?n=t_+Qg:-1===r&&(n=-t_-Qg);for(var u=0,c=e.length;u<c;++u)if(p=(h=e[u]).length)for(var h,p,d=h[p-1],f=T_(d),m=d[1]/2+i_,v=c_(m),y=u_(m),g=0;g<p;++g,f=b,v=w,y=k,d=_){var _=h[g],b=T_(_),x=_[1]/2+i_,w=c_(x),k=u_(x),P=b-f,S=P>=0?1:-1,T=S*P,E=T>e_,C=v*w;if(l.add(l_(C*S*c_(T),y*k+C*u_(T))),o+=E?P+S*n_:P,E^f>=i^b>=i){var M=w_(b_(d),b_(_));S_(M);var I=w_(a,M);S_(I);var O=(E^P>=0?-1:1)*d_(I[2]);(n>O||n===O&&(M[0]||M[1]))&&(s+=E^P>=0?1:-1)}}return(o<-1e-6||o<Qg&&l<-1e-12)^1&s}(a,n);o.length?(h||(r.polygonStart(),h=!0),v_(o,D_,e,i,r)):e&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=a=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(t,i){e(t,i)&&r.point(t,i)}function f(e,t){l.point(e,t)}function m(){p.point=f,l.lineStart()}function v(){p.point=d,l.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function g(){c.lineStart(),s=[]}function _(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,i,n,l=c.clean(),p=u.result(),d=p.length;if(s.pop(),a.push(s),s=null,d)if(1&l){if((t=(i=p[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),e=0;e<t;++e)r.point((n=i[e])[0],n[1]);r.lineEnd()}}else d>1&&2&l&&p.push(p.pop().concat(p.shift())),o.push(p.filter(O_))}return p}}function O_(e){return e.length>1}function D_(e,t){return((e=e.x)[0]<0?e[1]-t_-Qg:t_-e[1])-((t=t.x)[0]<0?t[1]-t_-Qg:t_-t[1])}var A_=I_((function(){return!0}),(function(e){var t,i=NaN,n=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?e_:-e_,l=o_(a-i);o_(l-e_)<Qg?(e.point(i,n=(n+o)/2>0?t_:-t_),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),t=0):r!==s&&l>=e_&&(o_(i-r)<Qg&&(i-=r*Qg),o_(a-s)<Qg&&(a-=s*Qg),n=function(e,t,i,n){var r,a,o=c_(e-i);return o_(o)>Qg?s_((c_(t)*(a=u_(n))*c_(i)-c_(n)*(r=u_(t))*c_(e))/(r*a*o)):(t+n)/2}(i,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),t=0),e.point(i=a,n=o),r=s},lineEnd:function(){e.lineEnd(),i=n=NaN},clean:function(){return 2-t}}}),(function(e,t,i,n){var r;if(null==e)r=i*t_,n.point(-e_,r),n.point(0,r),n.point(e_,r),n.point(e_,0),n.point(e_,-r),n.point(0,-r),n.point(-e_,-r),n.point(-e_,0),n.point(-e_,r);else if(o_(e[0]-t[0])>Qg){var a=e[0]<t[0]?e_:-e_;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(t[0],t[1])}),[-e_,-t_]);function L_(e,t,i,n,r,a){if(i){var o=u_(t),s=c_(t),l=n*i;null==r?(r=t+n*n_,a=t-l/2):(r=z_(o,r),a=z_(o,a),(n>0?r<a:r>a)&&(r+=n*n_));for(var u,c=r;n>0?c>a:c<a;c-=l)u=__([o,-s*u_(c),-s*c_(c)]),e.point(u[0],u[1])}}function z_(e,t){(t=b_(t))[0]-=e,S_(t);var i,n=(i=-t[1])>1?0:i<-1?e_:Math.acos(i);return((-t[2]<0?-n:n)+n_-Qg)%n_}function R_(e){var t=u_(e),i=6*a_,n=t>0,r=o_(t)>Qg;function a(e,i){return u_(e)*u_(i)>t}function o(e,i,n){var r=[1,0,0],a=w_(b_(e),b_(i)),o=x_(a,a),s=a[0],l=o-s*s;if(!l)return!n&&e;var u=t*o/l,c=-t*s/l,h=w_(r,a),p=P_(r,u);k_(p,P_(a,c));var d=h,f=x_(p,d),m=x_(d,d),v=f*f-m*(x_(p,p)-1);if(!(v<0)){var y=p_(v),g=P_(d,(-f-y)/m);if(k_(g,p),g=__(g),!n)return g;var _,b=e[0],x=i[0],w=e[1],k=i[1];x<b&&(_=b,b=x,x=_);var P=x-b,S=o_(P-e_)<Qg;if(!S&&k<w&&(_=w,w=k,k=_),S||P<Qg?S?w+k>0^g[1]<(o_(g[0]-b)<Qg?w:k):w<=g[1]&&g[1]<=k:P>e_^(b<=g[0]&&g[0]<=x)){var T=P_(d,(-f+y)/m);return k_(T,p),[g,__(T)]}}}function s(t,i){var r=n?e:e_-e,a=0;return t<-r?a|=1:t>r&&(a|=2),i<-r?a|=4:i>r&&(a|=8),a}return I_(a,(function(e){var t,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,p){var d,f=[h,p],m=a(h,p),v=n?m?0:s(h,p):m?s(h+(h<0?e_:-e_),p):0;if(!t&&(u=l=m)&&e.lineStart(),m!==l&&(!(d=o(t,f))||f_(t,d)||f_(f,d))&&(f[2]=1),m!==l)c=0,m?(e.lineStart(),d=o(f,t),e.point(d[0],d[1])):(d=o(t,f),e.point(d[0],d[1],2),e.lineEnd()),t=d;else if(r&&t&&n^m){var y;v&i||!(y=o(f,t,!0))||(c=0,n?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!m||t&&f_(t,f)||e.point(f[0],f[1]),t=f,l=m,i=v},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}}),(function(t,n,r,a){L_(a,e,i,r,t,n)}),n?[0,-e]:[-e_,e-e_])}var F_=1e9,j_=-1e9;function B_(e,t,i,n){function r(r,a){return e<=r&&r<=i&&t<=a&&a<=n}function a(r,a,s,u){var c=0,h=0;if(null==r||(c=o(r,s))!==(h=o(a,s))||l(r,a)<0^s>0)do{u.point(0===c||3===c?e:i,c>1?n:t)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(n,r){return o_(n[0]-e)<Qg?r>0?0:3:o_(n[0]-i)<Qg?r>0?2:1:o_(n[1]-t)<Qg?r>0?1:0:r>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var i=o(e,1),n=o(t,1);return i!==n?i-n:0===i?t[1]-e[1]:1===i?e[0]-t[0]:2===i?e[1]-t[1]:t[0]-e[0]}return function(o){var l,u,c,h,p,d,f,m,v,y,g,_=o,b=Jg(),x={point:w,lineStart:function(){x.point=k,u&&u.push(c=[]);y=!0,v=!1,f=m=NaN},lineEnd:function(){l&&(k(h,p),d&&v&&b.rejoin(),l.push(b.result()));x.point=w,v&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],g=!0},polygonEnd:function(){var t=function(){for(var t=0,i=0,r=u.length;i<r;++i)for(var a,o,s=u[i],l=1,c=s.length,h=s[0],p=h[0],d=h[1];l<c;++l)a=p,o=d,p=(h=s[l])[0],d=h[1],o<=n?d>n&&(p-a)*(n-o)>(d-o)*(e-a)&&++t:d<=n&&(p-a)*(n-o)<(d-o)*(e-a)&&--t;return t}(),i=g&&t,r=(l=M_(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),r&&v_(l,s,t,a,o),o.polygonEnd());_=o,l=u=c=null}};function w(e,t){r(e,t)&&_.point(e,t)}function k(a,o){var s=r(a,o);if(u&&c.push([a,o]),y)h=a,p=o,d=s,y=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&v)_.point(a,o);else{var l=[f=Math.max(j_,Math.min(F_,f)),m=Math.max(j_,Math.min(F_,m))],b=[a=Math.max(j_,Math.min(F_,a)),o=Math.max(j_,Math.min(F_,o))];!function(e,t,i,n,r,a){var o,s=e[0],l=e[1],u=0,c=1,h=t[0]-s,p=t[1]-l;if(o=i-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>u&&(u=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<c&&(c=o)}if(o=n-l,p||!(o>0)){if(o/=p,p<0){if(o<u)return;o<c&&(c=o)}else if(p>0){if(o>c)return;o>u&&(u=o)}if(o=a-l,p||!(o<0)){if(o/=p,p<0){if(o>c)return;o>u&&(u=o)}else if(p>0){if(o<u)return;o<c&&(c=o)}return u>0&&(e[0]=s+u*h,e[1]=l+u*p),c<1&&(t[0]=s+c*h,t[1]=l+c*p),!0}}}}}(l,b,e,t,i,n)?s&&(_.lineStart(),_.point(a,o),g=!1):(v||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),g=!1)}f=a,m=o,v=s}return x}}function V_(e,t){function i(i,n){return i=e(i,n),t(i[0],i[1])}return e.invert&&t.invert&&(i.invert=function(i,n){return(i=t.invert(i,n))&&e.invert(i[0],i[1])}),i}var N_=function(e){return e};function U_(e,t){return[o_(e)>e_?e+Math.round(-e/n_)*n_:e,t]}function G_(e,t,i){return(e%=n_)?t||i?V_(H_(e),Z_(t,i)):H_(e):t||i?Z_(t,i):U_}function W_(e){return function(t,i){return[(t+=e)>e_?t-n_:t<-e_?t+n_:t,i]}}function H_(e){var t=W_(e);return t.invert=W_(-e),t}function Z_(e,t){var i=u_(e),n=c_(e),r=u_(t),a=c_(t);function o(e,t){var o=u_(t),s=u_(e)*o,l=c_(e)*o,u=c_(t),c=u*i+s*n;return[l_(l*r-c*a,s*i-u*n),d_(c*r+l*a)]}return o.invert=function(e,t){var o=u_(t),s=u_(e)*o,l=c_(e)*o,u=c_(t),c=u*r-l*a;return[l_(l*r+u*a,s*i+c*n),d_(c*i-s*n)]},o}function q_(e){return function(t){var i=new X_;for(var n in e)i[n]=e[n];return i.stream=t,i}}function X_(){}function K_(e,t){e&&$_.hasOwnProperty(e.type)&&$_[e.type](e,t)}U_.invert=U_,X_.prototype={constructor:X_,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Y_={Feature:function(e,t){K_(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,r=i.length;++n<r;)K_(i[n].geometry,t)}},$_={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){J_(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)J_(i[n],t,0)},Polygon:function(e,t){Q_(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)Q_(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,r=i.length;++n<r;)K_(i[n],t)}};function J_(e,t,i){var n,r=-1,a=e.length-i;for(t.lineStart();++r<a;)n=e[r],t.point(n[0],n[1],n[2]);t.lineEnd()}function Q_(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)J_(e[i],t,1);t.polygonEnd()}var eb=1/0,tb=eb,ib=-eb,nb=ib,rb={point:function(e,t){e<eb&&(eb=e);e>ib&&(ib=e);t<tb&&(tb=t);t>nb&&(nb=t)},lineStart:$g,lineEnd:$g,polygonStart:$g,polygonEnd:$g,result:function(){var e=[[eb,tb],[ib,nb]];return ib=nb=-(tb=eb=1/0),e}};var ab=rb;function ob(e,t,i){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=n&&e.clipExtent(null),function(e,t){e&&Y_.hasOwnProperty(e.type)?Y_[e.type](e,t):K_(e,t)}(i,e.stream(ab)),t(ab.result()),null!=n&&e.clipExtent(n),e}function sb(e,t,i){return ob(e,(function(i){var n=t[1][0]-t[0][0],r=t[1][1]-t[0][1],a=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+t[0][0]+(n-a*(i[1][0]+i[0][0]))/2,s=+t[0][1]+(r-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([o,s])}),i)}var lb=u_(30*a_);function ub(e,t){return+t?function(e,t){function i(n,r,a,o,s,l,u,c,h,p,d,f,m,v){var y=u-n,g=c-r,_=y*y+g*g;if(_>4*t&&m--){var b=o+p,x=s+d,w=l+f,k=p_(b*b+x*x+w*w),P=d_(w/=k),S=o_(o_(w)-1)<Qg||o_(a-h)<Qg?(a+h)/2:l_(x,b),T=e(S,P),E=T[0],C=T[1],M=E-n,I=C-r,O=g*M-y*I;(O*O/_>t||o_((y*M+g*I)/_-.5)>.3||o*p+s*d+l*f<lb)&&(i(n,r,a,o,s,l,E,C,S,b/=k,x/=k,w,m,v),v.point(E,C),i(E,C,S,b,x,w,u,c,h,p,d,f,m,v))}}return function(t){var n,r,a,o,s,l,u,c,h,p,d,f,m={point:v,lineStart:y,lineEnd:_,polygonStart:function(){t.polygonStart(),m.lineStart=b},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function v(i,n){i=e(i,n),t.point(i[0],i[1])}function y(){c=NaN,m.point=g,t.lineStart()}function g(n,r){var a=b_([n,r]),o=e(n,r);i(c,h,u,p,d,f,c=o[0],h=o[1],u=n,p=a[0],d=a[1],f=a[2],16,t),t.point(c,h)}function _(){m.point=v,t.lineEnd()}function b(){y(),m.point=x,m.lineEnd=w}function x(e,t){g(n=e,t),r=c,a=h,o=p,s=d,l=f,m.point=g}function w(){i(c,h,u,p,d,f,r,a,n,o,s,l,16,t),m.lineEnd=_,_()}return m}}(e,t):function(e){return q_({point:function(t,i){t=e(t,i),this.stream.point(t[0],t[1])}})}(e)}var cb=q_({point:function(e,t){this.stream.point(e*a_,t*a_)}});function hb(e,t,i,n,r,a){if(!a)return function(e,t,i,n,r){function a(a,o){return[t+e*(a*=n),i-e*(o*=r)]}return a.invert=function(a,o){return[(a-t)/e*n,(i-o)/e*r]},a}(e,t,i,n,r);var o=u_(a),s=c_(a),l=o*e,u=s*e,c=o/e,h=s/e,p=(s*i-o*t)/e,d=(s*t+o*i)/e;function f(e,a){return[l*(e*=n)-u*(a*=r)+t,i-u*e-l*a]}return f.invert=function(e,t){return[n*(c*e-h*t+p),r*(d-h*e-c*t)]},f}function pb(e){return function(e){var t,i,n,r,a,o,s,l,u,c,h=150,p=480,d=250,f=0,m=0,v=0,y=0,g=0,_=0,b=1,x=1,w=null,k=A_,P=null,S=N_,T=.5;function E(e){return l(e[0]*a_,e[1]*a_)}function C(e){return(e=l.invert(e[0],e[1]))&&[e[0]*r_,e[1]*r_]}function M(){var e=hb(h,0,0,b,x,_).apply(null,t(f,m)),n=hb(h,p-e[0],d-e[1],b,x,_);return i=G_(v,y,g),s=V_(t,n),l=V_(i,s),o=ub(s,T),I()}function I(){return u=c=null,E}return E.stream=function(e){return u&&c===e?u:u=cb(function(e){return q_({point:function(t,i){var n=e(t,i);return this.stream.point(n[0],n[1])}})}(i)(k(o(S(c=e)))))},E.preclip=function(e){return arguments.length?(k=e,w=void 0,I()):k},E.postclip=function(e){return arguments.length?(S=e,P=n=r=a=null,I()):S},E.clipAngle=function(e){return arguments.length?(k=+e?R_(w=e*a_):(w=null,A_),I()):w*r_},E.clipExtent=function(e){return arguments.length?(S=null==e?(P=n=r=a=null,N_):B_(P=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),I()):null==P?null:[[P,n],[r,a]]},E.scale=function(e){return arguments.length?(h=+e,M()):h},E.translate=function(e){return arguments.length?(p=+e[0],d=+e[1],M()):[p,d]},E.center=function(e){return arguments.length?(f=e[0]%360*a_,m=e[1]%360*a_,M()):[f*r_,m*r_]},E.rotate=function(e){return arguments.length?(v=e[0]%360*a_,y=e[1]%360*a_,g=e.length>2?e[2]%360*a_:0,M()):[v*r_,y*r_,g*r_]},E.angle=function(e){return arguments.length?(_=e%360*a_,M()):_*r_},E.reflectX=function(e){return arguments.length?(b=e?-1:1,M()):b<0},E.reflectY=function(e){return arguments.length?(x=e?-1:1,M()):x<0},E.precision=function(e){return arguments.length?(o=ub(s,T=e*e),I()):p_(T)},E.fitExtent=function(e,t){return sb(E,e,t)},E.fitSize=function(e,t){return function(e,t,i){return sb(e,[[0,0],t],i)}(E,e,t)},E.fitWidth=function(e,t){return function(e,t,i){return ob(e,(function(i){var n=+t,r=n/(i[1][0]-i[0][0]),a=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];e.scale(150*r).translate([a,o])}),i)}(E,e,t)},E.fitHeight=function(e,t){return function(e,t,i){return ob(e,(function(i){var n=+t,r=n/(i[1][1]-i[0][1]),a=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;e.scale(150*r).translate([a,o])}),i)}(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&C,M()}}((function(){return e}))()}var db=Math.abs,fb=Math.atan,mb=(Math.atan2,Math.ceil,Math.cos),vb=Math.exp,yb=(Math.floor,Math.log),gb=(Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),_b=Math.tan,bb=Math.PI,xb=bb/2,wb=bb/4;Math.SQRT1_2,Pb(2),Pb(bb);function kb(e){return e>1?xb:e<-1?-xb:Math.asin(e)}function Pb(e){return e>0?Math.sqrt(e):0}function Sb(e,t){return[e,1.25*yb(_b(wb+.4*t))]}Sb.invert=function(e,t){return[e,2.5*fb(vb(.8*t))-.625*bb]};var Tb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=pb(Sb).scale(108.318),t}return Us(t,e),t}(kg);function Eb(e,t){for(var i=(1+xb)*gb(t),n=0,r=1/0;n<10&&db(r)>1e-6;n++)t-=r=(t+gb(t)-i)/(1+mb(t));return i=Pb(2+bb),[e*(1+mb(t))/i,2*t/i]}Bu.registeredClasses.Miller=Tb,Eb.invert=function(e,t){var i=1+xb,n=Pb(i/2);return[2*e*n/(1+mb(t*=n)),kb((t+gb(t))/i)]};var Cb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=pb(Eb).scale(173.044),t}return Us(t,e),t}(kg);function Mb(e){return function(t,i){var n=sm(t*t+i*i),r=e(n),a=am(r),o=tm(r);return[em(t*a,n*o),um(n&&i*a/n)]}}function Ib(e,t){return[tm(t)*am(e),am(t)]}Bu.registeredClasses.Eckert6=Cb,Ib.invert=Mb(um);var Ob=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=fy(Ib).scale(249.5).clipAngle(90.000001),t}return Us(t,e),t}(kg);function Db(e,t){var i=tm(t),n=1+tm(e)*i;return[i*am(e)/n,am(t)/n]}Bu.registeredClasses.Orthographic=Ob,Db.invert=Mb((function(e){return 2*Qf(e)}));var Ab=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=fy(Db).scale(250).clipAngle(142),t}return Us(t,e),t}(kg);function Lb(e,t){var i=am(e),n=(i+am(t))/2;if(Jf(n)<Hf)return function(e){var t=tm(e);function i(e,i){return[e*t,am(i)/t]}return i.invert=function(e,i){return[e/t,um(i*t)]},i}(e);var r=1+i*(2*n-i),a=sm(r)/n;function o(e,t){var i=sm(r-2*n*am(t))/n;return[i*am(e*=n),a-i*tm(e)]}return o.invert=function(e,t){var i=a-t,o=em(e,Jf(i))*om(i);return i*n<0&&(o-=Zf*om(e)*om(i)),[o/n,um((r-(e*e+i*i)*n*n)/(2*n))]},o}function zb(){return function(e){var t=0,i=Zf/3,n=my(e),r=n(t,i);return r.parallels=function(e){return arguments.length?n(t=e[0]*$f,i=e[1]*$f):[t*Yf,i*Yf]},r}(Lb).scale(155.424).center([0,33.6442])}function Rb(){return zb().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}Bu.registeredClasses.Stereographic=Ab;var Fb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=Rb(),t}return Us(t,e),t}(kg);Bu.registeredClasses.Albers=Fb;var jb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=function(){var e,t,i,n,r,a,o=Rb(),s=zb().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=zb().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){a=[e,t]}};function c(e){var t=e[0],o=e[1];return a=null,i.point(t,o),a||(n.point(t,o),a)||(r.point(t,o),a)}function h(){return e=t=null,c}return c.invert=function(e){var t=o.scale(),i=o.translate(),n=(e[0]-i[0])/t,r=(e[1]-i[1])/t;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?l:o).invert(e)},c.stream=function(i){return e&&t===i?e:e=function(e){var t=e.length;return{point:function(i,n){for(var r=-1;++r<t;)e[r].point(i,n)},sphere:function(){for(var i=-1;++i<t;)e[i].sphere()},lineStart:function(){for(var i=-1;++i<t;)e[i].lineStart()},lineEnd:function(){for(var i=-1;++i<t;)e[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<t;)e[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<t;)e[i].polygonEnd()}}}([o.stream(t=i),s.stream(i),l.stream(i)])},c.precision=function(e){return arguments.length?(o.precision(e),s.precision(e),l.precision(e),h()):o.precision()},c.scale=function(e){return arguments.length?(o.scale(e),s.scale(.35*e),l.scale(e),c.translate(o.translate())):o.scale()},c.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),a=+e[0],c=+e[1];return i=o.translate(e).clipExtent([[a-.455*t,c-.238*t],[a+.455*t,c+.238*t]]).stream(u),n=s.translate([a-.307*t,c+.201*t]).clipExtent([[a-.425*t+Hf,c+.12*t+Hf],[a-.214*t-Hf,c+.234*t-Hf]]).stream(u),r=l.translate([a-.205*t,c+.212*t]).clipExtent([[a-.214*t+Hf,c+.166*t+Hf],[a-.115*t-Hf,c+.234*t-Hf]]).stream(u),h()},c.fitExtent=function(e,t){return oy(c,e,t)},c.fitSize=function(e,t){return sy(c,e,t)},c.fitWidth=function(e,t){return ly(c,e,t)},c.fitHeight=function(e,t){return uy(c,e,t)},c.scale(1070)}(),t}return Us(t,e),t}(kg);function Bb(e,t){var i=t*t,n=i*i;return[e*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),t*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}Bu.registeredClasses.AlbersUsa=jb,Bb.invert=function(e,t){var i,n=t,r=25;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-t)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(Jf(i)>Hf&&--r>0);return[e/(.8707+(a=n*n)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),n]};var Vb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=fy(Bb).scale(175.295),t}return Us(t,e),t}(kg);Bu.registeredClasses.NaturalEarth1=Vb;var Nb,Ub=(Nb=function(e){return sm(2/(1+e))},function(e,t){var i=tm(e),n=tm(t),r=Nb(i*n);return r===1/0?[2,0]:[r*n*am(e),r*am(t)]});Ub.invert=Mb((function(e){return 2*um(e/2)}));var Gb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=fy(Ub).scale(124.75).clipAngle(179.999),t}return Us(t,e),t}(kg);Bu.registeredClasses.AzimuthalEqualArea=Gb;var Wb=1.340264,Hb=-.081106,Zb=893e-6,qb=.003796,Xb=sm(3)/2;function Kb(e,t){var i=um(Xb*am(t)),n=i*i,r=n*n*n;return[e*tm(i)/(Xb*(Wb+3*Hb*n+r*(7*Zb+9*qb*n))),i*(Wb+Hb*n+r*(Zb+qb*n))]}Kb.invert=function(e,t){for(var i,n=t,r=n*n,a=r*r*r,o=0;o<12&&(a=(r=(n-=i=(n*(Wb+Hb*r+a*(Zb+qb*r))-t)/(Wb+3*Hb*r+a*(7*Zb+9*qb*r)))*n)*r*r,!(Jf(i)<1e-12));++o);return[Xb*e*(Wb+3*Hb*r+a*(7*Zb+9*qb*r))/tm(n),um(am(n)/Xb)]};var Yb=function(e){function t(){var t=e.call(this)||this;return t.d3Projection=fy(Kb).scale(177.158),t}return Us(t,e),t}(kg);Bu.registeredClasses.EqualEarth=Yb;var $b,Jb=function(e){Vu(e,"SpriteState")&&(e.transitionDuration=400),Vu(e,"Component")&&(e.rangeChangeDuration=500,e.interpolationDuration=500,e.sequencedInterpolation=!1,Vu(e,"SankeyDiagram")&&(e.sequencedInterpolation=!0),Vu(e,"FunnelSeries")&&(e.sequencedInterpolation=!0)),Vu(e,"Chart")&&(e.defaultState.transitionDuration=2e3,e.hiddenState.transitionDuration=1e3),Vu(e,"Tooltip")&&(e.animationDuration=400,e.defaultState.transitionDuration=400,e.hiddenState.transitionDuration=400),Vu(e,"Scrollbar")&&(e.animationDuration=500),Vu(e,"Series")&&(e.defaultState.transitionDuration=1e3,e.hiddenState.transitionDuration=700,e.hiddenState.properties.opacity=1,e.showOnInit=!0),Vu(e,"MapSeries")&&(e.hiddenState.properties.opacity=0),Vu(e,"PercentSeries")&&(e.hiddenState.properties.opacity=0),Vu(e,"FunnelSlice")&&(e.defaultState.transitionDuration=800,e.hiddenState.transitionDuration=1e3,e.hiddenState.properties.opacity=1),Vu(e,"Slice")&&(e.defaultState.transitionDuration=700,e.hiddenState.transitionDuration=1e3,e.hiddenState.properties.opacity=1),Vu(e,"Preloader")&&(e.hiddenState.transitionDuration=2e3),Vu(e,"Column")&&(e.defaultState.transitionDuration=700,e.hiddenState.transitionDuration=1e3,e.hiddenState.properties.opacity=1),Vu(e,"Column3D")&&(e.hiddenState.properties.opacity=0)};$b=Jb,-1===Bu.themes.indexOf($b)&&Bu.themes.push($b);var Qb=function(e){(0,St.Z)(i,e);var t=Ct(i);function i(){return(0,kt.Z)(this,i),t.apply(this,arguments)}return(0,Pt.Z)(i,[{key:"componentDidMount",value:function(){var e=function(e,t){var i;sl(t)&&(nl(Bu.registeredClasses[t])?t=Bu.registeredClasses[t]:(t=Bu.registeredClasses.Container,i=new Error("Class ["+t+"] is not loaded.")));var n=cf(e,t);return i&&n.raiseCriticalError(i),n}("chartdiv",Vg);e.geodataSource.url="https://www.amcharts.com/lib/4/geodata/json/japanLow.json",e.geodataSource.events.on("parseended",(function(e){for(var i=[],n=0;n<e.target.data.features.length;n++)i.push({id:e.target.data.features[n].id,value:Math.round(1e4*Math.random())});t.data=i})),e.projection=new Yg,e.zoomControl=new qg,e.homeZoomLevel=1;var t=e.series.push(new wv);t.mapPolygons.template.strokeWidth=.5,t.useGeodata=!0;var i=t.mapPolygons.template;i.tooltipText="{name}: {value}",i.fill=uc("#aac4e7"),i.states.create("hover").properties.fill=e.colors.getIndex(0),i.states.create("active").properties.fill=e.colors.getIndex(1),i.events.on("hit",(function(e){e.target.isActive=!e.target.isActive}))}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return(0,mt.jsx)("div",{children:(0,mt.jsx)("div",{id:"chartdiv",className:"map-overview"})})}}]),i}(t.Component),ex=Qb;var tx=i.p+"static/media/location.db5a88dad8ab43554118ae46fc77d932.svg",ix=function(){return(0,mt.jsxs)("div",{className:"online-user-home",children:[(0,mt.jsx)("h4",{children:"Online users"}),(0,mt.jsxs)("p",{children:["3213 ",(0,mt.jsx)("img",{src:tx,alt:"location",style:{width:"15px",height:"24px",marginTop:"-9px"}})," "]})]})},nx=function(){return(0,mt.jsxs)("div",{children:[(0,mt.jsxs)("header",{className:"home-overview-header",children:[(0,mt.jsx)("h1",{children:"Overview"}),(0,mt.jsx)("p",{children:"of the next products"})]}),(0,mt.jsx)("div",{children:(0,mt.jsx)(ix,{})}),(0,mt.jsx)("main",{children:(0,mt.jsx)(ex,{})})]})},rx=function(){return(0,mt.jsx)("div",{children:"Notifications"})},ax={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},ox=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:ax}))};ox.displayName="DownOutlined";var sx=t.forwardRef(ox),lx={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},ux=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:lx}))};ux.displayName="RightOutlined";var cx=t.forwardRef(ux),hx={adjustX:1,adjustY:1},px=[0,0],dx={topLeft:{points:["bl","tl"],overflow:hx,offset:[0,-4],targetOffset:px},topCenter:{points:["bc","tc"],overflow:hx,offset:[0,-4],targetOffset:px},topRight:{points:["br","tr"],overflow:hx,offset:[0,-4],targetOffset:px},bottomLeft:{points:["tl","bl"],overflow:hx,offset:[0,4],targetOffset:px},bottomCenter:{points:["tc","bc"],overflow:hx,offset:[0,4],targetOffset:px},bottomRight:{points:["tr","br"],overflow:hx,offset:[0,4],targetOffset:px}},fx=Yi.ESC,mx=Yi.TAB;var vx=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function yx(e,i){var n=e.arrow,a=void 0!==n&&n,o=e.prefixCls,s=void 0===o?"rc-dropdown":o,l=e.transitionName,u=e.animation,c=e.align,h=e.placement,p=void 0===h?"bottomLeft":h,d=e.placements,f=void 0===d?dx:d,m=e.getPopupContainer,v=e.showAction,y=e.hideAction,g=e.overlayClassName,_=e.overlayStyle,b=e.visible,x=e.trigger,w=void 0===x?["hover"]:x,k=e.autoFocus,P=$(e,vx),S=t.useState(),T=(0,r.Z)(S,2),E=T[0],C=T[1],M="visible"in e?b:E,I=t.useRef(null);t.useImperativeHandle(i,(function(){return I.current})),function(e){var i=e.visible,n=e.setTriggerVisible,r=e.triggerRef,a=e.onVisibleChange,o=e.autoFocus,s=t.useRef(!1),l=function(){var e,t,o,s;i&&r.current&&(null===(e=r.current)||void 0===e||null===(t=e.triggerRef)||void 0===t||null===(o=t.current)||void 0===o||null===(s=o.focus)||void 0===s||s.call(o),n(!1),"function"===typeof a&&a(!1))},u=function(){var e,t,i,n,a=uo(null===(e=r.current)||void 0===e||null===(t=e.popupRef)||void 0===t||null===(i=t.current)||void 0===i||null===(n=i.getElement)||void 0===n?void 0:n.call(i))[0];return!!(null===a||void 0===a?void 0:a.focus)&&(a.focus(),s.current=!0,!0)},c=function(e){switch(e.keyCode){case fx:l();break;case mx:var t=!1;s.current||(t=u()),t?e.preventDefault():l()}};t.useEffect((function(){return i?(window.addEventListener("keydown",c),o&&Li(u,3),function(){window.removeEventListener("keydown",c),s.current=!1}):function(){s.current=!1}}),[i])}({visible:M,setTriggerVisible:C,triggerRef:I,onVisibleChange:e.onVisibleChange,autoFocus:k});var O=function(){var i=function(){var t=e.overlay;return"function"===typeof t?t():t}();return t.createElement(t.Fragment,null,a&&t.createElement("div",{className:"".concat(s,"-arrow")}),i)},D=y;return D||-1===w.indexOf("contextMenu")||(D=["click"]),t.createElement(Ya,K(K({builtinPlacements:f},P),{},{prefixCls:s,ref:I,popupClassName:Q()(g,(0,q.Z)({},"".concat(s,"-show-arrow"),a)),popupStyle:_,action:w,showAction:v,hideAction:D||[],popupPlacement:p,popupAlign:c,popupTransitionName:l,popupAnimation:u,popupVisible:M,stretch:function(){var t=e.minOverlayWidthMatchTrigger,i=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!i}()?"minWidth":"",popup:"function"===typeof e.overlay?O:O(),onPopupVisibleChange:function(t){var i=e.onVisibleChange;C(t),"function"===typeof i&&i(t)},onPopupClick:function(t){var i=e.onOverlayClick;C(!1),i&&i(t)},getPopupContainer:m}),function(){var i=e.children,n=i.props?i.props:{},r=Q()(n.className,function(){var t=e.openClassName;return void 0!==t?t:"".concat(s,"-open")}());return M&&i?t.cloneElement(i,{className:r}):i}())}var gx,_x=t.forwardRef(yx),bx=t.createContext(!1),xx=bx,wx=t.createContext(void 0),kx=wx,Px=0,Sx={};function Tx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=Px++,n=t;function r(){(n-=1)<=0?(e(),delete Sx[i]):Sx[i]=Li(r)}return Sx[i]=Li(r),i}function Ex(e){return!e||null===e.offsetParent||e.hidden}function Cx(e){var t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return!(t&&t[1]&&t[2]&&t[3])||!(t[1]===t[2]&&t[2]===t[3])}Tx.cancel=function(e){void 0!==e&&(Li.cancel(Sx[e]),delete Sx[e])},Tx.ids=Sx;var Mx=function(e){(0,St.Z)(n,e);var i=Ct(n);function n(){var e;return(0,kt.Z)(this,n),(e=i.apply(this,arguments)).containerRef=t.createRef(),e.animationStart=!1,e.destroyed=!1,e.onClick=function(t,i){var n,r,a=e.props,o=a.insertExtraNode;if(!(a.disabled||!t||Ex(t)||t.className.indexOf("-leave")>=0)){e.extraNode=document.createElement("div");var s=(0,Dn.Z)(e).extraNode,l=e.context.getPrefixCls;s.className="".concat(l(""),"-click-animating-node");var u=e.getAttributeName();if(t.setAttribute(u,"true"),i&&"#ffffff"!==i&&"rgb(255, 255, 255)"!==i&&Cx(i)&&!/rgba\((?:\d*, ){3}0\)/.test(i)&&"transparent"!==i){s.style.borderColor=i;var c=(null===(n=t.getRootNode)||void 0===n?void 0:n.call(t))||t.ownerDocument,h=c instanceof Document?c.body:null!==(r=c.firstChild)&&void 0!==r?r:c;gx=Fe("\n      [".concat(l(""),"-click-animating-without-extra-node='true']::after, .").concat(l(""),"-click-animating-node {\n        --antd-wave-shadow-color: ").concat(i,";\n      }"),"antd-wave",{csp:e.csp,attachTo:h})}o&&t.appendChild(s),["transition","animation"].forEach((function(i){t.addEventListener("".concat(i,"start"),e.onTransitionStart),t.addEventListener("".concat(i,"end"),e.onTransitionEnd)}))}},e.onTransitionStart=function(t){if(!e.destroyed){var i=e.containerRef.current;t&&t.target===i&&!e.animationStart&&e.resetEffect(i)}},e.onTransitionEnd=function(t){t&&"fadeEffect"===t.animationName&&e.resetEffect(t.target)},e.bindAnimationEvent=function(t){if(t&&t.getAttribute&&!t.getAttribute("disabled")&&!(t.className.indexOf("disabled")>=0)){var i=function(i){if("INPUT"!==i.target.tagName&&!Ex(i.target)){e.resetEffect(t);var n=getComputedStyle(t).getPropertyValue("border-top-color")||getComputedStyle(t).getPropertyValue("border-color")||getComputedStyle(t).getPropertyValue("background-color");e.clickWaveTimeoutId=window.setTimeout((function(){return e.onClick(t,n)}),0),Tx.cancel(e.animationStartId),e.animationStart=!0,e.animationStartId=Tx((function(){e.animationStart=!1}),10)}};return t.addEventListener("click",i,!0),{cancel:function(){t.removeEventListener("click",i,!0)}}}},e.renderWave=function(i){var n=i.csp,r=e.props.children;if(e.csp=n,!t.isValidElement(r))return r;var a=e.containerRef;return Zt(r)&&(a=Ht(r.ref,e.containerRef)),$o(r,{ref:a})},e}return(0,Pt.Z)(n,[{key:"componentDidMount",value:function(){this.destroyed=!1;var e=this.containerRef.current;e&&1===e.nodeType&&(this.instance=this.bindAnimationEvent(e))}},{key:"componentWillUnmount",value:function(){this.instance&&this.instance.cancel(),this.clickWaveTimeoutId&&clearTimeout(this.clickWaveTimeoutId),this.destroyed=!0}},{key:"getAttributeName",value:function(){var e=this.context.getPrefixCls,t=this.props.insertExtraNode;return"".concat(e(""),t?"-click-animating":"-click-animating-without-extra-node")}},{key:"resetEffect",value:function(e){var t=this;if(e&&e!==this.extraNode&&e instanceof Element){var i=this.props.insertExtraNode,n=this.getAttributeName();e.setAttribute(n,"false"),gx&&(gx.innerHTML=""),i&&this.extraNode&&e.contains(this.extraNode)&&e.removeChild(this.extraNode),["transition","animation"].forEach((function(i){e.removeEventListener("".concat(i,"start"),t.onTransitionStart),e.removeEventListener("".concat(i,"end"),t.onTransitionEnd)}))}}},{key:"render",value:function(){return t.createElement(No,null,this.renderWave)}}]),n}(t.Component);Mx.contextType=Vo;var Ix=(0,t.forwardRef)((function(e,i){return t.createElement(Mx,a({ref:i},e))})),Ox=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Dx=t.createContext(void 0),Ax=function(e){var i,n=t.useContext(Vo),r=n.getPrefixCls,o=n.direction,s=e.prefixCls,l=e.size,u=e.className,c=Ox(e,["prefixCls","size","className"]),h=r("btn-group",s),p="";switch(l){case"large":p="lg";break;case"small":p="sm"}var d=Q()(h,(i={},(0,q.Z)(i,"".concat(h,"-").concat(p),p),(0,q.Z)(i,"".concat(h,"-rtl"),"rtl"===o),i),u);return t.createElement(Dx.Provider,{value:l},t.createElement("div",a({},c,{className:d})))},Lx={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},zx=function(e,i){return t.createElement($e,K(K({},e),{},{ref:i,icon:Lx}))};zx.displayName="LoadingOutlined";var Rx=t.forwardRef(zx),Fx=function(){return{width:0,opacity:0,transform:"scale(0)"}},jx=function(e){return{width:e.scrollWidth,opacity:1,transform:"scale(1)"}},Bx=function(e){var i=e.prefixCls,n=!!e.loading;return e.existIcon?t.createElement("span",{className:"".concat(i,"-loading-icon")},t.createElement(Rx,null)):t.createElement(kr,{visible:n,motionName:"".concat(i,"-loading-icon-motion"),removeOnLeave:!0,onAppearStart:Fx,onAppearActive:jx,onEnterStart:Fx,onEnterActive:jx,onLeaveStart:jx,onLeaveActive:Fx},(function(e,n){var r=e.className,a=e.style;return t.createElement("span",{className:"".concat(i,"-loading-icon"),style:a,ref:n},t.createElement(Rx,{className:r}))}))},Vx=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Nx=/^[\u4e00-\u9fa5]{2}$/,Ux=Nx.test.bind(Nx);function Gx(e){return"text"===e||"link"===e}function Wx(e,i){if(null!==e&&void 0!==e){var n,r=i?" ":"";return"string"!==typeof e&&"number"!==typeof e&&"string"===typeof e.type&&Ux(e.props.children)?$o(e,{children:e.props.children.split("").join(r)}):"string"===typeof e?Ux(e)?t.createElement("span",null,e.split("").join(r)):t.createElement("span",null,e):(n=e,t.isValidElement(n)&&n.type===t.Fragment?t.createElement("span",null,e):e)}}Go("default","primary","ghost","dashed","link","text"),Go("default","circle","round"),Go("submit","button","reset");var Hx=function(e,i){var n,o=e.loading,s=void 0!==o&&o,l=e.prefixCls,u=e.type,c=void 0===u?"default":u,h=e.danger,p=e.shape,d=void 0===p?"default":p,f=e.size,m=e.disabled,v=e.className,y=e.children,g=e.icon,_=e.ghost,b=void 0!==_&&_,x=e.block,w=void 0!==x&&x,k=e.htmlType,P=void 0===k?"button":k,S=Vx(e,["loading","prefixCls","type","danger","shape","size","disabled","className","children","icon","ghost","block","htmlType"]),T=t.useContext(kx),E=t.useContext(xx),C=m||E,M=t.useContext(Dx),I=t.useState(!!s),O=(0,r.Z)(I,2),D=O[0],A=O[1],L=t.useState(!1),z=(0,r.Z)(L,2),R=z[0],F=z[1],j=t.useContext(Vo),B=j.getPrefixCls,V=j.autoInsertSpaceInButton,N=j.direction,U=i||t.createRef(),G=function(){return 1===t.Children.count(y)&&!g&&!Gx(c)},W="boolean"===typeof s?s:(null===s||void 0===s?void 0:s.delay)||!0;t.useEffect((function(){var e=null;return"number"===typeof W?e=window.setTimeout((function(){e=null,A(W)}),W):A(W),function(){e&&(window.clearTimeout(e),e=null)}}),[W]),t.useEffect((function(){if(U&&U.current&&!1!==V){var e=U.current.textContent;G()&&Ux(e)?R||F(!0):R&&F(!1)}}),[U]);var H=function(t){var i=e.onClick;D||C?t.preventDefault():null===i||void 0===i||i(t)},Z=B("btn",l),X=!1!==V,K=M||f||T,Y=K&&{large:"lg",small:"sm",middle:void 0}[K]||"",$=D?"loading":g,J=$i(S,["navigate"]),ee=Q()(Z,(n={},(0,q.Z)(n,"".concat(Z,"-").concat(d),"default"!==d&&d),(0,q.Z)(n,"".concat(Z,"-").concat(c),c),(0,q.Z)(n,"".concat(Z,"-").concat(Y),Y),(0,q.Z)(n,"".concat(Z,"-icon-only"),!y&&0!==y&&!!$),(0,q.Z)(n,"".concat(Z,"-background-ghost"),b&&!Gx(c)),(0,q.Z)(n,"".concat(Z,"-loading"),D),(0,q.Z)(n,"".concat(Z,"-two-chinese-chars"),R&&X&&!D),(0,q.Z)(n,"".concat(Z,"-block"),w),(0,q.Z)(n,"".concat(Z,"-dangerous"),!!h),(0,q.Z)(n,"".concat(Z,"-rtl"),"rtl"===N),(0,q.Z)(n,"".concat(Z,"-disabled"),void 0!==J.href&&C),n),v),ie=g&&!D?g:t.createElement(Bx,{existIcon:!!g,prefixCls:Z,loading:!!D}),ne=y||0===y?function(e,i){var n=!1,r=[];return t.Children.forEach(e,(function(e){var t=(0,te.Z)(e),i="string"===t||"number"===t;if(n&&i){var a=r.length-1,o=r[a];r[a]="".concat(o).concat(e)}else r.push(e);n=i})),t.Children.map(r,(function(e){return Wx(e,i)}))}(y,G()&&X):null;if(void 0!==J.href)return t.createElement("a",a({},J,{className:ee,onClick:H,ref:U}),ie,ne);var re=t.createElement("button",a({},S,{type:P,className:ee,onClick:H,disabled:C,ref:U}),ie,ne);return Gx(c)?re:t.createElement(Ix,{disabled:!!D},re)},Zx=t.forwardRef(Hx);Zx.Group=Ax,Zx.__ANT_BUTTON=!0;var qx=Zx,Xx=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},Kx=qx.Group,Yx=function(e){var i=t.useContext(Vo),n=i.getPopupContainer,o=i.getPrefixCls,s=i.direction,l=e.prefixCls,u=e.type,c=void 0===u?"default":u,h=e.disabled,p=e.loading,d=e.onClick,f=e.htmlType,m=e.children,v=e.className,y=e.overlay,g=e.trigger,_=e.align,b=e.visible,x=e.onVisibleChange,w=e.placement,k=e.getPopupContainer,P=e.href,S=e.icon,T=void 0===S?t.createElement(Ot,null):S,E=e.title,C=e.buttonsRender,M=void 0===C?function(e){return e}:C,I=e.mouseEnterDelay,O=e.mouseLeaveDelay,D=e.overlayClassName,A=e.overlayStyle,L=e.destroyPopupOnHide,z=Xx(e,["prefixCls","type","disabled","loading","onClick","htmlType","children","className","overlay","trigger","align","visible","onVisibleChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide"]),R=o("dropdown-button",l),F={align:_,overlay:y,disabled:h,trigger:h?[]:g,onVisibleChange:x,getPopupContainer:k||n,mouseEnterDelay:I,mouseLeaveDelay:O,overlayClassName:D,overlayStyle:A,destroyPopupOnHide:L};"visible"in e&&(F.visible=b),F.placement="placement"in e?w:"rtl"===s?"bottomLeft":"bottomRight";var j=M([t.createElement(qx,{type:c,disabled:h,loading:p,onClick:d,htmlType:f,href:P,title:E},m),t.createElement(qx,{type:c,icon:T})]),B=(0,r.Z)(j,2),V=B[0],N=B[1];return t.createElement(Kx,a({},z,{className:Q()(R,v)}),V,t.createElement(Qx,a({},F),N))};Yx.__ANT_BUTTON=!0;var $x=Yx,Jx=(Go("topLeft","topCenter","topRight","bottomLeft","bottomCenter","bottomRight","top","bottom"),function(e){var i,n=t.useContext(Vo),o=n.getPopupContainer,s=n.getPrefixCls,l=n.direction,u=e.arrow,c=e.prefixCls,h=e.children,p=e.trigger,d=e.disabled,f=e.getPopupContainer,m=e.overlayClassName,v=e.visible,y=e.onVisibleChange,g=s("dropdown",c),_=t.Children.only(h),b=$o(_,{className:Q()("".concat(g,"-trigger"),(0,q.Z)({},"".concat(g,"-rtl"),"rtl"===l),_.props.className),disabled:d}),x=d?[]:p;x&&-1!==x.indexOf("contextMenu")&&(i=!0);var w=Nt(!1,{value:v}),k=(0,r.Z)(w,2),P=k[0],S=k[1],T=zt((function(e){null===y||void 0===y||y(e),S(e)})),E=Q()(m,(0,q.Z)({},"".concat(g,"-rtl"),"rtl"===l)),C=hs({arrowPointAtCenter:"object"===(0,te.Z)(u)&&u.pointAtCenter,autoAdjustOverflow:!0}),M=t.useCallback((function(){S(!1)}),[]);return t.createElement(_x,a({alignPoint:i},e,{visible:P,builtinPlacements:C,arrow:!!u,overlayClassName:E,prefixCls:g,getPopupContainer:f||o,transitionName:function(){var t=s(),i=e.placement,n=void 0===i?"":i,r=e.transitionName;return void 0!==r?r:n.indexOf("top")>=0?"".concat(t,"-slide-down"):"".concat(t,"-slide-up")}(),trigger:x,overlay:function(){var i,n=e.overlay;return i="function"===typeof n?n():n,i=t.Children.only("string"===typeof i?t.createElement("span",null,i):i),t.createElement(Ts,{prefixCls:"".concat(g,"-menu"),expandIcon:t.createElement("span",{className:"".concat(g,"-menu-submenu-arrow")},t.createElement(cx,{className:"".concat(g,"-menu-submenu-arrow-icon")})),mode:"vertical",selectable:!1,onClick:M,validator:function(e){e.mode}},i)},placement:function(){var t=e.placement;return t?t.includes("Center")?t.slice(0,t.indexOf("Center")):t:"rtl"===l?"bottomRight":"bottomLeft"}(),onVisibleChange:T}),b)});Jx.Button=$x,Jx.defaultProps={mouseEnterDelay:.15,mouseLeaveDelay:.1};var Qx=Jx,ew=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},tw=function(e){var i,n,r=e.prefixCls,o=e.separator,s=void 0===o?"/":o,l=e.children,u=e.overlay,c=e.dropdownProps,h=ew(e,["prefixCls","separator","children","overlay","dropdownProps"]),p=(0,t.useContext(Vo).getPrefixCls)("breadcrumb",r);return i="href"in h?t.createElement("a",a({className:"".concat(p,"-link")},h),l):t.createElement("span",a({className:"".concat(p,"-link")},h),l),n=i,i=u?t.createElement(Qx,a({overlay:u,placement:"bottom"},c),t.createElement("span",{className:"".concat(p,"-overlay-link")},n,t.createElement(sx,null))):n,l?t.createElement("li",null,i,s&&t.createElement("span",{className:"".concat(p,"-separator")},s)):null};tw.__ANT_BREADCRUMB_ITEM=!0;var iw=tw,nw=function(e){var i=e.children,n=(0,t.useContext(Vo).getPrefixCls)("breadcrumb");return t.createElement("span",{className:"".concat(n,"-separator")},i||"/")};nw.__ANT_BREADCRUMB_SEPARATOR=!0;var rw=nw,aw=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function ow(e,i,n,r){var a=n.indexOf(e)===n.length-1,o=function(e,t){if(!e.breadcrumbName)return null;var i=Object.keys(t).join("|");return e.breadcrumbName.replace(new RegExp(":(".concat(i,")"),"g"),(function(e,i){return t[i]||e}))}(e,i);return a?t.createElement("span",null,o):t.createElement("a",{href:"#/".concat(r.join("/"))},o)}var sw=function(e,t){return e=(e||"").replace(/^\//,""),Object.keys(t).forEach((function(i){e=e.replace(":".concat(i),t[i])})),e},lw=function(e,t,i){var n=(0,Dt.Z)(e),r=sw(t||"",i);return r&&n.push(r),n},uw=function(e){var i,n=e.prefixCls,r=e.separator,o=void 0===r?"/":r,s=e.style,l=e.className,u=e.routes,c=e.children,h=e.itemRender,p=void 0===h?ow:h,d=e.params,f=void 0===d?{}:d,m=aw(e,["prefixCls","separator","style","className","routes","children","itemRender","params"]),v=t.useContext(Vo),y=v.getPrefixCls,g=v.direction,_=y("breadcrumb",n);if(u&&u.length>0){var b=[];i=u.map((function(e){var i,n=sw(e.path,f);return n&&b.push(n),e.children&&e.children.length&&(i=t.createElement(Os,{items:e.children.map((function(e){return{key:e.path||e.breadcrumbName,label:p(e,f,u,lw(b,e.path,f))}}))})),t.createElement(iw,{overlay:i,separator:o,key:n||e.breadcrumbName},p(e,f,u,b))}))}else c&&(i=Gt(c).map((function(e,t){return e?$o(e,{separator:o,key:t}):e})));var x=Q()(_,(0,q.Z)({},"".concat(_,"-rtl"),"rtl"===g),l);return t.createElement("nav",a({className:x,style:s},m),t.createElement("ol",null,i))};uw.Item=iw,uw.Separator=rw;var cw=uw,hw=function(){var e=A();return(0,mt.jsx)("div",{children:function(){var t=e.pathname.split("/").filter((function(e){return e})),i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};return(0,mt.jsx)("div",{children:(0,mt.jsxs)(cw,{children:[t.length>0?(0,mt.jsxs)(cw.Item,{children:["You Are Here ",">"," Next"]}):(0,mt.jsxs)(cw.Item,{children:["You Are Here ",">"," Next ",">"," TSCOBOX  ","/"," Overview"]}),t.map((function(e,n){var r="/".concat(t.slice(0,n+1).join("/"));return n===t.length-1?(0,mt.jsx)(cw.Item,{children:i(e)}):(0,mt.jsx)(cw.Item,{children:(0,mt.jsx)(H,{to:"".concat(r),children:i(e)})})}))]})})}()})},pw=function(){return(0,mt.jsxs)("div",{children:[(0,mt.jsx)("header",{children:(0,mt.jsx)(Bs,{})}),(0,mt.jsx)("div",{children:(0,mt.jsx)(hw,{})}),(0,mt.jsx)("main",{children:(0,mt.jsxs)(B,{children:[(0,mt.jsx)(F,{index:!0,path:"",element:(0,mt.jsx)(nx,{})}),(0,mt.jsx)(F,{path:"notifications",element:(0,mt.jsx)(rx,{})})]})})]})};n.createRoot(document.getElementById("root")).render((0,mt.jsx)(W,{children:(0,mt.jsx)(pw,{})}))}()}();
//# sourceMappingURL=main.1daf90a3.js.map